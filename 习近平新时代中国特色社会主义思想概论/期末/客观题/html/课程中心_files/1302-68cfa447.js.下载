(self.webpackChunklms=self.webpackChunklms||[]).push([[1302],{789785:function(e){e.exports=["$rootScope","$scope","$timeout",(e,t,i)=>i((function(){if(e.org)return e.org.copyright=t.copyright,e.org.filing_number=t.filingNumber}))]},786995:function(e,t,i){var r=i(383228),a=i(496486);i(682772),i(66992),i(747042),i(339714),i(864765),i(333948),i(560285),e.exports=["$rootScope","$scope","$routeParams","$http","$window","toastr",function(e,t,i,n,o,s){var u=r("#courseId").val(),c=r("#orgId").val(),d="True"===r("#isVisitor").data("value"),l=r("#userId").data("id");t.ui={showList:!1,inList:!1,showNavigationList:!1,inNavigationList:!1,showOperList:!1,inOperList:!1,showAppQRCode:!1,inAppQRCode:!1,showManualList:!1,inManualList:!1,showNavbarList:!1,inNavbarList:!1,langList:[]},e.org={name:"",logoUrl:""},t.getOrgName=function(){var i;return e.orgNamesI18n&&0!==Object.keys(e.orgNamesI18n).length&&e.orgName||(e.orgNamesI18n=t.orgNamesI18n,e.orgName=t.orgName),(null===(i=e.orgNamesI18n)||void 0===i?void 0:i[t.lang])||e.orgName},t.getOrgLogo=function(){return e.orgLogoUrl||(e.orgLogoUrl=t.orgLogoUrl),e.orgLogoUrl},t.getOrgShowName=function(){return e.orgShowName||(e.orgShowName=t.orgShowName),e.orgShowName},t.getOrgShowLogo=function(){return e.orgShowLogo||(e.orgShowLogo=t.orgShowLogo),e.orgShowLogo},t.isShowCalendar=!1,t.toggleCalendar=()=>(WebuiPopovers.hideAll(),r(".webui-popover.webui-popover-calendar.webui-no-padding.in").hide(),t.isShowCalendar=!t.isShowCalendar,t.isShowCalendar?r("body").addClass("fixed-content"):r("body").removeClass("fixed-content"),null);var p=()=>{var e=new URLSearchParams(window.location.search);e.has("lang")?(e.delete("lang"),o.location.search=e.toString()):e.has("locale")?(e.delete("locale"),o.location.search=e.toString()):o.location.reload()};t.changeLanguage=function(e){var t={language:e},i=document.domain,a=i.substring(i.indexOf("."));r.cookie("lang",e,{path:"/"}),r.cookie("lang",e,{path:"/",domain:a});return d?p():n.put("/api/user/language",t).success((function(){return p()})).error((e=>s.warning(e.errors)))},t.showLangList=function(){return r(".languages .entry").focus(),t.ui.showList=!0},t.hideLangList=()=>t.ui.showList=t.ui.inList,t.showNavigationList=function(){return r(".navigation .entry").focus(),t.ui.showNavigationList=!0},t.hideNavigationList=function(){if(!t.ui.inNavigationList)return t.ui.showNavigationList=!1},t.showUserOperationList=function(){r(".profile .entry").focus();var e=new CustomEvent("show-user-operation-list");return window.dispatchEvent(e),t.ui.showOperList=!0},t.hideUserOperationList=function(){if(!t.ui.inOperList)return t.ui.showOperList=!1},t.showAppQRCode=function(){return r(".app .entry").focus(),t.ui.showAppQRCode=!0},t.hideAppQRCode=function(){if(!t.ui.inAppQRCode)return t.ui.showAppQRCode=!1},t.showManualList=function(){return r(".manual .entry").focus(),t.ui.showManualList=!0},t.hideManualList=function(){if(!t.ui.inManualList)return t.ui.showManualList=!1},t.goToFAQ=function(t){o.open(t+"?lang=".concat(e.lang))},t.showNavbarList=function(){return r(".nav-bar .entry").focus(),t.ui.showNavbarList=!0},t.hideNavbarList=function(){t.ui.inNavbarList||t.ui.touchList?t.ui.touchList?(r(".nav-bar .entry").focus(),t.ui.touchList=!1):r(".nav-bar .entry").focus():t.ui.showNavbarList=!1},t.$on("clickManualListItem",(()=>t.ui.showManualList=!1)),t.openTrialPopup=function(){return r("#create-trial-student-popup").foundation("reveal","open"),e.$broadcast("openCreateTrialStudentPopup",!1),!1};var v=function(e,t){u=parseInt(u);var i=a.find(t,{courseId:u});i?i.updateTime=a.now():t.push({courseId:u,updateTime:a.now()});var r=a.map(a.sortBy(t,(e=>-e.updateTime)).slice(0,6),"courseId");if(!d&&!a.isEqual(r,e))return window.localStorage.setItem("visitedCoursesInfo",JSON.stringify(t)),window.localStorage.setItem("visitedCourseOrderList",JSON.stringify(r)),n.put("/api/user/recently-visited-courses",r)};t.$watch("courseId",(()=>function(){if(u&&l){var e=JSON.parse(window.localStorage.getItem("visitedCourseOrderList")),t=JSON.parse(window.localStorage.getItem("visitedCoursesInfo")),i=parseInt(window.localStorage.getItem("visitedCoursesUser"));return e&&t&&i===parseInt(l)?v(e,t):n.get("/api/user/recently-visited-courses").success((function(i){var r=i.visited_courses;e=a.map(r,"id"),t=[];for(var n=0;n<e.length;n++)u=e[n],t.push({courseId:u,updateTime:a.now()-10*n});return window.localStorage.setItem("visitedCoursesInfo",JSON.stringify(t)),window.localStorage.setItem("visitedCourseOrderList",JSON.stringify(e)),window.localStorage.setItem("visitedCoursesUser",l),v(e,t)}))}}())),t.trackZhiyunHome=function(){window.st.trackZhiyunVisit("visit_home",{})};return function(){!function(){var e=e=>t.ui.langList=e.lang_settings;d&&c?n.get("/anonymous-api/orgs/".concat(c,"/lang-settings")).success(e):n.get("/api/orgs/".concat(c,"/lang-settings")).success(e)}();var i,r;if(d&&c)return n.get("/anonymous-api/orgs/".concat(c,"/login-settings")).success((e=>t.loginSettings=e.login_settings));i=new URLSearchParams(window.location.search),(r=i.get("lang"))&&(["en-US","zh-CN","zh-TW"].includes(r)&&e.lang!==r?t.changeLanguage(r):(i.delete("lang"),o.location.search=i.toString()))}()}]},766832:function(e,t,i){var r=i(496486),a=i(730381),n=i(383228),o=i(261139);function s(e,t){var i;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(i=function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return u(e,t)}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,o=!0,s=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return o=e.done,e},e:function(e){s=!0,n=e},f:function(){try{o||null==i.return||i.return()}finally{if(s)throw n}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}i(682772),i(185827),i(747042),i(339714),i(132023),i(804723),i(323123),i(454747);var c=i(693604).replaceActivityTypeKey,d=i(117403).default;e.exports=["$window",function(e){var t=function(e,t){var i="learning_activity";return"exam"===t.type&&(i="exam_activity"),"classroom"===t.type&&(i="classroom_activity"),r.some(e,{activity_id:t.id,activity_type:i,completeness:"full"})},i=function(e,t,i){return e.chapter.module_id=t,e.chapter.syllabus_id=i},u=function(e,t,a,n,o,s,u){if(e.showSelect2=!1,(e.hideDefaultModuleTitle||t.hideDefaultModuleTitle)&&!n&&a.modules.length>0&&(n=a.modules[0].id),t.chapter={id:"0"},a.syllabus_enabled)if(o)t.chapter.id="syllabus_".concat(o),i(t,n,o);else if(n)t.chapter.id="module_".concat(n),i(t,n,0);else if(u&&t.isInSyllabusPage){var c=r.last(a.modules);if(r.isEmpty(c.syllabuses))t.chapter.id="module_".concat(c.id),i(t,c.id,0);else{var d=r.last(c.syllabuses);t.chapter.id="syllabus_".concat(d.id),i(t,c.id,d.id)}}return s((()=>e.showSelect2=!0))},l=(e,t,i)=>e.push({title:"".concat(t.title),key:"".concat(t.unique_key),id:t.id,optionType:"activity",type:t.type,completionCriterion:t.completion_criterion,isAvailable:p(t,i)}),p=function(e,t){return!r.isEmpty(e.completion_criterion)&&!r.find(t,{activity_id:e.id,activity_type:e.type})},v=function(e){return!["classroom","feedback"].includes(e.type)&&("forum"!=e.type||"crossCourse"!==e.data.participation_scope)},y=(e,t,i,r,a)=>(()=>{var n,o,u=[],c=s(t);try{for(c.s();!(n=c.n()).done;)o=void 0,o=n.value,e.activityHasPrerequisite(o)?u.push((()=>{var t,n=[],u=s(o.prerequisites);try{for(u.s();!(t=u.n()).done;){var c=t.value;c.activity_id===i.id&&c.activity_type===i.type&&(a===e.notScored&&[e.forumNoneCompletedInfo,e.homeworkNoneCompletedInfo].includes(c.completion_criterion.completion_info)||a!==e.notScored)?(c.completion_criterion.has_completed=r,n.push(c.completion_criterion.completion_info=a)):n.push(void 0)}}catch(e){u.e(e)}finally{u.f()}return n})()):u.push(void 0)}catch(e){c.e(e)}finally{c.f()}return u})(),f=function(e,t){var i=r.find(e,{id:t.id,type:t.type});if(i)return i.prerequisites=t.prerequisites};return{modulesAndSyllabuses(e){var t,i=r.sortBy(e.modules,"sort");return window.featureToggles.enableIndependentCoTeachingPermission&&null!==(t=window.globalData)&&void 0!==t&&t.courseRoles.includes("lecturer")&&(i=r.filter(i,(e=>{var t,i;return!e.lecturer_id||e.lecturer_id===(null===(t=window.globalData)||void 0===t||null===(i=t.user)||void 0===i?void 0:i.id)}))),r.reduce(i,(function(e,t){return r.isEmpty(t.name)&&r.isEmpty(t.activities)&&r.isEmpty(t.syllabuses)||(e.push({name:t.name,id:t.id,type:"module",value:"module_".concat(t.id),moduleId:t.id}),r.map(t.syllabuses,(i=>e.push({name:"".concat(i.summary),id:i.id,type:"syllabus",moduleId:t.id,syllabusId:i.id,value:"syllabus_".concat(i.id)})))),e}),[])},getPreActivities(e,t){var i=r.sortBy(e.modules,"sort");return r.reduce(i,(function(e,i){return r.isEmpty(i.activities)||(e.push({title:i.name,id:i.id,optionType:"module",isAvailable:!1}),function(e,t,i){r.map(r.sortBy(e.directActivities,"sort"),(function(e){return v(e)?l(i,e,t):i})),r.map(e.syllabuses,(function(e){return r.isEmpty(e.activities)?i:(i.push({title:"".concat(e.summary),id:e.id,optionType:"syllabus",isAvailable:!1}),r.map(r.sortBy(e.activities,"sort"),(function(e){return v(e)?l(i,e,t):i})))}))}(i,t,e)),e}),[])},syllabuses:e=>r.reduce(e.modules,(function(e,t){return r.each(t.syllabuses,(function(i){var r={id:i.id,module_name:t.name,ref:i};return e.push(r)})),e}),[]),showSyllabusSubItem(e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1]){if(e.show)return!0}else if(e.activities&&e.activities.length>0)return!0;return!1},getBelongTo(e){var t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";if(!e)return"";var a=[];return arguments.length>2&&void 0!==arguments[2]&&arguments[2]||a.push(e.department),null!==(t=window.globalData)&&void 0!==t&&t.hideGradeInfo||a.push(e.grade),a.push(e.klass),r.compact(r.map(r.compact(a),"name")).join(i)},calcProgress(e){var t=e=>e+1,i=a.utc(e.start_date),r=a.utc(e.end_date),n=a.utc();if(n<i)return e.status="notStarted",void(e.progress=0);if(n>r)return e.status="closed",void(e.progress=100);e.status="ongoing";var o=t(r.diff(i,"days")),s=t(n.diff(i,"days"));return e.progress=Math.floor(100*s/o)},calcProgressByDates(e){var t=e=>e+1;return r.each(e,(e=>e.progress=function(e){var i=a.utc(e.start_date),r=a.utc(e.end_date),n=a.utc();if(n<i)return e.status="notStarted",0;if(n>r)return e.status="closed",100;e.status="ongoing";var o=t(r.diff(i,"days")),s=t(n.diff(i,"days"));return Math.floor(100*s/o)}(e)))},initCourseExtraInfo(e){if(e.introductionUrl="/course/".concat(e.id),e.registered&&"notStarted"===e.status?e.url=e.introductionUrl:e.url="/course/".concat(e.id,"/content"),e.instructorNames=r.map(e.instructors,"name").join(" / "),e.durationAsWeeks=a(e.end_date).diff(a(e.start_date),"weeks")+1,e.passedAsWeeks=e.durationAsWeeks,e.is_closed||(e.passedAsWeeks=a().diff(a(e.start_date),"weeks")+1),e.is_started||(e.passedAsWeeks=0),e.passedAsWeeks.toString().length<2&&(e.passedAsWeeks="0"+e.passedAsWeeks),e.durationAsWeeks.toString().length<2&&(e.durationAsWeeks="0"+e.durationAsWeeks),!r.isEmpty(e.lesson_info_lst)){var t={start_time:void 0,end_time:void 0};e.lesson_info_lst.forEach((function(e){var i,r,a=null===(i=e.lesson_slot_info)||void 0===i?void 0:i.start_time,n=null===(r=e.lesson_slot_info)||void 0===r?void 0:r.end_time;t.start_time=t.start_time&&t.start_time<a?t.start_time:a,t.end_time=t.end_time&&t.end_time>n?t.end_time:n})),e.timeSlotRange=t}return e.durationAsWeeksInNum=parseInt(e.durationAsWeeks,10)},isActivityRead:t,addLearningActivityRead(e,t){if(Array.isArray(e))return e.push({activity_id:t.id,activity_type:"learning_activity",completeness:"full"})},refreshActivitiesReadForMaterialActivity:(e,t)=>(r.remove(e,{activity_id:t.activity_id,activity_type:"learning_activity"}),e.push({activity_id:t.activity_id,activity_type:"learning_activity",completeness:t.completeness})),refreshPrerequisitesStatus:(e,t,i,r)=>(()=>{var a,n=[],o=s(t.course.modules);try{for(o.s();!(a=o.n()).done;){var u=a.value;y(t,u.directActivities,e,i,r),n.push(u.syllabuses.map((a=>y(t,a.activities,e,i,r))))}}catch(e){o.e(e)}finally{o.f()}return n})(),getActivityIcon(e,i,r){var a=c(e.type),n="";n=t(i,e)||r?"-read":n,n=this.activityExpired(e)?"-expired":n;var o=e.active?"-active":"";return"icon-syllabus-".concat(a).concat(o).concat(n)},getActivityGreyIcon(e){var t=c(e.type);return"material"===t&&"PPT"==e.data.material_type?"font-syllabus-interaction":"select-student"!==t&&"select-group"!==t||!window.featureToggles.askQuestion?"font-syllabus-".concat(t):"font-syllabus-ask-question"},getActivityI18nMessage:(e,t)=>window.featureToggles.askQuestion&&["select_group","select_student"].includes(e.type)?d.t("ask-question.name"):"material"!==e.type?t[e.type]:"PPT"===e.data.material_type?"PPT":t[e.type],activityExpired:e=>!e.is_in_progress,activityUpcoming(e){if(e)return!e.is_started},activityPublishing:e=>!(!e||"scheduled"!==e.publish_type)&&e.is_in_progress,activityFinish:e=>"homework"===e.type&&"submitted"===e.status_code,activityOBERelated(e){var t;return!(null===(t=window.featureToggles)||void 0===t||!t.outcomeBasedEducation||!e)&&e.obe_tag},lessonDuration:(e,t)=>a(t).diff(a(e),"seconds"),videoDuration(e){if(!e)return 0;if(r.some(e,{status:"failed"}))return-2;if(r.some(e,{status:"processing"}))return-1;var t=r.reduce(e,((e,t)=>e+r.reduce(t.videos,((e,t)=>e+parseFloat(t.duration)),0)),0);return Math.round(t)},activityUrl(e,t){var i=arguments.length>3?arguments[3]:void 0;if(arguments.length>2&&void 0!==arguments[2]&&arguments[2]){var r="/course/".concat(t,"/learning-activity/full-screen#/").concat(e.id);return void 0!==i&&(r+="/topics/".concat(i)),["exam","classroom","feedback","questionnaire","live_record","race_answer","number_rollcall","qr_rollcall"].includes(e.type)&&(r="/course/".concat(t,"/learning-activity/full-screen#/")+e.type+"/".concat(e.id)),["select_student","select_group"].includes(e.type)&&(r="/course/".concat(t,"/ask-question/").concat(e.id)),r}switch(e.type){case"exam":case"classroom":case"feedback":case"questionnaire":case"danmu":case"vote":return"/course/".concat(t,"/learning-activity#/")+e.type+"/".concat(e.id);case"select_student":case"select_group":return"/course/".concat(t,"/ask-question/").concat(e.id);default:return"/course/".concat(t,"/learning-activity#/").concat(e.id)}},activityPopupName:e=>c(e.type),initChapterId(e,t,i,a){if(e.chapter={id:"0"},a){if(a.syllabus_id)return e.chapter.id="syllabus_".concat(a.syllabus_id);if(a.module_id)return e.chapter.id="module_".concat(a.module_id)}else{if(t.syllabus_id)return e.chapter.id="syllabus_".concat(t.syllabus_id);if(t.module_id)return e.chapter.id="module_".concat(t.module_id);if(e.isInSyllabusPage){var n=r.last(i.modules);if(r.isEmpty(n.syllabuses))return e.chapter.id="module_".concat(n.id);var o=r.last(n.syllabuses);return e.chapter.id="syllabus_".concat(o.id)}}},createActivity(e,t,i,r,a,n,o){var s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return e.courseCode=i.course_code,e.activityType=o,u(e,t,i,r,a,n,!0),e.$broadcast("bind".concat(o,"ForNew"),{course:i,moduleId:r,syllabusId:a,activityType:o,showSelectActivity:s})},editActivity(e,t,i,a,n,o,s){e.courseCode=i.course_code,e.activityType=s.type,u(e,t,i,a,n,o,!1);var c=r.map(s.type.split("_"),(e=>e.charAt(0).toUpperCase()+e.slice(1)));return e.$broadcast("bind".concat(c.join(""),"ForEdit"),s)},editModule(e,t,i,a){e.editing=!0;var o=e.name,s=function a(s){if("keydown"===s.type){if(27!==s.keyCode&&13!==s.keyCode)return}else if(s.target===n("input.module-name-edit")[0])return;if(s.stopPropagation(),!e.updating){delete e.editing;var u=function(t){return delete e.updating,e.id||(e.id=t.id),n("body")[0].removeEventListener("click",a,!0),n("body")[0].removeEventListener("keydown",a)},c=function(){return delete e.updating,e.name=o,e.id||r.remove(i.course.modules,e),n("body")[0].removeEventListener("click",a,!0),n("body")[0].removeEventListener("keydown",a)};return e.name&&e.name!==o&&27!==s.keyCode?(e.id?t.updateModule(e,u,c):t.addModule(e,u,c),e.updating=!0):(e.name=o,e.id||r.remove(i.course.modules,e),n("body")[0].removeEventListener("click",a,!0),n("body")[0].removeEventListener("keydown",a)),i.$apply()}};return a((function(){return n("body")[0].addEventListener("click",s,!0),n("body")[0].addEventListener("keydown",s),n("input.module-name-edit").focus()}))},showSlide:t=>(e.open("/user/slides/".concat(t),"_blank"),!0),canEditSelectedRubric:(e,t)=>t>0&&function(e,t){var i;if(!e)return!1;var a=r.map(e,"id");return i=parseInt(t),a.includes(i)}(e.rubrics,t)&&!e.ui.disableSelectRubric,rubricChanged(e){e.homework&&(-1===e.homework.rubric_id?e.$broadcast("openRubricPopup",-1,"add"):e.homework.rubric=r.find(e.rubrics,{id:parseInt(e.homework.rubric_id)}))},intraRubricChanged(e){-1===e.homework.intra_rubric_id?e.$broadcast("openRubricPopup",-1,"addIntra"):e.homework.intra_rubric=r.find(e.rubrics,{id:parseInt(e.homework.intra_rubric_id)})},handleHomeworkFormErrors(e){e.errors;return e.ui.showHomeworkAdvanced=!0},getDependantActivities(e,t,i){var r,a=[],n=function(t){if(i.activityHasPrerequisite(t))return(()=>{var i,r=[],n=s(t.prerequisites);try{for(n.s();!(i=n.n()).done;){var o=i.value;o.activity_id===e.id&&o.activity_type===e.type?r.push(a.push(t)):r.push(void 0)}}catch(e){n.e(e)}finally{n.f()}return r})()},o=s(t.modules);try{for(o.s();!(r=o.n()).done;){var u,c=r.value,d=s(c.directActivities);try{for(d.s();!(u=d.n()).done;)n(u.value)}catch(e){d.e(e)}finally{d.f()}var l,p=s(c.syllabuses);try{for(p.s();!(l=p.n()).done;){var v,y=s(l.value.activities);try{for(y.s();!(v=y.n()).done;)n(v.value)}catch(e){y.e(e)}finally{y.f()}}}catch(e){p.e(e)}finally{p.f()}}}catch(e){o.e(e)}finally{o.f()}return a},changeInfoOfDependantActivities:(e,t)=>e.map((e=>(()=>{var i,r=[],a=s(e.prerequisites);try{for(a.s();!(i=a.n()).done;){var n=i.value;n.activity_id===t.id&&n.activity_type===t.type?(n.completion_criterion.criterion_text=t.completion_criterion,r.push(n.title=t.title)):r.push(void 0)}}catch(e){a.e(e)}finally{a.f()}return r})())),getDependantActivity:(e,t,i,a,n)=>(()=>{var u,c=[],d=s(e);try{for(d.s();!(u=d.n()).done;){var l=u.value;r.find(t,{id:l.id,type:l.type})&&n.activityHasPrerequisite(l)?c.push((()=>{var e,t=[],n=s(o.copy(l.prerequisites));try{for(n.s();!(e=n.n()).done;){var u=e.value;u.activity_id===i.id&&u.activity_type===i.type?(r.remove(l.prerequisites,u),t.push(a.push({activity_id:l.id,activity_type:l.type}))):t.push(void 0)}}catch(e){n.e(e)}finally{n.f()}return t})()):c.push(void 0)}}catch(e){d.e(e)}finally{d.f()}return c})(),getUnusedPrerequisites(e,t){var i,a=[],n=s(o.copy(e.prerequisites));try{for(n.s();!(i=n.n()).done;){var u,c=i.value;c.key||(c.key="".concat(c.activity_type,"-").concat(c.activity_id)),u=c.key,r.map(t,"key").includes(u)||(a.push({activity_id:c.activity_id,activity_type:c.activity_type}),r.remove(e.prerequisites,c))}}catch(e){n.e(e)}finally{n.f()}return a},resetChapter(e){var t=r.find(e.modulesAndSyllabuses,{value:e.chapter.id});return e.chapter.module_id=t?t.moduleId:0,e.chapter.syllabus_id=t&&t.syllabusId?t.syllabusId:0},activityHasCriterion:e=>["exam","homework","forum","online_video"].includes(e.type)&&e.completion_criterion&&e.completion_criterion.match(/\d{1,3}/),getCriterion:e=>parseInt(e.completion_criterion.match(/\d{1,3}/)[0]),calculateCompletenessForHasCriterionActivity(e,t){if(e.data){if("reviewed"===t.completion_criterion_key)return"full"!==e.completeness?.1:(e=>"homework"===e.type&&(e.inter_score_map&&e.inter_score_map.id||e.intra_score_map&&e.intra_score_map.id))(t)?e.data.reviewed?e.data.reviewed:.1:100;if(e.data.completeness)return e.data.completeness>=t.criterion?100:e.data.completeness;if(e.data.score)return e.data.score>=t.criterion?100:Math.round(100*e.data.score/t.criterion)}else{if("online_video"!==t.type)return.1;if("full"===e.completeness)return 100}},updateCriterionInfoForActivities:(e,t)=>t.map((t=>e.modules.map((e=>(()=>{var i,r=[],a=s(e.directActivities);try{for(a.s();!(i=a.n()).done;){var n=i.value;n.id===t.id&&n.type===t.type&&(t.prerequisites=n.prerequisites),r.push(e.syllabuses.map((e=>(()=>{var i,r=[],a=s(e.activities);try{for(a.s();!(i=a.n()).done;)(n=i.value).id===t.id&&n.type===t.type?r.push(t.prerequisites=n.prerequisites):r.push(void 0)}catch(e){a.e(e)}finally{a.f()}return r})())))}}catch(e){a.e(e)}finally{a.f()}return r})())))),deleteActivityFromCourse(e,t){if(r.remove(e.activities,{id:t.id,type:t.type}),t.module_id)return(()=>{var i,a=[],n=s(e.modules);try{for(n.s();!(i=n.n()).done;){var u,c,d=i.value,l=s(o.copy(d.directActivities));try{for(l.s();!(c=l.n()).done;)(u=c.value).id===t.id&&u.type===t.type&&(r.remove(d.activities,u),r.remove(d.directActivities,u))}catch(e){l.e(e)}finally{l.f()}a.push(d.syllabuses.map((e=>(()=>{var i,a=[],n=s(o.copy(e.activities));try{for(n.s();!(i=n.n()).done;)(u=i.value).id===t.id&&u.type===t.type?(r.remove(d.activities,u),a.push(r.remove(e.activities,u))):a.push(void 0)}catch(e){n.e(e)}finally{n.f()}return a})())))}}catch(e){n.e(e)}finally{n.f()}return a})()},refreshPrerequisitesForDependantActivities:(e,t,i)=>i.map((i=>(()=>{var a,n=[],o=s(e);try{for(o.s();!(a=o.n()).done;){var u=a.value;i.id===u.activity_id&&i.type===u.activity_type?n.push(r.remove(i.prerequisites,(e=>e.activity_id===t.id&&e.activity_type===t.type))):n.push(void 0)}}catch(e){o.e(e)}finally{o.f()}return n})())),refreshPrerequisitesForAllDependantActivities:(e,t)=>(()=>{var i,a=[],n=s(e.modules);try{for(n.s();!(i=n.n()).done;){var o,u,c=i.value,d=s(c.directActivities);try{for(d.s();!(u=d.n()).done;)o=u.value,r.remove(o.prerequisites,(e=>e.activity_id===t.id&&e.activity_type===t.type))}catch(e){d.e(e)}finally{d.f()}a.push(c.syllabuses.map((e=>(()=>{var i,a=[],n=s(e.activities);try{for(n.s();!(i=n.n()).done;)o=i.value,a.push(r.remove(o.prerequisites,(e=>e.activity_id===t.id&&e.activity_type===t.type)))}catch(e){n.e(e)}finally{n.f()}return a})())))}}catch(e){n.e(e)}finally{n.f()}return a})(),removeOldActivity(e,t){var i=function(e){return!!e&&(e.id===t.id&&(e.type=t.type))};return r.remove(e.activities,i),r.remove(e.directActivities,i),r.each(e.syllabuses,(e=>r.remove(e.activities,i)))},addNewActivity(e,t){if(t.id===e.module_id){if(t.activities=t.activities||[],t.activities.push(e),!e.syllabus_id)return t.directActivities=t.directActivities||[],t.directActivities.push(e);var i=r.find(t.syllabuses,{id:e.syllabus_id});if(i)return i.activities=i.activities||[],i.activities.push(e)}},refreshPrerequisitesForCurrentActivity:(e,t,i)=>(f(t,e),f(i.activities,e),(()=>{var t,r=[],a=s(i.modules);try{for(a.s();!(t=a.n()).done;){var n=t.value;f(n.directActivities,e),r.push(n.syllabuses.map((t=>f(t.activities,e))))}}catch(e){a.e(e)}finally{a.f()}return r})()),uploadIsWebResource:e=>!!(e&&e.source&&e.third_part_referrer_id)&&-1!=e.key.indexOf("http")}}]},959242:function(e,t,i){var r=i(496486),a=i(383228),n=i(408901),o={positionClass:"toast-top-center",closeButton:!1,timeOut:"3000",showDuration:"100",hideDuration:"100",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut",preventDuplicates:!0};e.exports=["$location",function(e){var t=function(e,t,i){return n.options=r.merge(r.clone(o),e),t(r.escape(i))};return{warning(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e){var r=a("html").attr("lang");e=(()=>{switch(!1){case!/^en/.test(r):return"Sorry but our system is busy now, Try again later";case!/^zh-TW/.test(r):return"系統繁忙，請稍後重試";default:return"系统繁忙，请稍后重试"}})()}return t(i,n.warning,e)},success(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e){var r=a("html").attr("lang");e=(()=>{switch(!1){case!/^en/.test(r):return"Request success.";case!/^zh-TW/.test(r):return"繳交成功。";default:return"提交成功。"}})()}return t(i,n.success,e)},info(e){return t(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n.info,e)},error(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e?t(i,n.error,e):this.warning("",i)},decorateError(i){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(a,o)=>{if(null!=a&&a.message&&t({},n.error,null==a?void 0:a.message),(null!=a?null==a?void 0:a.message:void 0)||(null!=a?null==a?void 0:a.errors:void 0)||this.warning("",{}),i&&i(a,o),r)return e.path("/")}},decorateSuccess:e=>function(i,r){if(i.message&&t({},n.success,i.message),e)return e(i,r)},toastError(e){throw e.data&&(e.data.message?t({},n.error,e.data.message):e.data.errors||this.warning("",{})),e},mobileOptions:{showMethod:"fadeIn",hideMethod:"fadeOut"}}}]},635224:function(e,t,i){var r=i(730381),a=i(383228);t.datetime=()=>function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY.MM.DD HH:mm";r.locale(a("html").attr("lang"));var i=r(e);return i.isValid()?i.format(t):e},t.time=()=>function(e){r.locale(a("html").attr("lang"));var t=r(e);return t.isValid()?t.format("HH:mm"):e},t.date=()=>function(e,t){t||(t="YYYY.MM.DD"),r.locale(a("html").attr("lang"));var i=r(e);return i.isValid()?i.format(t):e},t.dateWithoutYear=()=>function(e){r.locale(a("html").attr("lang"));var t=r(e);return t.isValid()?t.format("MM-DD"):e}}}]);