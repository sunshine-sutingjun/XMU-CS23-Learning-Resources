(self.webpackChunklms=self.webpackChunklms||[]).push([[98035],{942518:function(e,r,t){var o=t(496486),n=t(730381),i=t(383228),c=t(993776),a=t(261139);t(682772),t(66992),t(185827),t(140561),t(556977),t(324603),t(339714),t(132023),t(115306),t(323123),t(333948);var s=t(693604);r.duration=()=>function(e){var r=o.filter(e.syllabuses||[],(e=>n(e.date).isValid()));if(0===r.length)return"";var t=r[0],c=r[r.length-1],a="YYYY.MM.DD";return n.locale(i("html").attr("lang")),"".concat(n(t.date).format(a)," ~ ").concat(n(c.date).format(a))},r.formatTime=()=>e=>s.formatTime(e),r.statFormatTime=()=>function(e){return e?s.formatTime(e):"- -"},r.humanizeBytes=()=>function(e){var r=["B","KB","MB","GB","TB"];if(0===e)return"0 "+r[0];var t=parseInt(Math.floor(Math.log(e)/Math.log(1024)));return"".concat((e/Math.pow(1024,t)).toFixed(2)," ").concat(r[t])},r.humanizeSpeed=()=>function(e){var r=["Bytes/s","KB/s","MB/s","GB/s","TB/s"];if(0===e)return"0 "+r[0];var t=parseInt(Math.floor(Math.log(e)/Math.log(1024)));return"".concat((e/Math.pow(1024,t)).toFixed(2)," ").concat(r[t])},r.courseFilter=()=>function(e,r){return!!e&&o.filter(e,(function(e){var t=r.notStarted&&"notStarted"===e.status,o=r.ongoing&&"ongoing"===e.status,n=r.closed&&"closed"===e.status;return t||o||n}))},r.limitLength=()=>function(e,r){var t=!r||!("number"==typeof r)||r<=3,o=!e||!("string"==typeof e)||e.length<=3;return t||o||e.length<=r?e:"".concat(e.substring(0,r-3),"...")},r.formatScore=()=>s.formatScore,r.statDatetime=()=>function(e){if(!e)return"- -";n.locale(i("html").attr("lang"));var r=n(e);return r.isValid()?r.format("YYYY.MM.DD HH:mm"):e},r.percent=()=>function(e,r){if(e||(e="0"),null!=e&&/^\d+\.?\d*$/.test(e)){if(r){var t=new c(e);return t=t<0?0:t.toFixed(r,c.ROUND_HALF_UP),"".concat(t,"%")}return"".concat(e,"%")}return e},r.truncateText=["$sanitize",e=>function(r,t){var o,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=()=>"<div>"+r+"</div>";if("string"!=typeof(r=e(r)))return r;n&&(o=c());var a=n?i(o).text().replace(/\t|\n/g,""):r;return a.length>t?"".concat(a.substr(0,t-3),"..."):a}],r.fileName=()=>function(e){if(!o.includes(e,"."))return e;var r=e.split(".");return r.pop(),r.join(".")},r.fileExtension=()=>function(e){if(!o.includes(e,"."))return"";var r=e.split(".");return".".concat(r.pop())},r.clearText=["$sanitize",e=>function(r){return r&&""!==r?e(r.replace(/<|>/g,(function(e){return"<"===e?"&lt;":"&gt;"})).replace(/\n/g,"<br/>")):""}],r.sanitizeHtml=["$sanitize",e=>function(r){var t=e(r),o={"rgb(227, 55, 55)":"color-E33737","rgb(226, 139, 65)":"color-E28B41","rgb(200, 167, 50)":"color-C8A732","rgb(32, 147, 97)":"color-209361","rgb(65, 140, 175)":"color-418CAF","rgb(170, 135, 115)":"color-AA8773","rgb(153, 153, 153)":"color-999999"},n=i(t="<div>"+t+"</div>");i("*[style]",n).each((function(e,r){if(o.hasOwnProperty(r.style.color)&&r.classList.add(o[r.style.color]),r.style.marginLeft){var t=Math.min(Math.round(parseInt(r.style.marginLeft)/40),10);r.classList.add("margin-level-"+t)}var n=r.style.fontSize;if(n&&(/px/.test(n)&&parseInt(n)<12||/em/.test(n)&&parseFloat(n)<.6))return r.style.fontSize="12px"}));var c=n.toArray().reduce(((e,r)=>e+r.outerHTML),"");return c.substring(5,c.length-6)}],r.year=()=>function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-";return a.isString(e)?e.split(r)[0]:e},r.month=()=>function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-";return a.isString(e)?e.split(r)[1]:e},r.day=()=>function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-";return a.isString(e)?e.split(r)[2]:e},r.trustSrc=["$sce",e=>r=>e.trustAsResourceUrl(r)],r.scoreAsActivity=()=>function(e){var r;if(!e.score||!e.score_percentage)return"0";r=e.score>100?100:e.score,r=new c(r);var t=new c(e.score_percentage);return r.times(t).dividedBy(100).toFixed(1)},r.uuidFilter=()=>function(e){return e&&0===e.indexOf("_uuid_")?"":e};var u=e=>String.fromCharCode(65+e%26);r.intToChar=()=>function(e){return a.isNumber(e)?u(e):a.isArray(e)&&o.every(e,a.isNumber)?o.map(e,u).join(" "):e},r.contains=()=>(e,r)=>-1!==e.indexOf(r),r.trustAsHtml=["$sce",e=>r=>e.trustAsHtml(r)],r.removeFilesizeTag=["$sce",e=>e=>e.replace(/<span class="file-size">[^>]+<\/span>/g,"")],r.removeHtmlTag=["$sce",e=>e=>e.replace(/<[^>]+>/g,"").replace(/&nbsp;/gi," ")],r.replaceImgTag=["$sce",e=>e=>e.replace(/<img.*?(?:>|\/>|img>|\/img>)/gi," [image] ")];var l=RegExp(/&(?:amp|lt|gt|quot|#39|#96);/g.source);r.unescape=()=>function(e){return Array.isArray(e)?o.map(e,(e=>unescape(e))):(e=null==(r=e)?"":r+"")&&l.test(e)?o.unescape(e):e;var r},r.displayName=()=>function(e){return"object"!=typeof e?"":"True"===i("#showNickname").val()&&e.nickname?"".concat(e.name," (").concat(e.nickname,")"):e.name||""},r.ellipsisText=()=>function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:14,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;return e.length>r?"".concat(e.substring(0,t),"...").concat(e.substring(e.length-t)):e},r.insert=()=>function(e,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null==e)return e;var o=[...e];return o.splice(t,0,r),o}},194410:function(e,r,t){function o(e,r){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,r){if(!e)return;if("string"==typeof e)return n(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return n(e,r)}(e))||r&&e&&"number"==typeof e.length){t&&(e=t);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,s=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return a=e.done,e},e:function(e){s=!0,c=e},f:function(){try{a||null==t.return||t.return()}finally{if(s)throw c}}}}function n(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,o=new Array(r);t<r;t++)o[t]=e[t];return o}t(132023),t(115306),t(864765),t(573210);var i=t(554174).checkUserLarkAuth,c=t(496486),a=t(693604);e.exports=["commonApi","resourceGroupApi","config","toastr","$http",function(e,r,t,n,s){var u=function(e){if(!e.type)return"slide";if("scorm"===e.type)return"scorm";if("evercam"===e.type)return"evercam";if("folder"===e.type)return"folder";if("video-quiz"===e.type)return"video-quiz";if("subject-lib"===e.type)return"subject-lib";if("lesson-resource"===e.type)return"lesson-resource";if("link"===e.type)return"link";if("other"===e.type)return"other";var r=a.fileExtension(e.name,!0);return c.includes(t.SUPPORTED_VIDEO_FORMATS,r)?"video":c.includes(t.SUPPORTED_AUDIO_FORMATS,r)?"audio":c.includes(t.SUPPORTED_IMAGE_FORMATS,r)?"image":c.includes(t.SUPPORTED_DOCUMENT_FORMATS,r)?"document":c.includes(t.SUPPORTED_FLASH_FORMATS,r)?"swf":"file"===e.type?"file":"other"},l=function(e){return e.isThirdPartResource="third_part_resource"===p.tab,e.selectable=!c.isFunction(p.checkIsSelectable)||p.checkIsSelectable(e),"lark"===p.tab?(e.allow_download=!1,e.allow_forward_seeking=!1,e.origin_allow_download=!1,e.source="LARK",e.status="ready",e.selected=!!c.find(p.selectedUploads,{token:e.token,source:"LARK"}),void(e.deleted=!1)):"wedrive"===p.tab?(e.allow_download=!0,e.allow_forward_seeking=!1,e.origin_allow_download=!0,e.source="WEDRIVE",e.status="ready",e.selected=!!c.find(p.selectedUploads,{fileid:e.fileid,source:"WEDRIVE"}),e.selectable=1!==e.file_type,void(e.deleted=!1)):"academic_learning_platform"===p.tab?(e.allow_download=!1,e.allow_forward_seeking=!1,e.origin_allow_download=!0,e.source="SHTVU",e.status="ready",void(e.deleted=!1)):("public_resource"!==p.tab&&(e.type=u(e),e.selected=!!c.find(p.selectedUploads,{id:e.id,isThirdPartResource:e.isThirdPartResource})),void(c.includes(["repository","public_resource","group_resource","vtrs_resource"],p.tab)&&(p.selectedIds&&(e.selected=p.selectedIds.includes(e.id)&&!e.is_folder,e.selected&&p.selectedUploads.push(e)),p.disabledIds&&(e.selectable=!p.disabledIds.includes(e.id)),e.is_folder&&!p.allowSelectFolder&&(e.selectable=!1),"vtrs_resource"===p.tab&&(e.id=e.upload_id),e.origin_allow_download=e.allow_download)))},d=()=>"knowledge_graph"===p.usePublicResourceScope?"/api/knowledge-nodes/".concat(p.nodeId,"/reference-resource"):"/api/public-resources",p={onlyReady:!1,showPublicResource:!0,showLarkSpace:!0,showAcademicLearningPlatformTab:!1,showVirtualClassroomTab:!1,showMaterialTab:!1,activity:null,allowSelectFolder:!1,tab:"repository",fileType:"all",mode:"thumbnail",keyword:"",nodeId:0,selectedIds:[],disabledIds:[],searching:!1,selectedUploads:[],singleSelectedUpload:void 0,supportFormat:[],limitTypes:[],singleSelect:!1,context:{},filters:[],linkTypes:[],vtrsId:"",path:[],usePublicResourceScope:"",identifyFileType:u,pagination:{currentList:[],currentPage:1,totalPage:1,inputPage:1},unSupportFolderUpload:!1,setPublicResourceScope(e){p.usePublicResourceScope=e},resetPagination(){p.pagination={currentList:[],currentPage:1,totalPage:1,inputPage:1}},changeFileType:(e,r)=>(p.resetPagination(),p.fileType=e,p.path=[],p.changePage(1,r)),changeVtrs:(e,r)=>(p.resetPagination(),p.vtrsId=void 0!==e?e:null,p.path=[],p.changePage(1,r)),getDefaultFileType:()=>1===p.limitTypes.length?p.limitTypes[0]:"all",changePath:(e,r)=>(p.path.push(e),p.changePage(1,r)),addUploads:e=>t.load().then((()=>(()=>{var r,t=[],n=o(e);try{for(n.s();!(r=n.n()).done;){var i=r.value;"academic_learning_platform"!==p.tab&&(i.type=u(i)),t.push(p.pagination.currentList.unshift(i))}}catch(e){n.e(e)}finally{n.f()}return t})())),removeUpload:e=>c.remove(p.pagination.currentList,{id:e.id}),cleanCreateFailed:()=>c.remove(p.pagination.currentList,{createFailed:!0}),search:e=>(p.searching=p.keyword.trim().length>0,p.changePage(1,e)),changePage:(o,a)=>function(o,a){var u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,f=function(e){var r,n=e.uploads||e.resources||(null===(r=e.data)||void 0===r?void 0:r.items)||[];return t.load().then((()=>{n.map((e=>l(e)))})),p.pagination={currentList:n,currentPage:e.page,totalPage:e.pages,inputPage:e.page},o()},m=function(e){return p.pagination={currentList:[],currentPage:1,totalPage:1,inputPage:1},o(),n.error(e.message)},g=()=>{i().then((e=>{if(!e.data.authorized){var r=window.location,t="".concat(r.pathname).concat(r.search).concat(r.hash),o="".concat(e.data.authorization_url,"&state=").concat(t);window.open(o,"_self")}}))},v=p.searching?p.keyword:"",y={keyword:v,includeSlides:p.context.includeSlides,includeSubjectLibs:p.context.includeSubjectLibs,includeVideoQuizzes:p.context.includeVideoQuizzes,includeLessonResources:p.context.includeLessonResources,limitTypes:p.limitTypes,fileType:p.fileType,fileExts:p.fileExts,parentId:p.path.length>0?p.path[p.path.length-1].id:0,folderToken:p.path.length>0?p.path.at(-1).token:"",resourceType:p.path.length>0?p.path[p.path.length-1].resource_type:null,filters:p.filters,linkTypes:p.linkTypes,only_ready:p.onlyReady};if(p.limitTypes.includes("courseware")&&(y.fileExts=["zip"]),["repository","material"].includes(p.tab))return e.getUserResources(a,u,y,f,m);if("vtrs_resource"===p.tab)return""!==p.vtrsId&&(y.vtrs_id=p.vtrsId),e.getVtrsesShareResources(a,u,y,f,m);if("third_part_resource"===p.tab)return e.getThirdPartUserResources(a,u,y,f,m);if("lark"===p.tab)return g(),e.getResourceFromLark(a,u,y.folderToken,f,m);if("wedrive"===p.tab){var _="/api/wedrive/files?page=".concat(a,"&page_size=").concat(u);p.path.length>0&&(_="/api/wedrive/files?page=".concat(a,"&page_size=").concat(u,"&file_id=").concat(p.path.at(-1).fileid)),s.get(_).success(f).error(m)}if("other_video_resources"===p.tab)return e.getOtherVideoResources(a,u,f,m);if("academic_learning_platform"===p.tab)return e.getAcademicLearningPlatformResources(a,u,v,p.courseCode,p.filterFileTypes,f,m);if("group_resource"===p.tab){var h,S,b=[],P=[],w={keyword:v,parent_id:0,group_folder_id:p.path.length>0?p.path[p.path.length-1].id:0,file_type:p.fileType,limit_types:p.limitTypes,sort_predicate:"created_at",reverse:!0},A=function(e){return e.resources.map((e=>{var r=e.upload;r.cc_license_code=e.cc_license_name,r.group_id=e.group.id,r.group_name=e.group.name,"folder"===r.type&&(r.is_folder=!0),r.allow_download=e.origin_allow_download,P.push(r)})),t.load().then((()=>{p.selectedUploads=[],P.map((e=>l(e)))})),S=b.length>0&&h==a?b.length>=u?b:b.concat(P):P,p.pagination={currentList:S,currentPage:e.page,totalPage:e.pages,inputPage:e.page},o()},T=function(e){h=e.page,b=e.folders,c.each(b,(function(e){e.is_folder=!0,e.selectable=!1,e.group_name=e.resource_group.name})),r.getAllPagedResourceGroupResources(a,u,w,A)};"all"===p.fileType?r.getAllPagedResourceGroupFolders(a,u,w,T):r.getAllPagedResourceGroupResources(a,u,w,A)}if("public_resource"===p.tab){var I,C=d();s.get(C,{params:{page:a,page_size:u,keyword:v,limit_types:p.limitTypes,parent_id:null===(I=p.path.at(-1))||void 0===I?void 0:I.resource_reference_id,file_type:p.fileType}}).success(f).error(m)}return"virtual_classroom"===p.tab?e.getVirtualClassroomResources(a,u,v,p.fileType,f,m):void 0}(a,o),getSelectedUploads:()=>p.singleSelect?p.singleSelectedUpload?[p.singleSelectedUpload]:[]:c.filter(p.selectedUploads,{selectable:!0}),copySelectedThirdPartResources(r){var t=p.getSelectedUploads();return 0===c.filter(t,{isThirdPartResource:!0}).length?r(t):function(r,t){return e.copyThirdPartResources(c.filter(r,{isThirdPartResource:!0}).map((e=>e.id)),(function(e){var o=e.uploads||[];return t(o.concat(c.filter(r,{isThirdPartResource:!1})))}),(function(){}))}(t,r)},clearSelected(){var e,r=o(p.pagination.currentList);try{for(r.s();!(e=r.n()).done;){e.value.selected=!1}}catch(e){r.e(e)}finally{r.f()}return p.selectedUploads=[],p.singleSelectedUpload=void 0},getSupportFormatString(e){if(p.fileExts&&p.fileExts.length)return".".concat(p.fileExts.join(",."));var r,t=[],n=o(e);try{for(n.s();!(r=n.n()).done;){var i=r.value;t=t.concat(p.supportFormat[i])}}catch(e){n.e(e)}finally{n.f()}return 0===t.length&&(t=a.getSupportedFormats()),".".concat(t.join(",."))},getSupportFormatMsg:e=>p.getSupportFormatString(e).replace(/\./g,""),getSupportFormatMsgWithSpaces:e=>p.getSupportFormatString(e).replace(/\./g," ").replace(/^[\s]+/,""),verifyPageIndexInput(){if(p.pagination.inputPage){var e=String(p.pagination.inputPage).replace(/\./,"");return p.pagination.inputPage=isNaN(e)||e<1||e>p.pagination.totalPage?p.pagination.currentPage:parseInt(e)}}};return t.load().then((function(){return p.supportFormat.video=t.SUPPORTED_VIDEO_FORMATS,p.supportFormat.audio=t.SUPPORTED_AUDIO_FORMATS,p.supportFormat.document=t.SUPPORTED_DOCUMENT_FORMATS,p.supportFormat.image=t.SUPPORTED_IMAGE_FORMATS,p.supportFormat.scorm="zip",p.supportFormat.evercam="zip",p.supportFormat.courseware="zip",p.supportFormat.swf=t.SUPPORTED_FLASH_FORMATS,p.supportFormat["open-office"]=t.SUPPORTED_OPEN_OFFICE_FORMATS})),p}]},330459:function(e,r,t){var o=t(383228),n=t(261139);e.exports=["toastr","performanceApi","$q",function(e,r,t){var i,c=o("#courseId").val(),a=t.defer(),s=null,u={},l=null,d=null,p={};return{initScorePercentage(){if(!p.id){r.getPerformanceScorePercentage(c,(function(e){return n.copy(e,p),a.resolve(p)}),(e=>a.reject(e)))}return a.promise},updateScorePercentage(e){p.score_percentage=e},clearCachedCourseStudentsPerformance(){s=null},initCourseStudentsPerformance(){return s?s.promise:this.refreshCourseStudentsPerformance()},initCourseStudentByUserId(e){if(u[e])return u[e];var o=t.defer();return r.initCourseStudentPerformance(c,e,(r=>{u[e]=r,o.resolve(r)})),o.promise},clearSpecificCachedStudentPerformance(e){u[e]&&(u[e]=null)},clearAllCachedStudentPerformance(){u={}},initCoursePagedStudentsPerformance(e){var o=t.defer();return r.initCoursePagedStudentsPerformance(c,e.pageIndex,e.pageSize,e.condition,(e=>o.resolve(e))),o.promise},initCourseStudentsName(){if(i)return i.promise;i=t.defer();return r.initCourseStudentsName(c,(e=>i.resolve(e))),i.promise},refreshCourseStudentsPerformance(){s=t.defer();return r.initCourseStudentsPerformance(c,(e=>s.resolve(e)),(function(){})),s.promise},initCoursePerformanceScoreSetting(){if(l)return l.promise;l=t.defer();return r.initCoursePerformanceScoreSetting(c,(e=>l.resolve(e)),(function(){})),l.promise},updateCoursePerformanceScoreSetting(){l=null},getCourseLeftScorePercent(){if(d)return d.promise;d=t.defer();return r.getLeftScorePercentage(c,(e=>d.resolve(e)),(function(){})),d.promise}}}]},776405:function(e,r,t){var o=t(496486);e.exports=["$http","toastr","commonApi",function(e,r,t){return{getPerformanceScorePercentage:t.getPerformanceScorePercentage,getPerformanceScoreSetting(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/course/".concat(t,"/performance/score-setting")).success(n).error(r.decorateError(i))},updatePerformanceScoreSetting(r,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:o.noop;return e.put("/api/course/".concat(r,"/performance/score-setting"),t).success(n).error(i)},getInteractions:r=>e.get("/api/courses/".concat(r,"/interactions")),saveInteractionScores:(r,t)=>e.put("/api/courses/interactions/".concat(r,"/score"),t),updateVoteById:(r,t)=>e.put("/api/courses/interactions/vote/".concat(r),t),initCourseStudentsPerformance(r,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/course/".concat(r,"/students-performance?isOriginalScore=true")).success(t).error(n)},initCoursePagedStudentsPerformance(r,t,n,i,c){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:o.noop;return e.get("/api/course/".concat(r,"/students-performance?isOriginalScore=true"),{params:{page:t,page_size:n,conditions:i}}).success(c).error(a)},initCourseStudentsName(r,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/course/".concat(r,"/students-performance?isOriginalScore=true&onlyStudentsName=true")).success(t).error(n)},initCourseStudentPerformance(r,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:o.noop;return e.get("/api/course/".concat(r,"/students-performance?isOriginalScore=true"),{params:{conditions:{user_ids:Array.isArray(t)?t:[t]}}}).success(n).error(i)},initCoursePerformanceScoreSetting(r,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/course/".concat(r,"/performance/score-setting")).success(t).error(n)},saveStudentPerformanceScore(r,t,n,i){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:o.noop;return e.put("/api/course/".concat(r,"/performance/score"),{student_id:t,score:n}).success(i).error(c)},getLeftScorePercentage(r,t,o){var n="/api/course/".concat(r,"/score-percentages");return e.get(n).success(t).error(o)}}}]},301253:function(e,r,t){var o=t(383228),n=t(261139);function i(e,r){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,r){if(!e)return;if("string"==typeof e)return c(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return c(e,r)}(e))||r&&e&&"number"==typeof e.length){t&&(e=t);var o=0,n=function(){};return{s:n,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==t.return||t.return()}finally{if(s)throw i}}}}function c(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,o=new Array(r);t<r;t++)o[t]=e[t];return o}e.exports=["toastr","$q","commonApi","groupApi",function(e,r,t,c){var a=o("#courseId").val(),s=r.defer(),u=null,l={},d={init:()=>(p(),s.promise),updateSetting:e=>(n.copy(e,l),l.has_advanced_rules=!!(l.arrive_late_as_absence||l.max_absence_times||l.leave_early_as_absence||l.on_personal_leave_as_absence)),setting:l,initGroupSets:function(){if(u)return u.promise;u=r.defer();return c.getGroupSets(a,0,(function(e){var r,t={},o=i(e.group_sets);try{for(o.s();!(r=o.n()).done;){var n=r.value;t[n.id]=n}}catch(e){o.e(e)}finally{o.f()}return u.resolve(t)})),u.promise},getGroups:function(e){var t=r.defer();return null!=e.groups?t.resolve(e.groups):c.getGroups(e.id,(function(r){return e.groups=r.groups,t.resolve(e.groups)}),t.reject,"name,members"),t.promise}},p=function(){return t.getCourseRollcallSetting(a,(function(e){return n.copy(e,d.setting),s.resolve(d.setting),d.updateSetting(e)}),(e=>s.reject(e)))};return d}]},548373:function(e,r,t){var o=t(383228),n=t(496486),i=t(993776),c=t(261139);function a(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var t=[],o=!0,n=!1,i=void 0;try{for(var c,a=e[Symbol.iterator]();!(o=(c=a.next()).done)&&(t.push(c.value),!r||t.length!==r);o=!0);}catch(e){n=!0,i=e}finally{try{o||null==a.return||a.return()}finally{if(n)throw i}}return t}(e,r)||function(e,r){if(!e)return;if("string"==typeof e)return s(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return s(e,r)}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,o=new Array(r);t<r;t++)o[t]=e[t];return o}t(491038),t(66992),t(185827),t(556977),t(454747),t(333948);var u=t(180736);e.exports=["$rootScope","$scope","$http","toastr","rollcallRepository","onlineVideoCompletenessRepository","$q","performanceRepository","modelHelper","scoreRepository","$window",function(e,r,t,s,l,d,p,f,m,g,v){var y=o("#courseId").val();r.errorMessage="",r.ui.validTotalPercentage=!0,r.ui.isPercentage100=r.ui.isPercentage100||!1,r.getActivityGreyIcon=m.getActivityGreyIcon,r.getActivityI18nMessage=m.getActivityI18nMessage,r.courseScoreSetting=r.courseScoreSetting||{},r.courseTemplatParams=r.courseScoreSetting.CourseTemplateParms||{master_score_percent:0},r.percentageData=r.percentageData||{},r.activityListFromMaster=[];var _=u(r),h=["online_video","interaction","homework","exam","forum"];r.isShowObe=e=>h.includes(e);var S=function(e){var t;if([r.scoreLeftPercent].every(Boolean)){var o=n.some(e,(e=>isNaN(e.score_percentage))),c=new i(r.rollcallSetting.score_percentage||0).plus(new i((null===(t=r.onlineVideoCompletenessSetting)||void 0===t?void 0:t.score_percentage)||0)).plus(new i(r.performanceSetting.score_percentage||0));o||(c=c.plus(n.reduce(e,(function(e,r){var t=r.score_percentage;return t?e.plus(new i(t)):e.plus(new i(0))}),new i(0))));var a=new i(r.scoreLeftPercent.score_percentage_total)-c;r.courseScoreSetting.limitCourseScorePercent=r.courseScoreSetting.limitCourseScorePercent?r.courseScoreSetting.limitCourseScorePercent:r.scoreLeftPercent.score_percentage_total,a=a<0?0:a.toFixed(1,i.ROUND_HALF_UP),r.totalPercentage=isNaN(c)?"-":"".concat(c,"%"),r.remainingPercentage=isNaN(a)?"-":"".concat(a,"%"),r.ui.validTotalPercentage=!isNaN(c)&&c>=0&&c<=100,r.ui.isPercentage100=100==c,r.courseScoreSetting.currentPercentage=isNaN(c)?0:c;var s=r.courseScoreSetting.currentPercentage-r.courseScoreSetting.limitCourseScorePercent;r.courseScoreSetting.excessPercentage=s>0?s:0}},b=function(){r.customScoreItemList?S(r.activityList.concat(r.customScoreItemList)):S(r.activityList),r.loading=!1},P=e=>n.forEach(e,(function(e){if(!e[1]||!e[0])return!0;var r=parseFloat(e[1].score_percentage);return e[0].score_percentage=r,e[1].score_percentage=r}));r.onChangeInput=function(e){"0."!==e&&(r.errorMessage="",r.errors={},b())},r.save=function(){_.show();var i={activity_score_percentages:n.map(r.activityList,(e=>({id:e.id,type:e.type,score_percentage:e.score_percentage,metrics:e.metrics}))),custom_score_percentages:n.map(r.customScoreItemList,(e=>({id:e.id,percentage:e.score_percentage,metrics:e.metrics}))),rollcall_score_percentage:r.rollcallSetting.score_percentage,performance_score_percentage:r.performanceSetting.score_percentage,online_video_completeness_score_percentage:r.onlineVideoCompletenessSetting.score_percentage,online_video_obe_metrics:r.onlineVideoCompletenessSetting.metrics};return t.put("/api/course/".concat(y,"/course-advance-setting"),{params:r.courseTemplatParams}),t.put("/api/courses/".concat(y,"/score-percentages"),i).success((function(){if(_.hide(),"excess"==r.courseScoreSetting.popupType)return o("#score-percentage-popup").foundation("reveal","close"),s.success(),void e.$broadcast("scorePercentageUpdated");P(n.zip(r.activities,r.activityList)),P(n.zip(r.customScoreItems,r.customScoreItemList)),r.percentageData.activityList=c.copy(r.activityList),r.percentageData.customScoreItemList=c.copy(r.customScoreItemList),l.updateSetting(r.rollcallSetting),f.updateScorePercentage(r.performanceSetting.score_percentage),d.updateScorePercentage(r.onlineVideoCompletenessSetting.score_percentage),e.$broadcast("scoreChanged"),o("#score-percentage-popup").foundation("reveal","close"),window.location.reload()})).error((function(e,t){_.hide(),400===t&&(r.errorMessage=function(e){if(e.rollcall_score_percentage)return e.rollcall_score_percentage[0];if(e.performance_score_percentage)return e.performance_score_percentage[0];if(e.online_video_completeness_score_percentage)return e.online_video_completeness_score_percentage[0];var r=e=>"string"==typeof e,t="",o=e.custom_score_percentages;return n.some(o,(function(e){if(r(e))t=e;else{if(!e.percentage)return!1;t=e.percentage[0]}return!0})),t||(o=e.activity_score_percentages,n.some(o,(function(e){if(r(e))t=e;else{if(!e.score_percentage)return!1;t=e.score_percentage[0]}return!0})),t)}(e.errors),r.errors=e.errors),404===t&&(o("#score-percentage-popup").foundation("reveal","close"),s.error(e.message),window.location.reload())}))},r.closePopup=function(){o("#score-percentage-popup").foundation("reveal","close")},v.addEventListener("obe-metrics-changed-event",(e=>{if(e.detail&&e.detail.activityType){var t=e.detail.activityType,o=e.detail.activityId;"custom_score"===t?r.customScoreItemList.forEach((r=>{r.id===o&&(r.metrics=e.detail.metrics)})):"online_video"===t?r.onlineVideoCompletenessSetting.metrics=e.detail.metrics:r.activityList.forEach((r=>{r.type===t&&r.id===o&&(r.metrics=e.detail.metrics)}))}}));var w=function(){r.openObeMetric&&p.all([g.initCourseObeMetrics(),g.initActivityMetricSetting()]).then((function(){var e=Array.from(arguments.length<=0?void 0:arguments[0]),t=a(e,2),o=t[0],n=t[1],i=["obe_metrics",y].join("_"),c={metrics:[],selected:{},programs:1};window.localStorage.removeItem(i),200===o.status&&(c.metrics=o.data.metrics,c.programs=o.data.programs),200===n.status&&(c.selected=n.data),window.localStorage.setItem(i,JSON.stringify(c)),r.obeMetricsInited=!0}))},A=function(){"excess"==r.courseScoreSetting.popupType&&setTimeout((function(){r.errors={activity_score_percentages:[],custom_score_percentages:[],performance_score_percentage:["error"],rollcall_score_percentage:["error"],online_video_completeness_score_percentage:["error"]},r.errors.activity_score_percentages=n.map(r.activityList,(function(){return{score_percentage:["error"]}})),r.errors.custom_score_percentages=n.map(r.activityList,(function(){return{percentage:["error"]}}))}),10)},T=function(){r.loading=!0,r.obeMetricsInited=!1,r.activityList=c.copy(r.percentageData.activityList),r.customScoreItemList=c.copy(r.percentageData.customScoreItemList);var e=[l.init(),d.init(),f.initScorePercentage(),g.initActivitiesPercentages(),g.initCustomScoreItems(),g.initScoreStatus(),f.getCourseLeftScorePercent()];return r.allowVirtualExperiment&&e.push(g.initVirtualExperimentPercentages()),p.all(e).then((function(){var e=Array.from(arguments.length<=0?void 0:arguments[0]),t=a(e,8),o=t[0],n=t[1],i=t[2],s=t[3],u=t[4],l=t[5],d=t[6],p=t[7];r.rollcallSetting=c.copy(o),r.onlineVideoCompletenessSetting=c.copy(n),r.performanceSetting=c.copy(i),p&&s.push(...p),r.activityList=c.copy(s),r.customScoreItemList=r.customScoreItemList||c.copy(u),r.scoreStatus=l.score_status,r.scoreLeftPercent=c.copy(d),b(),A(),w()}))};return r.$on("calculatePercentage",T),T()}]},6201:function(e,r,t){var o=t(383228),n=t(261139);t(788674),t(117727),e.exports=["$http","$q",function(e,r){var t=o("#courseId").val(),i=r.defer(),c={},a=!1;return{setting:c,init:()=>(c.id||a||(a=!0,e.get("/api/course/".concat(t,"/online-video-completeness/setting?no-loading-animation=true")).success((e=>{n.copy(e,c),i.resolve(c)})).finally((()=>{a=!1}))),i.promise),update:function(o){var i=r.defer(),a=n.copy(o);return"rate"===a.score_method&&delete a.custom_score_rule,e.put("/api/course/".concat(t,"/online-video-completeness/setting"),a).success((function(e){return n.copy(e,c),i.resolve(e)})).error((e=>i.reject(e))),i.promise},delete:r=>e.delete("/api/course/".concat(r,"/online-video-completeness/setting")).success((()=>n.copy({},c))),getScoresOfCourse:function(){var o=r.defer();return e.get("/api/course/".concat(t,"/online-video-completeness/scores")).success((e=>o.resolve(e))),o.promise},getScoresOfStudent:function(){var o=r.defer();return e.get("/api/course/".concat(t,"/online-video-completeness/score")).success((e=>o.resolve(e))),o.promise},updateScorePercentage:e=>c.score_percentage=e}}]},201305:function(e,r,t){var o=t(383228),n=t(496486),i=t(261139),c=t(730381);function a(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var t=[],o=!0,n=!1,i=void 0;try{for(var c,a=e[Symbol.iterator]();!(o=(c=a.next()).done)&&(t.push(c.value),!r||t.length!==r);o=!0);}catch(e){n=!0,i=e}finally{try{o||null==a.return||a.return()}finally{if(n)throw i}}return t}(e,r)||function(e,r){if(!e)return;if("string"==typeof e)return s(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return s(e,r)}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,o=new Array(r);t<r;t++)o[t]=e[t];return o}t(491038),t(556977),e.exports=["$http","$q","commonApi","toastr","activityRepository","onlineVideoCompletenessRepository",function(e,r,t,s,u,l){var d=o("#courseId").val(),p=o("#userId").attr("value"),f=r.defer(),m=r.defer(),g=r.defer(),v=r.defer(),y=r.defer(),_=r.defer(),h=r.defer(),S=r.defer(),b=r.defer(),P=r.defer(),w=r.defer(),A=r.defer(),T=r.defer(),I=r.defer(),C=r.defer(),F=r.defer(),x=r.defer(),R=r.defer(),E=r.defer(),L=r.defer(),O={},k=function(){var o=t.homeworkStudentStatus(d,(e=>{O.homework=e})),c=r.defer(),u=r.defer();r.all([o,c.promise,u.promise]).then((function(){var e=Array.from(arguments.length<=0?void 0:arguments[0]),r=a(e,3),t=(r[0],r[1]),o=r[2],c=n.each(i.copy(t.homework_activities),(function(e){e.type="homework",e.url="/course/".concat(d,"/learning-activity#/").concat(e.id);var r=n.find(t.scores,{activity_id:e.id})||{};return e.score=r.score,e.waitForScore=null===r.score||void 0===r.score,e.instructor_comment=r.instructor_comment,e.recommend=-1!==n.findIndex(o,{activity_id:e.id}),e.public=e.is_announce_score_time_passed,e.student_status=D(e),!0}));return m.resolve(c)}));return t.homeworkScores(d,"id,title,data,start_time,end_time,syllabus_id,module_id,is_announce_score_time_passed,score_percentage,created_at,prerequisites,module_sort,syllabus_sort,sort,published,is_in_progress",(e=>c.resolve(e)),s.decorateError()),e.get("/api/course/".concat(d,"/all-recommend-submissions?fields=activity_id")).success((e=>u.resolve(e.submissions))).error(s.decorateError())},M=function(){var e=t.examStudentStatus(d,(e=>{O.exam=e})),o=u.initExams(d),c=u.initExamScores(d),s=u.initExamsSubmissions(d);return r.all([e,o,c,s]).then((function(){var e=Array.from(arguments.length<=0?void 0:arguments[0]),r=a(e,4),t=(r[0],r[1]),o=r[2],c=r[3];return t=n.each(i.copy(t),(function(e){e.type="exam",e.url="/course/".concat(d,"/learning-activity#/exam/").concat(e.id);var r=n.find(o,{activity_id:e.id})||{};return e.score=r.score,e.submissions=c[e.id],e.leftTimes=e.submit_times-c[e.id].length,e.leftTimes<0&&(e.leftTimes=0),e.public=e.is_announce_score_time_passed,e.waitForScore=!(void 0===c[e.id]&&null===c[e.id]||null!==r.score&&void 0!==r.score),e.student_status=D(e),!0})),g.resolve(t)}))},U=function(){var o=t.classroomStudentStatus(d,(e=>{O.classroom=e})),c=u.initClassroom(d),l=u.initClassroomScores(d),p=r.defer();return e.get("/api/courses/".concat(d,"/classroom-exams/correct-percent")).success((e=>p.resolve(e))).error(s.decorateError()),r.all([o,c,l,p.promise]).then((function(){var e=Array.from(arguments.length<=0?void 0:arguments[0]),r=a(e,4),t=(r[0],r[1]),o=r[2],c=r[3];return t=n.filter(t,{type:"classroom"}),t=n.each(i.copy(t),(function(e){e.url="#";var r=n.find(o,{activity_id:e.id})||{};if(e.score=r.score,e.waitForScore=null===r.score||void 0===r.score,e.start_time=e.created_at,e.public=e.is_score_public,e.student_status=D(e),c[e.id]||0===c[e.id])return e.correctPercent=(100*c[e.id]).toFixed(1)})),n.remove(t,{status:"none"}),v.resolve(t)}))},j=function(){return t.customScoreItemScores(d,(e=>T.resolve(e.custom_score_items)),(function(){})),T.promise},D=function(e){return((O[e.type]||{})[e.id]||{})[p]||""},V={deferredHomeworks:r.defer(),deferredExams:r.defer(),deferredClassroom:r.defer(),deferredForums:r.defer(),deferredWeblink:r.defer(),deferredQuestionnaires:r.defer(),deferredInteractions:r.defer()};return{init:function(){var o,c,p,C,F,x,R,L,O,D;return t.course(d,"id,learning_mode,modules(id,name,sort,syllabuses(id,summary))",(e=>f.resolve(e)),s.decorateError()),e.get("/api/course/".concat(d,"/student-self-score")).success((e=>w.resolve(e))),k(),U(),M(),o=u.initForumActivity(d),c=u.initForumScores(d),r.all([o,c]).then((function(){var e=a(Array.from(arguments.length<=0?void 0:arguments[0]),2),r=e[0],t=e[1];return r=n.each(i.copy(r),(function(e){e.type="forum";var r=n.find(t,{activity_id:e.id})||{};return e.score=r.score,e.waitForScore=null===r.score||void 0===r.score,e.public=e.can_show_score,!0})),y.resolve(r)})),p=u.initWeblinkActivity(d),C=u.initWeblinkScores(d),r.all([p,C]).then((function(){var e=a(Array.from(arguments.length<=0?void 0:arguments[0]),2),r=e[0],t=e[1];return r=n.each(i.copy(r),(function(e){e.type="web_link";var r=n.find(t,{activity_id:e.id})||{};return e.score=r.score,e.waitForScore=null===r.score||void 0===r.score,e.public=e.can_show_score,!0})),_.resolve(r)})),F=u.initQuestionnaireActivity(d),x=u.initQuestionnaireScores(d),r.all([F,x]).then((function(){var e=a(Array.from(arguments.length<=0?void 0:arguments[0]),2),r=e[0],t=e[1],o=n.filter(r,(e=>e.data.is_scored));return r=n.each(i.copy(o),(function(e){e.type="questionnaire";var r=n.find(t,{activity_id:e.id})||{};return e.score=r.score,e.waitForScore=!1,e.public=!0,!0})),h.resolve(r)})),R=u.initInteractionActivity(d),L=u.initInteractionScores(d),r.all([R,L]).then((function(){var e=a(Array.from(arguments.length<=0?void 0:arguments[0]),2),r=e[0],t=e[1];return r=n.each(i.copy(r),(function(e){e.type="interaction";var r=n.find(t,{activity_id:e.id})||{};return e.score=r.score,e.waitForScore=null==e.score,e.public=!0,!0})),S.resolve(r)})),e.get("/api/course/".concat(d,"/rollcall-score")).success((function(e){var r=e;return b.resolve(r)})).error(s.decorateError()),e.get("/api/course/".concat(d,"/performance-score?isOriginalScore=true")).success((e=>P.resolve(e))).error(s.decorateError()),r.all([l.init(),l.getScoresOfStudent()]).then((function(){var e=a(Array.from(arguments.length<=0?void 0:arguments[0]),2),r=e[0],t=e[1];return r.id?(t={score_percentage:r.score_percentage,score:t.score,complete_rate:t.complete_rate},A.resolve(t)):A.resolve()})),j(),t.getAnnounceScoreSettings(d,(e=>I.resolve(e.announce_score_settings||{})),(function(){})),O=u.initCourseVirtualExperimentActivity(d),D=u.initCourseVirtualExperimentScores(d),r.all([O,D]).then((function(){var e=a(Array.from(arguments.length<=0?void 0:arguments[0]),2),r=e[0],t=e[1];return r=n.each(i.copy(r),(function(e){e.type="virtual_experiment";var r=n.find(t,{activity_id:e.id})||{};return e.score=r.score,e.waitForScore=null===r.score||void 0===r.score,e.public=e.can_show_score||!0,!0})),E.resolve(r)})),r.all([f.promise,m.promise,v.promise,g.promise,w.promise,y.promise,_.promise,h.promise,S.promise,b.promise,P.promise,A.promise,T.promise,I.promise,E.promise]).then((function(){var e=Array.from(arguments.length<=0?void 0:arguments[0]),r=a(e,15),t=r[0],o=r[1],i=r[2],c=r[3],s=r[4],u=r[5],l=r[6],d=r[7],p=r[8],f=r[9],m=r[10],g=r[11],v=r[12],y=r[13],_=r[14];t.rollcallScore=f,t.performanceScore=m,t.onlineVideoCompletenessScore=g,t.customScoreItems=v,t.announceScoreSettings=y;var h=o.concat(i).concat(c).concat(u).concat(l).concat(d).concat(_).concat(p);return t.allActivities=n.sortBy(h,["module_sort","syllabus_sort","sort","created_at"]),{course:t,courseStudentScore:s}}))},initScoreSection:function(){return e.get("/api/course/".concat(d,"/score-distribution?no-intercept=true")).success((e=>C.resolve(e||{}))),C.promise},initScoreTypeSetting:function(){return e.get("/api/courses/".concat(d,"/score-type-settings")).success((e=>L.resolve(e||{}))),L.promise},initActivitiesPercentages:function(){var e,o,c,s,l,p;return t.homeworkScores(d,"id,title,data,start_time,end_time,syllabus_id,module_id,is_announce_score_time_passed,score_percentage,created_at,prerequisites,module_sort,syllabus_sort,sort,published,is_in_progress",(function(e){var r=n.each(i.copy(e.homework_activities),(function(e){e.type="homework",e.score_published=e.is_announce_score_time_passed,e.url="/course/".concat(d,"/learning-activity#/").concat(e.id)}));return V.deferredHomeworks.resolve(r)}),(e=>V.deferredHomeworks.reject(e))),e=u.initClassroom(d),r.all([e]).then((function(){var e=a(Array.from(arguments.length<=0?void 0:arguments[0]),1)[0];return e=n.filter(e,{type:"classroom"}),e=n.each(i.copy(e),(function(e){return e.url="/course/".concat(d,"/learning-activity#/classroom/").concat(e.id),e.start_time=e.created_at})),V.deferredClassroom.resolve(e)}),(e=>V.deferredClassroom.reject(e))),o=u.initExams(d),r.all([o]).then((function(){var e=a(Array.from(arguments.length<=0?void 0:arguments[0]),1)[0];return e=n.each(i.copy(e),(function(e){e.type="exam",e.score_published=e.is_announce_score_time_passed,e.url="/course/".concat(d,"/learning-activity#/exam/").concat(e.id)})),V.deferredExams.resolve(e)}),(e=>V.deferredExams.reject(e))),c=u.initForumActivity(d),r.all([c]).then((function(){var e=a(Array.from(arguments.length<=0?void 0:arguments[0]),1)[0];return e=n.each(i.copy(e),(function(e){return e.type="forum",e.url="/course/".concat(d,"/learning-activity#/").concat(e.id),e.start_time=e.created_at,e.public=e.can_show_score,!0})),V.deferredForums.resolve(e)}),(e=>V.deferredForums.reject(e))),s=u.initWeblinkActivity(d),r.all([s]).then((function(){var e=a(Array.from(arguments.length<=0?void 0:arguments[0]),1)[0];return e=n.each(i.copy(e),(function(e){return e.type="web_link",e.url="/course/".concat(d,"/learning-activity#/").concat(e.id),e.start_time=e.created_at,e.public=e.can_show_score,!0})),V.deferredWeblink.resolve(e)}),(e=>V.deferredWeblink.reject(e))),l=u.initQuestionnaireActivity(d),r.all([l]).then((function(){var e=a(Array.from(arguments.length<=0?void 0:arguments[0]),1)[0],r=n.filter(e,(e=>e.data.is_scored));return e=n.each(i.copy(r),(function(e){return e.type="questionnaire",e.url="/course/".concat(d,"/learning-activity/full-screen#/questionnaire/").concat(e.id),e.start_time=e.created_at,e.public=!0,!0})),V.deferredQuestionnaires.resolve(e)}),(e=>V.deferredQuestionnaires.reject(e))),p=u.initInteractionActivity(d),r.all([p]).then((function(){var e=a(Array.from(arguments.length<=0?void 0:arguments[0]),1)[0];return e=n.each(i.copy(e),(function(e){return e.type="interaction",e.url="/course/".concat(d,"/learning-activity/full-screen#/").concat(e.id),e.start_time=e.created_at,e.public=!0,!0})),V.deferredInteractions.resolve(e)}),(e=>V.deferredInteractions.reject(e))),r.all([V.deferredHomeworks.promise,V.deferredClassroom.promise,V.deferredExams.promise,V.deferredForums.promise,V.deferredWeblink.promise,V.deferredQuestionnaires.promise,V.deferredInteractions.promise]).then((function(){var e=Array.from(arguments.length<=0?void 0:arguments[0]),r=a(e,7),t=r[0],o=r[1],i=r[2],c=r[3],s=r[4],u=r[5],l=r[6],d=t.concat(o).concat(i).concat(c).concat(s).concat(u).concat(l);return d=n.sortBy(d,["module_sort","syllabus_sort","sort","created_at"])}))},initCustomScoreItems:j,initScoreStatus:function(){return t.scoreStatus(d,(function(e){var r=e;return"string"==typeof e.published_at&&(r.published_at=c(e.published_at).format("YYYY.MM.DD HH:mm")),F.resolve(r)}),(e=>F.reject(e))),F.promise},initCourseObeMetrics:function(){return t.getCourseAvailableObeMetrics(d,(e=>x.resolve(e||{})),(function(){}))},initActivityMetricSetting:function(){return t.getActivityExistedObeMetrics(JSON.stringify({course_id:d,refers:[]}),(e=>R.resolve(e||{})),(function(){}))},initVirtualExperimentPercentages:function(){var e=u.initCourseVirtualExperimentActivity(d);return r.all([e]).then((function(){var e=Array.from(arguments.length<=0?void 0:arguments[0]),r=a(e,1),t=r[0];return t=n.each(i.copy(t),(function(e){return t.type="virtual_experiment",t.url="/course/".concat(d,"/learning-activity#/").concat(e.id),t.start_time=e.created_at,t.public=e.can_show_score||!0,!0}))}))}}}]}}]);