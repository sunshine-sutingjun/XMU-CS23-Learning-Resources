"use strict";(self.webpackChunklms=self.webpackChunklms||[]).push([[32910],{558794:function(e,t,n){n.d(t,{Z:function(){return l}});var i,a=n(495334),r=(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=function(e,t,n,i){var a,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var u=e.length-1;u>=0;u--)(a=e[u])&&(o=(r<3?a(o):r>3?a(t,n,o):a(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o},u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.onlyShowOverflowed=function(){var e=this.$refs.span,t=this.$refs.tooltip.$refs.popper;e.offsetWidth<e.scrollWidth||e.offsetHeight<e.scrollHeight?t.style.visibility="visiable":t.style.visibility="hidden"},t.prototype.onHide=function(){var e=this.$refs.tooltip.$refs.popper;e.style.visibility=null,e.style.display="none"},o([(0,a.fI)({required:!0})],t.prototype,"text",void 0),o([(0,a.fI)({default:"top"})],t.prototype,"placement",void 0),o([(0,a.fI)({default:!0})],t.prototype,"transfer",void 0),o([(0,a.fI)({default:""})],t.prototype,"transferClassName",void 0),o([(0,a.fI)({default:!1})],t.prototype,"customContent",void 0),o([(0,a.fI)({default:!1})],t.prototype,"htmlTips",void 0),t=o([(0,a.wA)({name:"tooltip-advanced"})],t)}(a.w3),l=(0,n(551900).Z)(u,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Tooltip",{ref:"tooltip",attrs:{content:e.text,placement:e.placement,transfer:e.transfer,"transfer-class-name":e.transferClassName},on:{"on-popper-show":e.onlyShowOverflowed,"on-popper-hide":e.onHide},scopedSlots:e._u([e.customContent||e.htmlTips?{key:"content",fn:function(){return[n("div",{domProps:{innerHTML:e._s(e.text)}})]},proxy:!0}:null],null,!0)},[e._v(" "),e.customContent?n("div",{ref:"span",staticClass:"text-too-long",domProps:{innerHTML:e._s(e.text)}}):n("span",{ref:"span",staticClass:"text-too-long"},[e._v(e._s(e.text))])])}),[],!1,null,"a126b194",null).exports},832910:function(e,t,n){n.d(t,{Z:function(){return K}});n(141817),n(66992),n(788674),n(333948);var i=n(925706),a=n(202669),r=(n(702707),n(140561),n(319601),n(132023),n(923157),n(454747),n(681423)),o=n(919094),u=n(356264),l=n(558794),s=n(693604),c=n(48496),f=n(28740),d=n(356744),p=n(15477),v=n(651469),g=n(631342),b=n(177597),y=n(172025),h=function(){return(h=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},m=function(e,t,n,i){return new(n||(n=Promise))((function(a,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function u(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,u)}l((i=i.apply(e,t||[])).next())}))},j=function(e,t){var n,i,a,r,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return r={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function u(u){return function(l){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,u[0]&&(o=0)),o;)try{if(n=1,i&&(a=2&u[0]?i.return:u[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,u[1])).done)return a;switch(i=0,a&&(u=[2&u[0],a.value]),u[0]){case 0:case 1:a=u;break;case 4:return o.label++,{value:u[1],done:!1};case 5:o.label++,i=u[1],u=[0];continue;case 7:u=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==u[0]&&2!==u[0])){o=0;continue}if(3===u[0]&&(!a||u[1]>a[0]&&u[1]<a[3])){o.label=u[1];break}if(6===u[0]&&o.label<a[1]){o.label=a[1],a=u;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(u);break}a[2]&&o.ops.pop(),o.trys.pop();continue}u=t.call(e,o)}catch(e){u=[6,e],i=0}finally{n=a=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,l])}}},_=(0,i.aZ)({components:{GenerateButton:d.Z,BloomSelector:p.Z,TooltipExt:l.Z,RemainingCreditsTip:b.default,SubjectSelector:y.Z,OutputLanguageSelector:v.Z},props:{activity:{type:Object,default:function(){}},upload:{type:Object,default:function(){}},generating:{type:Boolean,default:!1},subjects:{type:Array,default:function(){return[]}}},setup:function(e,t){var n=this,a=(0,i.iH)(0),r=(0,i.iH)([{value:"single",label:t.root.$i18n.t("subjectType.singleSelection"),disabled:!1,icon:"single-icon"},{value:"multiple",label:t.root.$i18n.t("subjectType.multipleSelection"),disabled:!1,icon:"multiple-icon"},{value:"fillInBlank",label:t.root.$i18n.t("subjectType.fillInBlank"),disabled:!1,icon:"fib-icon"},{value:"trueOrFalse",label:t.root.$i18n.t("subjectType.trueOrFalse"),disabled:!1,icon:"tof-icon"}]),o=(0,i.iH)([{type:"single",count:5}]),u=(0,i.Fl)((function(){var e=o.value.map((function(e){return e.type}));return r.value.map((function(t){return h(h({},t),{disabled:e.includes(t.value)})}))})),l=(0,i.Fl)((function(){var e={};return o.value.forEach((function(t){e[t.type]=t.count})),r.value.forEach((function(t){e[t.value]||(e[t.value]=0)})),e})),d=(0,i.iH)(["understand"]),p=(0,i.iH)("auto"),v=(0,i.Fl)((function(){return t.root.$store.getters["airCredit/hasRemainingCredits"]})),b=(0,i.Fl)((function(){return("ready"===e.upload.status||"processing"===e.upload.status&&"video"===e.upload.type)&&v.value&&(l.value.single||l.value.multiple||l.value.fillInBlank||l.value.trueOrFalse)})),y=(0,f._E)().submitBloomCognitiveDomains,_=(0,i.Fl)((function(){return e.generating?"".concat(t.root.$i18n.t("air.generating"),"..."):e.subjects.length>0?t.root.$i18n.t("air.genContinue"):"".concat(t.root.$i18n.t("air.generateQuestion"))}));m(n,void 0,void 0,(function(){var e,t;return j(this,(function(n){switch(n.label){case 0:return e=a,[4,(0,g.getAiQuizSettings)()];case 1:return e.value=(null===(t=n.sent())||void 0===t?void 0:t.quizCountLimit)||1,a.value<l.value.single&&(l.value.single=a.value),a.value<l.value.multiple&&(l.value.multiple=a.value),a.value<l.value.fillInBlank&&(l.value.fillInBlank=a.value),[2]}}))}));return{subjectsConfig:o,subjectOptions:r,subjectSelectorUpdate:function(e,t){e.value&&(o.value[t].type=e.value),e.count>=0&&(o.value[t].count=e.count)},addSubjectConfig:function(){if(!e.generating&&r.value.length!==o.value.length){var t=r.value.find((function(e){return!o.value.map((function(e){return e.type})).includes(e.value)}));o.value.push({type:(null==t?void 0:t.value)||"",count:5})}},deleteSubjectConfig:function(e){o.value.splice(e,1)},subjectOptionsFilter:u,subjectsGenerateConfig:l,generate:function(){b.value&&(l.value.single+l.value.multiple+l.value.fillInBlank+l.value.trueOrFalse<=a.value?t.emit("generate",{locale:p.value,subjectsGenerateConfig:l.value,bloomCognitiveDomains:y(d.value)}):c.Toast.error(t.root.$i18n.t("air.generateQuestionCountLimit",[a.value])))},generatButtonText:_,bloomCognitiveDomains:d,fileTypeByExtension:s.fileTypeByExtension,allowGenerate:b,questionsInputBlur:function(e,t){Number(e)>0||(l.value[t]=0)},currentLanguage:p}}}),w=n(551900),S=(0,w.Z)(_,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"designQuizPanel"},[n("div",{staticClass:"document-content"},[n("i",{class:["font","font-file-"+e.fileTypeByExtension(e.upload)]}),e._v(" "),n("TooltipExt",{attrs:{text:e.upload.name}})],1),e._v(" "),n("form",{staticClass:"design-form"},[n("div",{staticClass:"subjects-conent"},[n("div",{staticClass:"subjectsLabel"},[e._v(e._s(e.$t("air.typesAndQuantity")))]),e._v(" "),n("div",{staticClass:"subjects"},e._l(e.subjectsConfig,(function(t,i){return n("SubjectSelector",{key:t.type,attrs:{generating:e.generating,type:t.type,count:t.count,subjectOptions:e.subjectOptionsFilter,showDelete:e.subjectsConfig.length>1},on:{update:function(t){return e.subjectSelectorUpdate(t,i)},delete:function(t){return e.deleteSubjectConfig(i)}}})})),1),e._v(" "),e.subjectsConfig.length<e.subjectOptions.length?n("div",{staticClass:"addSubjectConfig"},[n("a",{staticClass:"addButton",class:{disabledHover:e.generating},on:{click:e.addSubjectConfig}},[n("i",{staticClass:"font font-ai-add"}),e._v("\n          "+e._s(e.$t("air.addSubject"))+"\n        ")])]):e._e()]),e._v(" "),n("BloomSelector",{attrs:{disabled:e.generating},model:{value:e.bloomCognitiveDomains,callback:function(t){e.bloomCognitiveDomains=t},expression:"bloomCognitiveDomains"}}),e._v(" "),n("OutputLanguageSelector",{attrs:{disabled:e.generating},model:{value:e.currentLanguage,callback:function(t){e.currentLanguage=t},expression:"currentLanguage"}}),e._v(" "),n("div",{staticClass:"buttonsbuttons"},[n("GenerateButton",{attrs:{disabled:!e.allowGenerate,loading:e.generating},on:{click:function(t){return e.generate()}}},[e._v("\n        "+e._s(e.generatButtonText)+"\n      ")]),e._v(" "),n("RemainingCreditsTip",{attrs:{category:e.activity.type}})],1)],1),e._v(" "),n("div",{staticClass:"generateTips"},[n("span",[e._v(e._s(e.$t("air.llmTips")))])])])}),[],!1,null,"3eac4272",null).exports,C=n(391737),$=n(311610),k=n(758942),E=n(146273),x=n(817172),z=n(29394),T=n(439222),O=n(386933),L=n(420278),F=n(407035),Z=n(5758),Q=function(){return(Q=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},B=function(e,t,n,i){return new(n||(n=Promise))((function(a,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function u(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,u)}l((i=i.apply(e,t||[])).next())}))},I=function(e,t){var n,i,a,r,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return r={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function u(u){return function(l){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,u[0]&&(o=0)),o;)try{if(n=1,i&&(a=2&u[0]?i.return:u[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,u[1])).done)return a;switch(i=0,a&&(u=[2&u[0],a.value]),u[0]){case 0:case 1:a=u;break;case 4:return o.label++,{value:u[1],done:!1};case 5:o.label++,i=u[1],u=[0];continue;case 7:u=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==u[0]&&2!==u[0])){o=0;continue}if(3===u[0]&&(!a||u[1]>a[0]&&u[1]<a[3])){o.label=u[1];break}if(6===u[0]&&o.label<a[1]){o.label=a[1],a=u;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(u);break}a[2]&&o.ops.pop(),o.trys.pop();continue}u=t.call(e,o)}catch(e){u=[6,e],i=0}finally{n=a=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,l])}}},P=(0,i.aZ)({components:{Generating:k.Z,SingleSubject:E.Z,MultipleSubject:x.Z,FillInBlankSubject:z.Z,TrueOrFalseSubject:T.Z,ShortAnswerSubject:O.Z,StreamSubjects:L.Z,CommonTag:F.Z,SvgIcon:$.Z},props:{activity:{type:Object,default:function(){}},generating:{type:Boolean,default:!1},generateFail:{type:Boolean,default:!1},subjects:{type:Array,default:function(){return[]}},streamSubjects:{type:Array,default:function(){return[]}},upload:{type:Object,default:function(){}}},setup:function(e,t){var n=this,a=(0,i.Fl)((function(){return!e.generating&&!e.subjects.length})),r=(0,i.Fl)((function(){return e.generating||e.subjects.length})),o=function(t){void 0===t&&(t=!1),Z.Z.$emit("ai-generate-success"),t&&Z.Z.$emit("ai-quiz-preview-summary"),function(t){var n;void 0===t&&(t=!1);var i=(0,C.useAngularScope)();"document"!==e.upload.type||(null===(n=document.querySelector("[ng-controller=FilePreviewerController]"))||void 0===n?void 0:n.querySelector(".pdf-reader-detail"))?i.$broadcast("updateActivityQuizzes",{previewFile:!1,openQuizPanel:t,uploadId:e.upload.id,activityId:e.activity.id}):i.$broadcast("updateActivityQuizzes",{previewFile:t,openQuizPanel:t,uploadId:e.upload.id,activityId:e.activity.id})}(t)},u=function(){return B(n,void 0,void 0,(function(){var i,a,r,o,u,l;return I(this,(function(s){switch(s.label){case 0:return e.upload.aiQuiz&&e.upload.aiQuiz.id?(r=g.updateAiQuizzes,o=[e.upload.aiQuiz.id],l={},[4,B(n,void 0,void 0,(function(){var t,n,i;return I(this,(function(a){switch(a.label){case 0:return[4,(0,(0,f.ke)().loadQuizSubjects)(e.upload.aiQuiz.id)];case 1:return t=a.sent(),(n=e.subjects).forEach((function(e,n){e.sort=t.length+n})),(i=t.concat(n)).forEach((function(e,t){e.sort=t})),[2,i]}}))}))]):[3,3];case 1:return[4,r.apply(void 0,o.concat([(l.subjects=s.sent(),l),!0]))];case 2:return i=s.sent(),i[0],(a=i[1])?(Z.Z.$emit("ai-generate-modal-close",!0),null==t||t.root.$Message.success(t.root.$i18n.t("air.updateSuccess"))):null==t||t.root.$Message.error(t.root.$i18n.t("air.updateFail")),[2,a];case 3:return[4,(0,g.createAiQuizzes)(e.activity.id,{uploadReferenceId:e.upload.reference_id,subjects:e.subjects})];case 4:return(u=s.sent())?(Z.Z.$emit("ai-generate-modal-close",!0),null==t||t.root.$Message.success(t.root.$i18n.t("air.saveSuccess"))):null==t||t.root.$Message.error(t.root.$i18n.t("air.saveFail")),[2,u]}}))}))},l=(0,i.iH)(!1),s=(0,i.iH)(!1),c=!1,d=(0,i.iH)(),p=function(){c=d.value.scrollTop+d.value.clientHeight+60>=d.value.scrollHeight},v=function(){c&&d.value&&(d.value.scrollTop=d.value.scrollHeight-d.value.clientHeight)};return(0,i.YP)((function(){return e.generating}),(function(e){e?(c=!0,(0,i.Y3)((function(){v(),d.value.addEventListener("scroll",p)}))):(c=!1,d.value.removeEventListener("scroll",p))})),(0,i.YP)((function(){return e.streamSubjects}),(function(e){v()})),{quizListRef:d,showBlank:a,showDataList:r,subjectEditing:l,saving:s,save:function(){return B(n,void 0,void 0,(function(){return I(this,(function(e){switch(e.label){case 0:return l.value?[2]:(s.value=!0,[4,u()]);case 1:return e.sent()&&o(),s.value=!1,[2]}}))}))},saveAndPreview:function(){return B(n,void 0,void 0,(function(){return I(this,(function(e){switch(e.label){case 0:return l.value?[2]:(s.value=!0,[4,u()]);case 1:return e.sent()&&o(!0),s.value=!1,[2]}}))}))},resetTurlyAnswer:function(n,i){e.subjects.forEach((function(e){e.id===i.id&&t.root.$set(e,"options",e.options.map((function(e){return Q(Q({},e),{isAnswer:e.id===n})})))}))},subjectUpdate:function(n){t.root.$set(e.subjects,e.subjects.findIndex((function(e){return e.id===n.id})),n),l.value=!1}}}}),A=(0,w.Z)(P,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"quizListPanel"},[e.showDataList?n("div",{staticClass:"quizListContent"},[e.generating?e._e():n("div",{staticClass:"statistic"},[e._v(e._s(e.$t("air.Xquestions",[e.subjects.length])))]),e._v(" "),n("div",{ref:"quizListRef",staticClass:"quizList",class:{isGenerating:e.generating}},[e._l(e.subjects,(function(t,i){return["single_selection"===t.type?n("SingleSubject",{key:t.sort,attrs:{disabled:"",showDelete:!e.generating,allowDelete:"",allowEdit:!e.generating,subject:t,index:i+1},on:{delete:function(){return e.$emit("delete",i)},select:e.resetTurlyAnswer,save:e.subjectUpdate,edit:function(){return e.subjectEditing=!0},cancel:function(){return e.subjectEditing=!1}}}):e._e(),e._v(" "),"multiple_selection"===t.type?n("MultipleSubject",{key:t.sort,attrs:{disabled:"",showDelete:!e.generating,allowDelete:"",allowEdit:!e.generating,subject:t,index:i+1},on:{delete:function(){return e.$emit("delete",i)},select:e.resetTurlyAnswer,save:e.subjectUpdate,edit:function(){return e.subjectEditing=!0},cancel:function(){return e.subjectEditing=!1}}}):e._e(),e._v(" "),"fill_in_blank"===t.type?n("FillInBlankSubject",{key:t.sort,attrs:{disabled:"",showDelete:!e.generating,allowDelete:"",allowEdit:!e.generating,index:i+1,subject:t},on:{delete:function(){return e.$emit("delete",i)},save:e.subjectUpdate,edit:function(){return e.subjectEditing=!0},cancel:function(){return e.subjectEditing=!1}}}):e._e(),e._v(" "),"true_or_false"===t.type?n("TrueOrFalseSubject",{key:t.sort,attrs:{disabled:"",showDelete:!e.generating,allowDelete:"",allowEdit:!e.generating,subject:t,index:i+1},on:{delete:function(){return e.$emit("delete",i)},select:e.resetTurlyAnswer,save:e.subjectUpdate,edit:function(){return e.subjectEditing=!0},cancel:function(){return e.subjectEditing=!1}}}):e._e(),e._v(" "),"short_answer"===t.type?n("ShortAnswerSubject",{key:t.sort,attrs:{disabled:"",showDelete:!e.generating,allowDelete:"",allowEdit:!e.generating,subject:t,index:i+1},on:{delete:function(){return e.$emit("delete",i)},select:e.resetTurlyAnswer,save:e.subjectUpdate,edit:function(){return e.subjectEditing=!0},cancel:function(){return e.subjectEditing=!1}}}):e._e()]})),e._v(" "),e.generating&&e.streamSubjects.length?n("StreamSubjects",{attrs:{streamSubjects:e.streamSubjects}}):e._e(),e._v(" "),e.generating?n("Generating",{attrs:{simpleMode:!!e.streamSubjects.length||!!e.subjects.length}}):e._e()],2),e._v(" "),e.generating?e._e():n("div",{staticClass:"buttons"},[e.saving?n("div",{staticClass:"loading-spinner"},[e._m(0)]):[n("Button",{attrs:{disabled:e.subjectEditing,type:"primary"},on:{click:function(t){return e.save()}}},[e._v("\n          "+e._s(e.$t("air.save"))+"\n        ")]),e._v(" "),e.upload.aiQuiz?e._e():n("Button",{attrs:{disabled:e.subjectEditing},on:{click:function(t){return e.saveAndPreview()}}},[e._v("\n          "+e._s(e.$t("air.saveAndView"))+"\n        ")])]],2)]):e._e(),e._v(" "),!e.subjects&&e.generateFail?n("div",{staticClass:"quizListBlank"},[n("SvgIcon",{attrs:{name:"ai-generate-fail"}}),e._v(" "),n("span",[e._v(e._s(e.$t("air.generateFail")))])],1):e._e(),e._v(" "),e.showBlank?n("div",{staticClass:"quizListBlank"},[n("SvgIcon",{attrs:{name:"ai-generate-empty"}}),e._v(" "),n("span",[e._v(e._s(e.$t("air.noQuestions")))])],1):e._e()])}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"spinner"},[t("div",{staticClass:"mask"},[t("div",{staticClass:"maskedCircle"})])])}],!1,null,"bd797400",null).exports,q=n(153166),H=function(){return(H=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},D=function(e,t,n,i){return new(n||(n=Promise))((function(a,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function u(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,u)}l((i=i.apply(e,t||[])).next())}))},G=function(e,t){var n,i,a,r,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return r={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function u(u){return function(l){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,u[0]&&(o=0)),o;)try{if(n=1,i&&(a=2&u[0]?i.return:u[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,u[1])).done)return a;switch(i=0,a&&(u=[2&u[0],a.value]),u[0]){case 0:case 1:a=u;break;case 4:return o.label++,{value:u[1],done:!1};case 5:o.label++,i=u[1],u=[0];continue;case 7:u=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==u[0]&&2!==u[0])){o=0;continue}if(3===u[0]&&(!a||u[1]>a[0]&&u[1]<a[3])){o.label=u[1];break}if(6===u[0]&&o.label<a[1]){o.label=a[1],a=u;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(u);break}a[2]&&o.ops.pop(),o.trys.pop();continue}u=t.call(e,o)}catch(e){u=[6,e],i=0}finally{n=a=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,l])}}},R=(0,i.aZ)({name:"GenerateQuiz",components:{DesignQuizPanel:S,QuizListPanel:A},props:{activity:{type:Object,default:function(){}},upload:{type:Object,default:function(){}}},setup:function(e,t){var n=this,a=(0,i.iH)(),l=(0,i.iH)(!1),s=(0,i.iH)(!1),c=(0,i.iH)([]),d=(0,i.Fl)((function(){var e;return null===(e=window.globalData)||void 0===e?void 0:e.lang.includes("en")})),p=(0,f.mQ)(),v=p.originalSubjects,b=p.streamSubjects,y=p.resetData,h=p.fetchStreamSubjects,m=(0,i.Fl)((function(){return b.value.map((function(e,t){return H(H({},e),{sort:c.value.length+t})}))})),j=function(){return D(n,void 0,void 0,(function(){var e;return G(this,(function(n){switch(n.label){case 0:return v.value?[4,(0,g.getFormatStreamSubjects)(JSON.parse((0,o.K)(v.value)))]:[3,2];case 1:e=n.sent(),n.label=2;case 2:return l.value=!1,e?(c.value.length>0?e.forEach((function(e,t){e.sort=c.value.length+t,c.value.push(e)})):c.value=e,r.Z.success(function(e){var n=0,i=0,a=0,r=0,o=0;e.forEach((function(e){switch(e.type){case q.EW.SINGLE_SELECTION:n++;break;case q.EW.MULTIPLE_SELECTION:i++;break;case q.EW.FILL_IN_BLANK:a++;break;case q.EW.TRUE_OR_FALSE:r++;break;case q.EW.SHORT_ANSWER:o++}}));var u="";return n>0&&(u+="".concat(t.root.$i18n.t("air.generatedTips.single",[n]))),i>0&&(u+="".concat(u?"、":"").concat(t.root.$i18n.t("air.generatedTips.multiple",[i]))),a>0&&(u+="".concat(u?"、":"").concat(t.root.$i18n.t("air.generatedTips.fillInBlank",[a]))),r>0&&(u+="".concat(u?"、":"").concat(t.root.$i18n.t("air.generatedTips.trueOrFalse",[r]))),o>0&&(u+="".concat(u?"、":"").concat(t.root.$i18n.t("air.generatedTips.shortAnswer",[o]))),"".concat(t.root.$i18n.t("air.generatedTips.prefix")," ").concat(u)}(e))):(s.value=!0,r.Z.error(t.root.$i18n.t("air.generateFail"))),y(),t.root.$store.dispatch("airCredit/fetchCurrentUserState"),[2]}}))}))};return{QuizListPanelRef:a,generating:l,generateFail:s,generateStream:function(i){return D(n,void 0,void 0,(function(){var n,o;return G(this,(function(c){return a.value.subjectEditing?(n=document.querySelector(".quizListPanel .quizList"),o=document.querySelector(".quizListPanel .quizList .subjectEditing"),n&&o&&n.scrollTo(0,o.offsetTop-n.offsetTop),r.Z.warning(t.root.$i18n.t("air.editingTips")),[2]):(s.value=!1,l.value=!0,h("/api/courseware-quiz/activity/".concat(e.activity.id,"/subjects"),{upload_reference_id:e.upload.reference_id,num_of_single_selection:i.subjectsGenerateConfig.single,num_of_multiple_selection:i.subjectsGenerateConfig.multiple,num_of_fill_in_blank:i.subjectsGenerateConfig.fillInBlank,num_of_true_or_false:i.subjectsGenerateConfig.trueOrFalse,num_of_short_answer:i.subjectsGenerateConfig.shortAnswer,bloom_cognitive_domains:i.bloomCognitiveDomains,locale:"auto"===i.locale?"":i.locale,stream:!0},{onClose:function(){s.value||j()},onError:function(n){!function(n){var i="";n.message&&(i=t.root.$i18n.t("air.".concat((0,u.camelize)(n.message.toLowerCase()),".").concat(e.upload.type))),i&&!i.startsWith("air.")||(i=t.root.$i18n.t("air.generateFail")),r.Z.error(i)}(n),s.value=!0,l.value=!1}}),[2])}))}))},streamSubjects:b,appendStreamSubjects:m,subjects:c,showConfirm:function(){null==t||t.root.$Modal.confirm({title:"title",content:"content"})},deleteQuiz:function(e){return D(n,void 0,void 0,(function(){return G(this,(function(t){return c.value.splice(e,1),[2]}))}))},isEnContent:d}}}),M=(0,w.Z)(R,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"generateQuiz"},[e._e(),e._v(" "),n("main",[n("div",{staticClass:"designQuiz",class:{"en-content":e.isEnContent}},[n("DesignQuizPanel",{attrs:{generating:e.generating,upload:e.upload,activity:e.activity,subjects:e.subjects},on:{generate:e.generateStream}})],1),e._v(" "),n("div",{staticClass:"quizList"},[n("QuizListPanel",{ref:"QuizListPanelRef",attrs:{generating:e.generating,generateFail:e.generateFail,subjects:e.subjects,activity:e.activity,streamSubjects:e.appendStreamSubjects,upload:e.upload},on:{delete:e.deleteQuiz}})],1)])])}),[],!1,null,"9cfd2404",null).exports,U=function(e,t,n,i){return new(n||(n=Promise))((function(a,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function u(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,u)}l((i=i.apply(e,t||[])).next())}))},N=function(e,t){var n,i,a,r,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return r={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function u(u){return function(l){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,u[0]&&(o=0)),o;)try{if(n=1,i&&(a=2&u[0]?i.return:u[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,u[1])).done)return a;switch(i=0,a&&(u=[2&u[0],a.value]),u[0]){case 0:case 1:a=u;break;case 4:return o.label++,{value:u[1],done:!1};case 5:o.label++,i=u[1],u=[0];continue;case 7:u=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==u[0]&&2!==u[0])){o=0;continue}if(3===u[0]&&(!a||u[1]>a[0]&&u[1]<a[3])){o.label=u[1];break}if(6===u[0]&&o.label<a[1]){o.label=a[1],a=u;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(u);break}a[2]&&o.ops.pop(),o.trys.pop();continue}u=t.call(e,o)}catch(e){u=[6,e],i=0}finally{n=a=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,l])}}},W=(0,i.aZ)({name:"ai-generate-quiz-modal",components:{GenerateQuiz:M},props:{activity:{type:Object,default:function(){}},upload:{type:Object,default:function(){}},lockScroll:{type:Boolean,default:!0}},setup:function(e,t){var n=this,r=(0,i.iH)(!0),o=(0,i.iH)(),u=function(){return U(n,void 0,void 0,(function(){var e=this;return N(this,(function(n){return[2,new Promise((function(n){return U(e,void 0,void 0,(function(){var e;return N(this,(function(i){switch(i.label){case 0:return o.value.subjects.length>0||o.value.generating?(e="",e=o.value.generating?t.root.$i18n.t("air.generatingLeaveTips"):t.root.$i18n.t("air.leaveTips"),[4,a.Z.open({type:"warning",title:t.root.$i18n.t("air.prompt"),content:e,width:416,verticalCenter:!0})]):[3,2];case 1:return i.sent()&&n("OK"),[3,3];case 2:n("OK"),i.label=3;case 3:return[2]}}))}))}))]}))}))},l=function(e){return U(n,void 0,void 0,(function(){return N(this,(function(t){switch(t.label){case 0:return e?[3,2]:[4,u()];case 1:t.sent(),t.label=2;case 2:return r.value=!1,[2]}}))}))};return(0,i.bv)((function(){Z.Z.$on("ai-generate-modal-close",l)})),(0,i.Ah)((function(){Z.Z.$off("ai-generate-modal-close",l)})),{GenerateQuizRef:o,modalShow:r,closeModal:l,beforeClose:u}}}),K=(0,w.Z)(W,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Modal",{ref:"modal",attrs:{width:900,"footer-hide":"","class-name":"ai-generate-quiz-modal","mask-closable":!1,closable:!1,"before-close":e.beforeClose,lockScroll:e.lockScroll},scopedSlots:e._u([{key:"header",fn:function(){return[n("div",{staticClass:"ai-generate-quiz-modal-header"},[n("span",{staticClass:"ai-generate-quiz-modal-title"},[e._v(e._s(e.$t("air.aiQuestion")))]),e._v(" "),n("i",{staticClass:"font font-close",on:{click:function(t){return e.closeModal(!1)}}})])]},proxy:!0}]),model:{value:e.modalShow,callback:function(t){e.modalShow=t},expression:"modalShow"}},[e._v(" "),n("GenerateQuiz",{ref:"GenerateQuizRef",attrs:{upload:e.upload,activity:e.activity}})],1)}),[],!1,null,"c4c00444",null).exports}}]);