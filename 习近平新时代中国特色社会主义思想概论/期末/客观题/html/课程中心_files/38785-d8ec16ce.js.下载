(self.webpackChunklms=self.webpackChunklms||[]).push([[38785,93604,54174,19332,21928,54127],{595684:function(e,t,n){var o={"./":[600683,9],"./air-chatbot":[193929,9],"./air-chatbot.js":[193929,9],"./class_mode_casting":[423527,7,49998,23527],"./class_mode_casting.js":[423527,7,49998,23527],"./conjure":[284607,7],"./conjure.js":[284607,7],"./course_info_filter":[936334,9,36334],"./course_info_filter.js":[936334,9,36334],"./detect_browser_version":[305604,9],"./detect_browser_version.js":[305604,9],"./elastic-apm":[475902,9],"./elastic-apm.ts":[475902,9],"./face_check_service":[814480,9,14480],"./face_check_service.js":[814480,9,14480],"./face_recognition_service":[379766,9,79766],"./face_recognition_service.js":[379766,9,79766],"./gpt":[149572,7],"./gpt.js":[149572,7],"./howxm":[476824,9,76824],"./howxm.js":[476824,9,76824],"./index":[600683,9],"./index.ts":[600683,9],"./single_user_session_constraint":[561907,7,49998,61907],"./single_user_session_constraint.js":[561907,7,49998,61907],"./sobot":[876408,7,76408],"./sobot.js":[876408,7,76408]};function r(e){if(!n.o(o,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=o[e],r=t[0];return Promise.all(t.slice(2).map(n.e)).then((function(){return n.t(r,16|t[1])}))}r.keys=function(){return Object.keys(o)},r.id=595684,e.exports=r},296808:function(e,t,n){n(66992),n(747042),n(439575),n(682472),n(812974),function(){if("function"==typeof window.CustomEvent)return!1;window.CustomEvent=function(e,t){t=t||{bubbles:!1,cancelable:!1,detail:null};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}}(),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=function(){return new Uint8Array(this).subarray(this.arguments)})},822077:function(e,t,n){"use strict";n.r(t),n.d(t,{checkEnableAirChatbot:function(){return G},courseId:function(){return E},createAirChatbotScript:function(){return A},enableAirChatbot:function(){return S},enabledBvBot:function(){return M},hasAiAbility:function(){return T},hasUserAiAbility:function(){return D},isSimulatingInstructor:function(){return $},lang:function(){return x},role:function(){return k},userCourseRole:function(){return N},userCourseRoles:function(){return I}});n(319601),n(324603),n(339714);var o,r,i,a,s,l,c,u,d,p,f,v,h,m,g,y,w,b,_,C=n(383228),k=null===(o=window.globalData)||void 0===o?void 0:o.user.role,x=C("html").attr("lang"),S=(null===(r=window.featureToggles)||void 0===r?void 0:r.airChatbot)&&!(null!==(i=window.globalData)&&void 0!==i&&i.isSimulatingVisitor),T=null!==(a=null===(s=window.globalData)||void 0===s||null===(l=s.course)||void 0===l?void 0:l.hasAiAbility)&&void 0!==a&&a,D=null!==(c=null===(u=window.globalData)||void 0===u||null===(d=u.user)||void 0===d?void 0:d.hasAiAbility)&&void 0!==c&&c,I=null!==(p=null===(f=window.globalData)||void 0===f?void 0:f.courseRoles)&&void 0!==p?p:[],E=null===(v=window.globalData)||void 0===v||null===(h=v.course)||void 0===h?void 0:h.id,N=I[0],$=null!==(m=null===(g=window.globalData)||void 0===g||null===(y=g.course)||void 0===y?void 0:y.isSimulatingInstructor)&&void 0!==m&&m,R=null!==(w=null===(b=window.orgSettings)||void 0===b?void 0:b.airChatbot)&&void 0!==w?w:{},j=R.url,P=void 0===j?"":j,M=(R.course_roles,((null===(_=window.orgSettings)||void 0===_?void 0:_.bvChatbot)||{}).enabled),O=[{path:/^\/exam\/\d+\/subjects/,hash:/take/},{path:/^\/portal\/?$/},{path:/^\/course\/\d+\/online-videos\/\d+/}],G=()=>{return!(void 0!==E&&!T)&&!(!(P&&k&&x&&S)||(e=window.location,t=e.pathname,n=e.hash,O.some((e=>{var o=e.path,r=e.hash,i=o instanceof RegExp?o.test(t):o===t,a=r instanceof RegExp?r.test(n):r===n;return(!o||i)&&(!r||a)}))));var e,t,n};function A(){if(!document.getElementById("airChatbotScript")){var e=document.createElement("script");e.async=!0,e.id="airChatbotScript",e.src=P,window.airChatbotConfig||(window.airChatbotConfig={launchEnv:"embed"}),Object.assign(window.airChatbotConfig,{isBvChat:M,lang:x}),document.head.appendChild(e)}}},525752:function(e,t,n){"use strict";n.r(t);n(788674);var o=n(887757),r=n.n(o),i=(n(535666),n(370538)),a=n(754641),s=n(285526),l=n(383228);function c(e,t,n,o,r,i,a){try{var s=e[i](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(o,r)}i.default.use(s.V);var u=new s.V({locale:"zh-CN",messages:{"en-US":{alert:{title:"Early Alert",notification:"Alert Notification",course_score:"Course Score ",rollcall:"Rollcall ",rollcall_warning:"Attendance warning",learning_activity:"Learning Activity ",learning_activity_warning:"Learning activity warning",course_completeness:"Course Completeness ",course_completeness_warning:"Syllabus warning",obe:"Course OBE ",iAlreadyKnow:"I know it",course_taken:"Course Not Taken",course_attendance_rate:"Attendance Rate",unread_popup_tip:"You have unread notifications, please check out your course."}},"zh-CN":{alert:{title:"预警",notification:"预警通知",course_score:"课程成绩",rollcall:"考勤",rollcall_warning:"点名预警",learning_activity:"学习活动",learning_activity_warning:"学习活动预警",course_completeness:"课程完成度",course_completeness_warning:"课程大纲完整度预警",obe:"课程OBE",iAlreadyKnow:"我已知晓",course_taken:"修习",course_attendance_rate:"课程到课率",unread_popup_tip:"您目前有未读的预警通知，请前往相关科目查阅。查阅后将不再提示。"}},"zh-TW":{alert:{title:"預警",notification:"預警通知",course_score:"課程成績",rollcall:"點名",rollcall_warning:"點名預警",learning_activity:"學習活動",learning_activity_warning:"學習活動預警",course_completeness:"課程完成度",course_completeness_warning:"課程大綱完整度預警",obe:"課程OBE",iAlreadyKnow:"我已知曉",course_taken:"修習",course_attendance_rate:"課程出席率",unread_popup_tip:"您目前有未讀的預警通知，請前往相關課程查閱。查閱後將不再提示。"}},"zh-MO":{alert:{title:"預警",notification:"預警通知",course_score:"科目成績",rollcall:"點名",rollcall_warning:"點名預警",rollcall_alert:"點名預警",learning_activity:"學習活動",learning_activity_warning:"學習活動預警",course_completeness:"科目完成度",course_completeness_warning:"科目大綱完整度預警",obe:"科目OBE",iAlreadyKnow:"我已知曉",course_taken:"修習",course_attendance_rate:"科目出席率",unread_popup_tip:"您目前有未讀的預警通知，請前往相關科目查閱。查閱後將不再提示。"}},"th-TH":{alert:{title:"แจ้งเตือนล่วงหน้า",notification:"Alert Notification",course_score:"คะแนน ",rollcall:"การขานชื่อ ",rollcall_warning:"Attendance warning",learning_activity:"กิจกรรมการเรียนรู้ ",learning_activity_warning:"Learning activity warning",course_completeness:"ความสมบูรณ์ของรายวิชา ",course_completeness_warning:"Syllabus warning",obe:"รายวิชา OBE ",iAlreadyKnow:"ฉันทราบแล้ว",course_taken:"ไม่ได้ลงทะเบียนรายวิชา",course_attendance_rate:"อัตราการเข้าร่วม",unread_popup_tip:"You have unread notifications, please check out your course."}},"id-ID":{alert:{title:"Peringatan",notification:"Notifikasi peringatan",course_score:"Nilai kelas",rollcall:"Absensi",rollcall_warning:"Peringatan Daftar Hadir",learning_activity:"Kegiatan Belajar",learning_activity_warning:"Peringatan Aktivitas Belajar",course_completeness:"Tingkat Penyelesaian Kelas",course_completeness_warning:"Peringatan kelengkapan silabus",obe:"Kelas OBE",iAlreadyKnow:"Saya mengerti",course_taken:"Belajar",course_attendance_rate:"Persentase Kehadiran Kelas",unread_popup_tip:"Saat ini Anda memiliki pemberitahuan peringatan yang belum dibaca, silakan buka kelas yang relevan untuk memeriksanya. Setelah memeriksa, Anda tidak akan diminta lagi."}},"ms-MY":{alert:{title:"Amaran Awal",notification:"Pemberitahuan amaran",course_score:"Skor kursus",rollcall:"Nama",rollcall_warning:"Amaran Daftar Hadir",learning_activity:"aktiviti pembelajaran",learning_activity_warning:"Amaran Aktiviti Pembelajaran",course_completeness:"Penyelesaian Kurikulum",course_completeness_warning:"Kurikulum menggariskan amaran lengkap",obe:"Kursus OBE",iAlreadyKnow:"saya tahu",course_taken:"Amalan",course_attendance_rate:"Kadar kehadiran kursus",unread_popup_tip:"Pada masa ini anda mempunyai pemberitahuan amaran yang belum dibaca, sila pergi ke kursus yang berkaitan untuk menyemaknya. Selepas menyemak, anda tidak akan digesa lagi."}},"vi-VN":{alert:{title:"Cảnh báo sớm",notification:"Thông báo cảnh báo",course_score:"Điểm môn học",rollcall:"Điểm danh",rollcall_warning:"Cảnh báo điểm danh",learning_activity:"Hoạt động học",learning_activity_warning:"Cảnh báo hoạt động",course_completeness:"Hoàn tất môn học",course_completeness_warning:"Cảnh báo đề cương",obe:"Chuẩn OBE",iAlreadyKnow:"Tôi đã biết",course_taken:"Chưa học môn",course_attendance_rate:"Tỷ lệ chuyên cần",unread_popup_tip:"Bạn có thông báo chưa đọc, vui lòng kiểm tra khóa học."}}},silentTranslationWarn:!0});l(".header.gtm-category").length&&new i.default({el:"#alertMessages",name:"alertMessages",i18n:u,data:{allMessages:[],modals:[],index:0},mounted(){var e=(0,a.getLang)(window.$("html").attr("lang"));u.locale=e},methods:{closeModal(){this.modals[this.index].index=1,this.index+=1,this.index<this.modals.length&&(this.modals[this.index].index=0)}},created(){var e,t=this;return(e=r().mark((function e(){var n,o;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("/user/index"!==document.location.pathname){e.next=6;break}return e.next=3,t.$http.get("/api/alert/messages");case 3:for(n=e.sent,t.allMessages=n.data.data||[],o=0;o<t.allMessages.length;o+=1)t.modals.push({index:o,messages:t.allMessages[o]});case 6:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(o,r){var i=e.apply(t,n);function a(e){c(i,o,r,a,s,"next",e)}function s(e){c(i,o,r,a,s,"throw",e)}a(void 0)}))})()},components:{"vue-alert-messages":n(816237).Z}})},84359:function(e,t,n){"use strict";n.r(t);n(788674);var o=n(887757),r=n.n(o),i=(n(535666),n(74104)),a=n(370538),s=n(383228);function l(e,t,n,o,r,i,a){try{var s=e[i](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(o,r)}"$url"in a.default.prototype||a.default.use(i.ZP),s(".header.gtm-category").length&&new a.default({el:"#announcement",data:{announcements:[]},created(){var e,t=this;return(e=r().mark((function e(){var n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$http.get("/api/announcement");case 2:n=e.sent,t.announcements=n.data.announcements;case 4:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(o,r){var i=e.apply(t,n);function a(e){l(i,o,r,a,s,"next",e)}function s(e){l(i,o,r,a,s,"throw",e)}a(void 0)}))})()},components:{"vue-announcement":n(618511).default}})},559061:function(e,t,n){"use strict";n(682772),n(339714),Date.now||(Date.now=function(){return(new Date).getTime()});var o=function(e){var t,n,o,r,i=Date.now(),a=document.querySelectorAll("script[src]"),s=a[a.length-1].src,l=null,c=!1;function u(){return this?u:u.toString()}function d(e,t){this.value=e,this.precision=t}function p(e){String(e);l&&Math.abs(e-l),l=e,Math.abs(l-r)>u.amortizationThreshold&&(r=l)}function f(){var e,t,n,o=1;function r(){var i,a=new XMLHttpRequest;i=s.indexOf("?")>-1?"&":"?",a.open("HEAD",s+i+"noCache="+Date.now()+parseInt(1e6*Math.random())),a.onreadystatechange=function(){this.readyState==this.HEADERS_RECEIVED&&200==this.status&&(t=Date.now())},a.onload=function(){if(200==this.status)try{var i=this.getAllResponseHeaders();-1===i.indexOf("date:")&&-1===i.indexOf("Date:")||function(i){var a=(t-e)/2,s=new d(i+a-t,a);String(s),(1==o||a<=n.precision)&&(n=s);o<10?(o++,r()):(p(n),c=!1)}(new Date(this.getResponseHeader("Date")).getTime())}catch(e){}},e=Date.now(),a.send()}c||(c=!0,setTimeout((function(){c=!1}),1e4),r())}return u.parse=Date.parse,u.UTC=Date.UTC,u.now=function(){return Date.now()+r},["toString","toDateString","toTimeString","toLocaleString","toLocaleDateString","toLocaleTimeString","valueOf","getTime","getFullYear","getUTCFullYear","getMonth","getUTCMonth","getDate","getUTCDate","getDay","getUTCDay","getHours","getUTCHours","getMinutes","getUTCMinutes","getSeconds","getUTCSeconds","getMilliseconds","getUTCMilliseconds","getTimezoneOffset","toUTCString","toISOString","toJSON"].forEach((function(e){u[e]=function(){return new Date(u.now())[e]()}})),u.getPrecision=function(){if(void 0!==l.precision)return l.precision+Math.abs(l-r)},u.amortizationRate=25,u.amortizationThreshold=2e3,Object.defineProperty(u,"synchronizationIntervalDelay",{get:function(){return t},set:function(e){t=e,clearInterval(n),n=setInterval(f,u.synchronizationIntervalDelay)}}),u.synchronizationIntervalDelay=6e5,d.prototype.valueOf=function(){return this.value},d.prototype.toString=function(){return this.value+(void 0!==this.precision?" +/- "+this.precision:"")+" ms"},r=e-i,"undefined"!=typeof performance&&(o=(i-performance.timing.domLoading)/2,r+=o),p(new d(r,o)),setInterval((function(){var e=Math.max(-u.amortizationRate,Math.min(u.amortizationRate,l-r));r+=e,e&&l.value}),1e3),window.addEventListener("pageshow",f),f(),u}(Date.now());e.exports=o},180736:function(e){e.exports=e=>({show(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?e.loadingFullPage=!0:e.loading=!0},hide:()=>(e.loadingFullPage=!1,e.loading=!1)})},796824:function(e,t,n){var o=n(383228),r=n(261139);n(115306),n(864765),e.exports=function(e,t,n){var i,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],l=arguments.length>5&&void 0!==arguments[5]&&arguments[5],c=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=null!==(i=e.attr("data-title"))&&void 0!==i?i:e.attr("placeholder"),d=()=>{var e=0;return o(".ms-drop ul li span span").each((function(){e=this.offsetWidth>e?this.offsetWidth:e})),o(".ms-drop").css("width","".concat(e+45,"px")),e+45};e.multipleSelect({filter:s,minimumCountSelected:1,placeholder:u,single:!a,filterPlaceholder:o("#filter-placeholder").text(),selectAll:l,formatCountSelected:(e,t)=>o("#selected-text").text().replace("#",e),formatAllSelected:()=>o("#selected-text-all").text(),textTemplate:function(e){var t=e[0].title.length>0?e[0].title:e.html(),n=e[0].value;return'<span title="'.concat(t,'" value=').concat(n,">").concat(e.html(),"</span>")},formatNoMatchesFound:()=>"",onClick:function(){var t=r.element(e).controller("ngModel");t.$viewValue=e.multipleSelect("getSelects"),t.$commitViewValue();var n=e.scope();n.$emit("multiSelect.changed"),"function"!=typeof n.search||n.disbaleSearch||n.$applyAsync((()=>n.search()))},onOpen:function(){c&&d()}})}},693604:function(e,t,n){var o=n(293789),r=n(383228),i=n(993776);n(491038),n(682772),n(66992),n(294986),n(747042),n(439575),n(556977),n(319601),n(788674),n(324603),n(339714),n(470189),n(132023),n(804723),n(115306),n(323123),n(454747),n(333948),n(560285);var a=n(887757);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=p(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);o=!0);}catch(e){r=!0,i=e}finally{try{o||null==s.return||s.return()}finally{if(r)throw i}}return n}(e,t)||p(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){if(e){if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function v(e,t,n,o,r,i,a){try{var s=e[i](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(o,r)}n(535666);var h=n(496486),m=n(203494),g=n(933704);n(816414);var y=n(730381),w=n(356264).decamelizeKeys,b=n(750883),_=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(-1!==e.indexOf(".")){var n=e.split(".").pop();return t?n.toLowerCase():n}return e},C=function(e){var t=MULTIMEDIA.supportedConvertDocumentFormats;return t.push("pdf"),"image"===e.type||"document"===e.type&&t.findIndex((t=>t===_(e.name,!0)))>=0},k=function(e){if(e){if(e.is_folder)return"folder";if("link"===e.type)return E(e.link);var t=_(e.fileName||e.file_name||e.name||"",!0),n=e.type;return"folder"===n?"folder":"sheet"===n?"excel":["doc","docx","docs"].includes(n)?"word":["video-quiz","lesson-resource","other","sobey"].includes(n)?"video":["video","image","audio","scorm","evercam","swf","folder"].includes(n)?n:["doc","docx","dot","dotx"].includes(t)?"word":["xls","xlsx","xlt","xltx","csv"].includes(t)?"excel":"pdf"===t?"pdf":"ofd"===t?"ofd":["ppt","pptx","pps","ppsx"].includes(t)?"ppt":["jpg","jpeg","png","webp","gif","bmp","heic","svg"].includes(t)?"image":"numbers"===t?"numbers":"pages"===t?"pages":"key"===t?"keynote":"document"}},x=function(e){return"document"==e.type&&"ppt"===k(e)&&window.featureToggles.wps_preview},S=function(e){if(e){if(["zip","wgz"].includes(_(e.file_name||e.name||"",!0)))return"file";var t=k(e);return["video-link"].includes(t)?"link":["word","excel","pdf","ofd","ppt","keynote","numbers","pages"].includes(t)?"document":["subject-lib"].includes(t)?"subject_library":["course-package"].includes(t)?"course_package":t}},T=function(){var e,t=(e=a.mark((function e(t,n,r,i,s){var l,c,u,d,p,f,v,h,m,g,y,w=arguments;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=!(w.length>5&&void 0!==w[5])||w[5],c=w.length>6&&void 0!==w[6]?w[6]:0,u=w.length>7&&void 0!==w[7]?w[7]:null,d=(null!=n?n.videoDuration:void 0)||(null!=u?u.videoDuration:void 0),p=o.guard(null!=n?n.uploads:void 0,(e=>e[0]))||(null!=u?u.upload:void 0),void 0!==i){e.next=7;break}return e.abrupt("return");case 7:if(!(i-r<2&&d>2)){e.next=9;break}return e.abrupt("return");case 9:return f=null,v=Math.round(i),h=Math.round(r),m=0,"audio"===s?n&&t.logAudioPlayed&&(f=t.logAudioPlayed(n.id,h,v,d)):(null!=n?n.log_link_video:void 0)?f=t.logExternalVideoPlayed(n.id,h,v,l,c):(n&&(f=t.logVideoPlayed({activityId:n.id,startFrom:h,endAt:v,async:l})),g=!(!o.guard(null!=n?n.data:void 0,(e=>e.other_resources))&&!o.guard(null!=n?n.data:void 0,(e=>e.other_resource))),p&&p.id?m=p.id:(null!=n?n.interaction_activity_attributes:void 0)&&n.interaction_activity_attributes.video_quiz.uploads&&!g&&(m=n.interaction_activity_attributes.video_quiz.uploads[0].id)),y=v-h,n?st.track(null!=n?n.type:void 0,"play",{activity_id:n.id,upload_id:m},{start_at:h,end_at:v,duration:y}):u&&D(u,h,v,y,m),e.abrupt("return",f);case 17:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(o,r){var i=e.apply(t,n);function a(e){v(i,o,r,a,s,"next",e)}function s(e){v(i,o,r,a,s,"throw",e)}a(void 0)}))});return function(e,n,o,r,i){return t.apply(this,arguments)}}(),D=function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a={start_at:t,end_at:n,duration:r,resource_id:e.id,org_id:e.org_id,dep_id:(null!=e.department?e.department.id:void 0)||0,first_class_id:o.guard(null!=e.classification_dict?e.classification_dict.first:void 0,(e=>e.id))||0,second_class_id:o.guard(null!=e.classification_dict?e.classification_dict.second:void 0,(e=>e.id))||0,third_class_id:o.guard(null!=e.classification_dict?e.classification_dict.third:void 0,(e=>e.id))||0,upload_id:i,upload_type:o.guard(null!=e.upload?e.upload.link:void 0,(e=>e.type))||(null!=e.upload?e.upload.type:void 0)};return window.st.track("shared_resource","play",{},a)},I=function(e){return"function"==typeof e.currentTime?e.currentTime():"number"==typeof e.currentTime?e.currentTime:e[0]&&e[0].currentTime?e[0].currentTime:0},E=function(e){return e&&e.is_video_link?"video-link":"link"},N=/(https?:\/\/)?(\/\/)?(www\.)?(youtube|youtu|youtube-nocookie)\.(com|be)\/(watch\?v=|embed\/|v\/|.+\?v=)?([a-zA-Z0-9_-]{11})/,$=/(https?:\/\/)?((www|v)\.)?youku\.com\/v_show\/id_(((\w+)(_\w{2}_\d{1})?)|(\w+=*)).html.*/,R=/https?:\/\/?player\.youku\.com\/embed\/(\w+=*)/,j=/microsoftstream\.com(\/embed)?\/video\/([a-zA-Z0-9]{8}-([a-zA-Z0-9]{4}-){3}[a-zA-Z0-9]{12})/,P=/https:\/\/www\.microsoft\.com\/[a-zA-Z]*-[a-zA-Z]*\/videoplayer\/embed\/[a-zA-Z0-9]*/,M=/(?:http|https)?:?\/?\/?(?:www\.|player\.)?vimeo\.com\/(?:channels\/(?:\w+\/)?|groups\/(?:[^\/]*)\/videos\/|video\/|)(\d+)(?:|\/\?)/,O=[N,$,R,/https?:\/\/?www\.?tudou\.com\/programs\/view\/([\w-]{11})/,/https?:\/\/?www\.?tudou\.com\/(albumplay|listplay)\/([\w-]{11})\/([\w-]{11}).html/,/https?:\/\/?www\.?tudou\.com\/programs\/view\/html5embed\.action\?type=([0-2])&code=([\w-]{11})&lcode=([\w-]{11})?/,/http:\/\/tv\.sohu\.com\/upload\/static\/share\/share_play\.html#(\d+_\d+_\d+_\d+_\d)/,/https?:\/\/v\.163\.com\/swf\/video\/NetEaseFlvPlayerV3.swf\?topicid=\d+&vid=(\w+)&sid=\w+/,/https?:\/\/swf\.ws\.126\.net\/openplayer\/v02\/.+\.swf/,j,P,M],G=["zip","rar","tar"],A=["mp3","m4a","wav","wma"],Z=["jpeg","jpg","png","gif","bmp","heic","webp"],H=["txt","pdf","csv","xls","xlsx","doc","ppt","pptx","docx","odp","ods","odt","rtf"],F=["avi","flv","m4v","mkv","mov","mp4","3gp","3gpp","mpg","rm","rmvb","swf","webm","wmv","mpeg","asf","vob","f4v"],B=["%"];e.exports={YOUTUBE_LINK_REGEX:N,VIMEO_REGEX:M,html2pdf:b,getDownloadRefer:(e,t)=>{var n={};if(t&&(t.isFromKnowledgeGraph||t.from_project))return n.referId=t.referId,n.referType=t.referType,w(n);if(!e)return n;if(n.referId=e.id,"classroom"==e.type)n.referType="classroom_activity";else{if("exam"==e.type)return{};n.referType="learning_activity"}return w(n)},canEditByPdfEditor:C,safeUrl:function(e){var t=e.indexOf("?");if(-1===t)return e;var n=e.slice(0,t+1),o=e.slice(t+1),r=decodeURIComponent(o).replace(/<script\b[\s\S]*?<\/script>|<\s*[a-zA-Z]+\s*[\s\S]*?\s*>|javascript:/gi,"");return n+encodeURIComponent(r)},renderMathJax:function(){return window.MathJax?MathJax.typesetPromise():Promise.resolve()},formatTime(e){y.locale(r("html").attr("lang")),(!e||e<0)&&(e=0);var t=y.duration(1e3*e),n=t.hours()+24*t.days();return n<10&&(n="0"+n),n+":"+(t.minutes()<10?"0"+t.minutes():t.minutes())+":"+(e=t.seconds()<10?"0"+t.seconds():t.seconds())},formatScore(e){if(!e||isNaN(e))return e;var t=String(parseFloat(e));if(-1===t.indexOf("."))return t;var n=d(Array.from(t.split(".")),2);n[0];return n[1].length<=2?t:parseFloat(e).toFixed(2)},humanizeBytes(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:" ",r=!0,i=["Bytes","KB","MB","GB","TB"];if(/floor/.test(n)&&(n=Math.floor),0===e)return"0 "+i[0];if(e<0){if(!t)return"0 "+i[0];r=!1,e=-e}var a=parseInt(Math.floor(Math.log(e)/Math.log(1024)));a=a>3?3:a;var s=Number((e/Math.pow(1024,a)).toFixed(2));n&&(s=n(s));var l=s+o+i[a];return r||(l="-"+l),l},formatDatetime(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD HH:mm:ss";return e?y(e).format(t):""},fileExtension:_,fileName:function(e){if(-1!==e.indexOf(".")){var t=e.split(".");return t.pop(),t.join("")}return e},canEditByPdfEditor:C,parseInteger:e=>e?isNaN(parseInt(e))?e:parseInt(e):e,parseBoolean:e=>"true"===e||"false"!==e&&null,formatBoolean:e=>!0===e?"true":!1===e?"false":"null",secondsToHms(e){(!e||e<0)&&(e=0);var t=Math.floor(e/3600),n=Math.floor((e-3600*t)/60);return e=e-3600*t-60*n,t<10&&(t="0"+t),n<10&&(n="0"+n),(e=parseInt(e,10))<10&&(e="0"+e),"00"!==t?t+":"+n+":"+e:n+":"+e},fileTypeByExtension:k,wpsPreview:x,privateWpsPreview:function(e){return"document"==e.type&&e.allow_private_wps_office_view&&window.featureToggles.privateWpsOffice},ofdPreview:function(e){return"document"===e.type&&"ofd"===k(e)},aliyunOfficePreview:function(e){var t;return"document"==e.type&&e.size<=209715200&&e.allow_aliyun_office_view&&(null===(t=window.featureToggles)||void 0===t?void 0:t.aliyun_office)},showTranscodeUnreadyTips:function(e){return!!["document","video","audio","scorm","image","swf"].includes(e.type)&&(!(!e.status||"ready"===e.status||1==e.status)&&(!!("video"!==e.type||void 0!==e.video_urls&&h.isEmpty(e.video_urls))&&!x(e)))},fileCategoryByExtension:S,fileCategoryByResource(e){if(e&&e.referrer_type)return"upload"==e.referrer_type&&e.upload?S(e.upload):"subject-lib"==e.referrer_type?"subject_library":"slide"==e.referrer_type?e.referrer_type:"course-package"==e.referrer_type?"course_package":"lesson_resource"===e.referrer_type?e.is_folder?"folder":"lesson_resource":e.referrer_type},startsWith:(e,t)=>(null===e&&(e=""),0===e.lastIndexOf(t,0)),endsWith(e,t){null===e&&(e=""),t+="";var n=e.length-t.length;return n>=0&&e.indexOf(t,n)===n},formatFloat:e=>!e||isNaN(e)?e:parseFloat(new i(e).toFixed(1)),trackLinkVideo(e,t,n,o,r){var i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;return st.trackVisit(!0),T(e,t,n,o,"video",i,r,a)},enableTrack(e,t,n,o){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=0;n&&(i=n.videoDuration,n.videoDuration=0);var a=I(t),s=!1,l=null,c=0,u=0,d=null,p=function(){if(l)return clearInterval(l),l=null};t.on("loadedmetadata",(function(){t[0]&&n&&(n.videoDuration=t[0].duration),t[0]&&r&&(r.videoDuration=t[0].duration)})),t.on("play",(function(i){a=I(t),window.st.hasVideoPlaying=!0,l||(l=setInterval((function(){var i=I(t);T(e,n,a,i,o,!0,0,r),st.trackVisit(!0),a=i}),6e4)),!s&&n&&(n.uploads&&n.uploads.length>0&&n.uploads[0].id?st.track(n.type,"view",{activity_id:n.id,upload_id:n.uploads[0].id}):st.track(n.type,"view",{activity_id:n.id}),s=!0)})),t.on("ended",(function(t){p(),s=!1,window.st.hasVideoPlaying=!1,"video"==o&&i>a&&T(e,n,a,i,o,!0,0,r)})),t.on("pause",(function(i){c=I(t),p(),window.st.hasVideoPlaying&&a<c&&(T(e,n,a,c,o,!0,0,r),window.st.hasVideoPlaying=!1)})),t.on("timeupdate",(function(){u,u=I(t)})),t.on("seeking",(function(){null===d&&(d=u)})),t.on("beforeSeeking",((t,i)=>{T(e,n,a,i.timeBeforeSeeking,o,!0,0,r)})),t.on("seeked",(()=>{var i=Math.min(a,d),s=Math.max(a,d);T(e,n,i,s,o,!0,0,r),a=I(t),d=null}));e.$on("$destroy",(function(i){p();var s=I(t);T(e,n,a,s,o,!0,0,r).then((t=>{var o,r;null!=t&&t.data&&(o=t.data,(r=h.find(e.activitiesRead,{activity_type:"learning_activity",activity_id:n.id}))?r.data=o:e.activitiesRead.push({activity_id:n.id,activity_type:"learning_activity",data:o}))})),a=s}));return m((function(){p(),window.st.hasVideoPlaying&&(T(e,n,a,I(t),o,!0,0,r),a=I(t))}))},openPopupAfterCurrentClose:(e,t)=>(r(document).on("closed.fndtn.reveal",t,(function n(){return r(e).foundation("reveal","open"),r(document).off("closed.fndtn.reveal",t,n)})),null),getStarCssClass(e,t){(null==t||t<1)&&(t=1);return e<=t-1?"font font-whole-star blank-stars":"font font-whole-star"},getAddressJsonPath(){var e=r("html").attr("lang");return["en-US","en-GB","th-TH","id-ID","ms-MY"].includes(e)?"/static/json/countries-states-cities-regions-en-US.json":["zh-TW","zh-MO"].includes(e)?"/static/json/countries-states-cities-regions-zh_Hans_TW.json":"/static/json/countries-states-cities-regions-zh_Hans_CN.json"},isSupportedOnlineVideoLink(e){var t,n=u(O);try{for(n.s();!(t=n.n()).done;){if(t.value.test(e))return!0}}catch(e){n.e(e)}finally{n.f()}return!1},parseOnlineVideoUrl(e){var t=N,n=t.exec(e);return n?"//www.youtube.com/embed/".concat(n[7]):(n=(t=R).exec(e))?"https://player.youku.com/embed/".concat(n[1]):(n=(t=$).exec(e))?"https://player.youku.com/embed/".concat(n[4]):(n=(t=j).exec(e))?"https://web.microsoftstream.com/embed/video/".concat(n[2]):(n=(t=P).exec(e))?n[0]:(n=(t=M).exec(e))?"https://player.vimeo.com/video/".concat(n[1]):""},trackResource(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r={first_class_id:o.guard(null!=e.classification_dict?e.classification_dict.first:void 0,(e=>e.id))||0,second_class_id:o.guard(null!=e.classification_dict?e.classification_dict.second:void 0,(e=>e.id))||0,third_class_id:o.guard(null!=e.classification_dict?e.classification_dict.third:void 0,(e=>e.id))||0,owner_id:e.created_by_id,resource_id:e.id,dep_id:(null!=e.department?e.department.id:void 0)||0,upload_id:(null!=e.upload?e.upload.id:void 0)||e.referrer_id||0,upload_type:o.guard(null!=e.upload?e.upload.link:void 0,(e=>e.type))||(null!=e.upload?e.upload.type:void 0)||e.referrer_type,tag_ids:e.tags?e.tags.map((e=>e.id)):[]};return r=Object.assign(n,r),window.st.track("shared_resource",t,{},r)},intToChar:e=>String.fromCharCode(65+e%26),getSupportedFormats:()=>MULTIMEDIA.uploadExtensionFormatAllowlist,getAcceptedExtensions:()=>window.isConfigLoaded?".".concat(MULTIMEDIA.uploadExtensionFormatAllowlist.join(",.")):void 0,watchAcceptedExtensions(e){e.acceptedExtension||window.isConfigLoaded||window.addEventListener("global-config-loaded",(()=>{e.acceptedExtension=".".concat(MULTIMEDIA.uploadExtensionFormatAllowlist.join(",."))}))},base64ToFile(e,t,n,o){var r=g.decode(e),i=null;try{i=new File([r],t,{type:n})}catch(e){(i=new Blob([r],{type:n})).name=t}return i},retryTranscode:(e,t,n,o)=>e.post("/api/uploads/".concat(o,"/retranscode")).success(t.decorateSuccess((function(){n.location.reload()}))).error(t.decorateError((function(){}))),setUploadStatus:e=>e.status,setUploadsOriginStatus(e){if(Array.isArray(e)){var t,n=u(e);try{for(n.s();!(t=n.n()).done;){var o=t.value;o.originStatus||(o.originStatus=o.status)}}catch(e){n.e(e)}finally{n.f()}}},setUploadsFeature(e){if(void 0!==e){var t,n={},o=u(e);try{for(o.s();!(t=o.n()).done;){var r=t.value;n[r.id]=this.setUploadStatus(r)}}catch(e){o.e(e)}finally{o.f()}return n}},setUploadFeature(e){var t={};return t[e.id]=this.setUploadStatus(e),t},Timer:class{constructor(){this._id=0}running(){return 0!==this._id}start(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;if(!this.running())return this._id=window.setInterval(e,t)}stop(){if(this.running())return window.clearInterval(this._id),this._id=0}},track:T,closePopup(e){r("#".concat(e)).foundation("reveal","close")},fixMultiModalOverlay(e){r(document).off("closed.fndtn.reveal",e),r(document).on("closed.fndtn.reveal",e,(()=>{var e=r(".reveal-modal-bg");r(".reveal-modal.open").length>0&&e.css("display","block")}))},replaceActivityTypeKey:e=>(e||"").replace(/_/g,"-"),animateIncreaseWidth(e,t){var n="#";e.id_?n+=e.id_:n+=e.id;var o=r(n);o.animate({width:o.width()+t},500)},saveCorrectColumnSetting(e,t,n){var o=t+"CorrectColumnSetting",r=JSON.parse(window.localStorage.getItem(o)),i={activityId:e,updateTime:y.utc().unix(),column:n};if(r){var a=h.find(r,{activityId:e});a?(a.updateTime=y.utc().unix(),a.column=n):r.push(i)}else(r=[]).push(i);return window.localStorage.setItem(o,JSON.stringify(r))},loadCorrectColumnSetting(e,t){var n=t+"CorrectColumnSetting",o=JSON.parse(window.localStorage.getItem(n));return h.find(o,{activityId:e})},parseUploadsFromRichText(e,t,n){var o=new Set,i=[];return r(r.parseHTML(e)).find(t).each((function(){var e=r(this).data("id");e&&!o.has(e)&&(o.add(e),i.push({id:parseInt(e,10),type:n}))})),i},httpDownloadFile(e,t){var n=new XMLHttpRequest;n.onreadystatechange=function(){4==n.readyState&&200==n.status&&t(n.response)},n.open("GET",e,!0),n.responseType="arraybuffer",n.send(null)},createWaterMakerImage(e,t){var n=document.createElement("canvas");Object.assign(n,{width:300,height:140});var o=n.getContext("2d");if(o){var r,i;o.rotate(-28*Math.PI/180),o.font=null!==(r=null==t?void 0:t.font)&&void 0!==r?r:"14px PingFang SC",o.fillStyle=null!==(i=null==t?void 0:t.fillStyle)&&void 0!==i?i:"rgba(0, 0, 0, 0.12)",o.textAlign="center",o.textBaseline="middle";for(var a=e.split("***"),s=0;s<a.length;s++)o.fillText(a[s],100,140+16*s)}return n.toDataURL("image/png",1)},getMimeType(e){var t=new DataView(e).getUint32(0,!1).toString(16),n="unknown";return[{type:"image/png",h:"89504e47"},{type:"image/gif",h:"47494638"},{type:"image/jpeg",h:"ffd8ffe0,ffd8ffe1,ffd8ffe2,ffd8ffe3,ffd8ffe8"},{type:"image/webp",h:"524946461c"}].forEach((e=>{e.h.split(",").includes(t)&&(n=e.type)})),n},bufToUrl(e){var t=this.getMimeType(e),n=new Blob([e],{type:t});return URL.createObjectURL(n)},getDuration(e,t,n){var o=y.duration(y(t).diff(y(e)));return"minute"===n?o.asMinutes():"hour"===n?o.asHours():void 0},checkFileNameValidation(e){var t=[],n=[];return e.forEach((e=>{var o=!1,r=e.name;B.forEach((e=>{if(r.indexOf(e)>-1)return o=!0})),o?n.push(e):t.push(e)})),[t,t.length===e.length?"":B.toString(),n]},getFileType(e){var t=e.split(".").pop().toLowerCase(),n=window.orgSettings.plusSupportedMimeTypes,o=["mat","dwg","m","mlapp","slx","mlx"].concat(n);return F.includes(t)?"VIDEO":A.includes(t)?"AUDIO":Z.includes(t)?"IMAGE":H.includes(t)?"DOCUMENT":G.includes(t)?"COMPRESSED_DOCUMENT":o.includes(t)?"CONFIGURABLE":"DEFAULT"},checkNameValidation:e=>[B.some((t=>e.includes(t))),B.toString()],getHashParam(e){var t=window.location.hash.match(new RegExp("[?&]".concat(e,"=([^&#]*)")));return t?decodeURIComponent(t[1]):null},sendMessageToPlayer:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(((n,o)=>{var r="simulateJsonp_".concat(Math.random().toString(36).substring(2,15)),i=l({event:e,mode:"simulateJsonp",callback:r},t);window[r]=e=>{n(e),delete window[r]},postMessage(i,"*")}))}}},595221:function(e,t,n){"use strict";n.r(t);var o=n(92116),r=n.n(o),i=n(370538).default,a=n(383228),s=n(496486),l=n(258425);n(383087),i.directive("tipsy",{inserted:(e,t,n)=>a(e).tipsy({ellipsis:!0,opacity:.95,gravity:"sw",html:!0})}),i.directive("click-outside-el",{bind(e,t,n){var o;if("function"!=typeof t.value){var r=n.context.name,i="[Vue-click-outside:] provided expression '".concat(t.expression,"' is not a function, but has to be");r&&(i+="Found in component '".concat(r,"'")),console.warn(i)}var a=t.modifiers.bubble,l=n=>{var r=n.target||n.srcElement;if(!r.getAttribute||"true"!==r.getAttribute("disable-click-outside")){var i=t.arg;i&&(o=document.querySelectorAll(".".concat(i))),o&&s.some(o,(e=>e.contains(n.target)))||(a||!e.contains(n.target)&&e!==n.target)&&t.value(n)}};return e.__vueClickOutside__=l,document.addEventListener("mousedown",l)},unbind(e,t){document.removeEventListener("mousedown",e.__vueClickOutside__),e.__vueClickOutside__=null}});var c=n(704609);i.directive("mathjax",{bind(e){e.classList.add("mathjax-process")},inserted(e,t,n){window.MathJax.typeset?window.MathJax.typeset([e]):c()}}),i.directive("katex",{bind(e){r()(e,{output:"mathml",delimiters:[{left:"$$",right:"$$",display:!1},{left:"$",right:"$",display:!1}]})},update(e){r()(e,{output:"mathml",delimiters:[{left:"$$",right:"$$",display:!1},{left:"$",right:"$",display:!1}]})}});var u=n(640433);i.directive("markdown",{bind(e){e.innerHTML=u.parse(e.innerHTML)},update(e){e.innerHTML=u.parse(e.innerHTML)}}),i.directive("perfect-scrollbar-y",{inserted:(e,t,n)=>new l(e,{suppressScrollX:!0})}),i.directive("perfect-scrollbar-x",{inserted:(e,t,n)=>new l(e,{suppressScrollY:!0})}),i.directive("perfect-scrollbar-xy",{inserted:(e,t,n)=>new l(e,{suppressScrollY:!1,suppressScrollX:!1})})},665383:function(e,t,n){var o=n(261139),r=n(496486),i=n(993776),a=n(383228);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n(141817),n(682772),n(66992),n(185827),n(702707),n(140561),n(556977),n(324603),n(339714),n(115306),n(454747),n(333948);var u=n(678410).v4;e.exports=function(){class e{constructor(e){var t;o.extend(this,e),this.uuid||(this.uuid=this.id||u()),r.has(this,"sub_subjects")||(this.sub_subjects=[]),"matching"!==e.type&&"cloze"!==e.type||(!e.score_rule&&e.settings&&(e.score_rule=e.settings.score_rule),this.score_rule=e.score_rule||"single",this.sub_point="0.0",this.options||(this.options=[])),this.unsavedSubSubjects=o.copy(this.sub_subjects),this.ui={},this.errors={},this.saved=null!==(t=this.saved)&&void 0!==t&&t,this.update()}update(){if("matching"===this.type){var e=this.options,t=(this.saved?this.sub_subjects:this.unsavedSubSubjects).reduce(((e,t)=>[...e,t.options[0]]),[]);this.matchingSubjectAnswerPool=[...t,...e]}}addSubSubject(t,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"0.0",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"vertical",i=e.createSubjectByType(t,r);return i.parent_id=this.id,i.point=o,n>=0?this.unsavedSubSubjects.splice(n,0,i):this.unsavedSubSubjects.push(i),i}deleteSubSubject(e){r.remove(this.unsavedSubSubjects,e),e.id?r.remove(this.sub_subjects,{id:e.id}):r.remove(this.sub_subjects,e)}addMatchingSubjectInterfereAnswer(){this.options.push({content:"",is_answer:!1,type:"text",sort:0})}deleteMatchingSubjectInterfereAnswer(e){this.options.splice(e,1)}setOptionAsAnswer(e){return r.forEach(this.options,(function(e){return e.is_answer=!1,!0})),e.is_answer=!0}compactSort(){return r.each(this.options,((e,t)=>e.sort=t))}addOption(e){return this.options.push(e)}copyOption(e){var t=o.copy(e);return t.hasOwnProperty("id")&&delete t.id,t.hasOwnProperty("sort")&&(t.sort=r.maxBy(this.options,"sort").sort+1),t.is_answer&&(t.is_answer=!1),t.content="",this.addOption(t)}deleteOption(e){if(r.remove(this.options,e),this.options.length>0&&this.options[0].hasOwnProperty("sort"))return this.compactSort()}convertValue(e){return isNaN(e)||""===e||null===e?e:parseFloat(e)}getScore(){var e=String(this.score),t=e.indexOf(".")+1,n=e.length-t;return t>0&&n>1?parseFloat(this.score).toFixed(1):"0"===e.charAt(e.length-1)?parseFloat(this.score).toFixed(0):this.score}getPoint(){var e=this.convertValue(this.point);if(!["analysis","media"].includes(this.type))return e;var t=[];r.map(this.sub_subjects,(function(e){if(""!==e.point)return t.push(e.point)}));var n=r.reduce(t,((e,t)=>e.plus(new i(t))),new i(0));return parseFloat(n.toFixed(1))}isCompleted(){var e=!1;return["single_selection","true_or_false"].includes(this.type)?e=r.has(this,"answeredOption")&&null!==this.answeredOption:"multiple_selection"===this.type?e=r.some(this.options,(e=>r.has(e,"checked")&&!0===e.checked)):"fill_in_blank"===this.type?e=!r.some(this.answers,(e=>""===e.content)):"short_answer"===this.type?e=Boolean(this.answered_content&&this.answered_content.length>0||this.attachments&&this.attachments.length>0):"matching"===this.type?e=!r.some(this.sub_subjects,(e=>0===e.answer_number)):["cloze","analysis"].includes(this.type)&&(e=!r.some(this.sub_subjects,(e=>!e.isCompleted()))),e}collectAnswerData(){var e;if("text"!==this.type)return["matching","cloze","analysis","media"].includes(this.type)?r.map(this.sub_subjects,(e=>e.collectAnswerData())):("paragraph_desc"===this.type?e={answer:"",subject_id:this.id}:"single_selection"===this.type||"true_or_false"===this.type?(e={subject_id:this.id,subject_updated_at:this.last_updated_at},this.answeredOption?e.answer_option_ids=[+this.answeredOption]:e.answer_option_ids=[]):"multiple_selection"===this.type?e={answer_option_ids:r.map(r.filter(this.options,"checked"),"id"),subject_id:this.id}:"short_answer"===this.type?e={answer:this.answered_content,subject_id:this.id,attachments:this.attachments}:"fill_in_blank"===this.type&&(e={answers:this.answers,subject_id:this.id}),this.parent_id&&(e.parent_id=this.parent_id),e)}copy(){var e=o.copy(this);return e.saved=!1,delete e.id,e.uuid=u(),e}isObjective(){return["single_selection","multiple_selection","true_or_false"].includes(this.type)}isSubjective(){return"short_answer"===this.type}hasSubSubjects(){return["analysis","cloze"].includes(this.type)}collectRequestData(){var e=r.pick(this,["id","last_updated_at","parent_id","description","type","answer_explanation","wrong_explanation","sort","point","difficulty_level","set_limit","character_limit","required","options","options_layout","option_type","correct_answers","has_audio","play_limit","play_limit_times","uploads","note","show_note","score_rule","case_sensitive","unordered","limit_type","point_rule","point_rule_minimum_count","knowledge_node_ids","group_id"]);return(["text","analysis","media","paragraph_desc"].includes(e.type)||0===e.point)&&(e.point="0"),e}collectSubSubjectData(e){if(!["matching","cloze"].includes(this.type))return[];return((()=>0===this.unsavedSubSubjects.length)()?this.sub_subjects:this.unsavedSubSubjects).map(((t,n)=>{var o=l(l({},t.collectRequestData()),{},{sort:n,options_layout:this.options_layout});return e&&(o.classification_id=e),"cloze"===this.type&&(o.description="Cloze Subject"),o}))}updateSubSubjectsPointByRule(e){var t="random"===this.type?this.limit_type:this.type;["analysis","media"].includes(this.type)||(this.point=parseFloat(e[t][this.difficulty_level]||"0")),["analysis","random","media"].includes(this.type)&&(r.map(this.sub_subjects,(function(t){"paragraph_desc"!==t.type&&(t.point=parseFloat(e[t.type][t.difficulty_level]||"0"))})),r.map(this.unsavedSubSubjects,(function(t){"paragraph_desc"!==t.type&&(t.point=parseFloat(e[t.type][t.difficulty_level]||"0"))})))}deactivateSubject(){return this.active=!1,r.each(this.unsavedSubSubjects,(function(e){return e.active=!1,!0}))}getCorrectOptions(){var e=[],t=(t,n)=>{t.is_answer&&e.push(n)},n=e=>{e.forEach(t)};return["matching","cloze"].includes(this.type)?this.sub_subjects.forEach((e=>{n(e.options)})):n(this.options),e}isActive(){return this.active||r.some(this.unsavedSubSubjects,{active:!0})}hasError(e){return this.errors[e]}validate(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return"optionsLength"===e?this._setError(e,this.options.length<2):this._setError(e,t)}_setError(e,t){return this.errors[e]=Boolean(t)}}return e.createSubjectByType=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"vertical",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"true",r={type:t,saved:!1};if(r.difficulty_level="false"===o?"none":"medium",r.play_limit=!0,r.play_limit_times=1,["single_selection","multiple_selection","true_or_false"].includes(r.type)&&(r.options=[{content:"",is_answer:!1,type:"text",sort:0},{content:"",is_answer:!1,type:"text",sort:1}],["single_selection","multiple_selection"].includes(r.type)&&(r.options.push({content:"",is_answer:!1,type:"text",sort:2}),r.options.push({content:"",is_answer:!1,type:"text",sort:3})),r.options_layout=n,r.option_type="text"),"matching"===r.type){r.options_layout=n,r.option_type="text",r.sort=0;for(var i=new e(r),a=0;a<4;a++)i.addSubSubject("single_selection",a);return i.sub_subjects.forEach((e=>{e.options.forEach()})),i}return"cloze"===r.type&&(r.options_layout=n,r.option_type="text"),"fill_in_blank"===r.type&&(r.case_sensitive=!1,r.unordered=!1),new e(r)},e.setSettings=function(e){if(e.settings)return e.point_rule=e.settings.point_rule,e.point_rule_minimum_count=e.settings.point_rule_minimum_count,e.options_layout=e.settings.options_layout,e.character_limit=e.settings.character_limit,e.set_limit=e.settings.set_limit,e.required=e.settings.required,e.play_limit=null==e.settings.play_limit||e.settings.play_limit,e.play_limit_times=null==e.settings.play_limit_times?1:e.settings.play_limit_times,e.uploads=e.settings.uploads,e.has_audio=null!=r.find(e.settings.uploads,(e=>["audio","video"].includes(e.type)))||!!e.settings.has_audio,e.show_note=e.settings.show_note,"matching"===e.type?e.score_rule=e.settings.score_rule:"fill_in_blank"===e.type?(e.case_sensitive=e.settings.case_sensitive,e.unordered=e.settings.unordered):"random"===e.type&&(e.limit_type=e.settings.limit_type),["single_selection","multiple_selection","true_or_false","matching","cloze"].includes(e.type)?e.option_type=e.settings.option_type||"text":delete e.options},e.createSubjectBySavedSubject=function(t){var n,o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];o&&(e.setSettings(t),t.options&&(t.options=r.sortBy(t.options,"sort"))),t.description=t.description.replace(/&nbsp;/g," ");var i=new RegExp("<[^>]+>"),s=[];try{s=i.test(t.description)?a(t.description).find("span.__blank__[data-id]").get():[]}catch(e){s=[]}var l=s.map((e=>({ele:e,uuid:e.getAttribute("data-id")?Number(e.getAttribute("data-id")):0}))),c=r.map(t.sub_subjects,(function(n,i){return n=e.createSubjectBySavedSubject(n,o),s.length>0&&(n.uuid=l[i].uuid),"random"===t.type&&(n.ui.showContent=!1,n.isInRandom=!0,n.parent_id=t.id,"analysis"===n.type&&(r.each(n.sub_subjects,(function(e){e.isInRandom=!0,e.isInRandomAnalysis=!0})),r.each(n.unsavedSubSubjects,(function(e){e.isInRandom=!0,e.isInRandomAnalysis=!0})))),n}));if("cloze"===t.type&&c.sort(((e,t)=>e.sort-t.sort)),t.sub_subjects=c,"fill_in_blank"===t.type){if(r.isEmpty(t.answers)||t.answers.length!==t.answer_number){t.answers=[];for(var u=0,d=t.answer_number-1,p=d>=0;p?u<=d:u>=d;p?u++:u--)t.answers.push({sort:u,content:""})}t.displayedDescription=t.description}return"short_answer"!==t.type&&"short_answer"!=(null===(n=t.settings)||void 0===n?void 0:n.limit_type)||(""===t.lowest_score&&(t.lowest_score=t.highest_score=t.average_score="-"),t.attachments||(t.attachments=[])),t.saved=!0,new e(t)},e}},193929:function(e,t,n){"use strict";n.r(t);var o=n(822077);(0,o.checkEnableAirChatbot)()&&(0,o.createAirChatbotScript)()},284607:function(e,t,n){var o,r,i=n(383228);n(66992),n(333948),n(560285);var a=null===(o=window.orgSettings)||void 0===o?void 0:o.conjure,s=null===(r=window.globalData)||void 0===r?void 0:r.user.role,l=i("html").attr("lang");a&&(s&&l)&&function(e,t){!function(e,t,n){e.conjure=function(){e.crl=[...arguments];var t=new URL(a);e.crl.unshift("".concat(t.protocol,"//").concat(t.hostname))};var o=t.createElement("script");o.defer=!0,o.id="conjureScript",o.src=a,t.head.appendChild(o)}(window,document),conjure(e,t)}(s,l)},305604:function(e,t,n){"use strict";n.r(t);n(682772),n(323123);var o,r,i=n(979262),a=n.n(i);function s(e,t){for(var n=e.split("."),o=t.split("."),r=Math.max(n.length,o.length),i=0;i<r;i++){var a=i<n.length?parseInt(n[i]):0,s=i<o.length?parseInt(o[i]):0;if(a!==s)return a>s}return!1}window.console&&console.log("Browser version： "+a().name+" - "+a().version),o=a().name.toLowerCase(),r=a().version,("chrome"===o&&s("55",r)||o.indexOf("ie")>-1||o.indexOf("edge")>-1&&s("55",r)||"firefox"===o&&s("50.0",r)||"safari"===o&&s("9.0",r))&&(window.location.href="/browser-warning")},149572:function(e,t,n){var o;n(132023);var r=null===(o=window.orgSettings)||void 0===o?void 0:o.gpt,i=/.js/gi;!function(){if(r){if(!function(){if(!globalData.course||!globalData.course.name)return!1;if(!globalData.courseRoles||!globalData.courseRoles.includes("instructor"))return!1;return!0}())return void console.log("Not all conditions met, disabled GPT demo");i.test(r)||(r="https://chat-widget-psi.vercel.app/chat-widget.js"),window.chatCourseName=globalData.course.name;var e=document.createElement("script");e.async=!0,e.src="".concat(r,"?t=").concat(Date.now()),document.body.appendChild(e)}}()},994265:function(e,t,n){"use strict";n.d(t,{FR:function(){return l},T1:function(){return u},rG:function(){return s},x7:function(){return c},zo:function(){return a}});var o=n(117403),r=n(730381),i=(e,t)=>{if((e=>{e.make_up_record&&(e.make_up_record.is_closed=r()>r(e.make_up_record.closed_time)),e.resubmit_record&&(e.resubmit_record.is_closed=r()>r(e.resubmit_record.closed_time))})(t),!t.resubmit_record&&!t.make_up_record)return"";if(!t.resubmit_record&&t.make_up_record)return"makeUp";if(!t.make_up_record&&e)return"resubmit";if(!e)return"makeUp";var n=t.make_up_record.updated_at||t.make_up_record.created_at,o=t.resubmit_record.updated_at||t.resubmit_record.created_at;return n>=o?"makeUp":n<o?"resubmit":""};function a(e,t){var n={isMarked:null,submitStatus:""};n.isMarked="marked"===t.mark;var r=i(e,t);return t.markedSubmitted&&["makeUp","resubmit"].includes(r)?(n.submitStatus=o.default.t("homework.makeUp"),n):n}function s(e){var t=e.submission_correct;return t.instructor_score||t.comment}function l(e){return(!e.submit_by_instructor||e.marked_submitted)&&!e.is_draft&&!e.is_redo}function c(e){return e.submit_by_instructor&&!e.is_draft}function u(e){return e.final_score||e.submission_correct.instructor_score||e.submission_correct.comment?"marked":"unmarked"}},841789:function(e){e.exports=["$http","toastr",function(e,t){return{getBulletins(n,o,r,i,a){var s={bulletin_id:arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,page:n,page_size:o,conditions:r};return e.get("/api/org-bulletin/bulletins",{params:s}).success(i).error(t.decorateError(a))},getUnreadBulletins:(n,o)=>e.get("/api/org-bulletin/bulletins?fields=id",{params:{conditions:{unread:!0}}}).success(n).error(t.decorateError(o)),getDepartments(n,o){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i="fields=id,name,stopped&no-intercept=true&for-management=true&permission_obj=".concat(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"","&permission_act=").concat(r);return e.get("/api/departments?".concat(i)).success(n).error(t.decorateError(o))},getClassifications:(n,o)=>e.get("/api/org-bulletin/classifications").success(n).error(t.decorateError(o)),addBulletin:(n,o,r)=>e.post("/api/org-bulletin/bulletins",n).success(t.decorateSuccess(o)).error(t.decorateError(r)),deleteBulletin:(n,o,r)=>e.delete("/api/org-bulletin/bulletins/".concat(n)).success(t.decorateSuccess(o)).error(t.decorateError(r)),editBulletin:(n,o,r)=>e.put("/api/org-bulletin/bulletins/".concat(n.id),n).success(t.decorateSuccess(o)).error(t.decorateError(r)),markBulletinAsRead:(n,o,r)=>e.post("/api/org-bulletin/bulletins/".concat(n,"/read")).success(t.decorateSuccess(o)).error(t.decorateError(r))}}]},139587:function(e,t,n){n(788674),document.addEventListener("DOMContentLoaded",(()=>{document.querySelector("#vue-app")&&Promise.all([n.e(32156),n.e(32055),n.e(20688)]).then(n.bind(n,920688))}))},998009:function(e,t,n){"use strict";n.d(t,{P:function(){return s}});n(66992),n(788674),n(324603),n(339714),n(132023),n(115306),n(454747),n(333948);var o=n(887757),r=n.n(o);n(535666);function i(e,t,n,o,r,i,a){try{var s=e[i](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(o,r)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var a=e.apply(t,n);function s(e){i(a,o,r,s,l,"next",e)}function l(e){i(a,o,r,s,l,"throw",e)}s(void 0)}))}}var s={ABOVE:"drag-above",BELOW:"drag-below",ON:"drag-on"};function l(e){return e.path?e.path:e.composedPath?e.composedPath():function(e){for(var t=e.target,n=[];t;){if(n.push(t),"HTML"===t.tagName)return n.push(document),n.push(window),n;t=t.parentElement}return n}(e)}function c(e){var t=function(e){for(var t,n=0,o=l(e);n<o.length;n++)if(t=o[n].className||"",/tree-node/.test(t))return o[n];return null}(e);return t||null}function u(e,t){if(e){var n=e.className;if(t)new RegExp(t).test(n)||(n+=" ".concat(t));else{for(var o in s)n=n.replace(s[o],"");n.replace("dragging","")}e.className=n.replace(/\s+/g," ")}}function d(e,t){var n=t.getBoundingClientRect(),o=n.height/3,r=s.ON;return n.top+o>=e.clientY?r=s.ABOVE:n.top+2*o<=e.clientY&&(r=s.BELOW),r}function p(e,t,n){return f.apply(this,arguments)}function f(){return(f=a(r().mark((function e(t,n,o){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&n[o]&&"function"==typeof n[o]){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,n[o](...t);case 4:return e.t0=e.sent,e.abrupt("return",!1!==e.t0);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){for(var t in s)for(var n=e.querySelectorAll(".".concat(s[t])),o=0;o<n.length;o++)u(n[o])}t.Z={methods:{getDropDestination:c,getDropPosition:d,updateHelperClasses:u,clearDropClasses:v,onDragStart(e){e.preventDefault()},startDragging(e,t){var n=this;return a(r().mark((function o(){return r().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(o.t0=!e.isDraggable(),o.t0){o.next=6;break}return o.next=4,p([e],n.tree.options.dnd,"onDragStart");case 4:o.t1=o.sent,o.t0=!1===o.t1;case 6:if(!o.t0){o.next=8;break}return o.abrupt("return");case 8:n.$$startDragPosition=[t.clientX,t.clientY],n.$$possibleDragNode=e,n.$$possibleDragEle=e.vm.$el,n.initDragListeners();case 12:case"end":return o.stop()}}),o)})))()},initDragListeners(){var e,t=this,n=e=>{this.$el.style.userSelect=e?"none":null,this.$el.querySelectorAll(".tree-operate").forEach((t=>{t instanceof HTMLElement&&(t.style.pointerEvents=e?"none":null)})),document.body.style.cursor=e?"grabbing":null},o=()=>{window.removeEventListener("mouseup",i,!0),window.removeEventListener("mousemove",l,!0),n(!1)},i=function(){var n=a(r().mark((function n(i){return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.$$startDragPosition||i.stopPropagation(),t.draggableNode&&t.draggableNode.node.state("dragging",!1),!(t.$$dropDestination&&t.tree.isNode(t.$$dropDestination)&&t.$$dropDestination.vm)){n.next=9;break}return u(t.$$dropDestination.vm.$el,null),n.next=6,p([t.draggableNode.node,t.$$dropDestination,e],t.tree.options.dnd,"onDragFinish");case 6:!1!==n.sent&&(t.$$dropDestination.isDropable()||e!==s.ON)&&e&&(t.draggableNode.node.finishDragging(t.$$dropDestination,e),t.draggableNode.node.parent=t.$$dropDestination,t.$emit("dragFinish")),t.$$dropDestination=null;case 9:v(t.$el),t.$$possibleDragNode=null,t.$$possibleDragEle=null,t.$set(t,"draggableNode",null),o();case 14:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),l=function(){var i=a(r().mark((function i(a){var l,f,h,m,g;return r().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n(!0),!t.$$startDragPosition||(i=a,y=t.$$startDragPosition,Math.abs(i.clientX-y[0])>5||Math.abs(i.clientY-y[1])>5)){r.next=3;break}return r.abrupt("return");case 3:if(t.$$startDragPosition=null,!t.$$possibleDragNode){r.next=12;break}if(!1!==t.$$possibleDragNode.startDragging()){r.next=10;break}return o(),t.$$possibleDragNode=null,t.$$possibleDragEle=null,r.abrupt("return");case 10:t.$set(t,"draggableNode",{node:t.$$possibleDragNode,ele:t.$$possibleDragEle,left:0,top:0}),t.$$possibleDragNode=null;case 12:if(t.draggableNode.left=a.clientX,t.draggableNode.top=a.clientY,h=c(a),v(t.$el),h){r.next=19;break}return t.$$dropDestination=null,r.abrupt("return");case 19:if(m=h.getAttribute("data-id"),t.draggableNode.node.id!==m){r.next=22;break}return r.abrupt("return");case 22:if(t.$$dropDestination&&t.$$dropDestination.id===m||(t.$$dropDestination=t.tree.getNodeById(m)),!t.$$dropDestination||!t.draggableNode.node){r.next=28;break}if(!t.$$dropDestination.getPath().includes(t.draggableNode.node)){r.next=28;break}return t.$$dropDestination=null,r.abrupt("return");case 28:if((e=d(a,h))!==s.ON||!h.contains(null===(l=t.draggableNode)||void 0===l||null===(f=l.ele)||void 0===f?void 0:f.parentElement)){r.next=32;break}return t.$$dropDestination=null,r.abrupt("return");case 32:if(!t.options.dndChecker){r.next=36;break}if(t.options.dndChecker(t.draggableNode.node,t.$$dropDestination,e)){r.next=36;break}return t.$$dropDestination=null,r.abrupt("return");case 36:return r.next=38,p([t.draggableNode.node,t.$$dropDestination,e],t.tree.options.dnd,"onDragOn");case 38:g=r.sent,t.$$dropDestination.isDropable()&&!1!==g||e!==s.ON||(e=null),u(h,e);case 42:case"end":return r.stop()}var i,y}),i)})));return function(e){return i.apply(this,arguments)}}();window.addEventListener("mouseup",i,!0),window.addEventListener("mousemove",l,!0)}}}},48496:function(e,t,n){"use strict";n.r(t),n.d(t,{TimeUtils:function(){return c.Z},Toast:function(){return l.Z},UniqueToast:function(){return u.Z},_:function(){return r.a},fileExtension:function(){return v},fileTypeByExtension:function(){return h},humanizeBytes:function(){return f},isDate:function(){return p},numberToLocaleObject:function(){return m},numberToLocaleString:function(){return g},parseTimeToMinuteNum:function(){return w},reBuildColumns:function(){return b},sanitizeDisplaySubjectText:function(){return y},saveBlob:function(){return _},setDisableDevtool:function(){return C}});n(682772),n(747042),n(556977),n(339714),n(132023),n(115306),n(323123),n(923157);var o=n(496486),r=n.n(o),i=n(178598),a=n(387737),s=n.n(a),l=n(681423),c=n(576201),u=n(334647),d=Object.prototype.toString;function p(e){return"[object Date]"===d.call(e)}function f(e){var t=["Bytes","KB","MB","GB","TB"];if(0===e)return"0 ".concat(t[0]);var n=parseInt(Math.floor(Math.log(e)/Math.log(1024)),10);return"".concat((e/Math.pow(1024,n)).toFixed(2)," ").concat(t[n])}function v(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(-1!==e.indexOf(".")){var n=e.split(".").pop();return t?n.toLowerCase():n}return e}function h(e){if(!e)return"";if(e.is_folder)return"folder";if("link"===e.type)return(t=e.link)&&t.is_video_link?"video-link":"link";var t,n=e.extension||v(e.name||e.file_name||"",!0),o=e.type;return"folder"===o?"folder":["video-quiz","other"].includes(o)?"video":["video","image","audio","scorm","evercam","swf","folder"].includes(o)?o:["doc","docx","dot","dotx"].includes(n)?"word":["xls","xlsx","xlt","xltx","csv"].includes(n)?"excel":"pdf"===n?"pdf":["ppt","pptx","pps","ppsx"].includes(n)?"ppt":"numbers"===n?"numbers":"pages"===n?"pages":"key"===n?"keynote":"document"}function m(e,t){var n={value:String(e),unit:"",formulate:new Intl.NumberFormat("en-US").format(e)};if(!e||e<1e4)return n.value=new Intl.NumberFormat("en-US").format(e),n;var o=e.toString();return e<1e6?t.locale.value.startsWith("en")?(n.value="".concat(o.slice(0,-3),".").concat(o.substr(-3)[0]),n.unit="K",n):(n.value="".concat(o.slice(0,-4),".").concat(o.substr(-4)[0]),n.unit="".concat(t.t("10KShort")),n):e<1e8?t.locale.value.startsWith("en")?(n.value="".concat(o.slice(0,-6),".").concat(o.substr(-6)[0]),n.unit="".concat(t.t("1MShort")),n):(n.value="".concat(o.slice(0,-4),".").concat(o.substr(-4)[0]),n.unit="".concat(t.t("10KShort")),n):e<1e9?t.locale.value.startsWith("en")?(n.value="".concat(o.slice(0,-6),".").concat(o.substr(-6)[0]),n.unit="".concat(t.t("1MShort")),n):(n.value="".concat(o.slice(0,-8),".").concat(o.substr(-8)[0]),n.unit="".concat(t.t("100MShort")),n):t.locale.value.startsWith("en")?(n.value="".concat(o.slice(0,-9),".").concat(o.substr(-9)[0]),n.unit="".concat(t.t("1BShort")),n):(n.value="".concat(o.slice(0,-8),".").concat(o.substr(-8)[0]),n.unit="".concat(t.t("100MShort")),n)}function g(e,t){var n=m(e,t);return"".concat(n.value).concat(n.unit)}var y=(e,t,n)=>{var o=((e,t)=>e(t,{allowedTags:["img","p","span"],allowedAttributes:{img:["width","height","data-image-size","data-latex","data-non-image","class","src"],span:["class"]},allowedSchemes:["data","http","https"]}))(e,t);return o=((e,t)=>e.replace(/<img.*?(data-latex=|Wirisformula).*?>?.*?(>|\/img>|\/>)/gi," [".concat(t.t("simditor.santilize.forlumn"),"] ")).replace(/<img.*?>?.*?(>|\/img>|\/>)/gi," [".concat(t.t("simditor.santilize.image"),"] ")))(o,n),o=(e=>{var t=document.createElement("div");return t.innerHTML=e,t.innerText||t.textContent})(o=(e=>e.replace(/<[^>]+>/g,"").replace(/&nbsp;/gi," "))(o=o.replace(/<span class="file-size">[^>]+<\/span>/g,"")))},w=e=>{var t=e.split(":");return 60*parseInt(t[0],10)+parseInt(t[1],10)},b=(e,t)=>r().filter(e,(e=>r().every(t,(t=>t.name!==e.slot&&t.name!==e.key||!!t.isShow)))),_=e=>{if(e){var t=e.headers,n=decodeURIComponent(t["content-disposition"]),o=n.substring(n.indexOf("filename*=UTF-8")+17);o=o.replace(/name=/g,"");var r=new Blob([e.data],{type:t["content-type"]});(0,i.saveAs)(r,o)}},C=()=>{window.location.host.includes("localhost")||s()({ondevtoolopen:()=>{document.body.innerHTML="",(()=>!1).constructor("debugger").call()},ondevtoolclose:()=>{window.location.reload()}})}},321708:function(e,t,n){"use strict";n.r(t);n(788674),n(141817);var o=n(554174),r=n(496486),i={name:"CompletionCriteriaInput",props:{courseId:{type:Number},type:{type:String},value:{type:[Object,String]},initCompletionCriterionKey:{type:String},initCompletionCriterionValue:{type:[Number,String]},disable:{type:Boolean}},data:()=>({hasCompletionCriterion:0,completionCriteriaData:{completion_criteria:[]},selectedCompletionCriterion:{id:null,value:0},firstChangeCriterionId:!0}),methods:{change(){this.$emit("input",this.completionCriterionValue);var e=this.completionCriterionValue.id;if(e){var t=this.filteredCompletionCriterionType.find((t=>t.id===e));null!=t&&t.description&&this.$emit("completionCriterionForShowChange",t.description)}},setDefaultCompletionCriterion(){this.setCompletionCriterion(this.defaultCompletionCriterionType)},setCompletionCriterion(e){e.id!==this.noneCompletionCriterionType.id&&(this.hasCompletionCriterion=1,this.selectedCompletionCriterion.id=e.id)},setInitCompletionCriterion(){if(this.initCompletionCriterionKey){var e=r.find(this.completionCriteriaData.completion_criteria,{completion_criterion_type:this.initCompletionCriterionKey})||this.noneCompletionCriterionType;this.setCompletionCriterion(e),"none"===this.initCompletionCriterionKey&&(this.selectedCompletionCriterion.id=this.defaultCompletionCriterionType.id),this.selectedCompletionCriterion.value=this.initCompletionCriterionValue}else this.setDefaultCompletionCriterion(),this.selectedCompletionCriterion.value=this.defaultCompletionCriterionType.value}},watch:{completionCriterionValue:{deep:!0,handler(e,t){e!==t&&this.change()}},"selectedCompletionCriterionType.id":function(e,t){t&&e!==t&&(this.firstChangeCriterionId||(this.selectedCompletionCriterion.value=this.selectedCompletionCriterionType.value),this.firstChangeCriterionId=!1)}},computed:{completionCriterionValue(){var e=this.hasCompletionCriterion?this.selectedCompletionCriterion:this.noneCompletionCriterionType;return e.activity_completion_criterion_type_id=e.id,e},h5CoursewareCompleteness(){var e;return null===(e=window.orgSettings)||void 0===e?void 0:e.h5CoursewareCompleteness},noneCompletionCriterionType(){return r.find(this.completionCriteriaData.completion_criteria,{completion_criterion_type:"none"})||{id:0,value:0}},filteredCompletionCriterionType(){return"h5_courseware"!==this.type||this.h5CoursewareCompleteness?"h5_courseware"===this.type&&this.h5CoursewareCompleteness?r.reject(this.completionCriteriaData.completion_criteria,(e=>"none"===e.completion_criterion_type||"view"===e.completion_criterion_type)):r.reject(this.completionCriteriaData.completion_criteria,{completion_criterion_type:"none"}):r.reject(this.completionCriteriaData.completion_criteria,(e=>"none"===e.completion_criterion_type||"completeness"===e.completion_criterion_type))},defaultCompletionCriterionType(){return r.find(this.completionCriteriaData.completion_criteria,{is_default:!0})||{id:0,value:0}},selectedCompletionCriterionType(){return r.find(this.completionCriteriaData.completion_criteria,{id:this.completionCriterionValue.id})||{}},showCustomValueInput(){return["score","completeness"].includes(this.selectedCompletionCriterionType.completion_criterion_type)}},created(){(0,o.getCompletionCriteria)(this.courseId,this.type).then((e=>{this.completionCriteriaData=e.data})).then((()=>this.setInitCompletionCriterion()))},install(e){return e.component(this.name,this)}},a=(0,n(551900).Z)(i,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("RadioGroup",{model:{value:e.hasCompletionCriterion,callback:function(t){e.hasCompletionCriterion=t},expression:"hasCompletionCriterion"}},[n("Radio",{attrs:{label:0,disabled:e.disable}},[e._v(e._s(e.$t("has_not")))]),e._v(" "),n("Radio",{attrs:{label:1,disabled:e.disable}},[e._v(e._s(e.$t("has")))])],1),e._v(" "),"h5_courseware"===e.type&&this.h5CoursewareCompleteness?[e.hasCompletionCriterion?n("span",[e._v(e._s(e.$t("scorm.completeness")))]):e._e(),e._v(" "),e.hasCompletionCriterion?n("Input",{staticStyle:{width:"60px"},attrs:{disabled:e.disable},model:{value:e.selectedCompletionCriterion.value,callback:function(t){e.$set(e.selectedCompletionCriterion,"value",t)},expression:"selectedCompletionCriterion.value"}}):e._e(),e._v(" "),e.hasCompletionCriterion?n("span",[e._v("%")]):e._e()]:[e.hasCompletionCriterion?n("Select",{staticStyle:{width:"200px"},attrs:{disabled:e.disable},model:{value:e.selectedCompletionCriterion.id,callback:function(t){e.$set(e.selectedCompletionCriterion,"id",t)},expression:"selectedCompletionCriterion.id"}},e._l(e.filteredCompletionCriterionType,(function(t){return n("Option",{key:t.id,attrs:{value:t.id}},[e._v("\n        "+e._s(t.description)+"\n      ")])})),1):e._e(),e._v(" "),e.showCustomValueInput?n("Input",{staticStyle:{width:"60px"},model:{value:e.selectedCompletionCriterion.value,callback:function(t){e.$set(e.selectedCompletionCriterion,"value",t)},expression:"selectedCompletionCriterion.value"}}):e._e()],e._v(" "),e.hasCompletionCriterion?n("div",[n("div",{staticClass:"row-tip selected"},[n("label",[e._v("\n        "+e._s(e.$t("completion_selected_description"))+"\n      ")])])]):n("div",[n("div",{staticClass:"row-tip unselected"},[n("label",[e._v("\n        "+e._s(e.$t("completion_unselected_description"))+"\n      ")])])])],2)}),[],!1,null,"59d23be2",null).exports,s=n(582167),l=n(866473),c=n.n(l),u=n(370538),d=n(285256),p=n(385565),f=n.n(p),v=(n(422592),n(230791),n(117403)),h=n(863322),m=n(438589);u.default.use(d.default),u.default.customElement("edit-ask-question-modal",m.default);var g=n(496486);u.default.prototype.$store=h.Z,u.default.use(c()),u.default.use(d.default),u.default.use(s.Z),u.default.use(a),u.default.use(f()),u.default.use(n(965284)),(0,n(90963).install)(),Promise.all([n.e(63595),n.e(25366),n.e(34951)]).then(n.bind(n,128793)).then((e=>{e.default.store=h.Z,e.default.i18n=v.default,u.default.customElement(e.default.name,e.default)})),n.e(74259).then(n.bind(n,374259)).then((e=>{e.default.store=h.Z,e.default.i18n=v.default,u.default.customElement(e.default.name,e.default)})),n.e(12185).then(n.bind(n,112185)).then((e=>{e.default.store=h.Z,e.default.i18n=v.default,u.default.customElement(e.default.name,e.default)})),Promise.all([n.e(14242),n.e(94493),n.e(67925),n.e(70558),n.e(56148),n.e(62791)]).then(n.bind(n,822198)).then((e=>{e.default.options.store=h.Z,e.default.options.i18n=v.default,u.default.customElement(e.default.options.name,e.default.options)})),n.e(81174).then(n.bind(n,581174)).then((e=>{e.default.options.store=h.Z,e.default.options.i18n=v.default,u.default.customElement(e.default.options.name,e.default.options)})),n.e(41851).then(n.bind(n,441851)).then((e=>{e.default.options.store=h.Z,e.default.options.i18n=v.default,u.default.customElement(e.default.options.name,e.default.options)})),Promise.all([n.e(4301),n.e(2079),n.e(10405),n.e(62855)]).then(n.bind(n,41823)).then((e=>{e.default.store=h.Z,e.default.i18n=v.default,u.default.customElement(e.default.name,e.default)})),n.e(69390).then(n.bind(n,369390)).then((e=>{var t=g.cloneDeep(e.default);t.store=h.Z,t.i18n=v.default,u.default.customElement(t.name,t)})),n.e(89294).then(n.bind(n,989294)).then((e=>{e.default.store=h.Z,e.default.i18n=v.default,u.default.customElement(e.default.name,e.default)})),n.e(84359).then(n.bind(n,384359)).then((e=>{var t=g.cloneDeep(e.default);t.store=h.Z,t.i18n=v.default,u.default.customElement(t.name,t)})),n.e(67323).then(n.bind(n,167323)).then((e=>{var t=g.cloneDeep(e.default);t.store=h.Z,t.i18n=v.default,u.default.customElement(t.name,t)})),n.e(69022).then(n.bind(n,169022)).then((e=>{e.default.store=h.Z,e.default.i18n=v.default,u.default.customElement(e.default.name,e.default)})),n.e(49408).then(n.bind(n,649408)).then((e=>{e.default.store=h.Z,e.default.i18n=v.default,u.default.customElement(e.default.name,e.default)})),Promise.all([n.e(17455),n.e(98046),n.e(97430),n.e(41389)]).then(n.bind(n,884181)).then((e=>{e.default.store=h.Z,e.default.i18n=v.default,u.default.customElement(e.default.name,e.default)})),Promise.all([n.e(9575),n.e(70331)]).then(n.bind(n,501430)).then((e=>{e.default.store=h.Z,e.default.i18n=v.default,u.default.customElement(e.default.name,e.default)})),Promise.all([n.e(67925),n.e(9575),n.e(61128)]).then(n.bind(n,364714)).then((e=>{e.default.store=h.Z,e.default.i18n=v.default,u.default.customElement(e.default.name,e.default)})),n.e(92337).then(n.bind(n,192337)).then((e=>{e.default.store=h.Z,e.default.i18n=v.default,u.default.customElement(e.default.name,e.default)})),n.e(19158).then(n.bind(n,919158)).then((e=>{e.default.i18n=v.default,u.default.customElement("assign-to-sub-course",e.default)})),n.e(28758).then(n.bind(n,28758)).then((e=>{u.default.customElement("activity-time",e.default)})),n.e(83761).then(n.bind(n,783761)).then((e=>{u.default.customElement("wg-datepicker",e.default)})),n.e(69451).then(n.bind(n,669451)).then((e=>{u.default.customElement("activity-time-attr",e.default)})),n.e(74024).then(n.bind(n,74024)).then((e=>{e.default.store=h.Z,e.default.i18n=v.default,u.default.customElement(e.default.name,e.default)})),Promise.all([n.e(67925),n.e(9575),n.e(47995),n.e(43260),n.e(80147)]).then(n.bind(n,71621)).then((e=>{e.default.store=h.Z,e.default.i18n=v.default,u.default.customElement(e.default.name,e.default)})),Promise.resolve().then(n.bind(n,177597)).then((e=>{e.default.store=h.Z,e.default.i18n=v.default,u.default.customElement(e.default.name,e.default)}))},738619:function(e,t,n){"use strict";n.r(t);var o=n(370538),r=n(285256),i=n(235639),a=n(374929);o.default.use(r.default),o.default.customElement("wg-calendar",i.Z),o.default.customElement("calendar-color-select",a.Z)},157637:function(e,t,n){"use strict";n.r(t);var o,r=n(370538),i=n(285256),a=n(117403),s=(n(141817),n(66992),n(788674),n(333948),n(925706)),l=n(866473),c=n(202669),u=n(860250),d=n(940571),p=n(863559),f=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},v=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},h=(0,s.aZ)({watch:{$route:function(e){var t;this.$emit("input",(null===(t=e.meta)||void 0===t?void 0:t.step)?p.rw[p.rw[e.meta.step]]:p.rw.SELECT)}},render:function(e){return e("keep-alive",[e("router-view",{props:this.$props},this.$slots.default)])}}),m=(0,s.aZ)({router:d.N,components:{Button:l.Button,RouterView:h,Alert:l.Alert},props:{defaultCover:String},setup:function(e){var t=this,n=(0,s.iH)(p.rw.SELECT),o=(0,s.iH)({selectedCourses:[],cover:{url:"",key:""},name:""}),r=(0,s.iH)(!1),i=(0,s.iH)(),l=(0,s.Fl)((function(){return n.value===p.rw.SELECT?a.default.t("combineCourse.nextStep"):a.default.t("combineCourse.combine")}));(0,s.JJ)("config",o),(0,s.JJ)("defaultCover",e.defaultCover),(0,s.JJ)("formRef",i);var h=(0,s.Fl)((function(){switch(n.value){case p.rw.SELECT:return a.default.t("combineCourse.selectCourseTip");case p.rw.COMBINE:return a.default.t("combineCourse.configureCourseTip");default:return""}}));return(0,s.YP)((function(){return o.value.selectedCourses}),(function(e){var t=e.find((function(e){return e.courseType===p.lW.COMBINE}));o.value.name=t?t.name:""})),{step:n,alertMessage:h,config:o,nextText:l,loading:r,cancel:function(){return f(t,void 0,void 0,(function(){return v(this,(function(e){switch(e.label){case 0:return[4,c.Z.open({verticalCenter:!0,title:a.default.t("combineCourse.cancelConfirm"),type:"warning",content:a.default.t("combineCourse.cancelTip")})];case 1:return e.sent()&&(window.location.href="/user/courses"),[2]}}))}))},next:function(){return f(t,void 0,void 0,(function(){var e,t,s,l;return v(this,(function(f){switch(f.label){case 0:return n.value!==p.rw.SELECT?[3,1]:(d.N.push("step-2"),[3,7]);case 1:return[4,c.Z.open({verticalCenter:!0,title:a.default.t("combineCourse.confirm"),type:"warning",content:a.default.t("combineCourse.confirmTip")})];case 2:return e=f.sent(),[4,i.value.validate()];case 3:if(!f.sent())return[2];if(!e)return[3,7];r.value=!0,t=function(){var e=o.value.selectedCourses.find((function(e){return e.courseType===p.lW.COMBINE})),t={title:o.value.name,subCourseIds:o.value.selectedCourses.filter((function(e){return e.courseType!==p.lW.COMBINE})).map((function(e){return e.id}))};return e&&(t.parentCourseId=e.id),o.value.cover.type===p.gW.PRESET?t.courseCoverKey=o.value.cover.key:o.value.cover.type===p.gW.UPLOAD&&(t.courseCoverId=o.value.cover.key),t}(),f.label=4;case 4:return f.trys.push([4,,6,7]),[4,(0,u.combineCourse)(t)];case 5:return s=f.sent().courseId,window.location.href="/course/".concat(s,"/content"),[3,7];case 6:return r.value=!1,[7];case 7:return null===(l=i.value)||void 0===l||l.resetFields(),[2]}}))}))},prev:function(){var e;d.N.push("step-1"),null===(e=i.value)||void 0===e||e.resetFields()}}}}),g=n(551900),y=(0,g.Z)(m,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"combine-course"},[n("header",[n("span",[n("span",[e._v(e._s(e.$t("combineCourse.select")))]),e._v(" "),e._m(0)]),e._v(" "),n("Button",{on:{click:e.cancel}},[e._v(e._s(e.$t("combineCourse.cancel")))])],1),e._v(" "),n("main",{staticClass:"combine-course-step"},[n("Steps",{attrs:{current:e.step}},[n("Step",{attrs:{title:e.$t("combineCourse.select"),content:e.$t("combineCourse.step1Tip")}}),e._v(" "),n("Step",{attrs:{title:e.$t("combineCourse.combine"),content:e.$t("combineCourse.step2Tip")}})],1),e._v(" "),e.alertMessage?n("Alert",{attrs:{"show-icon":""}},[e._v("\n      "+e._s(e.alertMessage)+"\n    ")]):e._e(),e._v(" "),n("RouterView",{staticClass:"combine-course-content",model:{value:e.step,callback:function(t){e.step=t},expression:"step"}}),e._v(" "),n("div",{staticClass:"button-group"},[e.step>0?n("Button",{on:{click:e.prev}},[e._v(e._s(e.$t("combineCourse.prevStep")))]):e._e(),e._v(" "),n("Button",{attrs:{type:"primary",disabled:e.config.selectedCourses.length<2,loading:e.loading},on:{click:e.next}},[e._v("\n        "+e._s(e.nextText)+"\n      ")])],1)],1)])}),[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a",[n("i",{staticClass:"font font-question"}),e._v("\n        功能介绍\n      ")])}],!1,null,"a33804f0",null).exports,w=(n(117727),n(558794)),b=(n(185827),n(319601),n(938823)),_=(n(651532),n(576408)),C=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},k=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},x=new(function(){function e(e){this.inner=e,this.queue=[],this.maxConcurrency=1}return e.prototype.lock=function(){return C(this,void 0,void 0,(function(){var e=this;return k(this,(function(t){switch(t.label){case 0:return this.maxConcurrency<=0?[4,new Promise((function(t){return e.queue.push(t)}))]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.maxConcurrency--,[2,this.inner]}}))}))},e.prototype.release=function(){var e;this.maxConcurrency++,null===(e=this.queue.shift())||void 0===e||e()},e}())(new Map),S=function(){var e=(0,s.f3)("courseId",0),t=(0,s.iH)(new _.cQ),n=function(){return C(void 0,void 0,void 0,(function(){var n,o;return k(this,(function(r){switch(r.label){case 0:return[4,x.lock()];case 1:return(n=r.sent()).has(e)?[3,3]:[4,(0,u.getCoursesToMerged)(e)];case 2:o=r.sent(),n.set(e,_.cQ.fromObj(o)),r.label=3;case 3:return t.value=n.get(e),x.release(),[2]}}))}))};(0,s.bv)((function(){return C(void 0,void 0,void 0,(function(){return k(this,(function(e){switch(e.label){case 0:return[4,n()];case 1:return e.sent(),[2]}}))}))}));return{courses:t,fetch:n,clearCache:function(){return C(void 0,void 0,void 0,(function(){return k(this,(function(e){switch(e.label){case 0:return[4,x.lock()];case 1:return e.sent().clear(),x.release(),[2]}}))}))}}},T=function(){return(T=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},D=(0,s.aZ)({components:{Checkbox:l.Checkbox,Tree:b.ZP},setup:function(){var e=S().courses,t=(0,s.Fl)((function(){return e.value.reduce((function(e,t){var n,o=t.into().children.map((function(e){return e.state("expanded",!0)}));return T(T({},e),((n={})[t.id]=o,n))}),{})}));return{options:{selectable:!1,expandIcon:"arrow"},courses:e,treeData:t}}}),I=(0,g.Z)(D,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"module-card-wrapper"},[e._l(e.courses,(function(t){return[t.modules.length?n("div",{key:t.id,staticClass:"module-card",class:{selected:t.state("selected")}},[n("div",{staticClass:"module-card-header"},[n("Checkbox",{attrs:{value:t.state("selected")},on:{input:function(e){return t.state("selected",e)}}},[e._v("\n          "+e._s(t.name)+" ("+e._s(t.courseCode)+")\n        ")])],1),e._v(" "),n("div",{staticClass:"module-tree"},[n("Tree",{attrs:{data:e.treeData[t.id],options:e.options}})],1)]):e._e()]}))],2)}),[],!1,null,"3b15d896",null).exports,E=(n(115306),n(573210),n(454747),n(602750)),N=n(311610),$=(n(384944),n(133792),(0,s.aZ)({components:{Checkbox:l.Checkbox,SvgIcon:N.Z},props:{checkbox:{type:Boolean,default:!0},activity:{type:Object,required:!0},activities:{type:Array,default:function(){return[]}},draggable:{type:Boolean,default:!0}},setup:function(e){var t=(0,s.Fl)((function(){var t=e.activity.type.replace(/_/g,"-");return"lark_meeting"===e.activity.type?"syllabus-lark-meeting":"font-syllabus-".concat(t)})),n=(0,s.f3)("context",null);return{icon:t,mousedown:function(e,t,o){null==n||n.emit("on-item-mousedown",e,t,o)}}}})),R=(0,g.Z)($,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"activity",class:{selected:e.activity.selected},on:{mousedown:function(t){return e.mousedown(e.activity,e.activities,t)}}},[e.checkbox?n("Checkbox",{model:{value:e.activity.selected,callback:function(t){e.$set(e.activity,"selected",t)},expression:"activity.selected"}}):e._e(),e._v(" "),"lark_meeting"===e.activity.type?n("SvgIcon",{attrs:{name:e.icon}}):n("i",{staticClass:"font",class:e.icon}),e._v(" "),n("span",{staticClass:"activity-name"},[e._v("\n    "+e._s(e.activity.title)+"\n  ")]),e._v(" "),e.draggable?n("i",{staticClass:"font font-activity-drag"}):e._e()],1)}),[],!1,null,"82cd2f4c",null).exports,j=(0,s.aZ)({components:{Activity:R,NoData:E.Z},props:{condition:{type:Object,default:function(){return{}}},courses:{type:Array,required:!0}},setup:function(e,t){(0,s.JJ)("context",t);var n=(0,s.f3)("inCourse",!1),o=(0,s.Fl)((function(){return e.courses.map((function(e){return e.getRightActivities().get()})).flat()})),r=(0,s.Fl)((function(){return e.courses.forEach((function(t){t.filter(e.condition.type,e.condition.keywords,e.condition.courseId)})),e.courses})),i=(0,s.Fl)((function(){return n?a.default.t("noMatchedData"):e.courses.every((function(e){return 0===e.activities.length}))?a.default.t("combineCourse.noActivityTips"):0===e.courses.map((function(e){return e.getRightActivities(!0).get()})).flat().length?a.default.t("combineCourse.noActivityTips1"):e.courses.filter((function(t){return!e.condition.courseId||t.id===e.condition.courseId})).map((function(e){return e.getRightActivities()})).some((function(e){return e.length}))?"":a.default.t("combineCourse.noData")})),l=(0,s.Fl)((function(){return r.value.every((function(e){return!e.getRightActivities().length}))}));return{activities:o,showingData:r,noData:l,noDataText:i,inCourse:n}}}),P=(0,g.Z)(j,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.noData?e._e():[e._l(e.showingData,(function(t){return[t.getRightActivities().length?n("div",{key:t.id,staticClass:"activity-list-item"},[e.condition.courseId||e.inCourse?e._e():n("div",{staticClass:"course-name"},[e._v(e._s(t.name)+e._s(t.courseCode))]),e._v(" "),e._l(t.getRightActivities(),(function(t){return[t.showing?n("Activity",{key:t.type+"_"+t.id,attrs:{activity:t,activities:e.activities}}):e._e()]}))],2):e._e()]}))],e._v(" "),e.noData?n("NoData",{staticClass:"no-data"},[e._v("\n    "+e._s(e.noDataText)+"\n  ")]):e._e()],2)}),[],!1,null,"ff7c1f42",null).exports,M=(0,s.aZ)({components:{ActivityComp:R,Badge:l.Badge},props:{target:{type:Object}},setup:function(e){var t=(0,s.Fl)((function(){var t;return null===(t=e.target)||void 0===t?void 0:t.nodes.find((function(e){return e.currentDrag}))})),n=(0,s.Fl)((function(){return e.target?e.target.nodes.length:0})),o=(0,s.Fl)((function(){return e.target&&t.value&&void 0!==e.target.top?{top:"".concat(e.target.top-20,"px"),left:"".concat(e.target.left-180,"px"),background:"#eee"}:"display: block"}));return{node:t,styles:o,badgeCount:n}}}),O=(0,g.Z)(M,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"drag-node",style:e.styles},[e.node?n("ActivityComp",{attrs:{checkbox:!1,activity:e.node,draggable:!1}}):e._e(),e._v(" "),e.badgeCount>1?n("Badge",{staticClass:"badge",attrs:{count:e.badgeCount,size:"small"}}):e._e()],1)}),[],!1,null,"67d4aa3e",null).exports,G=(n(132023),function(e,t){var n=e.getAttribute("data-id");return t.getNodeById(n)}),A=function(e,t){var n,o,r,i,a=(0,s.iH)();return{startDrag:function(s,l,c){n=[c.clientX,c.clientY];var u=l.filter((function(e){return e.selected})),d=u.map((function(e){return e.id}));s.currentDrag=!0,o=d.includes(s.id)?u:[s];var p=function(t){if((!n||function(e,t){return Math.abs(e.clientX-t[0])>5||Math.abs(e.clientY-t[1])>5}(t,n))&&(n=void 0,o&&(a.value={nodes:o,left:t.clientX,top:t.clientY}),r=e.value.getDropDestination(t),e.value.clearDropClasses(e.value.$el),r)){i=e.value.getDropPosition(t,r);var s=G(r,e.value.tree);"module"===s.data.nodeType&&i!==b.Pw.ON||("activity"===s.data.nodeType||s.expanded())&&i===b.Pw.ON?i=void 0:i&&e.value.updateHelperClasses(r,i)}},f=function(l){if(n||l.stopPropagation(),s.currentDrag=!1,a.value=void 0,e.value.clearDropClasses(e.value.$el),o&&r&&i){var c=G(r,e.value.tree);c&&t(o,c,i)}n=void 0,o=void 0,r=void 0,i=void 0,v()},v=function(){window.removeEventListener("mousemove",p,!0),window.removeEventListener("mouseup",f,!0)};window.addEventListener("mousemove",p,!0),window.addEventListener("mouseup",f,!0)},draggableNode:a}},Z=function(e){return e.count((function(e){return"module"!==e.data.nodeType&&"syllabus"!==e.data.nodeType}))},H=function(e,t){return e.filter((function(e){var n;return(null===(n=e.parent)||void 0===n?void 0:n.id)===t})).map((function(e,t){return{id:e.id,type:e.data.type,sort:t}}))},F=function(e){var t=Number(e);if(!Number.isNaN(t)&&t)return t},B=(0,s.aZ)({props:{value:{type:Boolean,default:!1},data:{type:Array}},components:{Modal:l.Modal,Tree:b.ZP,Button:l.Button},setup:function(e,t){var n=(0,s.iH)(),o=S().courses,r=function(){t.emit("input",!1),t.emit("on-cancel")};return{options:{expandIcon:"arrow"},treeRef:n,save:function(){var e;r();var i=null===(e=n.value)||void 0===e?void 0:e.selected();i&&i.length&&i[0].id&&(t.emit("on-ok",i[0].id),o.value.modify())},close:r,nodeCount:Z}}}),z=(0,g.Z)(B,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Modal",{attrs:{value:e.value,title:e.$t("combineCourse.assignTo")},on:{"on-cancel":e.close},scopedSlots:e._u([{key:"footer",fn:function(){return[n("div",[n("Button",{attrs:{type:"primary"},on:{click:e.save}},[e._v(e._s(e.$t("confirm")))]),e._v(" "),n("Button",{on:{click:e.close}},[e._v(e._s(e.$t("cancel")))])],1)]},proxy:!0}])},[n("Tree",{ref:"treeRef",attrs:{data:e.data,options:e.options},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.node;return[n("span",[e._v("\n        "+e._s(o.text)+"\n        "),e.nodeCount(o)?n("span",{staticStyle:{"margin-left":"5px"}},[e._v("("+e._s(e.nodeCount(o))+")")]):e._e()])]}}])})],1)}),[],!1,null,"712d0bd7",null).exports,L=function(){return(L=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},U=(0,s.aZ)({components:{ISwitch:l.Switch,Button:l.Button,Select:l.Select,Option:l.Option,Input:l.Input,Icon:l.Icon,Tree:b.ZP,Dropdown:l.Dropdown,DropdownItem:l.DropdownItem,DropdownMenu:l.DropdownMenu,Tooltip:l.Tooltip,ActivityList:P,DragNode:O,NoData:E.Z,AssignModal:z,SvgIcon:N.Z},props:{inCourse:{type:Boolean,default:!1}},setup:function(e){(0,s.JJ)("inCourse",e.inCourse);var t=(0,s.iH)(!0),n=(0,s.iH)(!1),o=(0,s.qj)({courseId:0,type:"all",keywords:""}),r=(0,s.iH)(),i=(0,s.iH)(),c=(0,s.iH)(!1),u=(0,s.iH)([]),d=(0,s.iH)(!0),p=S(),f=p.courses,v=(p.clearCache,p.fetch,(0,s.Fl)((function(){var e,t;return!!(null===(t=null===(e=r.value)||void 0===e?void 0:e.tree)||void 0===t?void 0:t._editingNode)}))),h=(0,s.Fl)((function(){return f.value.getActivityTypes().map((function(e){return{name:a.default.t("activityType.".concat(e)),value:e}}))})),m=(0,s.Fl)((function(){return 0===f.value.getAllActivities().length?a.default.t("combineCourse.noActivityTips"):a.default.t("combineCourse.noActivityTips1")})),g=A(r,(function(e,n,o){e.forEach((function(e){return e.toLeft()}));var r=e.map((function(e){return _.cS.fromObj({id:e.id,title:e.title,type:e.type}).into().state("visible",t.value).state("editable",!1)}));switch(o){case b.Pw.ABOVE:n.isRoot()||(r.forEach((function(e){return n.before(e)})),t.value&&n.expand());break;case b.Pw.ON:n.append(r),t.value&&n.expand();break;case b.Pw.BELOW:n.isRoot()||(r.forEach((function(e){return n.after(e)})),t.value&&n.expand());break;default:throw new Error("Drop Position Error")}f.value.modify(),l.Message.success(a.default.t("operationSuccess"))})),y=g.startDrag,w=g.draggableNode,C=(0,s.qj)({editing:!0,expandIcon:"arrow",dnd:!0,dndChecker:function(e,t,n){return(!("activity"===e.data.nodeType&&"activity"===t.data.nodeType||"module"===e.data.nodeType&&"module"===t.data.nodeType||"syllabus"===e.data.nodeType&&"module"!==t.data.nodeType)||n!==b.Pw.ON)&&(("module"!==e.data.nodeType||"module"===t.data.nodeType)&&(n===b.Pw.ON||"module"!==t.data.nodeType||"module"===e.data.nodeType))},showOperate:!0,modelFields:["nodeType","type"],validate:function(e,t){return!!(t=null==t?void 0:t.trim())||(l.Message.error(a.default.t("knowledgeGraph.validate.notNull")),!1)}});return(0,s.YP)(n,(function(e){e&&(0,s.Y3)((function(){var e;null===(e=i.value)||void 0===e||e.focus()}))})),(0,s.YP)(t,(function(e){r.value.tree.recurseDown((function(t){"activity"===t.data.nodeType&&(e?t.show():t.hide())}))})),(0,s.YP)((function(){return f.value.treeData}),(function(e){d.value=0===e.length})),(0,s.bv)((function(){var e=(0,s.f3)("activitiesTree",null);e&&(e.value=r.value.tree)})),{showActivity:t,searchMode:n,condition:o,treeOptions:C,treeRef:r,inputRef:i,editing:v,noTreeData:d,draggableNode:w,activityTypes:h,courses:f,showAssignModal:c,assignModalData:u,noActivityDataText:m,nodeCount:Z,closeSearch:function(){n.value=!1,o.keywords=""},addSyllabus:function(e){var t;null===(t=r.value)||void 0===t||t.append(e,_.bP.default().into().startEditing().select()),e.expand(),f.value.modify(),d.value=!1},addModule:function(){var e;null===(e=r.value)||void 0===e||e.append(_.Yl.default().into().startEditing().select()),f.value.modify(),d.value=!1},rename:function(e){e.startEditing(),f.value.modify()},del:function(e){var t,n,o,i;"activity"!==e.data.nodeType?e.getPath().forEach((function(e){e.recurseDown((function(e){var t;"activity"===e.data.nodeType&&(null===(t=f.value.findActivity(e.id,e.data.type))||void 0===t||t.toRight())}))})):null===(t=f.value.findActivity(e.id,e.data.type))||void 0===t||t.toRight();var a=e.parent;e.remove(),a&&!a.hasChildren()&&a.state("expanded",!1),f.value.modify(),d.value=0===(null===(i=null===(o=null===(n=r.value)||void 0===n?void 0:n.tree)||void 0===o?void 0:o.model)||void 0===i?void 0:i.length)},removeNodeHandle:function(){var e,t,n;d.value=0===(null===(n=null===(t=null===(e=r.value)||void 0===e?void 0:e.tree)||void 0===t?void 0:t.model)||void 0===n?void 0:n.length)},startDrag:y,getActivityIcon:function(e){return"font-syllabus-".concat(e.replace(/_/g,"-"))},openAssignModal:function(){var e,t,n;c.value=!0,u.value=function(e){return function e(t){return t.map((function(t){var n=L(L({},t),{states:{visible:"activity"!==t.data.nodeType}});return n.children&&(n.children=e(n.children)),n}))}(e)}(null!==(n=null===(t=null===(e=r.value)||void 0===e?void 0:e.tree)||void 0===t?void 0:t.model)&&void 0!==n?n:[])},closeAssignModel:function(){u.value=[]},assignToTree:function(e){var n=f.value.getRightActivities().filter((function(e){return e.selected})).map((function(e){return e.toLeft().into().state("visible",t.value)})),o=r.value.tree.getNodeById(e);o&&(o.append(n),l.Message.success(a.default.t("operationSuccess")))},getDataToSend:function(){if(r.value)return function(e,t){var n=[],o=[],r=[];e.recurseDown((function(e){"module"===e.data.nodeType&&n.push(e),"syllabus"===e.data.nodeType&&o.push(e),"activity"===e.data.nodeType&&r.push(e)}));var i=[];return n.forEach((function(e,t){var n={id:F(e.id),name:e.text,sort:t};n.activities=H(r,e.id),n.syllabuses=o.filter((function(t){var n;return(null===(n=t.parent)||void 0===n?void 0:n.id)===e.id})).map((function(e,t){return{id:F(e.id),name:e.text,sort:t,activities:H(r,e.id)}})),i.push(n)})),{activities:t.getRightActivities().map((function(e){return{id:e.id,type:e.type,sort:0}})),modules:i}}(r.value,f.value)},dragFinish:function(){l.Message.success(a.default.t("operationSuccess")),f.value.modify()}}}}),V=(0,g.Z)(U,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"relating-activity-wrapper"},[n("div",{staticClass:"module-tree-wrapper"},[n("header",{staticClass:"relation-pane-header"},[n("span",[e._v(e._s(e.$t("combineCourse.sectionStructure")))]),e._v(" "),n("span",{staticClass:"button-group"},[n("span",[e._v(e._s(e.$t("combineCourse.activity")))]),e._v(" "),n("ISwitch",{attrs:{size:"small"},model:{value:e.showActivity,callback:function(t){e.showActivity=t},expression:"showActivity"}}),e._v(" "),e.inCourse?e._e():n("Button",{staticClass:"add-btn",attrs:{icon:"md-add",disabled:e.editing},on:{click:e.addModule}},[e._v("\n          "+e._s(e.$t("combineCourse.addSection"))+"\n        ")])],1)]),e._v(" "),n("div",{staticClass:"module-tree"},[n("Tree",{ref:"treeRef",attrs:{data:e.courses.treeData,options:e.treeOptions},on:{"node:removed":e.removeNodeHandle,dragFinish:e.dragFinish},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.node;return["activity"===o.data.nodeType?n("span",["lark_meeting"===o.data.type?n("SvgIcon",{staticClass:"icon",attrs:{name:"syllabus-lark-meeting"}}):n("i",{staticClass:"font icon",class:e.getActivityIcon(o.data.type)}),e._v("\n            "+e._s(o.text)+"\n          ")],1):n("span",[e._v("\n            "+e._s(o.text)+"\n            "),e.nodeCount(o)?n("span",{staticStyle:{"margin-left":"5px"}},[e._v("("+e._s(e.nodeCount(o))+")")]):e._e()])]}},{key:"right",fn:function(t){var o=t.node;return[n("div",[!o.tree._editingNode&&e.treeOptions.showOperate?n("div",{staticClass:"tree-operate"},["activity"===o.data.nodeType||o.immutable()&&"module"!==o.data.nodeType||e.inCourse?o.immutable()?e._e():n("Tooltip",{staticClass:"del-activity-icon-tooltip",attrs:{content:e.$t("remove"),placement:"top"}},[n("Icon",{staticClass:"del-activity-icon",attrs:{type:"md-close"},on:{click:function(t){return e.del(o)}}})],1):n("Dropdown",{attrs:{transfer:"",trigger:"hover"},scopedSlots:e._u([{key:"list",fn:function(){return[n("DropdownMenu",[o.depth<1?n("DropdownItem",{nativeOn:{click:function(t){return e.addSyllabus(o)}}},[e._v("\n                      "+e._s(e.$t("combineCourse.addUnit"))+"\n                    ")]):e._e(),e._v(" "),o.immutable()?e._e():n("DropdownItem",{nativeOn:{click:function(t){return e.rename(o)}}},[e._v("\n                      "+e._s(e.$t("knowledgeGraph.rename"))+"\n                    ")]),e._v(" "),o.immutable()?e._e():n("DropdownItem",{staticStyle:{color:"#f85353"},nativeOn:{click:function(t){return e.del(o)}}},[e._v("\n                      "+e._s(e.$t("delete"))+"\n                    ")])],1)]},proxy:!0}],null,!0)},[n("i",{staticClass:"font font-more"})]),e._v(" "),n("i",{staticClass:"font font-activity-drag",on:{mousedown:function(e){return e.stopPropagation(),o.vm.handleMouseDown(e)}}})],1):e._e()])]}}])}),e._v(" "),e.noTreeData?n("NoData",{staticClass:"no-data"},[e._v("\n        "+e._s(e.$t("combineCourse.noSectionTips"))+"\n      ")]):e._e()],1)]),e._v(" "),n("div",{staticClass:"activity-list-wrapper"},[n("header",{staticClass:"relation-pane-header"},[n("Button",{staticClass:"assign-btn",attrs:{type:"primary",ghost:"",disabled:!e.courses.hasActivitySelected()},on:{click:e.openAssignModal}},[e._v("\n        "+e._s(e.$t("combineCourse.assignTo"))+"\n      ")]),e._v(" "),e.searchMode?n("span",{key:"in"},[n("Input",{ref:"inputRef",staticClass:"search-input",attrs:{placeholder:e.$t("combineCourse.searchTip")},scopedSlots:e._u([{key:"suffix",fn:function(){return[n("Icon",{staticStyle:{cursor:"pointer"},attrs:{type:"md-close"},on:{click:e.closeSearch}})]},proxy:!0}]),model:{value:e.condition.keywords,callback:function(t){e.$set(e.condition,"keywords",t)},expression:"condition.keywords"}})],1):n("span",{key:"out",staticClass:"button-group"},[e.inCourse?e._e():n("span",{staticClass:"button-group"},[n("span",{staticClass:"button-label"},[e._v(e._s(e.$t("combineCourse.course")))]),e._v(" "),n("Select",{model:{value:e.condition.courseId,callback:function(t){e.$set(e.condition,"courseId",t)},expression:"condition.courseId"}},[n("Option",{attrs:{value:0}},[e._v(e._s(e.$t("all")))]),e._v(" "),e._l(e.courses,(function(t){return n("Option",{key:t.id,attrs:{value:t.id}},[e._v("\n              "+e._s(t.name)+"\n            ")])}))],2)],1),e._v(" "),n("span",{staticClass:"button-group"},[n("span",{staticClass:"button-label"},[e._v(e._s(e.$t("combineCourse.type")))]),e._v(" "),n("Select",{model:{value:e.condition.type,callback:function(t){e.$set(e.condition,"type",t)},expression:"condition.type"}},[n("Option",{attrs:{value:"all"}},[e._v(e._s(e.$t("all")))]),e._v(" "),e._l(e.activityTypes,(function(t){return n("Option",{key:t.name,attrs:{value:t.value}},[e._v(e._s(t.name))])}))],2)],1),e._v(" "),n("Button",{staticClass:"search-btn",attrs:{icon:"md-search"},on:{click:function(t){e.searchMode=!0}}})],1)],1),e._v(" "),n("ActivityList",{staticClass:"activity-list",attrs:{courses:e.courses.get(),condition:e.condition},on:{"on-item-mousedown":e.startDrag}})],1),e._v(" "),n("DragNode",{attrs:{target:e.draggableNode}}),e._v(" "),n("AssignModal",{attrs:{data:e.assignModalData},on:{"on-cancel":e.closeAssignModel,"on-ok":e.assignToTree},model:{value:e.showAssignModal,callback:function(t){e.showAssignModal=t},expression:"showAssignModal"}})],1)}),[],!1,null,"6a6b10d9",null).exports,q=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},Y=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}};!function(e){e[e.FIRST=0]="FIRST",e[e.SECOND=1]="SECOND"}(o||(o={}));var K=(0,s.aZ)({props:["courseId","hasCombined","moduleRequired"],components:{Modal:l.Modal,Button:l.Button,Steps:l.Steps,Step:l.Steps.Step,Alert:l.Alert,MergeModules:I,MergeActivity:V,Tooltip:l.Tooltip,TooltipExt:w.Z},setup:function(e){var t=this,n=(0,s.iH)(e.hasCombined?o.SECOND:o.FIRST),r=(0,s.iH)(!1),i=(0,s.iH)();(0,s.JJ)("courseId",e.courseId);var l=S().courses,c=(0,s.Fl)((function(){return n.value===o.FIRST&&!l.value.getSelection().length||n.value===o.SECOND&&e.moduleRequired&&!!l.value.getRightActivities().length})),d=(0,s.Fl)((function(){return n.value===o.FIRST?a.default.t("combineCourse.specifySectionTips"):n.value===o.SECOND?a.default.t("combineCourse.mergeTips"):""})),p=(0,s.Fl)((function(){switch(n.value){case o.FIRST:return a.default.t("combineCourse.nextStep");case o.SECOND:return a.default.t("combineCourse.save");default:return""}}));return{Step:o,step:n,alertMessage:d,nextText:p,courses:l,loading:r,mergeActivityRef:i,disabledNext:c,close:function(){window.location.href="/user/courses"},next:function(){n.value===o.FIRST?n.value=o.SECOND:n.value===o.SECOND&&q(t,void 0,void 0,(function(){var t,n;return Y(this,(function(o){return(t=null===(n=i.value)||void 0===n?void 0:n.getDataToSend())?(r.value=!0,(0,u.combineCourseContent)(e.courseId,t).then((function(){window.location.reload()})).finally((function(){r.value=!1})),[2]):[2]}))}))},prev:function(){n.value-=1}}}}),W=(0,g.Z)(K,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Modal",{attrs:{value:!0,"mask-closable":!1,title:e.$t("combineCourse.mergeContent"),width:1e3},on:{"on-cancel":e.close},scopedSlots:e._u([{key:"footer",fn:function(){return[n("div",[e.step>0&&!e.courses.hasCombine()?n("Button",{on:{click:e.prev}},[e._v(e._s(e.$t("combineCourse.prevStep")))]):e._e(),e._v(" "),n("Button",{attrs:{type:"primary",disabled:e.disabledNext,loading:e.loading},on:{click:e.next}},[e._v("\n        "+e._s(e.nextText)+"\n      ")])],1)]},proxy:!0}])},[n("Steps",{attrs:{current:e.step}},[n("Step",{attrs:{title:e.$t("combineCourse.specifySection")}}),e._v(" "),n("Step",{attrs:{title:e.$t("combineCourse.owner")}})],1),e._v(" "),n("Alert",{attrs:{"show-icon":""}},[n("TooltipExt",{attrs:{text:e.alertMessage}})],1),e._v(" "),n("div",{staticClass:"modal-content"},[n("MergeModules",{directives:[{name:"show",rawName:"v-show",value:e.step===e.Step.FIRST,expression:"step === Step.FIRST"}]}),e._v(" "),n("MergeActivity",{directives:[{name:"show",rawName:"v-show",value:e.step===e.Step.SECOND,expression:"step === Step.SECOND"}],ref:"mergeActivityRef"})],1)],1)}),[],!1,null,"2dfd2c04",null).exports,J=n(656283),X=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},Q=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},ee=(0,s.aZ)({components:{Modal:l.Modal,Button:l.Button,MergeActivity:V},props:["value","courseId"],setup:function(e,t){var n=this;(0,s.JJ)("courseId",e.courseId);var o=(0,s.iH)(),r=(0,s.iH)(!1),i=(0,s.iH)(!1),c=S(),d=c.clearCache,p=c.fetch,f=c.courses;return{mergeActivityRef:o,loading:r,fetching:i,courses:f,close:function(){t.emit("input",!1),d()},visibleChange:function(e){return X(n,void 0,void 0,(function(){return Q(this,(function(t){switch(t.label){case 0:if(i.value=!0,!e)return[3,5];t.label=1;case 1:return t.trys.push([1,,4,5]),[4,d()];case 2:return t.sent(),[4,p()];case 3:return t.sent(),[3,5];case 4:return i.value=!1,[7];case 5:return[2]}}))}))},save:function(){return X(n,void 0,void 0,(function(){var t,n;return Q(this,(function(i){switch(i.label){case 0:if(!(t=null===(n=o.value)||void 0===n?void 0:n.getDataToSend()))return[2];r.value=!0,i.label=1;case 1:return i.trys.push([1,,3,4]),[4,(0,u.assignActivityToModule)(e.courseId,t)];case 2:return i.sent(),l.Message.success(a.default.t("operationSuccess")),window.location.reload(),[3,4];case 3:return r.value=!1,[7];case 4:return[2]}}))}))}}}}),te=(0,g.Z)(ee,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Modal",{attrs:{title:e.$t("combineCourse.owner1"),value:e.value,width:1e3,"mask-closable":!1},on:{"on-cancel":e.close,"on-visible-change":e.visibleChange},scopedSlots:e._u([{key:"footer",fn:function(){return[n("div",[n("Button",{attrs:{type:"primary",loading:e.loading,disabled:!e.courses.modified()},on:{click:e.save}},[e._v("\n        "+e._s(e.$t("save"))+"\n      ")]),e._v(" "),n("Button",{on:{click:e.close}},[e._v(e._s(e.$t("cancel")))])],1)]},proxy:!0}])},[e.value?n("MergeActivity",{ref:"mergeActivityRef",attrs:{"in-course":!0}}):e._e()],1)}),[],!1,null,"4e524f0c",null).exports;r.default.use(i.default),r.default.customElement("combine-course",y),r.default.customElement("combine-course-compose-activity-modal",W),r.default.customElement("combine-course-assign-sub-course",J.Z),r.default.customElement("assign-activity-modal",te)},541647:function(e,t,n){"use strict";n.r(t);n(788674);var o=n(370538),r=n(285256),i=n(117403),a=n(863322);o.default.prototype.$store=a.Z,o.default.prototype.$featureToggles=window.featureToggles,o.default.use(r.default),n.e(46791).then(n.bind(n,746791)).then((e=>{e.default.options.store=a.Z,e.default.options.i18n=i.default,o.default.customElement(e.default.options.name,e.default.options)})),n.e(96463).then(n.bind(n,796463)).then((e=>{e.default.i18n=i.default,o.default.customElement(e.default.name,e.default)}))},161883:function(e,t,n){"use strict";n.r(t);var o,r,i,a,s,l,c,u,d,p=n(370538),f=n(578345),v=n(285256),h=n(117403),m=n(925706),g=n(153384),y=n(154803),w=n(802972),b=(n(141817),n(66992),n(788674),n(333948),n(866473)),_=n(718630),C=n(119292),k=n(243407),x=(0,m.aZ)({components:{HeaderWrapper:_.Z,CourseName:C.Z},setup:function(){var e=(0,k.tv)(),t=e.route,n=e.router;return{view:(0,m.Fl)({get:function(){return"/problem"===t.value.path?"/problem":"/outline"},set:function(e){null==n||n.push(e)}}),radioOptions:[{label:"/outline",text:h.default.t("knowledgeGraph.title")},{label:"/problem",text:h.default.t("problemGraph.graph")}]}}}),S=x,T=n(551900),D=(0,T.Z)(S,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("HeaderWrapper",{scopedSlots:e._u([{key:"center",fn:function(){return[n("RadioGroup",{attrs:{type:"button","button-style":"solid"},model:{value:e.view,callback:function(t){e.view=t},expression:"view"}},e._l(e.radioOptions,(function(t){return n("Radio",{key:t.label,attrs:{label:t.label}},[n("span",{staticClass:"text"},[e._v(e._s(t.text))])])})),1)]},proxy:!0},{key:"btn-group",fn:function(){return[e._t("btn-group")]},proxy:!0}],null,!0)},[n("div",{staticClass:"gap-10"},[n("CourseName")],1)]),e._v(" "),e._t("default")],2)}),[],!1,null,"c4095218",null),I=D.exports,E=n(950426),N=n(467691),$=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},R=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},j=(0,m.aZ)({components:{MainHeader:I},setup:function(){var e=this,t=(0,m.iH)((0,m.f3)("problemPublishType","unpublished")),n=(0,N.B)(),o=n.batchDeleteProblemsMode,r=n.problems,i=n.checkedProblems,a=n.toggleCheckAll,s=n.isCheckedAll,l=n.del,c=n.cancel;return(0,m.Ah)((function(){o.value=!1})),{toggleCollapse:function(){return $(e,void 0,void 0,(function(){var e,t,n,o,r;return R(this,(function(i){switch(i.label){case 0:return null===(e=y.jx.value)||void 0===e||e.unManageAll(),y.xN.value?null===(t=y.jx.value)||void 0===t||t.expandAll():null===(n=y.jx.value)||void 0===n||n.collapseAll(),[4,(0,m.Y3)()];case 1:return i.sent(),null===(o=y.jx.value)||void 0===o||o.repaintEndpoints(),null===(r=y.jx.value)||void 0===r||r.connect(),y.xN.value=!y.xN.value,[2]}}))}))},isCollapsedAllProblem:y.xN,isInstructor:y.wZ,publishType:t,publish:function(){return $(e,void 0,void 0,(function(){var e,n;return R(this,(function(o){switch(o.label){case 0:e="unpublished"===t.value?"published":"unpublished",b.Message.destroy(),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,(0,E.n8)(y.N7.value.id,e)];case 2:return o.sent(),t.value=e,n=h.default.t("knowledgeGraph.publishSuccess"),"unpublished"===e&&(n=h.default.t("knowledgeGraph.cancelPublishSuccess")),b.Message.success(n),[3,4];case 3:return o.sent(),b.Message.error(h.default.t("operationFailed")),[3,4];case 4:return[2]}}))}))},batchDeleteProblemsMode:o,problems:r,checkedProblems:i,del:l,isCheckedAll:s,toggleCheckAll:a,cancelDel:c}}}),P=j,M=(0,T.Z)(P,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("MainHeader",{scopedSlots:e._u([{key:"btn-group",fn:function(){return[e.batchDeleteProblemsMode?n("div",{staticClass:"flex gap-16"},[n("Checkbox",{attrs:{value:e.isCheckedAll},on:{"on-change":e.toggleCheckAll}},[e._v(e._s(e.$t("selectAll")))]),e._v(" "),n("span",{domProps:{innerHTML:e._s(e.$t("problemGraph.totalXItemsSelectedXItems",[e.problems.length,"<span style='color: var(--primary-brand-color)'>"+e.checkedProblems.length+"</span>"]))}}),e._v(" "),n("Button",{on:{click:e.cancelDel}},[e._v(e._s(e.$t("cancel")))]),e._v(" "),n("Button",{attrs:{type:"error",ghost:"",disabled:!e.checkedProblems.length},on:{click:e.del}},[e._v(e._s(e.$t("delete")))])],1):n("div",{staticClass:"flex gap-16"},[n("Button",{staticClass:"expand-btn",on:{click:e.toggleCollapse}},[n("SvgIcon",{class:{"rotate-180":e.isCollapsedAllProblem},attrs:{name:"problem-collapse-all"}}),e._v("\n        "+e._s(e.isCollapsedAllProblem?e.$t("problemGraph.expandAll"):e.$t("problemGraph.collapseAll"))+"\n      ")],1),e._v(" "),e.isInstructor&&e.problems.length?n("Button",{on:{click:function(t){e.batchDeleteProblemsMode=!0}}},[e._v("\n        "+e._s(e.$t("batch_delete"))+"\n      ")]):e._e(),e._v(" "),e.isInstructor?n("Button",{staticClass:"publish-btn",attrs:{type:"primary"},on:{click:e.publish}},[n("SvgIcon",{attrs:{name:"unpublished"===e.publishType?"publish":"unpublish"}}),e._v("\n        "+e._s("unpublished"===e.publishType?e.$t("knowledgeGraph.publish"):e.$t("knowledgeGraph.cancelPublish"))+"\n      ")],1):e._e()],1)]},proxy:!0}])})}),[],!1,null,"6d169868",null),O=M.exports,G=n(462149),A=n(202669),Z=n(681423),H=n(662061),F=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},B=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},z=(0,m.aZ)({setup:function(){var e=this,t=(0,m.iH)(!1),n=(0,m.f3)("knowledgeGraphSource","self");return{visible:t,handleEditGraphSource:function(t){return F(e,void 0,void 0,(function(){var e;return B(this,(function(o){switch(o.label){case 0:return n===t?[2]:[4,A.Z.open({title:h.default.t("knowledgeGraph.source.editTitle"),type:"warning",divider:!1,width:660,content:h.default.t("knowledgeGraph.source.editTip"),verticalCenter:!0,hideIcon:!1})];case 1:if(!o.sent())return[2];o.label=2;case 2:return o.trys.push([2,7,,8]),[4,(0,H.Pm)(y.N7.value.id,t)];case 3:return o.sent(),"self"!==t?[3,4]:(window.location.reload(),[3,6]);case 4:return[4,g.N.push("/extension")];case 5:o.sent(),o.label=6;case 6:return[3,8];case 7:return e=o.sent(),console.error(e),[3,8];case 8:return[2]}}))}))},onVisibleChange:function(e){t.value=e}}}}),L=z,U=(0,T.Z)(L,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"edit-graph-source-wrapper"},[n("Dropdown",{attrs:{placement:"bottom-end",trigger:"click"},on:{"on-click":e.handleEditGraphSource,"on-visible-change":e.onVisibleChange},scopedSlots:e._u([{key:"list",fn:function(){return[n("DropdownMenu",[n("DropdownItem",{attrs:{name:"self"}},[e._v(e._s(e.$t("knowledgeGraph.source.self")))]),e._v(" "),n("DropdownItem",{attrs:{name:"chinamcloud"}},[e._v(e._s(e.$t("knowledgeGraph.source.chinamcloud")))])],1)]},proxy:!0}])},[n("span",{staticClass:"edit-source-button",class:{open:e.visible}},[e._v("\n      "+e._s(e.$t("knowledgeGraph.source.title"))+"\n      "),n("Icon",{attrs:{custom:"font font-standard-arrow-down"}})],1)])],1)}),[],!1,null,"502cc19d",null),V=U.exports,q=n(892932),Y=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},K=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},W=(0,m.aZ)({components:{},props:{value:{type:Boolean,required:!0},courseId:{type:Number,required:!0},courseName:{type:String,required:!0},nodeCount:{type:Number,required:!0,default:0},isProject:{type:Boolean,default:!1}},setup:function(e,t){var n=this,o=(0,m.iH)(!1),r=(0,m.f3)("course",{id:0}),i=(0,m.iH)(new G.f5),a=function(){o.value=!1,t.emit("input",!1)};return(0,m.YP)((function(){return e.value}),(function(t){t&&Y(n,void 0,void 0,(function(){var t;return K(this,(function(n){switch(n.label){case 0:return t=i,[4,(0,H.ah)(e.courseId)];case 1:return t.value=n.sent(),[2]}}))}))})),{referTypeStat:i,importReferResource:o,close:a,submit:function(){return Y(n,void 0,void 0,(function(){var n;return K(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,3,4]),[4,(0,H.GZ)(e.courseId,r.id,o.value)];case 1:return n=i.sent(),t.emit("success",n),[3,4];case 2:return i.sent(),t.emit("error"),[3,4];case 3:return a(),[7];case 4:return t.emit("input",!1),[2]}}))}))}}}}),J=W,X=(0,T.Z)(J,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Modal",{attrs:{value:e.value,title:e.$t("knowledgeGraph.batchImport.importKnowledgeNodeTitle"),"class-name":"vertical-center-modal",width:"600"},on:{"on-cancel":e.close}},[n("div",{staticClass:"content"},[n("div",{staticClass:"title-area"},[e.isProject?n("span",{staticClass:"title"},[e._v("\n        "+e._s(e.$t("knowledgeGraph.batchImport.importKnowledgeNodesFormProject",{courseName:e.courseName}))+"\n      ")]):n("span",{staticClass:"title"},[e._v("\n        "+e._s(e.$t("knowledgeGraph.batchImport.importKnowledgeNodesFormCourse",{courseName:e.courseName}))+"\n      ")]),e._v(" "),n("span",{staticClass:"count"},[e._v(e._s(e.$t("knowledgeGraph.batchImport.importKnowledgeNodeCount",{num:e.nodeCount})))])]),e._v(" "),n("div",{staticClass:"check-type-area"},[n("Checkbox",{attrs:{disabled:!e.referTypeStat.resourceCount},model:{value:e.importReferResource,callback:function(t){e.importReferResource=t},expression:"importReferResource"}},[e._v("\n        "+e._s(e.$t("knowledgeGraph.batchImport.syncCopyReferResources",{num:e.referTypeStat.resourceCount}))+"\n      ")])],1)]),e._v(" "),n("template",{slot:"footer"},[n("Button",{attrs:{type:"primary",disabled:!e.nodeCount},on:{click:e.submit}},[e._v(e._s(e.$t("confirm")))]),e._v(" "),n("Button",{staticClass:"button button-grey medium",on:{click:e.close}},[e._v(e._s(e.$t("cancel")))])],1)],2)}),[],!1,null,"047d7f10",null),Q=X.exports,ee=n(599921),te=(0,m.aZ)({name:"CourseSelectModal",components:{CourseList:ee.Z},props:{showModal:{type:Boolean,required:!0},isProject:{type:Boolean,default:!1}},setup:function(e,t){var n=(0,m.iH)(null),o=(0,m.iH)(0),r=(0,m.Fl)((function(){return e.showModal}));return window.addEventListener("updateSelectedMoveCourseId",(function(e){var n=e.detail;o.value=n.courseId,t.emit("confirm",n)})),{show:r,close:function(){n.value.selectedCourseId=0,o.value=0,t.emit("close")},selectCourseId:o,courseListRef:n}}}),ne=te,oe=(0,T.Z)(ne,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Modal",{staticClass:"file-select-modal",attrs:{value:e.show,title:e.isProject?e.$t("knowledgeGraph.batchImport.project"):e.$t("knowledgeGraph.batchImport.course"),width:"900","footer-hide":""},on:{"on-cancel":e.close}},[e.show?n("CourseList",{ref:"courseListRef",staticClass:"course-list",attrs:{"show-knowledge-node-count":!0,"exclude-current-course":!0,"is-project":e.isProject}}):e._e()],1)}),[],!1,null,"4e8bab69",null),re=oe.exports,ie=(n(426833),n(923157),n(454747),n(966309)),ae=n(427372),se=(0,m.aZ)({props:{node:{type:Object,required:!0},edit:{type:Boolean,required:!1},error:{type:Boolean,required:!1}},setup:function(e,t){var n=t.emit,o="",r=(0,m.iH)(null);return(0,m.YP)((function(){return e.edit}),(function(){e.edit||""!==e.node.name||(e.node.name=o)})),{update:function(){n("update")},startEdit:function(){o=e.node.name,n("start-edit"),(0,m.Y3)((function(){r.value.focus()}))},inputRef:r}}}),le=se,ce=(0,T.Z)(le,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.edit?n("div",{staticClass:"node node-edit"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.node.name,expression:"node.name"}],ref:"inputRef",attrs:{draggable:!0,type:"text"},domProps:{value:e.node.name},on:{click:function(e){e.stopPropagation()},dragstart:function(e){e.stopPropagation(),e.preventDefault()},keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.update(t)},input:function(t){t.target.composing||e.$set(e.node,"name",t.target.value)}}})]):n("div",{staticClass:"flex node"},[n("div",[n("div",[e._v("\n      "+e._s(e.node.name)+"\n    ")]),e._v(" "),e.error?n("div",{staticClass:"error"},[e._v(e._s(e.$t("knowledgeGraph.nodeNameDuplicateError")))]):e._e()]),e._v(" "),n("div",{staticClass:"tree-action"},[n("button",{on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.startEdit(t)}}},[e._v(e._s(e.$t("edit")))]),e._v(" "),e._m(0)])])}),[function(){var e=this.$createElement,t=this._self._c||e;return t("button",[t("i",{staticClass:"font font-activity-drag"})])}],!1,null,"64edcf01",null),ue=ce.exports,de=n(146176),pe=n(949440),fe=n.n(pe),ve=n(48496),he=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},me=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},ge=(0,m.aZ)({name:"FileSelectModal",components:{VTree:fe(),NoData:ae.Z,PreviewNode:ue},props:{value:{type:Boolean,required:!0},format:{type:String,required:!0}},setup:function(e,t){var n=this,o=t.emit,r=(0,m.iH)(),i=(0,ie.NCN)(e,"value",o,{eventName:"input"}),a=(0,de.X)().depth,s=(0,m.f3)("course",{id:0}),l=(0,m.Fl)((function(){return h.default.t("knowledgeGraph.batchImport.".concat(e.format))})),c=(0,m.Fl)((function(){return h.default.t("knowledgeGraph.batchImport.supportTip",[a,e.format])})),u=(0,m.Fl)((function(){var e="zh-cn";return h.default.locale.startsWith("en-")&&(e="en-us"),["zh-TW","zh-MO"].includes(h.default.locale)&&(e="zh-tw"),"/static/data_import_templates/knowledge-import-excel-template-".concat(e,".xlsx")})),d=(0,m.iH)(!1),p=(0,m.iH)([]),f=(0,m.iH)(-1),v=(0,m.iH)([]),g=function e(t){t.forEach((function(t){e(t.children)}));var n=ve._.groupBy(t,(function(e){return e.name}));Object.values(n).forEach((function(e){e.length>1&&e.forEach((function(e){v.value.push(e.id)}))}))},y=(0,m.iH)(null),w={confirm:function(){},cancel:function(){},loading:(0,m.iH)(!1)};return{fileSelectRef:r,show:i,title:l,support:c,downloadTemplateUrl:u,mockSelectFile:function(){var e=r.value;e&&(e.value="",e.click())},selectFileHandler:function(t){return he(n,void 0,void 0,(function(){var n,r,i,a,l,c,u,f;return me(this,(function(v){switch(v.label){case 0:if(!(null===(u=t.target.files)||void 0===u?void 0:u.length)||1!==t.target.files.length)return[3,9];n=t.target.files[0],v.label=1;case 1:return v.trys.push([1,8,,9]),r=void 0,"docx"!==e.format?[3,5]:[4,(0,H.$C)(n)];case 2:return i=v.sent(),p.value=i.data,g(p.value),d.value=!0,[4,new Promise((function(e,t){w.confirm=function(){e(y.value.getTreeData())}}))];case 3:return a=v.sent(),w.loading.value=!0,l=function(e){return e.map((function(e){return{name:e.name,children:e.children?l(e.children):[]}}))},[4,(0,H._p)(s.id,l(a))];case 4:return r=v.sent(),d.value=!1,w.loading.value=!1,[3,7];case 5:return[4,(0,H.Ys)(s.id,n,e.format)];case 6:r=v.sent(),v.label=7;case 7:return(null===(f=null==r?void 0:r.data)||void 0===f?void 0:f.error)?o("error",r.data.error):o("success",r),[3,9];case 8:return c=v.sent(),console.error(c),o("error"),[3,9];case 9:return[2]}}))}))},showPreview:d,previewData:p,editingPreviewDataId:f,treeRef:y,preview:w,findAllErrors:function(){v.value=[],g(y.value.getTreeData())},errorSet:v}}}),ye=ge,we=(0,T.Z)(ye,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("Modal",{staticClass:"file-select-modal",attrs:{"footer-hide":"",title:e.title,width:"600"},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[n("div",{staticClass:"content"},[n("input",{ref:"fileSelectRef",staticStyle:{display:"none"},attrs:{type:"file",accept:"."+e.format},on:{change:e.selectFileHandler}}),e._v(" "),n("Button",{staticClass:"select-file-btn",attrs:{type:"primary"},on:{click:e.mockSelectFile}},[n("i",{staticClass:"font font-file-select"}),e._v(" "),"docx"===e.format?n("span",{staticClass:"btn-text"},[e._v(e._s(e.$t("knowledgeGraph.selectDocxFile")))]):n("span",{staticClass:"btn-text"},[e._v(e._s(e.$t("knowledgeGraph.batchImport.selectFile")))])]),e._v(" "),"docx"===e.format?n("div",{staticClass:"support"},[n("i",{staticClass:"font font-info-circle"}),e._v("\n        "+e._s(e.$t("knowledgeGraph.supportDocx"))+"\n      ")]):e._e(),e._v(" "),"xmind"===e.format?n("div",{staticClass:"support"},[e._v(e._s(e.support))]):e._e(),e._v(" "),"xlsx"===e.format?n("div",{staticClass:"download-template"},[n("a",{attrs:{href:e.downloadTemplateUrl}},[n("i",{staticClass:"font font-download-alt"}),e._v(" "),n("span",[e._v(e._s(e.$t("downloadOfficialTemplate")))])])]):e._e()],1)]),e._v(" "),n("Modal",{staticClass:"preview-modal",attrs:{title:e.$t("knowledgeGraph.nodePreview"),width:"900"},on:{"on-cancel":e.preview.cancel},model:{value:e.showPreview,callback:function(t){e.showPreview=t},expression:"showPreview"}},[n("Alert",{attrs:{"show-icon":""}},[e._v(e._s(e.$t("knowledgeGraph.smartImportTip")))]),e._v(" "),e.previewData.length>0?n("VTree",{ref:"treeRef",attrs:{data:e.previewData,nodeMinHeight:45,draggable:"",droppable:"",defaultExpandAll:"",titleField:"name"},on:{"node-drop":e.findAllErrors},scopedSlots:e._u([{key:"node",fn:function(t){var o=t.node;return[n("PreviewNode",{attrs:{node:o,edit:e.editingPreviewDataId===o.id,error:e.errorSet.includes(o.id)},on:{"start-edit":function(t){e.editingPreviewDataId=o.id},update:function(){e.editingPreviewDataId=-1,e.findAllErrors()}}})]}}],null,!1,411282307)}):n("NoData",{staticClass:"no-data"},[e._v(e._s(e.$t("noData")))]),e._v(" "),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{attrs:{disabled:0===e.previewData.length,loading:e.preview.loading.value,type:"primary"},on:{click:e.preview.confirm}},[e._v("\n        "+e._s(e.$t("knowledgeGraph.import"))+"\n      ")])],1)],1)],1)}),[],!1,null,"f56bc338",null),be=we.exports,_e=(0,m.aZ)({name:"ImportResult",props:{value:{type:Boolean,required:!0},format:{type:String,required:!0},result:{type:String,required:!0},count:{type:Number,default:0},updateCount:{type:Number,default:0},updateReferResourceCount:{type:Number,default:0},isProject:{type:Boolean,default:!1}},setup:function(e,t){var n=t.emit,o=(0,ie.NCN)(e,"value",n,{eventName:"input"}),r=(0,m.Fl)((function(){return e.isProject&&"course"===e.format?h.default.t("knowledgeGraph.batchImport.project"):h.default.t("knowledgeGraph.batchImport.".concat(e.format))})),i=(0,m.Fl)((function(){return"course"===e.format&&"success"===e.result?"".concat(h.default.t("knowledgeGraph.batchImport.success",[e.count]),", ").concat(h.default.t("knowledgeGraph.batchImport.successUpdate",[e.updateCount])):e.result?h.default.t("knowledgeGraph.batchImport.".concat(e.result),[e.count]):""}));return{show:o,title:r,message:i,ok:function(){o.value=!1,"success"===e.result&&(e.count>0||e.updateCount>0)&&window.location.reload()}}}}),Ce=_e,ke=(0,T.Z)(Ce,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Modal",{attrs:{width:"480",title:e.title},scopedSlots:e._u([{key:"footer",fn:function(){return[n("Button",{attrs:{type:"primary"},on:{click:e.ok}},[e._v(e._s(e.$t("ok")))])]},proxy:!0}]),model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[n("div",{staticClass:"content"},["success"===e.result?n("i",{staticClass:"font font-checkmark-circle"}):n("i",{staticClass:"font font-error"}),e._v(" "),n("div",{staticClass:"result"},[e._v(e._s(e.message))]),e._v(" "),e.updateReferResourceCount?n("div",{staticClass:"sync-type-result"},[n("div",{staticClass:"item"},[n("div",{staticClass:"tag"}),e._v(" "),n("span",{staticClass:"desc"},[e._v("\n          "+e._s(e.$t("knowledgeGraph.batchImport.successCopyReferResources",{num:e.updateReferResourceCount}))+"\n        ")])])]):e._e()])])}),[],!1,null,"2e08b053",null),xe=ke.exports,Se=n(558794),Te=(0,m.aZ)({components:{TooltipExt:Se.Z},name:"ImportIssuesModal",props:{value:{type:Boolean,required:!0},format:{type:String,required:!0},result:{type:String,required:!0},count:{type:Number,default:0},correctCount:{type:Number,default:0},issues:{type:Array,default:!1}},setup:function(e,t){var n=t.emit,o=(0,ie.NCN)(e,"value",n,{eventName:"input"}),r=(0,m.Fl)((function(){return h.default.t("knowledgeGraph.batchImport.".concat(e.format))}));return{show:o,title:r,retry:function(){o.value=!1,n("retry")}}}}),De=Te,Ie=(0,T.Z)(De,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Modal",{attrs:{width:"600",title:e.title},scopedSlots:e._u([{key:"footer",fn:function(){return[n("Button",{attrs:{type:"primary"},on:{click:e.retry}},[e._v(e._s(e.$t("knowledgeGraph.batchImport.reupload")))])]},proxy:!0}]),model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[n("div",{staticClass:"content"},[n("div",{staticClass:"error-tip"},[n("i",{staticClass:"font font-circle-wrong light"}),e._v("\n      "+e._s(e.$t("knowledgeGraph.batchImport.alertPrefix",[e.correctCount]))+"\n      "),n("span",{staticClass:"light"},[e._v(e._s(e.issues.length))]),e._v("\n      "+e._s(e.$t("knowledgeGraph.batchImport.alertSuffix"))+"\n    ")]),e._v(" "),n("ul",[n("li",{staticClass:"head"},[n("div",{staticClass:"line"},[e._v(e._s(e.$t("knowledgeGraph.batchImport.tipHeadId")))]),e._v(" "),n("div",{staticClass:"desc"},[e._v(e._s(e.$t("knowledgeGraph.batchImport.tipHeadReason")))])]),e._v(" "),e._l(e.issues,(function(t,o){return n("li",{key:o,staticClass:"item"},[n("div",{staticClass:"line"},[e._v(e._s(t.id))]),e._v(" "),n("div",{staticClass:"desc"},[n("TooltipExt",{attrs:{text:t.content,placement:"top"}})],1)])}))],2)])])}),[],!1,null,"096a8dc5",null),Ee=Ie.exports,Ne=(0,m.aZ)({name:"BatchImportDropdown",components:{FileSelectModal:be,ImportResult:xe,CourseSelectModal:re,ImportConfirmModal:Q,ImportIssuesModal:Ee},setup:function(){var e,t,n=(0,m.iH)(!1),o=(0,m.iH)(!1),r=(0,m.iH)(!1),i=(0,m.iH)(!1),a=(0,m.iH)(!1),s=(0,m.iH)(""),l=(0,m.iH)(0),c=(0,m.iH)(0),u=(0,m.iH)(0),d=(0,m.iH)(""),p=(0,m.iH)(0),f=(0,m.iH)(""),v=(0,m.iH)(0),h=(0,m.iH)(0),g=(0,m.iH)([]),y=8===(null===(t=null===(e=window.globalData)||void 0===e?void 0:e.course)||void 0===t?void 0:t.courseType),w=(0,m.iH)(!1),b=(0,m.Fl)((function(){return window.featureToggles.knowledgeGraphBatchImportXmind})),_=(0,m.Fl)((function(){return window.featureToggles.knowledgeGraphBatchImportExcel})),C=(0,m.Fl)((function(){return window.featureToggles.knowledgeGraphBatchImportCourse}));return{showImportFromFileModal:n,showImportFromCourseModal:o,showImportConfirmModal:r,showImportResult:i,showImportIssuesModal:a,fileFormat:d,result:s,count:l,correctCount:h,updateCount:c,updateReferResourceCount:u,issues:g,handleImport:function(e){o.value="course"===e,n.value=!o.value,d.value=e},onSuccess:function(e){o.value=!1,n.value=!1,s.value="success",l.value=e.data.count||0,c.value=e.data.update_count||0,u.value=e.data.update_refer_resource_count||0,h.value=e.data.correct_count||0,e.data.issues&&e.data.issues.length>0?(g.value=e.data.issues,a.value=!0):i.value=!0},onError:function(e){n.value=!1,i.value=!0,s.value=e||"failure"},reImport:function(){n.value=!0,i.value=!1,a.value=!1},showXmindImportBtn:b,showExcelImportBtn:_,showCourseImportBtn:C,closeCourseSelectModal:function(){o.value=!1},confirmCourseSelect:function(e){p.value=e.courseId,f.value=e.courseName,v.value=e.nodeCount,r.value=!0},courseId:p,courseName:f,nodeCount:v,isProject:y,onVisibleChange:function(e){w.value=e},visible:w}}}),$e=Ne,Re=(0,T.Z)($e,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"header-buttons-container",class:{green:e.visible}},[n("Dropdown",{attrs:{placement:"bottom-end",trigger:"click"},on:{"on-click":e.handleImport,"on-visible-change":e.onVisibleChange},scopedSlots:e._u([{key:"list",fn:function(){return[n("DropdownMenu",[e.showXmindImportBtn?n("DropdownItem",{attrs:{name:"docx"}},[e._v("\n          "+e._s(e.$t("knowledgeGraph.batchImport.docx"))+"\n        ")]):e._e(),e._v(" "),e.showXmindImportBtn?n("DropdownItem",{attrs:{name:"xmind"}},[e._v("\n          "+e._s(e.$t("knowledgeGraph.batchImport.xmind"))+"\n        ")]):e._e(),e._v(" "),e.showExcelImportBtn?n("DropdownItem",{attrs:{name:"xlsx"}},[e._v("\n          "+e._s(e.$t("knowledgeGraph.batchImport.xlsx"))+"\n        ")]):e._e(),e._v(" "),e.showCourseImportBtn?n("DropdownItem",{attrs:{name:"course"}},[e._v("\n          "+e._s(e.isProject?e.$t("knowledgeGraph.batchImport.project"):e.$t("knowledgeGraph.batchImport.course"))+"\n        ")]):e._e()],1)]},proxy:!0}])},[n("span",{staticClass:"batch-import-button",class:{open:e.visible}},[e._v("\n      "+e._s(e.$t("knowledgeGraph.batchImport.title"))+"\n      "),n("Icon",{attrs:{custom:"font font-standard-arrow-down"}})],1)]),e._v(" "),n("FileSelectModal",{attrs:{format:e.fileFormat},on:{success:e.onSuccess,error:e.onError},model:{value:e.showImportFromFileModal,callback:function(t){e.showImportFromFileModal=t},expression:"showImportFromFileModal"}}),e._v(" "),n("CourseSelectModal",{attrs:{"show-modal":e.showImportFromCourseModal,"is-project":e.isProject},on:{close:e.closeCourseSelectModal,confirm:e.confirmCourseSelect,success:e.onSuccess,error:e.onError}}),e._v(" "),n("ImportResult",{attrs:{format:e.fileFormat,result:e.result,"is-project":e.isProject,count:e.count,"update-count":e.updateCount,"update-refer-resource-count":e.updateReferResourceCount},model:{value:e.showImportResult,callback:function(t){e.showImportResult=t},expression:"showImportResult"}}),e._v(" "),n("ImportIssuesModal",{attrs:{format:e.fileFormat,result:e.result,count:e.count,"correct-count":e.correctCount,issues:e.issues},on:{retry:e.reImport},model:{value:e.showImportIssuesModal,callback:function(t){e.showImportIssuesModal=t},expression:"showImportIssuesModal"}}),e._v(" "),n("ImportConfirmModal",{attrs:{"is-project":e.isProject,"course-id":e.courseId,"course-name":e.courseName,"node-count":e.nodeCount},on:{success:e.onSuccess,error:e.onError},model:{value:e.showImportConfirmModal,callback:function(t){e.showImportConfirmModal=t},expression:"showImportConfirmModal"}})],1)}),[],!1,null,"82ed0bb8",null),je=Re.exports,Pe=n(643406),Me=(0,m.aZ)({setup:function(){var e=(0,m.iH)(!1),t=(0,m.iH)(null);return Pe.Y.$on("graphClick",(function(){e.value=!1})),{hide:function(){e.value=!1},show:e,keyword:y.$E,input:t,showInput:function(){e.value=!0,setTimeout((function(){t.value.focus()}),0)}}}}),Oe=(0,T.Z)(Me,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("button",{on:{click:e.showInput}},[n("i",{staticClass:"font font-nav-search flex items-center"})]),e._v(" "),e.show?n("div",{staticClass:"input-box flex"},[n("i",{staticClass:"font font-nav-search flex items-center"}),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.keyword,expression:"keyword"}],ref:"input",attrs:{type:"text"},domProps:{value:e.keyword},on:{input:function(t){t.target.composing||(e.keyword=t.target.value)}}}),e._v(" "),e.keyword?n("i",{staticClass:"font font-circle-wrong flex",on:{click:function(t){e.keyword=""}}}):e._e(),e._v(" "),n("button",{on:{click:e.hide}},[e._v(e._s(e.$t("close")))])]):e._e()])}),[],!1,null,"2a6158d8",null).exports,Ge=n(947475),Ae=(n(319601),n(132023),(0,m.aZ)({props:{course:{type:G.JD,required:!0},lastSelected:{type:Boolean,required:!0},versions:{type:Array,required:!0},selectedVersionId:{type:Number,required:!0},forestVersionStatsMap:{type:Object,required:!0}},components:{},setup:function(e,t){var n=t.emit;return{selectedVersionName:(0,m.Fl)((function(){var t;return null===(t=e.versions.find((function(t){return t.id===e.selectedVersionId})))||void 0===t?void 0:t.name})),handleSelectCourseVersion:function(t){n("on-version-select",{courseId:e.course.id,versionId:t})},selectedVersionStat:(0,m.Fl)((function(){return e.selectedVersionId&&e.forestVersionStatsMap[e.selectedVersionId]?e.forestVersionStatsMap[e.selectedVersionId]:{topicCount:0,dependencyCount:0,facetCount:0,fragmentCount:0}}))}}})),Ze=(0,T.Z)(Ae,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"item"},[n("div",{staticClass:"title"},[e._v("\n    "+e._s(e.course.name)+"\n    "),e.lastSelected?n("div",{staticClass:"last-select"},[e._v("\n      "+e._s(e.$t("knowledgeGraph.lastSelect"))+"\n    ")]):e._e()]),e._v(" "),n("div",{staticClass:"desc"},[n("Dropdown",{on:{"on-click":e.handleSelectCourseVersion}},[n("div",{},[e._v("\n        "+e._s(e.$t("knowledgeGraph.version"))+": "+e._s(e.selectedVersionName)+"\n        "),n("i",{staticClass:"font font-arrow-down"})]),e._v(" "),n("DropdownMenu",{attrs:{slot:"list"},slot:"list"},e._l(e.versions,(function(t){return n("DropdownItem",{key:t.id,attrs:{name:t.id,selected:e.selectedVersionId===t.id}},[e._v("\n          "+e._s(t.name)+"\n        ")])})),1)],1),e._v(" "),n("Divider",{attrs:{type:"vertical"}}),e._v(" "),n("div",[e._v(e._s(e.$t("teachingTeam.leader"))+"：")]),e._v(" "),e.course.principalsText?n("div",{staticClass:"leader-name"},[n("Tooltip",{attrs:{content:e.course.principalsText,placement:"top"}},[e._v("\n        "+e._s(e.course.principalsText)+"\n      ")])],1):n("div",{staticClass:"leader-name"},[e._v("--")]),e._v(" "),n("Divider",{attrs:{type:"vertical"}}),e._v(" "),n("div",[e._v(e._s(e.$t("knowledgeGraph.topic"))+"："+e._s(e.selectedVersionStat.topicCount))]),e._v(" "),n("Divider",{attrs:{type:"vertical"}}),e._v(" "),n("div",[e._v(e._s(e.$t("knowledgeGraph.dependency"))+"："+e._s(e.selectedVersionStat.dependencyCount))]),e._v(" "),n("Divider",{attrs:{type:"vertical"}}),e._v(" "),n("div",[e._v(e._s(e.$t("knowledgeGraph.facet"))+"："+e._s(e.selectedVersionStat.facetCount))]),e._v(" "),n("Divider",{attrs:{type:"vertical"}}),e._v(" "),n("div",[e._v(e._s(e.$t("knowledgeGraph.fragment"))+"："+e._s(e.selectedVersionStat.fragmentCount))])],1)])}),[],!1,null,"cc048d86",null).exports,He=function(){return(He=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Fe=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},Be=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},ze=(0,m.aZ)({props:{subjectListTitle:{type:String,required:!0},courseListTitle:{type:String,required:!0},courseSearchPlaceholder:{type:String,required:!0},lastSelect:{type:Array,default:function(){return[]}},value:{type:Object,required:!0},subjects:{type:Array,required:!0}},components:{NoData:ae.Z,KfsCourseVersionComponent:Ze},setup:function(e,t){var n=this,o=t.emit,r=(0,m.iH)(0),i=(0,m.iH)(""),a=(0,m.FN)(),s=(0,m.iH)({}),l=(0,m.iH)({}),c=(0,m.iH)({}),u=(0,m.Fl)((function(){var t;return((null===(t=e.subjects[r.value])||void 0===t?void 0:t.courses)||[]).filter((function(e){return e.name.includes(i.value)}))})),d=(0,ie.NCN)(e,"value",o,{eventName:"input"}),p=(0,m.Fl)((function(){return e.value.kfsCourseId?[e.value.kfsCourseId]:[]})),f=0,v=function(e){e.forEach((function(e){l.value[e]=s.value[e][0].id})),a.proxy.$forceUpdate()};return(0,m.YP)((function(){return e.subjects}),(function(){var t=e.subjects.findIndex((function(t){return t.courses.find((function(t){return e.lastSelect.includes(t.id)}))}));-1!==t&&(r.value=t)})),(0,m.YP)((function(){return u.value.map((function(e){return e.id}))}),(function(e){return Fe(n,void 0,void 0,(function(){var t,n,o,r;return Be(this,(function(i){switch(i.label){case 0:return 0===e.length?[2]:0===(t=ve._.difference(e,Object.keys(s.value))).length?(v(e),[2]):[4,(0,H.lw)(t)];case 1:return n=i.sent(),o=ve._.groupBy(n,(function(e){return e.courseId})),s.value=He(He({},s.value),o),r=n.map((function(e){return e.id})),[4,(0,H.B4)(r)];case 2:return i.sent().forEach((function(e){c.value[e.id]={topicCount:e.topicCount,dependencyCount:e.dependencyCount,facetCount:e.facetCount,fragmentCount:e.fragmentCount}})),v(e),[2]}}))}))}),{immediate:!0,deep:!0}),{subjectIndex:r,currentCourses:u,keyword:i,selectedCourseIds:p,change:function(e){e.length>=1&&(f=e[e.length-1]),d.value.kfsCourseId=f,d.value.kfsVersionId=l.value[f]},courseSelectedVersionMap:l,courseVersionsMap:s,forestVersionStatsMap:c,handleVersionSelect:function(e){return Fe(n,void 0,void 0,(function(){var t,n;return Be(this,(function(o){return t=e.courseId,n=e.versionId,l.value[t]=n,a.proxy.$forceUpdate(),[2]}))}))}}}}),Le=(0,T.Z)(ze,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[n("div",{staticClass:"left"},[n("div",{staticClass:"list-title"},[e._v(e._s(e.subjectListTitle))]),e._v(" "),n("RadioGroup",{attrs:{vertical:""},model:{value:e.subjectIndex,callback:function(t){e.subjectIndex=t},expression:"subjectIndex"}},e._l(e.subjects,(function(t,o){return n("Radio",{key:t.id,attrs:{label:o}},[n("div",{staticClass:"subject"},[n("div",{staticClass:"subject-name"},[n("Tooltip",{attrs:{content:t.id?t.name:e.$t("knowledgeGraph.noSpecifiedSubject"),placement:"top-start",transfer:""}},[e._v("\n              "+e._s(t.id?t.name:e.$t("knowledgeGraph.noSpecifiedSubject"))+"\n            ")])],1),e._v("\n          ("+e._s(t.courses.length)+")\n        ")])])})),1)],1),e._v(" "),n("div",{staticClass:"right"},[n("div",{staticClass:"right-header"},[n("span",{staticClass:"course-list-title"},[e._v(e._s(e.courseListTitle))]),e._v(" "),n("Input",{staticStyle:{width:"auto"},attrs:{placeholder:e.courseSearchPlaceholder},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}},[n("Icon",{attrs:{slot:"suffix",type:"ios-search"},slot:"suffix"})],1)],1),e._v(" "),n("CheckboxGroup",{staticClass:"course-list",attrs:{value:e.selectedCourseIds},on:{"on-change":e.change}},e._l(e.currentCourses,(function(t){return n("Checkbox",{key:t.id,attrs:{label:t.id}},[n("KfsCourseVersionComponent",{attrs:{course:t,"last-selected":e.lastSelect.includes(t.id),versions:e.courseVersionsMap[t.id]||[],"selected-version-id":e.courseSelectedVersionMap[t.id]||0,"forest-version-stats-map":e.forestVersionStatsMap},on:{"on-version-select":e.handleVersionSelect}})],1)})),1),e._v(" "),0===e.currentCourses.length?n("NoData",[e._v(e._s(e.$t("noData")))]):e._e()],1)])}),[],!1,null,"0eab373a",null).exports,Ue=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},Ve=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},qe=(0,m.aZ)({components:{NoData:ae.Z,KfsSubject:Le},setup:function(){var e=this,t=(0,m.iH)(!1),n=(0,m.iH)(!1),o=(0,m.iH)(!1),r=(0,ie.PL)((function(){return(0,H._Y)(y.N7.value.id)}),new G.yP).state,i=(0,ie.PL)(H.yF,[],{shallow:!0,immediate:!1}),a=i.state,s=i.execute;(0,Ge.f8)(t,(function(){return s()}));var l=(0,m.Fl)((function(){return a.value.filter((function(e){return"project"===e.dataType}))})),c=(0,m.Fl)((function(){return a.value.filter((function(e){return"subject"===e.dataType&&e.courses.length>0}))})),u=(0,m.iH)({project:{kfsCourseId:0,kfsVersionId:0},subject:{kfsCourseId:0,kfsVersionId:0}}),d=(0,m.iH)("subject"),p=(0,m.Fl)((function(){return u.value[d.value]||{kfsCourseId:0,kfsVersionId:0}})),f=(0,m.Fl)((function(){return p.value.kfsCourseId&&p.value.kfsVersionId}));return{info:r,loading:n,importData:function(){return Ue(e,void 0,void 0,(function(){return Ve(this,(function(e){return f.value?(n.value=!0,(0,H.J1)(y.N7.value.id,p.value.kfsCourseId,p.value.kfsVersionId).then((function(){t.value=!1,n.value=!1,Z.Z.success(h.default.t("knowledgeGraph.importSucess")),setTimeout((function(){window.location.reload()}),1e3)})),[2]):[2]}))}))},currentTab:d,selectedCourseMap:u,projects:l,subjects:c,state:a,show:t,currentCourseVersion:p,canImportData:f,showInnerTooltip:o}}}),Ye=(0,T.Z)(qe,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[n("Tooltip",{attrs:{content:e.$t("knowledgeGraph.lastImportTime")+"："+e.info.importTime,transfer:"","transfer-class-name":"knowledge-graph-outline-tooltip",placement:"bottom",disabled:e.showInnerTooltip||!e.info.importTime}},[n("Button",{staticClass:"btn",on:{click:function(t){e.show=!0}}},[n("div",{staticClass:"btn-content"},[n("span",{staticClass:"text"},[e._v(e._s(e.$t("knowledgeGraph.importData")))]),e._v(" "),n("Tooltip",{attrs:{content:e.$t("knowledgeGraph.kfsImportTip"),placement:"bottom",transfer:"","transfer-class-name":"knowledge-graph-outline-tooltip"},on:{"on-popper-show":function(t){e.showInnerTooltip=!0},"on-popper-hide":function(t){e.showInnerTooltip=!1}}},[n("i",{staticClass:"font font-question"})])],1)])],1),e._v(" "),n("Modal",{attrs:{width:"900",title:e.$t("knowledgeGraph.importData")},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[n("Tabs",{staticClass:"tab",model:{value:e.currentTab,callback:function(t){e.currentTab=t},expression:"currentTab"}},[n("a",{attrs:{slot:"extra",href:e.info.server,target:"_blank"},slot:"extra"},[n("Button",{staticClass:"extra-btn"},[e._v(e._s(e.$t("knowledgeGraph.gotoKfs")))])],1),e._v(" "),n("TabPane",{attrs:{label:e.$t("knowledgeGraph.subjectCourse"),name:"subject"}},[n("div",{staticClass:"info"},[n("i",{staticClass:"font font-info"}),e._v("\n          "+e._s(e.$t("knowledgeGraph.kfsImportWarning"))+"\n        ")]),e._v(" "),n("KfsSubject",{attrs:{subjects:e.subjects,"subject-list-title":e.$t("knowledgeGraph.subjectList"),"course-list-title":e.$t("knowledgeGraph.courseList"),"course-search-placeholder":e.$t("knowledgeGraph.courseName"),"last-select":e.info.importCourseIds},model:{value:e.selectedCourseMap.subject,callback:function(t){e.$set(e.selectedCourseMap,"subject",t)},expression:"selectedCourseMap.subject"}})],1),e._v(" "),n("TabPane",{attrs:{label:e.$t("knowledgeGraph.project-kfs"),name:"project"}},[n("div",{staticClass:"info"},[n("i",{staticClass:"font font-info"}),e._v("\n          "+e._s(e.$t("knowledgeGraph.kfsImportWarning"))+"\n        ")]),e._v(" "),n("KfsSubject",{attrs:{subjects:e.projects,"subject-list-title":e.$t("knowledgeGraph.projectList"),"course-list-title":e.$t("knowledgeGraph.kfsList"),"course-search-placeholder":e.$t("knowledgeGraph.kfsName"),"last-select":e.info.importCourseIds},model:{value:e.selectedCourseMap.project,callback:function(t){e.$set(e.selectedCourseMap,"project",t)},expression:"selectedCourseMap.project"}})],1)],1),e._v(" "),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{attrs:{type:"primary",loading:e.loading,disabled:!e.canImportData},on:{click:e.importData}},[e._v("\n        "+e._s(e.$t("importSubject.import"))+"\n      ")]),e._v(" "),n("Button",{on:{click:function(t){e.show=!1}}},[e._v("\n        "+e._s(e.$t("cancel"))+"\n      ")])],1)],1)],1)}),[],!1,null,"48b55da9",null).exports,Ke=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},We=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},Je=(0,m.aZ)({components:{TooltipExt:Se.Z},props:{value:{type:Boolean,required:!0},loading:{type:Boolean,default:!1},diff:{type:Array,default:function(){return[]}}},setup:function(e,t){var n=this,o=t.emit,r=(0,ie.NCN)(e,"value",o,{eventName:"input"}),i=(0,m.iH)(!1),a=(0,m.f3)("course",{id:0,graphUpdated:!1,newGraphId:0}),s=(0,m.Fl)((function(){return i.value?h.default.t("knowledgeGraph.diff.updating"):h.default.t("knowledgeGraph.diff.updateDetail")})),l=[{title:h.default.t("knowledgeGraph.diff.columns.action"),key:"action",width:100,slot:"action"},{title:h.default.t("knowledgeGraph.diff.node:name"),key:"nodeName",width:200},{title:h.default.t("knowledgeGraph.diff.columns.type"),key:"type",slot:"type",width:120},{title:h.default.t("knowledgeGraph.diff.columns.before"),key:"before",slot:"before",width:306},{title:h.default.t("knowledgeGraph.diff.columns.after"),key:"after",slot:"after"}],c=(0,m.Fl)((function(){return document.body.offsetHeight-320}));return{show:r,columns:l,handleSpan:function(t){var n=t.row,o=(t.column,t.rowIndex);if(0===t.columnIndex){var r=n.action,i=e.diff.findIndex((function(e){return e.action===r})),a=e.diff.filter((function(e){return e.action===r})).length;return o===i?{rowspan:a,colspan:1}:{rowspan:0,colspan:0}}return{rowspan:1,colspan:1}},maxHeight:c,onConfirm:function(){return Ke(n,void 0,void 0,(function(){var t,n;return We(this,(function(o){switch(o.label){case 0:t={add_nodes:e.diff.filter((function(e){return"add"===e.action})).map((function(e){return e.data})),delete_nodes:e.diff.filter((function(e){return"delete"===e.action})).map((function(e){return e.data})),update_nodes:e.diff.filter((function(e){return"update"===e.action&&["node:name","node:label"].includes(e.type)})).map((function(e){return e.data}))},i.value=!0,n=!1,o.label=1;case 1:return o.trys.push([1,3,,8]),[4,(0,H.Bc)(a.id,t)];case 2:return o.sent(),n=!0,[3,8];case 3:o.sent(),o.label=4;case 4:return o.trys.push([4,6,,7]),[4,(0,H.Bc)(a.id,t)];case 5:return o.sent(),n=!0,[3,7];case 6:return o.sent(),ve.Toast.error(h.default.t("systemError")),[3,7];case 7:return[3,8];case 8:return i.value=!1,n&&(r.value=!1,window.location.reload()),[2]}}))}))},updating:i,title:s}}}),Xe=(0,T.Z)(Je,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Modal",{staticClass:"graph-diff-modal",attrs:{width:"1080",title:e.title,"mask-closable":!1,closable:!e.updating,"class-name":"vertical-center-modal"},scopedSlots:e._u([{key:"footer",fn:function(){return[e.updating?e._e():n("Button",{staticClass:"cancel-btn",on:{click:function(t){e.show=!1}}},[e._v(e._s(e.$t("cancel")))]),e._v(" "),e.updating?e._e():n("Button",{attrs:{type:"primary",disabled:e.loading||!e.diff.length},on:{click:e.onConfirm}},[e._v("\n      "+e._s(e.$t("knowledgeGraph.diff.confirm"))+"\n    ")]),e._v(" "),e.updating?n("Button",{attrs:{type:"primary",loading:e.updating}},[e._v(e._s(e.$t("knowledgeGraph.diff.updating")))]):e._e()]},proxy:!0}]),model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[e.loading?n("div",{staticClass:"spin"},[n("div",{staticClass:"loading-gif"}),e._v(" "),n("span",{staticClass:"loading-tip"},[e._v(e._s(e.$t("knowledgeGraph.diff.loadingTip")))])]):e._e(),e._v(" "),e.loading?e._e():n("div",{staticClass:"content"},[e.updating?e._e():n("div",{staticClass:"warning-tip"},[n("i",{staticClass:"font font-info"}),e._v(" "),n("span",[e._v(e._s(e.$t("knowledgeGraph.diff.updateTip")))])]),e._v(" "),n("div",{staticClass:"table-wrap"},[n("Table",{attrs:{columns:e.columns,data:e.diff,border:"","span-method":e.handleSpan,"max-height":e.maxHeight},scopedSlots:e._u([{key:"action",fn:function(t){var o=t.row;return[n("span",{staticClass:"action",class:o.action},[e._v(e._s(e.$t("knowledgeGraph.diff."+o.action)))])]}},{key:"type",fn:function(t){var o=t.row;return[n("span",[e._v(e._s(e.$t("knowledgeGraph.diff."+o.type)))])]}},{key:"before",fn:function(t){var o=t.row;return["node:label"===o.type?n("div",[o.before.length?n("div",{staticClass:"resource-items-wrap"},e._l(o.before,(function(e,t){return n("div",{key:t,staticClass:"label-item"},[n("TooltipExt",{attrs:{text:e.key}})],1)})),0):n("div",[e._v("/")])]):"node:resource"===o.type?n("div",[o.before.length?n("div",{staticClass:"resource-items-wrap"},e._l(o.before,(function(t,o){return n("div",{key:o,staticClass:"resource-item"},[n("SvgIcon",{staticClass:"file-icon",attrs:{name:"icon-"+t.type}}),e._v(" "),n("TooltipExt",{attrs:{text:t.title}})],1)})),0):n("div",[e._v("/")])]):"node:edge"===o.type?n("div",[o.before.length?n("div",{staticClass:"resource-items-wrap"},e._l(o.before,(function(e,t){return n("div",{key:t,staticClass:"item"},[n("TooltipExt",{attrs:{text:e}})],1)})),0):n("div",[e._v("/")])]):n("div",[o.before?n("span",[e._v(e._s(o.before))]):n("span",[e._v("/")])])]}},{key:"after",fn:function(t){var o=t.row;return["node:label"===o.type?n("div",[o.after.length?n("div",{staticClass:"resource-items-wrap"},e._l(o.after,(function(e,t){return n("div",{key:t,staticClass:"label-item"},[n("TooltipExt",{attrs:{text:e.key}})],1)})),0):n("div",[e._v("/")])]):"node:resource"===o.type?n("div",[o.after.length?n("div",{staticClass:"resource-items-wrap"},e._l(o.after,(function(t,o){return n("div",{key:o,staticClass:"resource-item"},[n("SvgIcon",{staticClass:"file-icon",attrs:{name:"icon-"+t.type}}),e._v(" "),n("TooltipExt",{attrs:{text:t.title}})],1)})),0):n("div",[e._v("/")])]):"node:edge"===o.type?n("div",[o.after.length?n("div",{staticClass:"resource-items-wrap"},e._l(o.after,(function(e,t){return n("div",{key:t,staticClass:"item"},[n("TooltipExt",{attrs:{text:e}})],1)})),0):n("div",[e._v("/")])]):n("div",[o.after?n("span",[e._v(e._s(o.after))]):n("span",[e._v("/")])])]}}],null,!1,1345923950)})],1)])])}),[],!1,null,"30aba831",null).exports,Qe=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},et=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},tt=(0,m.aZ)({components:{EditGraphSourceDropdown:V,MainHeader:I,LearningPath:q.Z,Search:Oe,BatchImportDropdown:je,DataImport:Ye,KnowledgeGraphDiffModal:Xe},setup:function(){var e=this,t=(0,m.f3)("course",{id:0,graphUpdated:!1,newGraphId:0}),n=(0,m.iH)(!1),o=(0,m.Fl)((function(){return y.Vl.value===G.QO.PUBLISHED})),r=(0,m.f3)("enableExternalGraph",!1),i=(0,m.f3)("knowledgeGraphSource","self"),a=(0,m.iH)(!1),s=(0,m.iH)(!1),l=(0,m.iH)(!1),c=(0,m.iH)([]),u=(0,m.Fl)((function(){return!y.wZ&&!o.value})),d=(0,m.Fl)((function(){return t&&t.newGraphId})),p=(0,m.Fl)((function(){return d.value>0})),f=(0,m.Fl)((function(){return!y.yw&&!y.Uz.value&&y.wZ})),v=(0,m.Fl)((function(){return"self"!==i})),g=(0,m.Fl)((function(){return t&&t.graphUpdated&&f.value&&v.value})),w=function(e,t,n){return e("div",{style:{background:"#fff5e5",color:"#262833",padding:"8px 32px",marginLeft:"-32px",marginRight:"-32px",marginBottom:"24px",display:"flex",alignItems:"stretch",fontSize:"14px",lineHeight:"22px"}},[e("i",{class:"ivu-icon ".concat(t),style:{fontSize:"16px",color:"#ff9700",marginRight:"8px",marginTop:"2px"}}),e("span",n)])},b=(0,m.Fl)((function(){return y.wZ&&(window.featureToggles.knowledgeGraphBatchImportXmind||window.featureToggles.knowledgeGraphBatchImportCourse)})),_=(0,m.Fl)((function(){var e;return!y.yw&&!y.Uz.value&&(y.wZ&&y.nQ.value&&!(null===(e=window.orgSettings)||void 0===e?void 0:e.enableChinamCloudGraph))}));return{isExternalGraph:v,knowledgeGraphSource:i,showLearningPath:n,learningPathDisabled:u,haveUpdatePermission:f,enableExternalGraph:r,isUpdating:a,showUpdateBtn:g,updateGraph:function(){return Qe(e,void 0,void 0,(function(){var e,n,o,r,i;return et(this,(function(u){switch(u.label){case 0:if(p.value)return[3,9];if(s.value=!0,c.value.length)return[2];l.value=!0,e=!1,u.label=1;case 1:return u.trys.push([1,3,,8]),n=c,[4,(0,H.Hz)(t.id)];case 2:return n.value=u.sent(),e=!0,[3,8];case 3:u.sent(),u.label=4;case 4:return u.trys.push([4,6,,7]),o=c,[4,(0,H.Hz)(t.id)];case 5:return o.value=u.sent(),e=!0,[3,7];case 6:return u.sent(),Z.Z.error(h.default.t("systemError")),[3,7];case 7:return[3,8];case 8:return l.value=!1,e||(s.value=!1),[2];case 9:return a.value?[2]:(r=function(e){return e("div",[w(e,"ivu-icon-ios-alert",h.default.t("knowledgeGraph.replaceTips")),e("span",{domProps:{innerHTML:h.default.t("knowledgeGraph.replaceContentTips")}})])},[4,A.Z.open({title:h.default.t("knowledgeGraph.replaceTitle"),type:"warning",divider:!1,width:660,content:h.default.t("knowledgeGraph.updateTip"),verticalCenter:!0,hideIcon:!0,render:r})]);case 10:if(!u.sent())return[2];a.value=!0,u.label=11;case 11:return u.trys.push([11,13,14,15]),[4,(0,H.Yh)(t.id)];case 12:return u.sent(),Z.Z.success(h.default.t("air.updateSuccess")),window.location.reload(),[3,15];case 13:return i=u.sent(),console.error(i),Z.Z.error(h.default.t("air.updateFail")),[3,15];case 14:return a.value=!1,[7];case 15:return[2]}}))}))},showBatchImportDropdown:b,canImportData:_,publishOrCancelPublish:function(){return Qe(e,void 0,void 0,(function(){var e,n;return et(this,(function(r){switch(r.label){case 0:return e=o.value?h.default.t("knowledgeGraph.cancelPublishTip"):h.default.t("knowledgeGraph.publishTip"),[4,A.Z.open({title:h.default.t("tips"),type:"warning",divider:!1,width:416,content:e})];case 1:return r.sent()?(n=o.value?G.QO.UNPUBLISHED:G.QO.PUBLISHED,[4,(0,H.wy)(t.id,n).then((function(){y.Vl.value=n;var e=o.value?h.default.t("knowledgeGraph.publishSuccess"):h.default.t("knowledgeGraph.cancelPublishSuccess");Z.Z.success(e)})).catch((function(e){var t;(null===(t=e.response)||void 0===t?void 0:t.data.message)&&Z.Z.error(e.response.data.message)}))]):[2];case 2:return r.sent(),[2]}}))}))},goToEdit:function(){return Qe(e,void 0,void 0,(function(){var e;return et(this,(function(n){switch(n.label){case 0:return[4,(0,H.Cj)(t.id)];case 1:return e=n.sent(),window.open(e,"_blank"),[2]}}))}))},isPublished:o,showDiffModal:s,loadingDiff:l,graphDiff:c}}}),nt=(0,T.Z)(tt,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("MainHeader",{scopedSlots:e._u([{key:"btn-group",fn:function(){return[n("div",{staticClass:"flex gap-16"},[n("Button",{staticClass:"edit-btn",attrs:{disabled:e.learningPathDisabled},on:{click:function(t){e.showLearningPath=!0}}},[n("SvgIcon",{staticClass:"mr-5",attrs:{name:"learn-path"}}),e._v("\n        "+e._s(e.$t("knowledgeGraph.learningPath"))+"\n      ")],1),e._v(" "),n("Search",{staticClass:"hidden search"}),e._v(" "),e.enableExternalGraph&&e.haveUpdatePermission?n("EditGraphSourceDropdown"):e._e(),e._v(" "),e.haveUpdatePermission&&e.enableExternalGraph&&e.isExternalGraph?n("Button",{on:{click:e.goToEdit}},[n("i",{staticClass:"font font-batch-operation-share mr-5"}),e._v("\n        "+e._s(e.$t("edit"))+"\n      ")]):e._e(),e._v(" "),e.showUpdateBtn?n("Button",{attrs:{loading:e.isUpdating},on:{click:e.updateGraph}},[e.isUpdating?e._e():n("SvgIcon",{staticClass:"mr-5",attrs:{name:"refresh"}}),e._v(" "),e.isUpdating?n("span",[e._v("\n          "+e._s(e.$t("completeness.updating"))+"\n        ")]):n("span",[e._v("\n          "+e._s(e.$t("knowledgeGraph.update"))+"\n        ")])],1):e._e(),e._v(" "),e.showBatchImportDropdown&&!e.isExternalGraph?n("BatchImportDropdown",{staticClass:"import-btn"}):e._e(),e._v(" "),e.canImportData?n("div",[n("DataImport",{staticClass:"import-btn"})],1):e._e(),e._v(" "),e.haveUpdatePermission?n("span",[e.isPublished?n("Button",{staticClass:"publish-btn",on:{click:e.publishOrCancelPublish}},[n("SvgIcon",{attrs:{name:"unpublish"}}),e._v("\n          "+e._s(e.$t("knowledgeGraph.cancelPublish"))+"\n        ")],1):n("Button",{staticClass:"publish-btn",attrs:{type:"primary"},on:{click:e.publishOrCancelPublish}},[n("SvgIcon",{attrs:{name:"publish"}}),e._v("\n          "+e._s(e.$t("knowledgeGraph.publish"))+"\n        ")],1)],1):e._e()],1)]},proxy:!0}])},[e._v(" "),n("LearningPath",{model:{value:e.showLearningPath,callback:function(t){e.showLearningPath=t},expression:"showLearningPath"}}),e._v(" "),n("KnowledgeGraphDiffModal",{attrs:{diff:e.graphDiff,loading:e.loadingDiff},model:{value:e.showDiffModal,callback:function(t){e.showDiffModal=t},expression:"showDiffModal"}})],1)}),[],!1,null,"1230d85e",null).exports,ot=(n(651532),n(115306),n(163223)),rt={outline:"/outline",mindmap:"/mind-map",graph:"/graph",forest:"/forest"},it=(0,m.aZ)({components:{ViewSelect:ot.Z},setup:function(){var e=function(e){var t=new Map;return e?(t.set("outline",h.default.t("knowledgeGraph.outlineView")),t.set("graph",h.default.t("knowledgeGraph.title")),t.set("forest",h.default.t("knowledgeForest"))):(t.set("outline",h.default.t("knowledgeGraph.outlineView")),t.set("mindmap",h.default.t("knowledgeGraph.mindMap")),t.set("graph",h.default.t("knowledgeGraph.title"))),t}((0,m.f3)("allowFacetsAndFragments",!1)),t=(0,k.tv)(),n=t.route,o=t.router;return{viewsMap:e,view:(0,m.Fl)({get:function(){return n.value.path.replace(/[/-]/g,"")},set:function(e){var t=rt[e];null==o||o.push(t)}})}}}),at=(0,T.Z)(it,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ViewSelect",{attrs:{"view-map":e.viewsMap},model:{value:e.view,callback:function(t){e.view=t},expression:"view"}},["graph"===e.view?n("Tooltip",{attrs:{content:e.$t("darkMode"),placement:"bottom"}},[n("a",{staticClass:"btn",staticStyle:{color:"#333"},attrs:{href:"#/graph?mode=dark",target:"_blank"}},[n("i",{staticClass:"font font-dark-mode"})])]):e._e()],1)}),[],!1,null,null,null).exports,st=(0,m.aZ)({router:g.N,components:{RelationIndex:w.default,ProblemHeader:O,knowledgeGraphHeader:nt,KnowledgeGraphViewSelector:at},props:["course","treeDepth","allowedRelationTypes","publishType","editDisabled","isSimulatingAsStudent","allowFacetsAndFragments","enableExternalGraph","problemPublishType","knowledgeGraphSource"],provide(){return{course:this.course,treeDepth:this.treeDepth,allowedRelationTypes:this.allowedRelationTypes,publishType:this.publishType,editDisabled:this.editDisabled,isSimulatingAsStudent:this.isSimulatingAsStudent,allowFacetsAndFragments:this.allowFacetsAndFragments,enableExternalGraph:this.enableExternalGraph,problemPublishType:this.problemPublishType,knowledgeGraphSource:this.knowledgeGraphSource}},computed:{view(){return this.$route.path},viewSelectorPosition(){return this.isSimulatingAsStudent&&["/forest","/graph"].includes(this.view)?{top:"136px"}:{}}},watch:{"$route.query.mode":function(){"dark"===this.$route.query.mode&&(y._T.value=!0,document.querySelector("html").classList.add("dark"))}},created(){y.N7.value=this.course,y.Vl.value=this.publishType,y.nQ.value=this.editDisabled,y.Uz.value=this.isSimulatingAsStudent},setup:()=>({isDark:y._T})}),lt=(0,T.Z)(st,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"knowledge-wrapper"},["/problem"===e.view?n("ProblemHeader"):e._e(),e._v(" "),"/problem"!==e.view?n("knowledgeGraphHeader"):e._e(),e._v(" "),["/graph","/forest","/mind-map","/outline"].includes(e.view)&&!e.isDark?n("KnowledgeGraphViewSelector",{staticClass:"knowledge-node-graph-view-selector",style:e.viewSelectorPosition}):e._e(),e._v(" "),n("router-view",{staticClass:"view"})],1)}),[],!1,null,"749bc0af",null).exports,ct=n(992665),ut=n(534662),dt=(0,m.aZ)({name:"ActivityKnowledgeNodeReference",props:{courseId:{type:Number,default:0},activityId:{type:Number,default:0},knowledgeNodeReference:{type:Array,default:function(){return[]}}},components:{KnowledgeNodeTag:ut.Z},setup:function(e,t){var n=(0,m.iH)(0),o=(0,m.iH)(!1);return(0,m.YP)((function(){return e.knowledgeNodeReference}),(function(){var t;n.value=null===(t=e.knowledgeNodeReference)||void 0===t?void 0:t.length})),{show:o,nodeReferenceCount:n}}}),pt=(0,T.Z)(dt,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Poptip",{staticClass:"node-reference-poptip",attrs:{placement:"top",width:"280",trigger:"hover",delay:200}},[n("span",{staticClass:"title"},[e._v(e._s(e.$t("knowledgeGraph.node")))]),e._v(" "),n("span",{staticClass:"reference-count"},[e._v(e._s(e.nodeReferenceCount))]),e._v(" "),n("div",{staticClass:"node-reference-content",attrs:{slot:"content"},slot:"content"},[n("div",{staticClass:"reference-title"},[e._v(e._s(e.$t("knowledgeGraph.node")))]),e._v(" "),n("div",{staticClass:"reference-node-list"},e._l(e.knowledgeNodeReference,(function(t,o){return n("KnowledgeNodeTag",{key:"node-reference-"+o,attrs:{"course-id":e.courseId,"node-id":t.knowledge_node.id,content:t.knowledge_node.name,transfer:!1,"go-to-graph":!0,size:"medium"}})})),1)])])}),[],!1,null,"ee994a00",null).exports,ft=(n(804723),n(323123),n(311610)),vt=n(37423),ht=n(804992),mt=n(156209),gt=(n(140561),null!==(r=null===(o=window.globalData)||void 0===o?void 0:o.course)&&void 0!==r?r:{id:0}),yt=function(e,t){void 0===e&&(e=0),void 0===t&&(t=!1);var n=[{title:h.default.t("knowledgeGraph.nodeName"),key:"name",tree:!0,className:"node-name",tooltip:!0},{title:h.default.t("knowledgeGraph.statistics.related"),render:function(e,t){var n=t.row;return e("span",[e("span",{style:{color:"#4183DD",padding:"0 5px"}},n.resourceRefCount),"/",e("span",{style:{color:"#F28500",padding:"0 5px"}},n.activityRefCount)])},width:t?120:155},{title:h.default.t("knowledgeGraph.statistics.averageCompleteness"),key:"averageCompletenessRate",width:t?120:155},{title:h.default.t("knowledgeGraph.statistics.averageMastery"),key:"averageMasteryRate",width:t?120:155},{title:h.default.t("operation"),width:80,render:function(t,n){var o=n.row;return o.activityRefCount+o.resourceRefCount===0?t("span"):t(b.Tooltip,{props:{content:h.default.t("view"),placement:"top"},style:{display:"block",width:"min-content"}},[t("i",{class:"font font-resource-view",style:{cursor:"pointer"},on:{"!click":function(){window.location.href=e?"/course/".concat(gt.id,"/stat#/knowledge-graph/student/").concat(e,"/node/").concat(o.id):"/course/".concat(gt.id,"/stat#/knowledge-graph/node/").concat(o.id)}}})])}}];return t&&n.splice(2,0,{title:h.default.t("knowledgeGraph.cognitiveDimension.name"),key:"cognitiveDimensionTitle",width:130}),n},wt=n(496486),bt=n(486992),_t=function(e,t,n){var o=function e(t,n){t.length&&(0,wt.forEach)(t,(function(t){var o=(0,wt.filter)(t.children,(function(e){return n.includes(e.id)}));Object.assign(t,{children:o}),o.length&&e(o,n)}))},r=(0,m.iH)([]);return(0,m.m0)((function(){var i=(0,wt.cloneDeep)(e.value),a=[],s=[];(0,bt.T$)(i,(function(e,o,r,i){i&&(e.parent=i),t.value&&!e.name.includes(t.value)||0!==n.value.length&&e.cognitiveDimension&&!n.value.includes(e.cognitiveDimension)||(a.push(e),s.push(e.id))}));var l=[];(0,wt.forEach)(a,(function(e){for(var t=e;t&&t.parent;)t=t.parent,s.push(t.id);l.push(t.id),s.push(t.id)}));var c=(0,wt.filter)(i,(function(e){return l.includes(e.id)}));o(c,(0,wt.uniq)(s)),c.forEach((function(e){e._children=e.children,e.children.length>0&&(0,m.t8)(e,"_loading",!1),e.children=[]})),r.value=c})),{nodes:r,handleLoadData:function(e,t){setTimeout((function(){t(e._children)}))}}},Ct=(0,m.aZ)({props:{data:{type:Array,required:!0},keyword:{type:String,default:""},dimensions:{type:Array,default:function(){return[]}}},setup:function(e){var t,n=(null===(t=window.featureToggles)||void 0===t?void 0:t.isCognitiveDimensionOpen)||!1,o=(0,m.Fl)((function(){return yt(0,n)})),r=(0,m.BK)(e),i=_t(r.data,r.keyword,r.dimensions);return{columns:o,nodes:i.nodes,rowClassName:function(e,t){return e.parentId?"":"parent-node-row"},handleLoadData:i.handleLoadData}}}),kt=(0,T.Z)(Ct,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("Table",{attrs:{"row-key":"id","load-data":e.handleLoadData,columns:e.columns,data:e.nodes,"row-class-name":e.rowClassName,"update-show-children":!0}})}),[],!1,null,"a02b7e70",null).exports,xt=n(661510),St=n(986228),Tt=n(547454),Dt=null!==(a=null===(i=window.globalData)||void 0===i?void 0:i.course)&&void 0!==a?a:{id:0},It=(0,m.aZ)({components:{EllipsisText:St.Z,Pagination:xt.Z},props:{keyword:{type:String,default:""}},setup:function(e){var t=[{title:h.default.t("knowledgeGraph.statistics.userNo"),key:"userNo",slot:"userNo",width:"247px"},{title:h.default.t("name"),key:"name",slot:"name",width:"247px"},{title:h.default.t("knowledgeGraph.statistics.averageCompleteness"),key:"completenessRate",sortable:"custom",width:"160px"},{title:h.default.t("knowledgeGraph.statistics.averageMastery"),key:"masteryRate",sortable:"custom",width:"160px"},{title:h.default.t("operation"),render:function(e,t){var n=t.row;return e(b.Tooltip,{props:{content:h.default.t("view"),placement:"top"},style:{display:"block",width:"min-content"}},[e("i",{class:"font font-resource-view",style:{cursor:"pointer"},on:{"!click":function(){window.location.href="/course/".concat(Dt.id,"/stat#/knowledge-graph/student/").concat(n.studentId)}}})])}}],n=Dt.id,o=(0,Tt._)(e,H.VR,n);return{columns:t,data:o.data,pagination:o.pagination,sortChange:o.sortChange,isShowOffCampusUserFlag:function(e){return!(!window.orgSettings.enableOffCampusUserFlag||"identity_registered"!==e)}}}}),Et=(0,T.Z)(It,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"nodes-student-dimension-stats"},[n("Table",{attrs:{stripe:"",columns:e.columns,data:e.pagination.data.items},on:{"on-sort-change":e.sortChange},scopedSlots:e._u([{key:"userNo",fn:function(e){var t=e.row;return[n("EllipsisText",{attrs:{line:1,text:t.userNo,"use-tipsy":!0}})]}},{key:"name",fn:function(t){var o=t.row;return[n("div",{staticClass:"name-cell"},[n("tooltip",{attrs:{content:o.name,placement:"top"}},[e._v(e._s(o.name))]),e._v(" "),e.isShowOffCampusUserFlag(o.importedFrom)?n("tooltip",{attrs:{content:e.$t("offCampusUser"),placement:"top"}},[n("svg-icon",{attrs:{name:"off-campus-user-flag"}})],1):e._e()],1)]}}])}),e._v(" "),e.pagination.data.pages>0?n("div",{staticClass:"pagination"},[n("Pagination",{attrs:{total:e.pagination.data.total,"page-size":e.pagination.data.pageSize,current:e.pagination.data.page,"show-sizer":"","show-elevator":""},on:{"on-change":e.pagination.pageChanged,"on-page-size-change":e.pagination.pageSizeChanged}})],1):e._e()],1)}),[],!1,null,null,null).exports,Nt=(0,m.aZ)({components:{SvgIcon:ft.Z},props:{icon:{type:String,required:!0},info:{type:[Object,Array],required:!0},itemWidth:{type:Number,default:100}},setup:function(e){return{data:(0,m.Fl)((function(){return Array.isArray(e.info)?e.info:[e.info]}))}}}),$t=(0,T.Z)(Nt,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"statistics-info-card"},[n("SvgIcon",{class:e.icon,attrs:{name:e.icon}}),e._v(" "),n("div",{staticClass:"info-card-item",style:"--width: "+e.itemWidth+"px"},e._l(e.data,(function(t){return n("div",{key:t.title},[n("div",{staticClass:"statistics-info-count"},[e._v(e._s(t.count))]),e._v(" "),n("div",{staticClass:"statistics-info-title"},[e._v(e._s(t.title))])])})),0)],1)}),[],!1,null,null,null).exports,Rt=(0,m.aZ)({components:{InfoCard:$t},props:{data:{type:Object,default:function(){}},width:{type:Number,default:200},innerWidth:{type:Number,default:100}},setup:function(e){var t=(0,m.Fl)((function(){var t=0;if((0,bt.T$)(e.data.nodes,(function(e,n,o,r){r&&t++})),t+=e.data.relationCount,!Number.isNaN(t))return t}));return{infos:(0,m.Fl)((function(){return[{icon:"knowledge-node-count",info:{title:h.default.t("knowledgeGraph.statistics.nodeCount"),count:e.data.nodeCount}},{icon:"knowledge-relation-count",info:{title:h.default.t("knowledgeGraph.nodeRelationship"),count:t.value}},{icon:"knowledge-ref-count",info:[{title:h.default.t("knowledgeGraph.referenceResource"),count:e.data.resourceRefCount},{title:h.default.t("knowledgeGraph.referenceSubject"),count:e.data.subjectRefCount},{title:h.default.t("knowledgeGraph.referenceActivity"),count:e.data.activityRefCount}]}]}))}}}),jt=(0,T.Z)(Rt,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"info-card-wrapper",style:"--width: "+e.width+"px"},e._l(e.infos,(function(t,o){return n("InfoCard",{key:o,class:"info-card-"+o,attrs:{icon:t.icon,info:t.info,"item-width":e.innerWidth}})})),1)}),[],!1,null,null,null).exports,Pt=n(959769),Mt=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},Ot=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},Gt=function(){var e,t=(null!==(e=window.location.hash.split("?").pop())&&void 0!==e?e:"").match(/(?:^|&)tab=([^&]*)(?=&|$)/);return t?decodeURIComponent(t[1]):void 0},At=(0,m.aZ)({components:{SvgIcon:ft.Z,NodeStatisticsCard:ht.Z,NodeDimension:kt,StudentDimension:Et,CognitiveDimensionSelect:vt.Z,Summary:jt},setup:function(){var e,t,n,o,r,i=this,a=(null===(e=window.featureToggles)||void 0===e?void 0:e.isCognitiveDimensionOpen)||!1,s=(0,m.iH)(null!==(t=Gt())&&void 0!==t?t:"node"),l=null!==(r=null===(o=null===(n=window.globalData)||void 0===n?void 0:n.course)||void 0===o?void 0:o.id)&&void 0!==r?r:0,c=(0,m.iH)(new G.ob),u=(0,m.iH)(""),d=(0,Pt.bG)(),p=d.tooltipCompletionRate,f=d.tooltipMasteryRate,v=d.isNormalMode,g=(0,m.iH)([]),y=["80~100","60~79","below60"],w=(0,m.Fl)((function(){return y.map((function(e){var t;return{value:null===(t=c.value.completenessRateDistribution)||void 0===t?void 0:t[e],name:h.default.t("knowledgeGraph.statistics.".concat(e))}}))})),b=(0,m.Fl)((function(){return y.map((function(e){var t;return{value:null===(t=c.value.masteryRateDistribution)||void 0===t?void 0:t[e],name:h.default.t("knowledgeGraph.statistics.".concat(e))}}))})),_=(0,m.Fl)((function(){return"node"===s.value?h.default.t("knowledgeGraph.nodeName"):"".concat(h.default.t("knowledgeGraph.statistics.userNo"),"/").concat(h.default.t("name"))})),C=(0,m.iH)("");return(0,m.bv)((function(){return Mt(i,void 0,void 0,(function(){var e;return Ot(this,(function(t){switch(t.label){case 0:return e=c,[4,(0,H.gs)(l)];case 1:return e.value=t.sent(),[2]}}))}))})),{MASTERY_LEGEND_COLORS:mt.$e,COMPLETENESS_LEGEND_COLORS:mt.wR,tab:s,data:c,completenessDistribution:w,masteryDistribution:b,keyword:u,inputValue:C,placeholder:_,dimensions:g,search:function(e){u.value=e},changeTab:function(e){s.value=e,Gt()&&(window.location.href=window.location.href.split("?").shift()),u.value="",C.value="",g.value=[]},isCognitiveDimensionOpen:a,cognitiveDimensionSelected:function(e){g.value=e},tooltipCompletionRate:p,tooltipMasteryRate:f,isNormalMode:v}}}),Zt=(0,T.Z)(At,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"statistics-wrapper"},[n("div",{staticClass:"overview"},[n("div",{staticClass:"title"},[e._v(e._s(e.$t("knowledgeGraph.statistics.overview")))]),e._v(" "),n("div",{staticClass:"overview-card-wrapper"},[n("Summary",{attrs:{data:e.data}})],1),e._v(" "),n("div",{staticClass:"overview-chart"},[n("NodeStatisticsCard",{attrs:{data:e.completenessDistribution,colors:e.COMPLETENESS_LEGEND_COLORS}},[n("span",[e._v(e._s(e.$t("knowledgeGraph.statistics.averageCompletenessRate")))]),e._v(" "),n("Tooltip",{attrs:{placement:"top",transfer:!0,"transfer-class-name":"knowledge-graph-tooltip"}},[n("SvgIcon",{staticClass:"help-icon",attrs:{name:"help"}}),e._v(" "),n("template",{slot:"content"},[n("div",{staticClass:"tooltip-content"},[n("div",{staticClass:"item"},[n("span",{staticClass:"title"},[e._v(e._s(e.$t("knowledgeGraph.statistics.functionDescription")))]),e._v(" "),n("span",{staticClass:"content"},[e._v(e._s(e.tooltipCompletionRate))])]),e._v(" "),e.isNormalMode?n("div",{staticClass:"item"},[n("span",{staticClass:"title"},[e._v(e._s(e.$t("knowledgeGraph.statistics.calculationRules")))]),e._v(" "),n("span",{staticClass:"content"},[e._v(e._s(e.$t("knowledgeGraph.statistics.averageCompletenessRateTip")))])]):e._e()])])],2),e._v(" "),n("span",[e._v(": "+e._s(e.data.averageCompletenessRate))])],1),e._v(" "),n("NodeStatisticsCard",{attrs:{data:e.masteryDistribution,colors:e.MASTERY_LEGEND_COLORS}},[n("span",[e._v(e._s(e.$t("knowledgeGraph.statistics.averageMasteryRate")))]),e._v(" "),n("Tooltip",{attrs:{placement:"top",transfer:!0,"transfer-class-name":"knowledge-graph-tooltip"}},[n("SvgIcon",{staticClass:"help-icon",attrs:{name:"help"}}),e._v(" "),n("template",{slot:"content"},[n("div",{staticClass:"tooltip-content"},[n("div",{staticClass:"item"},[n("span",{staticClass:"title"},[e._v(e._s(e.$t("knowledgeGraph.statistics.functionDescription")))]),e._v(" "),n("span",{staticClass:"content"},[e._v(e._s(e.tooltipMasteryRate))])]),e._v(" "),e.isNormalMode?n("div",{staticClass:"item"},[n("span",{staticClass:"title"},[e._v(e._s(e.$t("knowledgeGraph.statistics.calculationRules")))]),e._v(" "),n("span",{staticClass:"content"},[e._v(e._s(e.$t("knowledgeGraph.statistics.averageMasteryRateTip")))])]):e._e()])])],2),e._v(" "),n("span",[e._v(": "+e._s(e.data.averageMasteryRate))])],1)],1)]),e._v(" "),n("div",{staticClass:"statistics-node-detail-wrapper"},[n("div",{staticClass:"tab-and-search-wrapper"},[n("div",{staticClass:"tabs"},[n("div",{staticClass:"tab",class:{active:"node"===e.tab},on:{click:function(t){return e.changeTab("node")}}},[e._v("\n          "+e._s(e.$t("knowledgeGraph.statistics.byNode"))+"\n        ")]),e._v(" "),n("div",{staticClass:"tab",class:{active:"student"===e.tab},on:{click:function(t){return e.changeTab("student")}}},[e._v("\n          "+e._s(e.$t("knowledgeGraph.statistics.byStudent"))+"\n        ")])]),e._v(" "),n("div",{staticClass:"search"},[n("Input",{staticStyle:{width:"172px"},attrs:{search:"",placeholder:e.placeholder},on:{"on-search":e.search},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}}),e._v(" "),e.isCognitiveDimensionOpen&&"node"==e.tab?n("CognitiveDimensionSelect",{staticStyle:{"margin-left":"12px"},attrs:{width:160,multiple:!0},on:{input:e.cognitiveDimensionSelected}}):e._e()],1)]),e._v(" "),n("div",{staticClass:"table-content"},["node"===e.tab?n("NodeDimension",{attrs:{data:e.data.nodes,keyword:e.keyword,dimensions:e.dimensions}}):e._e(),e._v(" "),"student"===e.tab?n("StudentDimension",{attrs:{keyword:e.keyword}}):e._e()],1)])])}),[],!1,null,"18133ab3",null).exports,Ht=(0,m.aZ)({components:{SvgIcon:ft.Z},props:{icon:{type:String,required:!0},percent:{type:String,default:"--"},rank:{type:String,default:"--"}},setup:function(){return{}}}),Ft=(0,T.Z)(Ht,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"stats-card"},[n("SvgIcon",{staticClass:"fs-50",attrs:{name:e.icon}}),e._v(" "),n("div",{staticClass:"percent fs-40 fw-500"},[n("span",{staticStyle:{"vertical-align":"text-bottom"}},[e._v(e._s(e.percent))])]),e._v(" "),n("div",{staticClass:"lh-28"},[n("div",{staticClass:"fs-16 fw-500"},[e._t("default")],2),e._v(" "),n("div",{staticClass:"rank fs-12"},[e._v("("+e._s(e.$t("knowledgeGraph.rake",{n:e.rank}))+")")])])],1)}),[],!1,null,"463888cd",null).exports,Bt=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},zt=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},Lt=null!==(c=null===(l=null===(s=window.globalData)||void 0===s?void 0:s.course)||void 0===l?void 0:l.id)&&void 0!==c?c:0,Ut=(0,m.aZ)({components:{CognitiveDimensionSelect:vt.Z,Card:Ft},setup:function(){var e,t,n,o=this,r=(null===(e=window.featureToggles)||void 0===e?void 0:e.isCognitiveDimensionOpen)||!1,i=Number(null!==(n=null===(t=window.location.hash.match(/student\/([^/]+)(?=(\/|$))/))||void 0===t?void 0:t[1])&&void 0!==n?n:""),a=yt(i,r);a.find((function(e){return"averageCompletenessRate"===e.key})).title=h.default.t("knowledgeGraph.completeRate"),a.find((function(e){return"averageMasteryRate"===e.key})).title=h.default.t("knowledgeGraph.masteryRate");var s=(0,m.iH)(new G.rk),l=(0,m.iH)(""),c=(0,m.iH)([]),u=(0,m.Fl)((function(){return s.value.nodes})),d=_t(u,l,c),p=d.nodes,f=d.handleLoadData;return(0,m.bv)((function(){return Bt(o,void 0,void 0,(function(){var e;return zt(this,(function(t){switch(t.label){case 0:return e=s,[4,(0,H.rh)(Lt,i)];case 1:return e.value=t.sent(),[2]}}))}))})),{columns:a,stats:s,nodes:p,isCognitiveDimensionOpen:r,back:function(){window.location.href="/course/".concat(Lt,"/stat#/knowledge-graph?tab=student")},search:function(e){l.value=e},cognitiveDimensionSelected:function(e){c.value=e},rowClassName:function(e,t){return e.parentId?"":"parent-node-row"},handleLoadData:f}}}),Vt=(0,T.Z)(Ut,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"breadcrumb-area"},[n("div",{staticClass:"back"},[n("a",{on:{click:e.back}},[e._v(e._s(e.$t("backParentList")))])]),e._v(" "),n("span",{staticClass:"split"}),e._v(" "),n("div",{staticClass:"breadcrumb"},[n("span",{staticClass:"desc"},[e._v(e._s(e.$t("knowledgeGraph.title")))]),e._v(" "),n("i",{staticClass:"font font-chevron-right chevron"}),e._v(" "),n("span",{staticClass:"desc"},[e._v(e._s(e.stats.name))])])]),e._v(" "),n("div",{staticClass:"summary-pane"},[n("div",{staticClass:"user-info"},[n("span",[e._v(e._s(e.stats.name))]),e._v(" "),n("span",[e._v("("+e._s(e.stats.userNo)+")")])]),e._v(" "),n("div",{staticClass:"summary-card"},[n("Card",{attrs:{icon:"complete-rate",percent:e.stats.completenessRate,rank:e.stats.completenessRateRank}},[e._v("\n        "+e._s(e.$t("knowledgeGraph.statistics.averageCompleteness"))+"\n      ")]),e._v(" "),n("Card",{attrs:{icon:"mastery-rate",percent:e.stats.masteryRate,rank:e.stats.masteryRateRank}},[e._v("\n        "+e._s(e.$t("knowledgeGraph.statistics.averageMastery"))+"\n      ")])],1)]),e._v(" "),n("div",{staticClass:"stats-info"},[n("div",{staticClass:"search"},[n("Input",{staticStyle:{width:"170px"},attrs:{search:"",placeholder:e.$t("knowledgeGraph.nodeName")},on:{"on-search":e.search}}),e._v(" "),e.isCognitiveDimensionOpen?n("CognitiveDimensionSelect",{staticStyle:{"margin-left":"12px"},attrs:{width:160,multiple:!0},on:{input:e.cognitiveDimensionSelected}}):e._e()],1),e._v(" "),n("div",{staticClass:"table-wrapper"},[n("Table",{staticClass:"table-content",attrs:{"row-key":"id",columns:e.columns,data:e.nodes,"row-class-name":e.rowClassName,"load-data":e.handleLoadData,"update-show-children":!0}})],1)])])}),[],!1,null,"319dfbe2",null).exports,qt=(n(339714),n(922942)),Yt=n(391737),Kt=n(693604),Wt=n(383228),Jt=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},Xt=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},Qt=(0,m.aZ)({props:{courseId:{type:Number,required:!0},nodeId:{type:Number,required:!0},userId:{type:Number,required:!0},resourceCount:{type:Number,default:0},activityCount:{type:Number,default:0}},components:{Pagination:xt.Z,TooltipExt:Se.Z},setup:function(e){var t=this,n=(0,m.iH)("resource"),o=(0,m.iH)(h.default.t("knowledgeGraph.statistics.resourceName")),r=(0,m.iH)([]),i=(0,m.iH)(""),a=function(){"resource"===n.value?r.value=[{title:h.default.t("knowledgeGraph.statistics.resourceName"),key:"name",slot:"name",width:250},{title:h.default.t("knowledgeGraph.statistics.completionStatus"),key:"viewed",slot:"viewed"},{title:h.default.t("knowledgeGraph.statistics.visits"),key:"visits"},{title:h.default.t("operation"),slot:"action",width:80}]:r.value=[{title:h.default.t("knowledgeGraph.statistics.activityName"),key:"title",slot:"name",width:250},{title:h.default.t("knowledgeGraph.statistics.activityType"),key:"type",slot:"activityType"},{title:h.default.t("knowledgeGraph.statistics.completionStatus"),key:"completeness",slot:"completeness"},{title:h.default.t("knowledgeGraph.statistics.finalScore"),key:"score"},{title:h.default.t("operation"),slot:"action",width:80}]},s=(0,qt.h0)((function(t,o){return(0,H.o9)(t,o,e.nodeId,e.userId,n.value.toString(),i.value.toString())}));return(0,m.bv)((function(){return Jt(t,void 0,void 0,(function(){return Xt(this,(function(e){return a(),null==s||s.fetch(),[2]}))}))})),(0,m.YP)((function(){return n.value}),(function(e){s.reset(),a(),s.fetch()})),{columns:r,pagination:s,search:function(e){i.value!==e&&(i.value=e,s.fetch())},relatedType:n,placeholder:o,changeRelatedType:function(e){n.value=e,"resource"===e&&(o.value=h.default.t("knowledgeGraph.statistics.resourceName")),"activity"===e&&(o.value=h.default.t("knowledgeGraph.statistics.activityName"))},preview:function(t){var o;"activity"!==n.value?(document.fullscreenElement&&document.exitFullscreen(),(0,Yt.useAngularScope)().$broadcast("previewFiles",s.data.items,t),Wt("#file-previewer").foundation("reveal","open")):window.open("exam"===(o=t).type?"/course/".concat(e.courseId,"/learning-activity#/exam/").concat(o.id):"/course/".concat(e.courseId,"/learning-activity#/").concat(o.id),"_blank")},fileTypeByExtension:Kt.fileTypeByExtension,getActivityGreyIcon:function(e){return"font-syllabus-".concat((0,Kt.replaceActivityTypeKey)(e))}}}}),en=(0,T.Z)(Qt,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"refer-table"},[n("div",{staticClass:"tabs"},[n("div",{staticClass:"tab active"},[e._v("\n      "+e._s(e.$t("knowledgeGraph.statistics.relatedContent"))+"\n    ")]),e._v(" "),n("div",{staticClass:"search"},[n("Input",{attrs:{search:"",placeholder:e.placeholder},on:{"on-search":e.search}})],1)]),e._v(" "),n("div",{staticClass:"related-type"},[n("div",{class:{active:"resource"===e.relatedType},on:{click:function(t){return e.changeRelatedType("resource")}}},[e._v("\n      "+e._s(e.$t("knowledgeGraph.statistics.relatedResourceType"))+"("+e._s(e.resourceCount)+")\n    ")]),e._v(" "),n("div",{class:{active:"activity"===e.relatedType},on:{click:function(t){return e.changeRelatedType("activity")}}},[e._v("\n      "+e._s(e.$t("knowledgeGraph.statistics.relatedActivityType"))+"("+e._s(e.activityCount)+")\n    ")])]),e._v(" "),n("div",{staticClass:"table-wrapper"},[n("Table",{attrs:{stripe:"","row-key":"id",columns:e.columns,data:e.pagination.data.items,loading:e.pagination.isLoading.value},scopedSlots:e._u([{key:"name",fn:function(t){var o=t.row;return["resource"===e.relatedType?n("div",{staticClass:"name"},[n("i",{staticClass:"font upload-icon",class:"font-file-"+e.fileTypeByExtension(o)}),e._v(" "),n("tooltip-ext",{attrs:{text:o.name}})],1):n("div",{staticClass:"name"},[n("i",{staticClass:"font",class:e.getActivityGreyIcon(o.type)}),e._v(" "),n("tooltip-ext",{attrs:{text:o.title}})],1)]}},"resource"===e.relatedType?{key:"viewed",fn:function(t){var o=t.row;return[n("div",{staticClass:"completeness-area"},[n("div",{staticClass:"status",class:o.viewed?"bg-green":"bg-orange"}),e._v(" "),o.viewed?n("span",[e._v(e._s(e.$t("knowledgeGraph.finished")))]):n("span",[e._v(e._s(e.$t("knowledgeGraph.notFinished")))])])]}}:null,"activity"===e.relatedType?{key:"activityType",fn:function(t){var n=t.row;return[e._v("\n        "+e._s(e.$t("activityType."+n.type))+"\n      ")]}}:null,"activity"===e.relatedType?{key:"completeness",fn:function(t){var o=t.row;return[n("div",{staticClass:"completeness-area"},[n("div",{staticClass:"status",class:"full"===o.completeness?"bg-green":"bg-orange"}),e._v(" "),"full"===o.completeness?n("span",[e._v(e._s(e.$t("knowledgeGraph.finished")))]):"part"===o.completeness?n("span",[e._v(e._s(e.$t("knowledgeGraph.partFinished")))]):n("span",[e._v(e._s(e.$t("knowledgeGraph.notFinished")))])])]}}:null,{key:"action",fn:function(t){var o=t.row;return[n("Tooltip",{attrs:{placement:"top",content:e.$t("view")}},[n("i",{staticClass:"font font-resource-view",on:{click:function(t){return e.preview(o)}}})])]}}],null,!0)})],1),e._v(" "),e.pagination.data.total?n("div",{staticClass:"page-wrapper"},[n("Pagination",{attrs:{total:e.pagination.data.total,current:e.pagination.data.page,"page-size":e.pagination.data.pageSize,"show-elevator":"","show-sizer":""},on:{"on-change":e.pagination.pageChanged,"on-page-size-change":e.pagination.pageSizeChanged}})],1):e._e()])}),[],!1,null,"f026b2ea",null).exports,tn=(0,m.aZ)({props:{source:{type:String,required:!0,default:"byNode"},courseId:{type:Number,required:!0},nodeId:{type:Number,required:!0},userId:{type:Number,required:!0},stats:{type:Object,required:!0}},components:{},setup:function(e){return{back:function(t){void 0===t&&(t=0);var n="/course/".concat(e.courseId,"/stat#/knowledge-graph");-1===t&&"byNode"===e.source?n="/course/".concat(e.courseId,"/stat#/knowledge-graph/node/").concat(e.nodeId):-1===t&&"byStudent"===e.source&&(n="/course/".concat(e.courseId,"/stat#/knowledge-graph/student/").concat(e.userId)),window.location.href=n},secondaryNode:(0,m.Fl)((function(){return"byNode"===e.source?e.stats.nodeName:e.stats.name})),thirdNode:(0,m.Fl)((function(){return"byNode"===e.source?e.stats.name:e.stats.nodeName}))}}}),nn=(0,T.Z)(tn,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"breadcrumb-area"},[n("div",{staticClass:"back"},[n("a",{on:{click:function(t){return e.back(-1)}}},[e._v(e._s(e.$t("backParentList")))])]),e._v(" "),n("span",{staticClass:"split"}),e._v(" "),n("div",{staticClass:"breadcrumb"},[n("a",{staticClass:"desc",on:{click:e.back}},[e._v(e._s(e.$t("knowledgeGraph.title")))]),e._v(" "),n("i",{staticClass:"font font-chevron-right chevron"}),e._v(" "),n("a",{staticClass:"desc",on:{click:function(t){return e.back(-1)}}},[e._v(e._s(e.secondaryNode))]),e._v(" "),n("a",{staticClass:"font font-chevron-right chevron"}),e._v(" "),n("span",{staticClass:"name"},[e._v(e._s(e.thirdNode))])])])}),[],!1,null,"3298b04f",null).exports,on=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},rn=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},an=(0,m.aZ)({components:{Breadcrumb:nn,Card:Ft,ReferDataList:en},setup:function(){var e,t,n,o,r,i,a,s=this,l=null!==(n=null===(t=null===(e=window.globalData)||void 0===e?void 0:e.course)||void 0===t?void 0:t.id)&&void 0!==n?n:0,c=Number(null!==(r=null===(o=window.location.hash.match(/node\/([^/]+)(?=(\/|$))/))||void 0===o?void 0:o[1])&&void 0!==r?r:""),u=Number(null!==(a=null===(i=window.location.hash.match(/student\/([^/]+)(?=(\/|$))/))||void 0===i?void 0:i[1])&&void 0!==a?a:""),d=(0,m.iH)(new G.PT);return(0,m.bv)((function(){return on(s,void 0,void 0,(function(){var e;return rn(this,(function(t){switch(t.label){case 0:return e=d,[4,(0,H.DD)(c,u)];case 1:return e.value=t.sent(),[2]}}))}))})),{courseId:l,nodeId:c,studentId:u,stats:d}}}),sn=(0,T.Z)(an,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"node-info-by-node"},[n("Breadcrumb",{attrs:{source:"byStudent","course-id":e.courseId,"node-id":e.nodeId,"user-id":e.studentId,stats:e.stats}}),e._v(" "),n("div",{staticClass:"summary-pane"},[n("div",{staticClass:"node-info"},[n("span",{staticClass:"title"},[e._v(e._s(e.stats.nodeName))]),e._v(" "),n("div",{staticClass:"description"},[e._v(e._s(e.stats.nodeDesc))])]),e._v(" "),n("div",{staticClass:"summary-card"},[n("Card",{attrs:{icon:"complete-rate",percent:e.stats.completenessRate,rank:e.stats.completenessRank}},[e._v("\n        "+e._s(e.$t("knowledgeGraph.statistics.averageCompleteness"))+"\n      ")]),e._v(" "),n("Card",{attrs:{icon:"mastery-rate",percent:e.stats.masteryRate,rank:e.stats.masteryRank}},[e._v("\n        "+e._s(e.$t("knowledgeGraph.statistics.averageMastery"))+"\n      ")])],1)]),e._v(" "),n("ReferDataList",{attrs:{"course-id":e.courseId,"node-id":e.nodeId,"user-id":e.studentId,"activity-count":e.stats.activityCount,"resource-count":e.stats.resourceCount}})],1)}),[],!1,null,"de094cce",null).exports,ln=(n(747042),n(651013)),cn=n(926630),un=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},dn=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},pn=null!==(d=null===(u=window.globalData)||void 0===u?void 0:u.course)&&void 0!==d?d:{id:0},fn=(0,m.aZ)({components:{NodeStatisticsCard:ht.Z,NodeStudentDetail:ln.Z,NodeContentDetail:cn.Z,SvgIcon:ft.Z},setup:function(){var e=this,t=Number(window.location.hash.split("/").slice(-1)[0]),n=(0,m.iH)(new G.Ee),o=(0,m.iH)("student"),r=["80~100","60~79","below60"],i=(0,Pt.bG)(),a=i.tooltipSingleCompletionRate,s=i.tooltipMasteryRate,l=i.isNormalMode,c=(0,m.Fl)((function(){return r.map((function(e){var t;return{value:null===(t=n.value.completenessRateDistribution)||void 0===t?void 0:t[e],name:h.default.t("knowledgeGraph.statistics.".concat(e))}}))})),u=(0,m.Fl)((function(){return r.map((function(e){var t;return{value:null===(t=n.value.masteryRateDistribution)||void 0===t?void 0:t[e],name:h.default.t("knowledgeGraph.statistics.".concat(e))}}))}));(0,m.bv)((function(){return un(e,void 0,void 0,(function(){var e;return dn(this,(function(o){switch(o.label){case 0:return e=n,[4,(0,H.u3)(t)];case 1:return e.value=o.sent(),[2]}}))}))}));var d=(0,m.iH)("".concat(h.default.t("knowledgeGraph.statistics.userNo"),"/").concat(h.default.t("name"))),p=(0,m.iH)(""),f=(0,m.iH)("");return{MASTERY_LEGEND_COLORS:mt.$e,COMPLETENESS_LEGEND_COLORS:mt.wR,back:function(){window.location.href="/course/".concat(pn.id,"/stat#/knowledge-graph")},data:n,tab:o,placeholder:d,inputValue:f,changeTab:function(e){o.value=e,p.value="",f.value="","student"===e&&(d.value="".concat(h.default.t("knowledgeGraph.statistics.userNo"),"/").concat(h.default.t("name")))},subTabChanged:function(e){"upload"===e&&(d.value=h.default.t("knowledgeGraph.statistics.resourceName")),"activity"===e&&(d.value=h.default.t("knowledgeGraph.statistics.activityName"))},search:function(e){p.value=e},keyword:p,completenessDistribution:c,masteryDistribution:u,tooltipSingleCompletionRate:a,tooltipMasteryRate:s,isNormalMode:l}}}),vn=(0,T.Z)(fn,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"breadcrumb-area"},[n("div",{staticClass:"back"},[n("a",{on:{click:e.back}},[e._v(e._s(e.$t("backParentList")))])]),e._v(" "),n("span",{staticClass:"split"}),e._v(" "),n("div",{staticClass:"breadcrumb"},[n("span",{staticClass:"desc"},[e._v(e._s(e.$t("knowledgeGraph.title")))]),e._v(" "),n("i",{staticClass:"font font-chevron-right chevron"}),e._v(" "),n("span",{staticClass:"desc"},[e._v(e._s(e.data.name))])])]),e._v(" "),n("div",{staticClass:"overview-wrapper"},[n("section",{staticClass:"title"},[e._v(e._s(e.data.name))]),e._v(" "),n("section",{staticClass:"description"},[e._v("\n      "+e._s(e.data.description)+"\n    ")]),e._v(" "),n("section",{staticClass:"overview-chart"},[n("NodeStatisticsCard",{attrs:{data:e.completenessDistribution,colors:e.COMPLETENESS_LEGEND_COLORS,left:120}},[[n("span",[e._v(e._s(e.$t("knowledgeGraph.statistics.completenessRate")))]),e._v(" "),n("Tooltip",{attrs:{placement:"top",transfer:!0,"transfer-class-name":"knowledge-graph-tooltip"}},[n("SvgIcon",{staticClass:"help-icon",attrs:{name:"help"}}),e._v(" "),n("template",{slot:"content"},[n("div",{staticClass:"tooltip-content"},[n("div",{staticClass:"item"},[n("span",{staticClass:"title"},[e._v(e._s(e.$t("knowledgeGraph.statistics.functionDescription")))]),e._v(" "),n("span",{staticClass:"content"},[e._v(e._s(e.tooltipSingleCompletionRate))])]),e._v(" "),e.isNormalMode?n("div",{staticClass:"item"},[n("span",{staticClass:"title"},[e._v(e._s(e.$t("knowledgeGraph.statistics.calculationRules")))]),e._v(" "),n("span",{staticClass:"content"},[e._v(e._s(e.$t("knowledgeGraph.statistics.singleNodeCompletenessRateTip")))])]):e._e()])])],2),e._v(" "),n("span",[e._v(": "+e._s(e.data.averageCompletenessRate))])]],2),e._v(" "),n("NodeStatisticsCard",{attrs:{data:e.masteryDistribution,colors:e.MASTERY_LEGEND_COLORS,left:120}},[[n("span",[e._v(e._s(e.$t("knowledgeGraph.statistics.masteryRate")))]),e._v(" "),n("Tooltip",{attrs:{placement:"top",transfer:!0,"transfer-class-name":"knowledge-graph-tooltip"}},[n("SvgIcon",{staticClass:"help-icon",attrs:{name:"help"}}),e._v(" "),n("template",{slot:"content"},[n("div",{staticClass:"tooltip-content"},[n("div",{staticClass:"item"},[n("span",{staticClass:"title"},[e._v(e._s(e.$t("knowledgeGraph.statistics.functionDescription")))]),e._v(" "),n("span",{staticClass:"content"},[e._v(e._s(e.tooltipMasteryRate))])]),e._v(" "),e.isNormalMode?n("div",{staticClass:"item"},[n("span",{staticClass:"title"},[e._v(e._s(e.$t("knowledgeGraph.statistics.calculationRules")))]),e._v(" "),n("span",{staticClass:"content"},[e._v(e._s(e.$t("knowledgeGraph.statistics.singleNodeMasteryRateTip")))])]):e._e()])])],2),e._v(" "),n("span",[e._v(": "+e._s(e.data.averageMasteryRate))])]],2)],1)]),e._v(" "),n("div",{staticClass:"statistics-students-detail-wrapper"},[n("div",{staticClass:"tabs"},[n("div",{staticClass:"tab",class:{active:"student"===e.tab},on:{click:function(t){return e.changeTab("student")}}},[e._v("\n        "+e._s(e.$t("knowledgeGraph.statistics.byStudent"))+"\n      ")]),e._v(" "),n("div",{staticClass:"tab",class:{active:"content"===e.tab},on:{click:function(t){return e.changeTab("content")}}},[e._v("\n        "+e._s(e.$t("knowledgeGraph.statistics.byContent"))+"\n      ")]),e._v(" "),n("div",{staticClass:"search"},[n("Input",{attrs:{search:"",placeholder:e.placeholder},on:{"on-search":e.search},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}})],1)]),e._v(" "),"student"===e.tab?n("NodeStudentDetail",{attrs:{keyword:e.keyword}}):e._e(),e._v(" "),"content"===e.tab?n("NodeContentDetail",{attrs:{keyword:e.keyword,uploadCount:e.data.uploadCount,activityCount:e.data.activityCount},on:{"tab-changed":e.subTabChanged}}):e._e()],1)])}),[],!1,null,"5ee01d08",null).exports,hn=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},mn=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},gn=(0,m.aZ)({components:{Breadcrumb:nn,Card:Ft,ReferDataList:en},setup:function(){var e,t,n,o,r,i,a,s=this,l=null!==(n=null===(t=null===(e=window.globalData)||void 0===e?void 0:e.course)||void 0===t?void 0:t.id)&&void 0!==n?n:0,c=Number(null!==(r=null===(o=window.location.hash.match(/node\/([^/]+)(?=(\/|$))/))||void 0===o?void 0:o[1])&&void 0!==r?r:""),u=Number(null!==(a=null===(i=window.location.hash.match(/student\/([^/]+)(?=(\/|$))/))||void 0===i?void 0:i[1])&&void 0!==a?a:""),d=(0,m.iH)(new G.PT);return(0,m.bv)((function(){return hn(s,void 0,void 0,(function(){var e;return mn(this,(function(t){switch(t.label){case 0:return e=d,[4,(0,H.DD)(c,u)];case 1:return e.value=t.sent(),[2]}}))}))})),{courseId:l,nodeId:c,studentId:u,stats:d,back:function(){window.location.href="/course/".concat(l,"/stat#/knowledge-graph/node/").concat(c)}}}}),yn=(0,T.Z)(gn,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"node-info-by-student"},[n("Breadcrumb",{attrs:{source:"byNode","course-id":e.courseId,"node-id":e.nodeId,"user-id":e.studentId,stats:e.stats}}),e._v(" "),n("div",{staticClass:"summary-pane"},[n("div",{staticClass:"user-info"},[n("span",[e._v(e._s(e.stats.name))]),e._v(" "),n("span",[e._v("("+e._s(e.stats.userNo)+")")])]),e._v(" "),n("div",{staticClass:"summary-card"},[n("Card",{attrs:{icon:"complete-rate",percent:e.stats.completenessRate,rank:e.stats.completenessRank}},[e._v("\n        "+e._s(e.$t("knowledgeGraph.statistics.averageCompleteness"))+"\n      ")]),e._v(" "),n("Card",{attrs:{icon:"mastery-rate",percent:e.stats.masteryRate,rank:e.stats.masteryRank}},[e._v("\n        "+e._s(e.$t("knowledgeGraph.statistics.averageMastery"))+"\n      ")])],1)]),e._v(" "),n("ReferDataList",{attrs:{"course-id":e.courseId,"node-id":e.nodeId,"user-id":e.studentId,"activity-count":e.stats.activityCount,"resource-count":e.stats.resourceCount}})],1)}),[],!1,null,"20a51acc",null).exports,wn=n(82720),bn=n(225590),_n=n(770181),Cn=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},kn=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},xn=(0,m.aZ)({components:{Summary:jt,Graph:bn.Z,Toolbar:_n.Z},props:{courseId:{type:Number,required:!0},treeDepth:Number,publishType:{type:String},isInstructor:{type:Boolean}},provide:function(){return{treeDepth:this.treeDepth}},setup:function(e){var t=this,n=(0,m.iH)(new G.ob),o=(0,m.iH)([]),r=(0,m.iH)(),i=(0,m.iH)(),a=wn.wO.LEVEL,s=(0,m.Fl)((function(){return"published"===e.publishType})),l=(0,m.iH)({course:!1,levelRelation:!0,directedRelation:!0,undirectedRelation:!0}),c=(0,m.Fl)((function(){return e.isInstructor||s.value?h.default.t("knowledgeGraph.noContent"):h.default.t("knowledgeGraph.NoContentTip")}));return(0,m.bv)((function(){return Cn(t,void 0,void 0,(function(){var t,r;return kn(this,(function(i){switch(i.label){case 0:return s.value||e.isInstructor?(t=n,[4,(0,H.gs)(e.courseId)]):[2];case 1:return t.value=i.sent(),r=o,[4,(0,H.$H)(e.courseId)];case 2:return r.value=i.sent(),[2]}}))}))})),{data:n,nodes:o,viewMode:a,graphSetting:l,graphWrapperRef:r,graphRef:i,settingChange:function(e){l.value=e},fullscreen:function(){var e;document.fullscreenElement?document.exitFullscreen():null===(e=r.value)||void 0===e||e.requestFullscreen()},restPosition:function(){var e;null===(e=i.value)||void 0===e||e.resetZoom()},zoomIn:function(){var e;null===(e=i.value)||void 0===e||e.zoomIn()},zoomOut:function(){var e;null===(e=i.value)||void 0===e||e.zoomOut()},noDataTip:c,isPublished:s}}}),Sn=(0,T.Z)(xn,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.isInstructor||e.isPublished?n("Summary",{attrs:{data:e.data,width:100,"inner-width":80}}):e._e(),e._v(" "),(e.isInstructor||e.isPublished)&&e.nodes.length?n("div",{ref:"graphWrapperRef",staticClass:"graph-wrapper"},[n("Graph",{ref:"graphRef",staticClass:"graph",attrs:{nodes:e.nodes,"view-mode":e.viewMode,setting:e.graphSetting}}),e._v(" "),n("Toolbar",{staticClass:"graph-toolbar",attrs:{"view-mode":e.viewMode},on:{"on-setting-change":e.settingChange,"on-fullscreen":e.fullscreen,"on-position":e.restPosition,"on-zoom-in":e.zoomIn,"on-zoom-out":e.zoomOut}})],1):n("div",{staticClass:"no-data",class:{"has-summary":e.isInstructor||e.isPublished}},[n("i",{staticClass:"blank-icon font font-courseware-blank"}),e._v("\n    "+e._s(e.noDataTip)+"\n  ")])],1)}),[],!1,null,"7d6dbf1c",null).exports,Tn=n(261139);p.default.use(v.default),p.default.use(f.Z),p.default.component("SvgIcon",n(311610).Z),p.default.customElement("knowledge-graph",lt),p.default.customElement("activity-knowledge-node-setting",ct.Z),p.default.customElement("activity-knowledge-node-reference",pt),p.default.customElement("knowledge-node-tag",ut.Z),p.default.customElement("knowledge-graph-statistics-overview",Zt),p.default.customElement("knowledge-graph-student-node-stats",Vt),p.default.customElement("knowledge-graph-node-students-stats",vn),p.default.customElement("knowledge-graph-node-student-stats",yn),p.default.customElement("knowledge-graph-student-node-stats-by-node",sn),p.default.customElement("knowledge-graph-course-homepage",Sn),Tn.module("common").directive("subjectRender",(function(){return{restrict:"A",scope:{subject:"=",inSubmission:"=",optionIdxToChar:"=",getSubIndex:"=",trustSrc:"="},templateUrl:"subject.html"}}))},64976:function(e,t,n){"use strict";var o=n(370538);t.Z=new o.default},153384:function(e,t,n){"use strict";n.d(t,{N:function(){return o}});n(788674);var o=new(n(578345).Z)({routes:[{path:"/outline",name:"outline",component:()=>Promise.resolve().then(n.bind(n,336775))},{path:"/graph",name:"index",component:()=>Promise.resolve().then(n.bind(n,802972))},{path:"/mind-map/:id?",name:"index",component:()=>Promise.all([n.e(73417),n.e(70386),n.e(88713)]).then(n.bind(n,582605))},{path:"/forest",name:"index",component:()=>Promise.resolve().then(n.bind(n,802972))},{path:"/extension",name:"extension",component:()=>n.e(58764).then(n.bind(n,58764))},{path:"/problem",name:"problem",component:()=>n.e(63293).then(n.bind(n,163293))}]});o.beforeEach(((e,t,n)=>{var o,r=null===(o=window.orgSettings)||void 0===o?void 0:o.allowFacetsAndFragments;"/"===e.path?n(r?"/forest":"/mind-map"):n()}))},863296:function(e,t,n){"use strict";var o=n(370538);t.Z=new o.default},384382:function(e,t,n){"use strict";n.r(t);var o=n(370538),r=n(117403),i=n(170803),a=n.n(i),s=(n(788674),n(887757)),l=n.n(s),c=(n(535666),n(409669)),u=n.n(c);function d(e,t,n,o,r,i,a){try{var s=e[i](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(o,r)}var p=new CustomEvent("__import-exam-subject-popup-visible",{detail:{show:!1}}),f={props:{show:{type:Boolean,default:!1},examId:{type:Number,required:!0}},data:()=>({loading:!1}),methods:{visibleChange(e){p.detail.show=e,document.dispatchEvent(p)},close(){p.detail.show=!1,document.dispatchEvent(p)},importSubject(){var e,t=this;return(e=l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.prev=1,e.next=4,u().post("/api/make-up-exams/".concat(t.examId,"/subjects/import"));case 4:window.location.reload(),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0),t.loading=!1;case 11:case"end":return e.stop()}}),e,null,[[1,7]])})),function(){var t=this,n=arguments;return new Promise((function(o,r){var i=e.apply(t,n);function a(e){d(i,o,r,a,s,"next",e)}function s(e){d(i,o,r,a,s,"throw",e)}a(void 0)}))})()}}},v=(0,n(551900).Z)(f,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Modal",{attrs:{"class-name":"vertical-center-modal",value:e.show,title:e.$t("importSubject.title"),width:480,"mask-closable":!1},on:{"on-visible-change":e.visibleChange}},[n("p",[e._v(e._s(e.$t("importSubject.confirm")))]),e._v(" "),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{attrs:{type:"primary",loading:e.loading},on:{click:e.importSubject}},[e._v(e._s(e.$t("importSubject.import")))]),e._v(" "),n("Button",{attrs:{type:"default"},on:{click:e.close}},[e._v(e._s(e.$t("importSubject.notImport")))])],1)])}),[],!1,null,"28f53260",null).exports;o.default.prototype._i18n=r.default,o.default.use(a()),o.default.customElement("import-exam-subject-popup",v),o.default.component("match-subject-info",n(192188).Z),o.default.component("number-input",n(603912).Z)},970781:function(e,t,n){"use strict";n.r(t);var o=n(370538),r=n(285256),i=n(925706),a=(n(141817),n(66992),n(788674),n(333948),n(496486)),s=n(311610),l=n(953977),c=n(32326),u=(0,i.aZ)({name:"CourseCard",components:{SvgIcon:s.Z},props:{course:{type:Object,required:!0},courseEnterGuard:{type:Function,default:function(e,t){}}},setup:function(e){return{courseInstructors:(0,i.Fl)((function(){var t,n=(null===(t=e.course)||void 0===t?void 0:t.instructors)||[];return(0,a.map)((0,a.slice)(n,0,3),(function(e){return e.name})).join(",")})),coverSrc:(0,i.Fl)((function(){return e.course.isProject?c:e.course.cover?e.course.cover:l}))}}}),d=n(551900),p=(0,d.Z)(u,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.course?n("div",{staticClass:"course-wrapper"},[n("a",{staticClass:"cover",attrs:{href:"/course/"+e.course.id+"/content"},on:{click:function(t){return t.stopPropagation(),e.courseEnterGuard(e.course.id,t)}}},[n("div",[n("img",{attrs:{src:e.coverSrc,alt:""}})])]),e._v(" "),n("div",{staticClass:"course-content"},[n("div",{staticClass:"course-name"},[n("Tooltip",{attrs:{content:e.course.name,placement:"top-start",transfer:""}},[n("a",{on:{click:function(t){return t.stopPropagation(),e.courseEnterGuard(e.course.id,t)}}},[e._v("\n          "+e._s(e.course.name)+"\n        ")])]),e._v(" "),e._t("action-dropdown")],2),e._v(" "),n("div",{staticClass:"course-instructor"},[n("Tooltip",{attrs:{content:e.courseInstructors,placement:"top-start",transfer:""}},[n("span",[e._v("\n          "+e._s(e.course.isProject?e.$t("project.instructor"):e.$t("learningSpace.courseProject.instructor"))+": \n        ")]),e._v("\n        "+e._s(e.courseInstructors)+"\n      ")])],1)]),e._v(" "),n("div",{staticClass:"operation"},[n("div",{staticClass:"row-item",staticStyle:{"margin-bottom":"8px"}},[n("div",{staticClass:"opt-item",attrs:{span:"12"}},[n("a",{staticClass:"button",attrs:{href:"/course/"+e.course.id+"/knowledge-graph"},on:{click:function(t){return e.courseEnterGuard(e.course.id,t)}}},["en-US"!==e.$i18n.locale?n("i",{staticClass:"font font-knowledge-graph"}):e._e(),e._v("\n          "+e._s(e.$t("learningSpace.courseProject.knowledgeGraph"))+"\n        ")])]),e._v(" "),n("div",{staticClass:"opt-item",attrs:{span:"12"}},[n("a",{staticClass:"button",attrs:{href:"/course/"+e.course.id+"/"+(e.course.isProject?"resource":"courseware")},on:{click:function(t){return e.courseEnterGuard(e.course.id,t)}}},["en-US"!==e.$i18n.locale?n("i",{staticClass:"font font-attachment"}):e._e(),e._v("\n          "+e._s(e.course.isProject?e.$t("project.resource.title"):e.$t("learningSpace.courseProject.resources"))+"\n        ")])])]),e._v(" "),n("div",{staticClass:"row-item"},[n("div",{staticClass:"opt-item",attrs:{span:"12"}},[n("a",{staticClass:"button",attrs:{href:"/course/"+e.course.id+"/homework"},on:{click:function(t){return e.courseEnterGuard(e.course.id,t)}}},["en-US"!==e.$i18n.locale?n("i",{staticClass:"font font-homework"}):e._e(),e._v("\n          "+e._s(e.$t("learningSpace.courseProject.assignment"))+"\n        ")])]),e._v(" "),n("div",{staticClass:"opt-item",attrs:{span:"12"}},[n("a",{staticClass:"button",attrs:{href:"/course/"+e.course.id+"/forum"},on:{click:function(t){return e.courseEnterGuard(e.course.id,t)}}},["en-US"!==e.$i18n.locale?n("i",{staticClass:"font font-forum"}):e._e(),e._v("\n          "+e._s(e.$t("learningSpace.courseProject.discussion"))+"\n        ")])])])])]):e._e()}),[],!1,null,"782bcbe6",null).exports,f=n(661510),v=n(655031),h=n(427372),m=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},g=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},y=(0,i.aZ)({name:"CourseList",components:{CourseCard:p,Pagination:f.Z,NoData:h.Z},setup:function(){var e=this,t=(0,i.iH)([]),n=(0,i.iH)(0),o=(0,i.iH)("course"),r=(0,i.iH)(1),s=(0,i.iH)(9),l=(0,i.iH)(1),c=(0,i.iH)(9),u=(0,i.iH)(0),d=(0,i.iH)([]),p=(0,i.iH)([]),f=(0,i.iH)(0),h="id,name,course_code,cover,academic_year_id,semester_id,instructors(id,name),is_project",y={semesterId:[]},w=function(){return m(e,void 0,void 0,(function(){var e;return g(this,(function(t){switch(t.label){case 0:return delete y.semesterId,n.value&&(y.semesterId=[n.value]),[4,(0,v.CT)(r.value,s.value,h,y)];case 1:return e=t.sent(),f.value=e.total||0,p.value=(0,a.chunk)(e.items,3),[2]}}))}))},b=function(){return m(e,void 0,void 0,(function(){var e,t;return g(this,(function(n){switch(n.label){case 0:return e={display_project_list:!0},[4,(0,v.CT)(l.value,c.value,h,e)];case 1:return t=n.sent(),u.value=t.total||0,d.value=(0,a.chunk)(t.items,3),[2]}}))}))};return(0,i.YP)((function(){return n.value}),(function(){w()})),(0,i.bv)((function(){m(e,void 0,void 0,(function(){var e;return g(this,(function(n){switch(n.label){case 0:return e=t,[4,(0,v.X7)()];case 1:return e.value=n.sent(),[2]}}))})),w(),b()})),{currentTab:o,handleChangeTab:function(e){o.value=e},viewSemesters:t,currentSemesterId:n,page:r,pageSize:s,total:f,viewCourses:p,onPageChanged:function(e){r.value=e,w()},viewProjects:d,projectPage:l,projectPageSize:c,projectTotal:u,onProjectPageChanged:function(e){l.value=e,b()}}}}),w=(0,d.Z)(y,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"courses-wrapper"},[n("div",{staticClass:"course-header"},[n("div",{staticClass:"title"},[e._v(e._s(e.$t("learningSpace.courseProject.title")))]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"course"===e.currentTab,expression:"currentTab === 'course'"}],staticClass:"filter"},[n("Select",{staticStyle:{width:"200px"},model:{value:e.currentSemesterId,callback:function(t){e.currentSemesterId=t},expression:"currentSemesterId"}},[n("Option",{attrs:{value:0}},[e._v(e._s(e.$t("all")))]),e._v(" "),n("Option",{attrs:{value:"null"}},[e._v(e._s(e.$t("learningSpace.courseProject.notSpecified")))]),e._v(" "),e._l(e.viewSemesters,(function(t){return n("Option",{key:t.id,attrs:{value:t.id}},[e._v("\n          "+e._s(t.name)+"\n        ")])}))],2)],1)]),e._v(" "),n("div",{staticClass:"tabs-wrapper"},[n("div",{staticClass:"tab",class:"course"===e.currentTab?"active":"",on:{click:function(t){return e.handleChangeTab("course")}}},[e._v("\n      "+e._s(e.$t("courseCover.title"))+" · "+e._s(e.total)+"\n    ")]),e._v(" "),n("div",{staticClass:"tab",class:"project"===e.currentTab?"active":"",on:{click:function(t){return e.handleChangeTab("project")}}},[e._v("\n      "+e._s(e.$t("project.tag"))+" · "+e._s(e.projectTotal)+"\n    ")])]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"course"===e.currentTab,expression:"currentTab === 'course'"}]},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.viewCourses.length,expression:"viewCourses.length"}],staticClass:"course-list"},e._l(e.viewCourses,(function(t,o){return n("Row",{key:"row-index-"+o,staticStyle:{"margin-bottom":"16px"},attrs:{gutter:16}},e._l(t,(function(e,t){return n("Col",{key:"col-index-"+t,attrs:{span:"8"}},[n("CourseCard",{attrs:{course:e}})],1)})),1)})),1),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.viewCourses.length,expression:"viewCourses.length"}],staticClass:"pagination"},[n("Pagination",{attrs:{current:e.page,total:e.total,"page-size":e.pageSize,"show-elevator":"",transfer:""},on:{"update:current":function(t){e.page=t},"on-change":e.onPageChanged}})],1),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!e.viewCourses.length,expression:"!viewCourses.length"}],staticClass:"empty-wrapper"},[n("NoData",[e._v(e._s(e.$t("noData")))])],1)]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"project"===e.currentTab,expression:"currentTab === 'project'"}]},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.viewProjects.length,expression:"viewProjects.length"}],staticClass:"course-list"},e._l(e.viewProjects,(function(t,o){return n("Row",{key:"row-index-"+o,staticStyle:{"margin-bottom":"16px"},attrs:{gutter:16}},e._l(t,(function(e,t){return n("Col",{key:"col-index-"+t,attrs:{span:"8"}},[n("CourseCard",{attrs:{course:e}})],1)})),1)})),1),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.viewProjects.length,expression:"viewProjects.length"}],staticClass:"pagination"},[n("Pagination",{attrs:{current:e.projectPage,total:e.projectTotal,"page-size":e.projectPageSize,"show-elevator":"",transfer:""},on:{"update:current":function(t){e.projectPage=t},"on-change":e.onProjectPageChanged}})],1),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!e.viewProjects.length,expression:"!viewProjects.length"}],staticClass:"empty-wrapper"},[n("NoData",[e._v(e._s(e.$t("noData")))])],1)])])}),[],!1,null,"9ef9845c",null).exports,b=n(997204),_=(0,i.aZ)({name:"Search",setup:function(){var e=(0,i.iH)(b.Sc.RESOURCE),t=(0,i.iH)(""),n=(0,i.f3)("rmsServer");return{type:e,keyword:t,SearchType:b.Sc,searchHandle:function(){if(t.value)switch(e.value){case b.Sc.RESOURCE:return void window.open("".concat(n,"/search?keyword=").concat(t.value),"_blank");case b.Sc.COURSE:return void window.open("/user/courses?keyword=".concat(t.value),"_blank");case b.Sc.PROJECT:return void window.open("/user/project?keyword=".concat(t.value),"_blank");default:console.log(e)}}}}}),C=(0,d.Z)(_,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"search-wrapper"},[n("Select",{staticStyle:{width:"150px"},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},[n("Option",{attrs:{value:e.SearchType.RESOURCE}},[e._v(e._s(e.$t("learningSpace.search.resource")))]),e._v(" "),n("Option",{attrs:{value:e.SearchType.COURSE}},[e._v(e._s(e.$t("learningSpace.search.course")))]),e._v(" "),n("Option",{attrs:{value:e.SearchType.PROJECT}},[e._v(e._s(e.$t("project.tag")))])],1),e._v(" "),n("Input",{attrs:{size:"large",placeholder:e.$t("learningSpace.search.placeholder")},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}},[n("Button",{staticClass:"search-btn",attrs:{slot:"append",type:"primary"},on:{click:e.searchHandle},slot:"append"},[n("Icon",{attrs:{size:16,custom:"font font-standard-search"}}),e._v(" "),n("span",[e._v(e._s(e.$t("search")))])],1)],1)],1)}),[],!1,null,"622d1bfb",null).exports,k="user-sign-in-stats",x=n(117403),S=(0,i.aZ)({name:"StatCard",components:{SvgIcon:s.Z},setup:function(){var e=(0,i.f3)(k);return{learningTimeText:(0,i.Fl)((function(){var t=parseInt("".concat(e.value.visitSeconds/3600),10),n=e.value.visitSeconds%3600/60,o=parseInt("".concat(n),10),r=t<10?"0".concat(t):t,i=o<10?"0".concat(o):o;return x.default.t("signIn.durationFormat",[r,i])})),stats:e}}}),T=(0,d.Z)(S,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"stat-card"},[n("span",{staticClass:"title"},[e._v(e._s(e.$t("signIn.stats")))]),e._v(" "),n("div",{staticClass:"inner-card-wrapper"},[n("div",{staticClass:"card-wrapper"},[n("section",{staticClass:"row-1"},[n("SvgIcon",{attrs:{name:"clock"}}),e._v(" "),n("span",[e._v(e._s(e.learningTimeText))])],1),e._v(" "),n("section",{staticClass:"row-2"},[n("span",{staticClass:"time-text"},[e._v(e._s(e.$t("signIn.totalVisit")))]),e._v(" "),n("Tooltip",{attrs:{content:e.$t("signIn.totalVisitTip"),placement:"top",transfer:!0}},[n("SvgIcon",{staticClass:"help-icon",attrs:{name:"help"}})],1)],1)]),e._v(" "),n("div",{staticClass:"card-wrapper"},[n("section",{staticClass:"row-1"},[n("SvgIcon",{attrs:{name:"knowledge-node"}}),e._v(" "),n("span",[e._v(e._s(e.$t("signIn.knowledgeCount",[e.stats.learnedKnowledgeNodeCount])))])],1),e._v(" "),n("section",{staticClass:"row-2"},[n("span",{staticClass:"count-text"},[e._v(e._s(e.$t("signIn.totalLearnedKnowledgeCount")))]),e._v(" "),n("Tooltip",{attrs:{content:e.$t("signIn.totalLearnedKnowledgeCountTip"),placement:"top",transfer:!0}},[n("SvgIcon",{staticClass:"help-icon",attrs:{name:"help"}})],1)],1)])])])}),[],!1,null,"ad0945aa",null).exports,D=(n(132023),n(730381)),I=(0,i.aZ)({name:"Calendar",components:{SvgIcon:s.Z},setup:function(){var e=[{title:x.default.t("signIn.weekday.sun"),key:"week0",slot:"week0"},{title:x.default.t("signIn.weekday.mon"),key:"week1",slot:"week1"},{title:x.default.t("signIn.weekday.tue"),key:"week2",slot:"week2"},{title:x.default.t("signIn.weekday.wed"),key:"week3",slot:"week3"},{title:x.default.t("signIn.weekday.thu"),key:"week4",slot:"week4"},{title:x.default.t("signIn.weekday.fri"),key:"week5",slot:"week5"},{title:x.default.t("signIn.weekday.sat"),key:"week6",slot:"week6"}],t=(0,i.f3)(k),n=(0,i.iH)(D()),o=(0,i.iH)([]),r=function(e){var o=e.format("MM")===n.value.format("MM"),r=e.format("YYYY/MM/DD")===D().format("YYYY/MM/DD"),i=t.value.monthSignedInDates.includes(e.format("YYYY-MM-DD")),a=[];return o||a.push("gray-cell"),r&&a.push("primary-border"),i&&a.push("primary-bg"),a},a=function(){var e=n.value.clone(),t=e.clone().startOf("month"),i=e.clone().endOf("month").endOf("isoWeek"),a=t.isoWeekday(),s=t.clone();for(7!==a&&(s=t.clone().subtract(a,"day")),7===i.isoWeekday()&&i.month()!==t.month()&&(i=i.subtract(1,"day"));s.isSameOrBefore(i,"day");){for(var l=s,c={week0:{date:l.date(),text:l.format("YYYY/MM/DD"),cellClass:r(l)}},u=0;u<6;u++){var d=l.clone().add(u+1,"day");c["week".concat(u+1)]={date:d.date(),text:d.format("YYYY/MM/DD"),cellClass:r(d)}}s=s.add(7,"day"),o.value.push(c)}};(0,i.YP)(n,(function(){o.value=[],a()})),(0,i.YP)((function(){return t.value.monthSignedInDates}),(function(){o.value=[],a()}));return{columns:e,curDay:n,calendar:o,toNextMonth:function(){n.value=n.value.clone().add(1,"month")},toPrevMonth:function(){n.value=n.value.clone().subtract(1,"month")}}}}),E=(0,d.Z)(I,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"calendar-wrapper"},[n("div",{staticClass:"calender-header"},[n("Button",{attrs:{type:"default"},on:{click:e.toPrevMonth}},[n("SvgIcon",{attrs:{name:"left-triangle"}})],1),e._v("\n    "+e._s(e.$t("signIn.monthDate",[e.curDay.format("YYYY"),e.curDay.format("M")]))+"\n    "),n("Button",{attrs:{type:"default"},on:{click:e.toNextMonth}},[n("SvgIcon",{attrs:{name:"right-triangle"}})],1)],1),e._v(" "),n("Table",{staticClass:"calendar-table",attrs:{columns:e.columns,data:e.calendar,"disabled-hover":""},scopedSlots:e._u([{key:"week0",fn:function(t){var o=t.row;return[n("div",{staticClass:"date-item",class:o.week0.cellClass},[e._v(e._s(o.week0.date))])]}},{key:"week1",fn:function(t){var o=t.row;return[n("div",{staticClass:"date-item",class:o.week1.cellClass},[e._v(e._s(o.week1.date))])]}},{key:"week2",fn:function(t){var o=t.row;return[n("div",{staticClass:"date-item",class:o.week2.cellClass},[e._v(e._s(o.week2.date))])]}},{key:"week3",fn:function(t){var o=t.row;return[n("div",{staticClass:"date-item",class:o.week3.cellClass},[e._v(e._s(o.week3.date))])]}},{key:"week4",fn:function(t){var o=t.row;return[n("div",{staticClass:"date-item",class:o.week4.cellClass},[e._v(e._s(o.week4.date))])]}},{key:"week5",fn:function(t){var o=t.row;return[n("div",{staticClass:"date-item",class:o.week5.cellClass},[e._v(e._s(o.week5.date))])]}},{key:"week6",fn:function(t){var o=t.row;return[n("div",{staticClass:"date-item",class:o.week6.cellClass},[e._v(e._s(o.week6.date))])]}}])})],1)}),[],!1,null,"c8e738f4",null).exports,N=(0,i.aZ)({name:"SignInModal",components:{SvgIcon:s.Z},props:{show:Boolean},setup:function(e){var t=(0,i.iH)(!1),n=(0,i.f3)(k);(0,i.YP)((function(){return e.show}),(function(){t.value=e.show}));return{modal:t,onClose:function(){t.value=!1},stats:n}}}),$=(0,d.Z)(N,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Modal",{attrs:{width:480,transfer:""},scopedSlots:e._u([{key:"footer",fn:function(){return[n("Button",{attrs:{type:"primary"},on:{click:e.onClose}},[e._v(e._s(e.$t("signIn.knowit")))])]},proxy:!0}]),model:{value:e.modal,callback:function(t){e.modal=t},expression:"modal"}},[n("SvgIcon",{staticClass:"sign-in-bg",attrs:{name:"sign-in"}}),e._v(" "),n("div",{staticClass:"sign-in-tip"},[n("div",{staticClass:"sign-in-success"},[e._v(e._s(e.$t("signIn.signInSuccess")))]),e._v(" "),n("span",[e._v("\n      "+e._s(e.$t("signIn.signInDaysPrefix"))+"\n      "),n("span",{staticClass:"sign-in-count"},[e._v(e._s(e.stats.continueSignInCount))]),e._v("\n      "+e._s(e.$t("signIn.SignInDaysSuffix"))+"\n    ")])])],1)}),[],!1,null,"1b7b42da",null).exports,R=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},j=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},P=(0,i.aZ)({name:"SignInCard",components:{SignInModal:$,Calendar:E,SvgIcon:s.Z},setup:function(){var e=this,t=(0,i.f3)(k),n=(0,i.iH)(!1);return{onSignIn:function(){return R(e,void 0,void 0,(function(){return j(this,(function(e){switch(e.label){case 0:return[4,(0,v.ii)()];case 1:return e.sent(),n.value=!0,t.value.monthSignedInCount+=1,t.value.continueSignInCount+=1,t.value.monthSignedInDates.push(D().format("YYYY-MM-DD")),t.value.todaySignedIn=!0,[2]}}))}))},showModal:n,stats:t}}}),M=(0,d.Z)(P,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"sign-in-card-wrapper"},[n("span",{staticClass:"title"},[e._v(e._s(e.$t("signIn.signIn")))]),e._v(" "),n("div",{staticClass:"content-wrapper"},[n("div",{staticClass:"left-card-wrapper"},[e.stats.todaySignedIn?n("div",{staticClass:"card-wrapper"},[n("SvgIcon",{staticClass:"sign-in-check",attrs:{name:"check"}}),e._v(" "),n("span",{staticClass:"sign-in-success"},[e._v(e._s(e.$t("signIn.signedIn")))])],1):n("div",{staticClass:"card-wrapper"},[n("span",{staticClass:"card-tip"},[e._v(e._s(e.$t("signIn.notSignIn")))]),e._v(" "),n("Button",{staticClass:"card-button",attrs:{type:"primary"},on:{click:e.onSignIn}},[e._v(e._s(e.$t("signIn.toSignIn")))])],1),e._v(" "),n("div",{staticClass:"card-wrapper"},[n("span",{staticClass:"card-count"},[e._v(e._s(e.$t("signIn.signInDays",[e.stats.continueSignInCount])))]),e._v(" "),n("span",{staticClass:"card-text"},[e._v(e._s(e.$t("signIn.continueSignInDays")))])]),e._v(" "),n("div",{staticClass:"card-wrapper"},[n("span",{staticClass:"card-count"},[e._v(e._s(e.$t("signIn.signInDays",[e.stats.monthSignedInCount])))]),e._v(" "),n("span",{staticClass:"card-text"},[e._v(e._s(e.$t("signIn.monthSignedInDays")))])])]),e._v(" "),n("div",{staticClass:"right-card-wrapper"},[n("Calendar")],1)]),e._v(" "),n("SignInModal",{attrs:{show:e.showModal}})],1)}),[],!1,null,"233b8580",null).exports,O=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},G=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},A=(0,i.aZ)({name:"SignIn",components:{SignInCard:M,StatCard:T},setup:function(){var e=this,t=(0,i.iH)(new b.OW);return(0,i.JJ)(k,t),(0,i.bv)((function(){return O(e,void 0,void 0,(function(){var e;return G(this,(function(n){switch(n.label){case 0:return e=t,[4,(0,v.eR)()];case 1:return e.value=n.sent(),[2]}}))}))})),{data:t}}}),Z=(0,d.Z)(A,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"sign-in-board-wrapper"},[n("StatCard"),e._v(" "),n("SignInCard",{staticStyle:{"margin-left":"12px"}})],1)}),[],!1,null,"6dcf944e",null).exports,H=(n(747042),n(356264)),F=n(391737),B=n(576201),z=n(383228),L=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},U=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},V=(0,i.aZ)({name:"TaskItem",props:{task:{type:Object,required:!0}},setup:function(e){var t=this,n=(0,i.Fl)((function(){return"font-syllabus-".concat(e.task.type)})),o=(0,i.Fl)((function(){return 8===e.task.courseType}));return{activityIcon:n,onClickRow:function(){if(e.task.isLocked){var t=(0,F.useAngularScope)(),n=(0,a.cloneDeep)(e.task);return t.lockedActivity=(0,H.decamelizeKeys)(n),void z("#prerequisites-confirmation-popup").foundation("reveal","open")}"homework"===e.task.type?window.location.href="/course/".concat(e.task.courseId,"/learning-activity#/").concat(e.task.id):window.location.href="/course/".concat(e.task.courseId,"/learning-activity#/exam/").concat(e.task.id)},toDoTask:function(){return L(t,void 0,void 0,(function(){var t,n,o;return U(this,(function(r){switch(r.label){case 0:return e.task.isLocked?[2]:"homework"!==e.task.type?[3,2]:(o=(0,F.useAngularScope)(),[4,(0,v.K3)(e.task.id)]);case 1:return t=r.sent(),o.$emit("submitHomework",t),z("#submit-popup").foundation("reveal","open"),[3,4];case 2:return[4,(0,v.OM)(e.task.id)];case 3:0===(n=r.sent()).subjects_count?window.location.href="/course/".concat(e.task.courseId,"/learning-activity#/exam/").concat(e.task.id):(o=(0,F.useAngularScope)()).$broadcast("openExamStartPopup",n),r.label=4;case 4:return[2]}}))}))},TimeUtils:B.Z,fromProject:o}}}),q=(0,d.Z)(V,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"task-item-wrapper",on:{click:e.onClickRow}},[n("div",{staticClass:"icon-wrapper"},[n("i",{staticClass:"font",class:e.activityIcon}),e._v(" "),n("span",{staticClass:"item-type"},[e._v(e._s(e.$t("activityType."+e.task.type)))])]),e._v(" "),n("div",{staticClass:"content-wrapper"},[n("div",{staticClass:"task-title"},[n("Tooltip",{attrs:{content:e.task.title,placement:"top",transfer:""}},[e._v("\n        "+e._s(e.task.title)+"\n      ")])],1),e._v(" "),n("div",{staticClass:"task-info"},[n("div",[e._v(e._s(e.fromProject?e.$t("todoList.fromProject"):e.$t("todoList.from"))+"：")]),e._v(" "),n("div",{staticClass:"course-name"},[n("Tooltip",{attrs:{content:e.task.courseName,placement:"top",transfer:""}},[e._v("\n          "+e._s(e.task.courseName)+"\n        ")])],1),e._v(" "),n("Divider",{attrs:{type:"vertical"}}),e._v(" "),n("div",{staticClass:"item-time"},[e._v("\n        "+e._s(e.$t("todoList.ddl"))+"："+e._s(e.task.endTime?e.TimeUtils.formatDatetime(e.task.endTime,"YYYY.MM.DD HH:mm"):"--")+"\n      ")])],1)]),e._v(" "),e.task.notScoredNum?e._e():n("div",{staticClass:"operation-wrapper"},[e.task.isLocked?n("div",{staticClass:"activity-lock"},[n("i",{staticClass:"font font-thin-lock"})]):n("Button",{attrs:{type:"primary",classs:"operation-button"},on:{click:function(t){return t.stopPropagation(),e.toDoTask(t)}}},[e._v("\n      "+e._s(e.$t("todoList.goto."+e.task.type))+"\n    ")])],1)])}),[],!1,null,"4f358f3f",null).exports,Y=(0,i.aZ)({name:"TaskList",components:{TaskItem:q,Pagination:f.Z},props:{tasks:{type:Array,required:!0}},setup:function(e){var t=(0,i.iH)(1),n=(0,i.iH)(10),o=(0,i.Fl)((function(){return e.tasks.length}));return{pageTasks:(0,i.Fl)((function(){return e.tasks.slice((t.value-1)*n.value,t.value*n.value)})),page:t,pageSize:n,total:o,onPageChanged:function(e){t.value=e}}}}),K=(0,d.Z)(Y,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"task-list-wrapper"},[e._l(e.pageTasks,(function(e){return n("TaskItem",{key:e.type+"-"+e.id,attrs:{task:e}})})),e._v(" "),n("div",{staticClass:"pagination"},[n("Pagination",{attrs:{current:e.page,total:e.total,"page-size":e.pageSize,"show-elevator":"",transfer:""},on:{"update:current":function(t){e.page=t},"on-change":e.onPageChanged}})],1)],2)}),[],!1,null,null,null).exports,W=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},J=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},X=(0,i.aZ)({name:"Tasks",components:{NoData:h.Z,TaskList:K},setup:function(){var e,t=this,n=(0,i.iH)("homework"),o=(0,i.iH)([]),r=(0,i.Fl)((function(){return o.value.filter((function(e){return"homework"===e.type}))})),s=(0,i.Fl)((function(){return o.value.filter((function(e){return"exam"===e.type}))})),l=(0,i.Fl)((function(){return"homework"===n.value?r.value:s.value})),c=function(){return W(t,void 0,void 0,(function(){var e;return J(this,(function(t){switch(t.label){case 0:return[4,(0,v.hy)()];case 1:return e=t.sent(),o.value=(0,a.sortBy)(e,(function(e){return e.endTime})),[2]}}))}))};return(0,i.bv)((function(){return W(t,void 0,void 0,(function(){return J(this,(function(t){switch(t.label){case 0:return[4,c()];case 1:return t.sent(),setTimeout((function(){var t=(0,F.useAngularScope)();e=t.$on("homeworkSubmitted",(function(){c()}))}),100),[2]}}))}))})),(0,i.Jd)((function(){e&&e()})),{currentTab:n,handleChangeTab:function(e){n.value=e},homeworks:r,exams:s,tasks:l}}}),Q=(0,d.Z)(X,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"task-wrapper"},[n("div",{staticClass:"header-wrapper"},[e._v(e._s(e.$t("todoList.title")))]),e._v(" "),n("div",{staticClass:"body-wrapper"},[n("div",{staticClass:"tabs-wrapper"},[n("div",{staticClass:"tab",class:"homework"===e.currentTab?"active":"",on:{click:function(t){return e.handleChangeTab("homework")}}},[e._v("\n        "+e._s(e.$t("activityType.homework"))+" · "+e._s(e.homeworks.length)+"\n      ")]),e._v(" "),n("div",{staticClass:"tab",class:"exam"===e.currentTab?"active":"",on:{click:function(t){return e.handleChangeTab("exam")}}},[e._v("\n        "+e._s(e.$t("activityType.exam"))+" · "+e._s(e.exams.length)+"\n      ")])]),e._v(" "),e.tasks.length?n("div",{staticClass:"content-wrapper"},[n("TaskList",{attrs:{tasks:e.tasks}})],1):n("div",{staticClass:"empty-wrapper"},[n("NoData",[e._v("\n        "+e._s(e.$t("noData"))+"\n      ")])],1)])])}),[],!1,null,"4dcb838f",null).exports,ee=(0,i.aZ)({name:"LearningSpace",props:{rmsServer:{type:String,required:!0}},components:{Search:C,SignIn:Z,CourseList:w,TaskList:Q},setup:function(e){return(0,i.JJ)("rmsServer",e.rmsServer),{}}}),te=(0,d.Z)(ee,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("Search",{staticClass:"item"}),e._v(" "),n("SignIn",{staticClass:"item"}),e._v(" "),n("CourseList",{staticClass:"item"}),e._v(" "),n("TaskList",{staticClass:"item"})],1)}),[],!1,null,"4cd2dad0",null).exports;o.default.use(r.default),o.default.customElement("learning-space",te)},638828:function(e,t,n){"use strict";n.r(t);var o,r=n(370538),i=n(285256),a=n(925706),s=n(243407),l=(n(788674),new(n(578345).Z)({routes:[{path:"/",component:function(){return n.e(62071).then(n.bind(n,562071))},name:"my-projects"},{path:"/all",name:"all-projects",component:function(){return n.e(49529).then(n.bind(n,549529))}}]})),c=(0,a.aZ)({name:"project-index",router:l,setup:function(){var e=(0,s.tv)().route;return{activeName:(0,a.Fl)((function(){return e.value.matched.length?e.value.matched[0].name:""}))}}}),u=n(551900),d=(0,u.Z)(c,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("Menu",{staticClass:"menu",attrs:{mode:"horizontal","active-name":e.activeName}},[n("MenuItem",{attrs:{name:"my-projects",to:"/"}},[e._v(e._s(e.$t("project.myProject")))]),e._v(" "),n("MenuItem",{attrs:{name:"all-projects",to:"/all"}},[e._v(e._s(e.$t("project.allProject")))])],1),e._v(" "),n("div",{staticClass:"content-wrapper"},[n("router-view")],1)],1)}),[],!1,null,"33a3eac9",null).exports,p=(n(141817),n(66992),n(333948),n(191882)),f=n.n(p),v=n(570345),h=n(117403),m=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},g=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},y=(0,a.aZ)({name:"CreateModal",setup:function(e,t){var n=this,o=(0,a.qj)({name:""}),r={name:[{required:!0,message:h.default.t("fieldRequired"),trigger:"blur"}]};return{projectImg:f(),project:o,projectRule:r,onCreate:function(){return m(n,void 0,void 0,(function(){var e,n=this;return g(this,(function(r){return(null===(e=t.refs)||void 0===e?void 0:e.validateRef).validate((function(e){return m(n,void 0,void 0,(function(){var t,n;return g(this,(function(r){switch(r.label){case 0:return e?[4,(0,v.$L)(o.name)]:[3,2];case 1:t=r.sent(),n=t.data.id,window.location.href="/course/".concat(n,"/resource"),r.label=2;case 2:return[2]}}))}))})),[2]}))}))}}}}),w=(0,u.Z)(y,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"project-add-wrapper"},[n("div",{staticClass:"bg"},[n("img",{attrs:{src:e.projectImg,alt:"imgs",width:"410px",height:"295px"}})]),e._v(" "),n("div",{staticClass:"content"},[n("Form",{ref:"validateRef",staticStyle:{width:"350px"},attrs:{model:e.project,rules:e.projectRule,"label-width":110}},[n("FormItem",{attrs:{prop:"name",label:e.$t("project.name")}},[n("Input",{attrs:{type:"text",placeholder:e.$t("project.createTip"),maxlength:100},model:{value:e.project.name,callback:function(t){e.$set(e.project,"name",t)},expression:"project.name"}})],1)],1),e._v(" "),n("div",{staticClass:"form-submit"},[n("Button",{staticClass:"button",attrs:{type:"primary"},on:{click:e.onCreate}},[e._v(e._s(e.$t("ok")))])],1)],1)])}),[],!1,null,"bc3885c4",null).exports,b=(n(132023),n(966309)),_=(0,a.aZ)({name:"DetailModal",props:{value:{type:Boolean,default:!1},project:{type:Object,default:null},canEdit:{type:Boolean,default:!1}},emits:["onEditProject"],setup:function(e,t){var n=t.emit,o=(0,b.NCN)(e,"value",n,{eventName:"input"});return{show:o,onEdit:function(){o.value=!1,n("onEditProject")}}}}),C=(0,u.Z)(_,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("Modal",{staticClass:"project-detail-modal",attrs:{title:e.$t("project.basic"),"footer-hide":"",width:800},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[n("Form",{attrs:{model:e.project,"label-width":150}},[n("FormItem",{staticClass:"name-row",attrs:{prop:"name",label:e.$t("project.name"),required:""}},[n("Tooltip",{attrs:{content:e.project.name,placement:"top-start",transfer:""}},[n("div",{staticClass:"form-item text-item"},[e._v(e._s(e.project.name))])]),e._v(" "),e.canEdit?n("Button",{staticClass:"edit-btn",attrs:{type:"default",size:"small"},on:{click:e.onEdit}},[e._v(e._s(e.$t("edit")))]):e._e()],1),e._v(" "),n("FormItem",{attrs:{prop:"description",label:e.$t("project.description")}},[n("div",{staticClass:"description form-item"},[e._v(e._s(e.project.description))])])],1)],1)],1)}),[],!1,null,null,null).exports,k=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},x=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},S=(0,a.aZ)({name:"EditModal",props:{value:{type:Boolean,default:!1},project:{type:Object,default:function(){},required:!0}},emits:["onUpdateProject"],setup:function(e,t){var n=this,o=(0,b.NCN)(e,"value",t.emit,{eventName:"input"}),r=(0,a.iH)({name:"",description:""});(0,a.YP)((function(){return e.value}),(function(){r.value.name=e.project.name,r.value.description=e.project.description}));var i={name:[{required:!0,message:h.default.t("project.createTip"),trigger:"blur"}]};return{show:o,form:r,handleSubmit:function(){return k(n,void 0,void 0,(function(){var n,i=this;return x(this,(function(a){return(null===(n=t.refs)||void 0===n?void 0:n.validateRef).validate((function(n){return k(i,void 0,void 0,(function(){var i,a;return x(this,(function(s){switch(s.label){case 0:if(!n||!e.project.id)return[3,4];s.label=1;case 1:return s.trys.push([1,3,,4]),[4,(0,v.ty)(e.project.id,{name:r.value.name,description:r.value.description})];case 2:return i=s.sent(),o.value=!1,t.emit("onUpdateProject",i),[3,4];case 3:return a=s.sent(),console.log("err",a),[3,4];case 4:return[2]}}))}))})),[2]}))}))},rule:i,onVisibleChange:function(e){var n;e||(null===(n=t.refs)||void 0===n?void 0:n.validateRef).resetFields()}}}}),T=(0,u.Z)(S,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("Modal",{staticClass:"project-edit-modal",attrs:{title:e.$t("project.editBasic"),width:800,"mask-closable":!1},on:{"on-visible-change":e.onVisibleChange},scopedSlots:e._u([{key:"footer",fn:function(){return[n("Button",{staticClass:"cancel-btn",on:{click:function(t){e.show=!1}}},[e._v(e._s(e.$t("cancel")))]),e._v(" "),n("Button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v(e._s(e.$t("ok")))])]},proxy:!0}]),model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[n("Form",{ref:"validateRef",attrs:{model:e.form,"label-width":150,rules:e.rule}},[n("FormItem",{attrs:{prop:"name",label:e.$t("project.name")}},[n("Input",{attrs:{maxlength:100},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),n("FormItem",{attrs:{prop:"description",label:e.$t("project.description")}},[n("Input",{attrs:{type:"textarea",rows:10,maxlength:5e3,placeholder:e.$t("project.descTip"),"show-word-limit":""},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1)],1)],1)],1)}),[],!1,null,null,null).exports,D=n(524137),I=((0,a.iH)(0),(0,a.iH)(new D.IK)),E=null===(o=window.globalData)||void 0===o?void 0:o.user.id,N=((0,a.Fl)((function(){return I.value.owners.filter((function(e){return e.id===E})).length>0})),(0,a.aZ)({name:"ProjectHeader",components:{EditModal:T,DetailModal:C},props:{course:{type:Object}},setup:function(e){var t,n=(0,a.iH)(!1),o=(null===(t=window.globalData)||void 0===t?void 0:t.courseRoles)&&window.globalData.courseRoles[0].includes("student"),r=(0,a.iH)();(0,a.YP)((function(){return e.course}),(function(){e.course&&(r.value={id:e.course.id,name:e.course.name,description:e.course.classroom_schedule,owners:e.course.instructors.map((function(e){return{id:e.id,name:e.name,userNo:e.user_no}}))})}));var i=(0,a.Fl)((function(){return r.value.owners.filter((function(e){return e.id===E})).length>0})),s=(0,a.iH)(!1);return{goBack:function(){window.location.href="/user/project"},onEdit:function(){n.value=!0},project:r,showDetail:s,onOpenDetail:function(){s.value=!0},showEditModal:n,onUpdateProject:function(e){r.value.name=e.name,r.value.description=e.description},canEditCurrentProject:i,isStudent:o,toEnrollment:function(){e.course&&(window.location.href="/course/".concat(e.course.id,"/enrollments"))},toAnalysis:function(){e.course&&(window.location.href="/course/".concat(e.course.id,"/my-stat"))}}}})),$=(0,u.Z)(N,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.project?n("div",{staticClass:"project-header-wrapper"},[n("div",{staticClass:"row"},[n("div",{staticClass:"project-title"},[n("a",{staticClass:"go-back-link",on:{click:e.goBack}},[n("i",{staticClass:"font font-arrow-left"}),e._v(" "),n("span",[e._v(e._s(e.$t("goBack")))])]),e._v(" "),n("div",{staticClass:"title item"},[n("Tooltip",{directives:[{name:"ellipsis",rawName:"v-ellipsis"}],attrs:{content:e.project.name,placement:"top",transfer:""}},[n("span",[e._v(e._s(e.project.name))])])],1),e._v(" "),n("div",{staticClass:"project-tag item"},[e._v(e._s(e.$t("project.tag")))]),e._v(" "),e.canEditCurrentProject?n("a",{staticClass:"button small edit",on:{click:e.onEdit}},[n("i",{staticClass:"font font-edit"}),e._v("\n        "+e._s(e.$t("edit"))+"\n      ")]):e._e()]),e._v(" "),n("div",{staticClass:"second-row"},[e.project.description?n("div",{staticClass:"description-wrapper"},[n("span",{staticClass:"project-description"},[e._v(e._s(e.project.description))]),e._v(" "),n("a",{staticClass:"btn",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.onOpenDetail(t)}}},[e._v(e._s(e.$t("project.detail"))+">")])]):e._e(),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.isStudent,expression:"isStudent"}],staticClass:"button-area"},[n("Button",{attrs:{type:"text"},on:{click:e.toEnrollment}},[n("i",{staticClass:"course-menu-icon font font-members-menu"}),e._v("\n          "+e._s(e.$t("project.refactor.enrollment"))+"\n        ")]),e._v(" "),n("Button",{attrs:{type:"text"},on:{click:e.toAnalysis}},[n("i",{staticClass:"course-menu-icon font font-learning-analysis"}),e._v("\n          "+e._s(e.$t("stat"))+"\n        ")])],1)])]),e._v(" "),n("DetailModal",{attrs:{project:e.project,"can-edit":e.canEditCurrentProject},on:{onEditProject:e.onEdit},model:{value:e.showDetail,callback:function(t){e.showDetail=t},expression:"showDetail"}}),e._v(" "),n("EditModal",{attrs:{project:e.project},on:{onUpdateProject:e.onUpdateProject},model:{value:e.showEditModal,callback:function(t){e.showEditModal=t},expression:"showEditModal"}})],1):e._e()}),[],!1,null,"4de0e745",null).exports,R=(n(747042),n(339714),n(453432)),j=n(356264),P=n(154803),M=n(661510),O=(n(323123),n(48496)),G=n(992665),A=n(863296),Z=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},H=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},F=(0,a.aZ)({name:"ReferenceEditModal",props:{value:{type:Boolean,required:!0},uploads:{type:Array,required:!0},knowledgeNodeIds:{type:String,default:""},isEdit:{type:Boolean,default:!1},uploadReferenceId:{type:Number,default:0},allowDownload:{type:String,default:"false"}},components:{KnowledgeNodeSetting:G.Z},emits:["onBack","onCreateFinish"],setup:function(e,t){var n,o,r=this,i=(0,b.NCN)(e,"value",t.emit,{eventName:"input"}),s=(0,a.iH)({name:"",allowDownload:"false"}),l=(0,a.Fl)((function(){return 1===e.uploads.length})),c=null===(o=null===(n=window.globalData)||void 0===n?void 0:n.user)||void 0===o?void 0:o.orgId,u=(0,a.iH)([]),d=(0,a.iH)(!1),p=(0,a.Fl)((function(){return l.value?(0,O.fileTypeByExtension)(e.uploads[0]):""})),f={name:[{required:!0,message:h.default.t("fieldRequired"),trigger:"blur"}]};(0,a.YP)((function(){return e.uploads}),(function(){s.value.name=l.value?e.uploads[0].name:"",s.value.type=l.value?e.uploads[0].type:"",e.isEdit&&(s.value.allowDownload=e.allowDownload)}));var m=(0,a.f3)("projectId"),g=function(){return Z(r,void 0,void 0,(function(){var t;return H(this,(function(n){switch(n.label){case 0:return t={resource_new_name:s.value.name,allow_download:s.value.allowDownload,uploads:e.uploads.map((function(e){return e.id})),node_ids:u.value},[4,(0,v.Q_)(m,t)];case 1:return n.sent(),u.value=[],[2]}}))}))},y=function(){return Z(r,void 0,void 0,(function(){var t;return H(this,(function(n){switch(n.label){case 0:return t={resource_new_name:s.value.name,allow_download:s.value.allowDownload,uploads:e.uploads.map((function(e){return e.id})),node_ids:u.value.length>0||d.value?u.value:e.knowledgeNodeIds.split(",").filter(Boolean),reference_id:e.uploadReferenceId},[4,(0,v.Aj)(m,t)];case 1:return n.sent(),d.value=!1,u.value=[],[2]}}))}))},w=(0,a.Fl)((function(){return!e.isEdit&&l.value&&!e.uploads[0].allow_download})),_=(0,a.Fl)((function(){return e.isEdit?h.default.t("project.resource.edit"):h.default.t("project.resource.editBasic")}));return(0,a.YP)((function(){return i.value}),(function(){i.value&&A.Z.$emit("refreshNodesInfo")})),{show:i,model:s,singleFile:l,singleFileType:p,onSubmit:function(){return Z(r,void 0,void 0,(function(){var n,o=this;return H(this,(function(r){switch(r.label){case 0:return l.value?[3,5]:e.isEdit?[4,y()]:[3,2];case 1:return r.sent(),[3,4];case 2:return[4,g()];case 3:r.sent(),r.label=4;case 4:return i.value=!1,t.emit("onCreateFinish"),[2];case 5:return(null===(n=t.refs)||void 0===n?void 0:n.validateRef).validate((function(n){return Z(o,void 0,void 0,(function(){return H(this,(function(o){switch(o.label){case 0:return n?e.isEdit?[4,y()]:[3,2]:[3,5];case 1:return o.sent(),[3,4];case 2:return[4,g()];case 3:o.sent(),o.label=4;case 4:i.value=!1,t.emit("onCreateFinish"),o.label=5;case 5:return[2]}}))}))})),[2]}}))}))},goBack:function(){i.value=!1,t.emit("onBack")},rules:f,disableDownloadOption:w,getSelectedNodes:function(e){d.value=!0,u.value=O._.map(e,(function(e){return e.id}))},orgId:c,projectId:m,knowledgeGraphToggle:window.featureToggles.knowledgeGraph,title:_,onCancel:function(){i.value=!1}}}}),B=(0,u.Z)(F,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Modal",{staticClass:"project-resource-modal",attrs:{title:e.title,width:500,"mask-closable":!1},scopedSlots:e._u([{key:"footer",fn:function(){return[n("Button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v(e._s(e.$t("ok")))]),e._v(" "),e.isEdit?n("Button",{staticClass:"cancel-btn",on:{click:e.onCancel}},[e._v(e._s(e.$t("cancel")))]):n("Button",{staticClass:"cancel-btn",on:{click:e.goBack}},[e._v(e._s(e.$t("prev_step")))])]},proxy:!0}]),model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[n("Form",{ref:"validateRef",attrs:{"label-width":100,model:e.model,rules:e.rules}},[n("FormItem",{directives:[{name:"show",rawName:"v-show",value:e.singleFile,expression:"singleFile"}],attrs:{label:e.$t("project.resource.name"),prop:"name"}},[n("Input",{attrs:{maxlength:100},model:{value:e.model.name,callback:function(t){e.$set(e.model,"name",t)},expression:"model.name"}})],1),e._v(" "),n("FormItem",{directives:[{name:"show",rawName:"v-show",value:e.singleFile,expression:"singleFile"}],attrs:{label:e.$t("project.resource.type")}},[n("div",{staticClass:"resource-type"},[n("i",{class:["font","font-file-"+e.singleFileType]}),e._v(" "),n("span",[e._v(e._s(e.uploads.length>0?e.$t("resourceType."+e.uploads[0].type):""))])])]),e._v(" "),n("FormItem",{attrs:{label:e.$t("project.resource.downloadSetting")}},[n("RadioGroup",{model:{value:e.model.allowDownload,callback:function(t){e.$set(e.model,"allowDownload",t)},expression:"model.allowDownload"}},[n("Radio",{attrs:{label:"false"}},[n("span",[e._v(e._s(e.$t("project.resource.disallowDownload")))])]),e._v(" "),n("Radio",{attrs:{label:"true",disabled:e.disableDownloadOption}},[n("span",[e._v(e._s(e.$t("project.resource.allowDownload")))])])],1)],1),e._v(" "),e.knowledgeGraphToggle?n("FormItem",{attrs:{label:e.$t("knowledgeGraph.node")}},[n("KnowledgeNodeSetting",{attrs:{"org-id":e.orgId,"course-id":e.projectId,"knowledge-node-ids":e.knowledgeNodeIds},on:{"after-selected-nodes":e.getSelectedNodes}})],1):e._e()],1)],1)}),[],!1,null,null,null).exports,z=n(769700),L=n(922942),U=n(391737),V=n(534662),q=n(383228),Y=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},K=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},W=(0,a.aZ)({name:"ProjectResourceList",components:{KnowledgeNodeTag:V.Z,ReferenceEditModal:B,Confirm:R.Z,NoData:z.Z,Pagination:M.Z},props:{course:{type:Object}},setup:function(e){var t,n,o,r=this,i=(0,a.iH)(!1),s=(0,a.iH)([]),l=(0,a.iH)([{name:h.default.t("all"),value:null}]),c=null===(n=null===(t=window.globalData)||void 0===t?void 0:t.course)||void 0===n?void 0:n.id;(0,a.JJ)("projectId",c);var u=(0,a.iH)(!1),d=(0,a.iH)(0),p=(0,a.iH)(""),f=(0,a.iH)(0),m=(0,a.iH)([]),g=(0,a.iH)(!1),y=(0,a.iH)("false");window.inProjectPage=!0;var w=null===(o=window.globalData)||void 0===o?void 0:o.user.id,_=(0,a.iH)({keyword:"",refParentId:null}),C=(0,a.iH)(new D.IK),k=(0,a.iH)([]),x=(0,a.iH)(""),S=(0,a.Fl)((function(){var e,t;return(null===(e=window.globalData)||void 0===e?void 0:e.courseRoles.length)&&(null===(t=window.globalData)||void 0===t?void 0:t.courseRoles[0].includes("instructor"))})),T=(0,L.Ef)((function(){return Y(r,void 0,void 0,(function(){return K(this,(function(e){return[2,(0,v.JV)(c,_.value)]}))}))})),I=(0,a.Fl)((function(){var e=[{title:h.default.t("project.resource.name"),slot:"name",sortable:"custom",key:"name"},{title:h.default.t("project.resource.knowledgeNode"),slot:"knowledge",width:100},{title:h.default.t("project.resource.size"),slot:"size",width:200,sortable:"custom",key:"size"},{title:h.default.t("project.resource.downloadSetting"),width:200,slot:"download"},{title:h.default.t("project.resource.operation"),slot:"operation",width:150}];return(0,O.reBuildColumns)(e,[{name:"download",isShow:S.value},{name:"knowledge",isShow:window.featureToggles.knowledgeGraph}])})),E=function(){return Y(r,void 0,void 0,(function(){return K(this,(function(e){switch(e.label){case 0:return T.data.page=1,[4,T.fetch()];case 1:return e.sent(),k.value=T.data.totalItems,[2]}}))}))};(0,b.ORN)(window,"filesSelected",(function(e){return Y(r,void 0,void 0,(function(){return K(this,(function(t){return function(e){q("#file-select").foundation("reveal","close"),s.value=e.detail,x.value="",i.value=!0}(e),[2]}))}))}));return(0,a.YP)((function(){return e.course}),(function(){e.course&&(C.value={id:e.course.id,name:e.course.name,description:e.course.classroom_schedule,owners:e.course.instructors.map((function(e){return{id:e.id,name:e.name,userNo:e.user_no}}))})})),(0,a.bv)((function(){return Y(r,void 0,void 0,(function(){return K(this,(function(e){switch(e.label){case 0:return[4,T.fetch()];case 1:return e.sent(),k.value=T.data.totalItems,[2]}}))}))})),{project:C,conditions:_,reFetch:E,openFileSelector:function(){var e=(0,U.useAngularService)("fileSelectModel"),t=O._.map(k.value,(function(e){return e.upload.id}));e.selectedIds=t,e.disabledIds=t,q("#file-select").foundation("reveal","open")},showRefEditModal:i,selectUploads:s,breadCrumbItems:l,goToFolder:function(e){_.value.refParentId=e,l.value=O._.slice(l.value,0,O._.findIndex(l.value,["value",e])+1),E()},columns:I,pagination:T,preview:function(e){if("folder"===e.upload.type)return _.value.refParentId=e.id,l.value.push({name:e.name,value:e.id}),void E();var t=(0,j.decamelizeKeys)(e.upload);t.allow_download=e.allowDownload||e.createdById===w&&e.upload.allowDownload,t.project_id=c,t.from_project=!0,t.ref_id=e.id,t.referId=c,t.referType="project";var n=O._.map(e.knowledgeNodes,(function(e){return e.id})).join(",");t.node_ids=n,(0,U.useAngularScope)().$broadcast("previewFile",t),q("#file-previewer").foundation("reveal","open")},destory:function(){var e={reference_id:d.value,upload_id:f.value,node_ids:m.value};(0,v.LT)(c,e).then((function(){return Y(r,void 0,void 0,(function(){return K(this,(function(e){switch(e.label){case 0:return O.Toast.success(h.default.t("delete_success")),[4,T.fetch()];case 1:return e.sent(),k.value=T.data.totalItems,[2]}}))}))})).catch((function(){O.Toast.error(h.default.t("delete_error"))}))},download:function(e){var t=O._.map(e.knowledgeNodes,(function(e){return e.id})).join(","),n="/api/project/".concat(c,"/share-resource/blob?reference_id=").concat(e.id,"&upload_id=").concat(e.upload.id,"&node_ids=").concat(t);window.open(n,"_self")},pageSizeOptions:[10,20,30,50,100],onSortChange:function(e){_.value.order="".concat(e.key,",").concat(e.order),E()},showDeleteModal:u,onDeleteConfirm:function(e){p.value=h.default.t("project.resource.deleteConfirm"),e.knowledgeNodes.length>0&&(p.value="".concat(h.default.t("project.resource.deleteConfirm")).concat(h.default.t("project.resource.deleteTip")),m.value=O._.map(e.knowledgeNodes,(function(e){return e.id}))),f.value=e.upload.id,u.value=!0,d.value=e.id},canDownload:function(e){return P.wZ||e.allowDownload||e.createdById===w&&e.upload.allowDownload},canDelete:function(e){return e.createdById===w&&!P.dE},canUpload:S,canEdit:function(e){return P.wZ&&"folder"!==e.upload.type},openEdit:function(e){s.value=[e.upload],x.value=O._.map(e.knowledgeNodes,(function(e){return e.id})).join(","),g.value=!0,d.value=e.id,y.value=e.allowDownload.toString(),i.value=!0},knowledgeNodeIds:x,deleteMessage:p,isEdit:g,selectedRowId:d,selectAllowDownload:y}}}),J=(0,u.Z)(W,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"toolbar-wrapper"},[e.canUpload&&e.breadCrumbItems.length<=1?n("Button",{attrs:{type:"primary"},on:{click:e.openFileSelector}},[n("i",{staticClass:"font font-add-new-elem"}),e._v("\n      "+e._s(e.$t("project.resource.add"))+"\n    ")]):e._e(),e._v(" "),n("div",{staticClass:"search-wrapper"},[n("Input",{staticStyle:{width:"170px"},attrs:{placeholder:e.$t("project.resource.name")},on:{"on-enter":e.reFetch},model:{value:e.conditions.keyword,callback:function(t){e.$set(e.conditions,"keyword",t)},expression:"conditions.keyword"}}),e._v(" "),n("Button",{attrs:{type:"default"},on:{click:e.reFetch}},[e._v(e._s(e.$t("search")))])],1)],1),e._v(" "),n("div",{staticClass:"resource-wrapper"},[e.breadCrumbItems.length>1?n("Breadcrumb",{staticClass:"bread-crumb-custom",attrs:{separator:">"}},e._l(e.breadCrumbItems,(function(t,o){return n("BreadcrumbItem",{key:o},[n("a",{on:{click:function(n){return e.goToFolder(t.value)}}},[e._v(e._s(t.name))])])})),1):e._e(),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.pagination.data.items.length>0,expression:"pagination.data.items.length > 0"}],staticClass:"resource-list"},[n("Table",{attrs:{columns:e.columns,data:e.pagination.data.items,loading:e.pagination.isLoading.value},on:{"on-sort-change":e.onSortChange},scopedSlots:e._u([{key:"name",fn:function(t){var o=t.row;return[n("div",{staticClass:"resource-name",on:{click:function(t){return e.preview(o)}}},[n("i",{directives:[{name:"upload-font",rawName:"v-upload-font",value:o.upload,expression:"row.upload"}]}),e._v(" "),n("div",{staticClass:"name-text"},[n("Tooltip",{directives:[{name:"ellipsis",rawName:"v-ellipsis"}],attrs:{transfer:"",content:o.name}},[n("span",[e._v(e._s(o.name))])])],1)])]}},{key:"knowledge",fn:function(t){var o=t.row;return[o.knowledgeNodes.length>0?n("Tooltip",{attrs:{"transfer-class-name":"node-reference-tooltip",placement:"top",trigger:"hover",transfer:"",delay:200,theme:"light"}},[n("span",{staticClass:"reference-count"},[e._v(e._s(o.knowledgeCount))]),e._v(" "),n("div",{staticClass:"node-reference-content",attrs:{slot:"content"},slot:"content"},[n("div",{staticClass:"reference-title"},[e._v(e._s(e.$t("knowledgeGraph.node")))]),e._v(" "),n("div",{staticClass:"reference-node-list"},e._l(o.knowledgeNodes,(function(e){return n("KnowledgeNodeTag",{key:"node-reference-"+e.id,attrs:{"course-id":e.courseId,"node-id":e.id,content:e.name,transfer:!0,"go-to-graph":!0,size:"medium"}})})),1)])]):n("span",{staticClass:"reference-count"},[e._v(e._s(o.knowledgeCount))])]}},{key:"size",fn:function(t){var o=t.row;return["folder"===o.upload.type?n("span",[e._v("--")]):n("span",[e._v(e._s(e._f("humanizeBytes")(o.upload.size)))])]}},{key:"download",fn:function(t){var o=t.row;return[n("span",[e._v(e._s(o.allowDownload?e.$t("project.resource.allow"):e.$t("project.resource.disallow")))])]}},{key:"operation",fn:function(t){var o=t.row;return[n("div",{staticClass:"operation-area"},[n("Tooltip",{staticClass:"op-item",attrs:{transfer:"",content:e.$t("view"),placement:"top"}},[n("i",{staticClass:"font font-resource-view",on:{click:function(t){return t.stopPropagation(),e.preview(o)}}})]),e._v(" "),e.canEdit(o)?n("Tooltip",{staticClass:"op-item",attrs:{transfer:"",content:e.$t("edit"),placement:"top"}},[n("i",{staticClass:"font font-edit",on:{click:function(t){return t.stopPropagation(),e.openEdit(o)}}})]):e._e(),e._v(" "),e.canDownload(o)?n("Tooltip",{staticClass:"op-item",attrs:{transfer:"",content:e.$t("download"),placement:"top"}},[n("i",{staticClass:"font font-table-edit-download",on:{click:function(t){return t.stopPropagation(),e.download(o)}}})]):e._e(),e._v(" "),e.canDelete(o)?n("Tooltip",{staticClass:"op-item",attrs:{transfer:"",content:e.$t("delete"),placement:"top"}},[n("i",{staticClass:"font font-delete",on:{click:function(t){return t.stopPropagation(),e.onDeleteConfirm(o)}}})]):e._e()],1)]}}])}),e._v(" "),e.pagination.data.items.length>0?n("div",{staticClass:"pagination"},[n("Pagination",{attrs:{total:e.pagination.data.total,"page-size":e.pagination.data.pageSize,current:e.pagination.data.page,"page-size-opts":e.pageSizeOptions,"show-elevator":"",transfer:"","show-sizer":""},on:{"on-change":e.pagination.pageChanged,"on-page-size-change":e.pagination.pageSizeChanged}})],1):e._e()],1),e._v(" "),0===e.pagination.data.items.length?n("div",{staticClass:"empty-wrapper"},[n("NoData",[e._v(e._s(e.$t("project.resource.noData")))])],1):e._e()],1),e._v(" "),n("ReferenceEditModal",{attrs:{uploads:e.selectUploads,"knowledge-node-ids":e.knowledgeNodeIds,"is-edit":e.isEdit,"upload-reference-id":e.selectedRowId,"allow-download":e.selectAllowDownload},on:{onBack:e.openFileSelector,onCreateFinish:e.reFetch},model:{value:e.showRefEditModal,callback:function(t){e.showRefEditModal=t},expression:"showRefEditModal"}}),e._v(" "),n("Confirm",{attrs:{title:e.$t("info"),okText:e.$t("ok"),cancelText:e.$t("cancel"),message:e.deleteMessage},on:{onOk:e.destory},model:{value:e.showDeleteModal,callback:function(t){e.showDeleteModal=t},expression:"showDeleteModal"}})],1)}),[],!1,null,"38f21a89",null).exports,X=n(686121),Q=n(110417),ee=n(496486),te=n.n(ee),ne=n(953115),oe=n(390701),re=n(139002),ie=n(947475),ae=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},se=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},le=(0,a.aZ)({components:{TreeSelect:Q.Z,DatePickerExt:ne.Z,Pagination:M.Z},setup:function(){var e,t,n,o,r=this,i=null===(t=null===(e=window.globalData)||void 0===e?void 0:e.course)||void 0===t?void 0:t.id,a=null===(o=null===(n=window.globalData)||void 0===n?void 0:n.user)||void 0===o?void 0:o.orgId,s=(0,X.iH)([]),l=(0,X.iH)({auditStatus:"waiting",dateRange:[],departmentIds:[],keyword:""}),c=(0,X.iH)(0),u=(0,L.h0)((function(e,t){var n={dateRange:l.value.dateRange,keyword:l.value.keyword,status:l.value.auditStatus,departmentIds:l.value.departmentIds};return(0,v.Z$)(i,e,t,n)}));(0,ie.oh)(l,(function(){u.fetch()}),{deep:!0,debounce:500});var d=[{title:h.default.t("name"),slot:"userName"},{title:h.default.t("user_no"),slot:"userNo"},{title:h.default.t("department"),slot:"department"},{title:h.default.t("project.apply.applyTime"),slot:"time"},{title:h.default.t("project.apply.status"),slot:"status"},{title:h.default.t("operation"),slot:"operation"}],p=(0,X.iH)(!1);return{showModal:p,openModal:function(){return ae(r,void 0,void 0,(function(){return se(this,(function(e){switch(e.label){case 0:return p.value=!0,(0,oe.getOrgDepartments)(a).then((function(e){var t=e.data.departments;te().isEmpty(t)||(s.value=(0,re.At)(t))})),[4,u.fetch()];case 1:return e.sent(),[2]}}))}))},columns:d,conditions:l,search:function(e){l.value.keyword=e},depsTreeData:s,onCheckDept:function(e){l.value.departmentIds=e.map((function(e){return e.id}))},pager:u,handleAudit:function(e,t){return ae(r,void 0,void 0,(function(){return se(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,(0,v.SA)(i,e.id,t)];case 1:return n.sent(),O.Toast.success(h.default.t("operationSuccess")),[3,3];case 2:return n.sent(),O.Toast.error(h.default.t("operationFailed")),[3,3];case 3:return"accepted"===t&&(c.value+=1),[4,u.fetch()];case 4:return n.sent(),[2]}}))}))},handleClose:function(e){e||c.value>0&&window.location.reload()}}}}),ce=(0,u.Z)(le,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("Button",{attrs:{size:"small"},on:{click:e.openModal}},[e._v(e._s(e.$t("project.apply.list")))]),e._v(" "),n("Modal",{attrs:{width:"1000",title:e.$t("project.apply.list"),"footer-hide":"","class-name":"vertical-center-modal"},on:{"on-visible-change":e.handleClose},model:{value:e.showModal,callback:function(t){e.showModal=t},expression:"showModal"}},[n("RadioGroup",{attrs:{type:"button"},model:{value:e.conditions.auditStatus,callback:function(t){e.$set(e.conditions,"auditStatus",t)},expression:"conditions.auditStatus"}},[n("Radio",{attrs:{label:""}},[e._v(e._s(e.$t("all")))]),e._v(" "),n("Radio",{attrs:{label:"waiting"}},[e._v(e._s(e.$t("project.apply.waiting")))]),e._v(" "),n("Radio",{attrs:{label:"accepted"}},[e._v(e._s(e.$t("project.apply.accepted")))]),e._v(" "),n("Radio",{attrs:{label:"reject"}},[e._v(e._s(e.$t("project.apply.reject")))])],1),e._v(" "),n("div",{staticClass:"content-warp"},[n("div",{staticClass:"filter-warp"},[n("div",{staticClass:"filter"},[n("span",{staticClass:"title"},[e._v(e._s(e.$t("project.apply.applyTime")))]),e._v(" "),n("DatePickerExt",{attrs:{type:"daterange",placement:"bottom-start",format:"yyyy-MM-dd",returnformat:"YYYY-MM-DD",placeholder:e.$t("project.apply.daterangeTip"),"use-default-shortcuts":!0},model:{value:e.conditions.dateRange,callback:function(t){e.$set(e.conditions,"dateRange",t)},expression:"conditions.dateRange"}})],1),e._v(" "),n("div",{staticClass:"filter"},[e.depsTreeData.length>0?n("span",{staticClass:"title"},[e._v(e._s(e.$t("department")))]):e._e(),e._v(" "),e.depsTreeData.length>0?n("TreeSelect",{staticClass:"tree-select",attrs:{data:e.depsTreeData,"min-width":160},on:{"on-checked-data":e.onCheckDept}}):e._e()],1),e._v(" "),n("Input",{staticClass:"search-input",attrs:{search:"",placeholder:e.$t("project.apply.searchTip")},on:{"on-search":e.search,"on-click":e.search}})],1),e._v(" "),n("Table",{staticClass:"table-warp",attrs:{columns:e.columns,data:e.pager.data.items},scopedSlots:e._u([{key:"userName",fn:function(t){var o=t.row;return[n("span",[e._v(e._s(o.user.name))])]}},{key:"userNo",fn:function(t){var o=t.row;return[n("span",[e._v(e._s(o.user.userNo))])]}},{key:"department",fn:function(t){var o=t.row;return[n("span",[e._v(e._s(o.user.department.id?o.user.department.name:""))])]}},{key:"time",fn:function(t){var o=t.row;return[n("span",[e._v(e._s(e._f("localDateYMDHm")(o.createdAt)))])]}},{key:"status",fn:function(t){var o=t.row;return[n("span",{staticClass:"audit-status",class:o.status},[e._v(e._s(e.$t("project.apply."+o.status)))])]}},{key:"operation",fn:function(t){var o=t.row;return["waiting"===o.status?n("section",[n("span",{staticClass:"action primary",on:{click:function(t){return e.handleAudit(o,"accepted")}}},[e._v("\n              "+e._s(e.$t("project.apply.approve"))+"\n            ")]),e._v(" "),n("span",{staticClass:"action reject ml-4",on:{click:function(t){return e.handleAudit(o,"reject")}}},[e._v("\n              "+e._s(e.$t("project.apply.rejected"))+"\n            ")])]):e._e()]}}])}),e._v(" "),e.pager.data.total>0?n("div",{staticClass:"pagination"},[n("Pagination",{attrs:{total:e.pager.data.total,"page-size":e.pager.data.pageSize,current:e.pager.data.page,"show-elevator":"",transfer:""},on:{"on-change":e.pager.pageChanged}})],1):e._e()],1)],1)],1)}),[],!1,null,"44433ab9",null).exports;n(422592);r.default.use(i.default),r.default.customElement("user-project",d),r.default.customElement("project-add",w),r.default.customElement("project-header",$),r.default.customElement("project-resource",J),r.default.customElement("project-audit-modal",ce)},475902:function(e,t,n){"use strict";n.r(t);n(141817),n(66992),n(788674),n(333948);var o=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},r=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}};t.default=function(e){var t;e&&e.ENABLE_APM&&(t=e,o(void 0,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,n.e(16629).then(n.bind(n,916629))];case 1:return e.sent().init({serviceName:t.SERVICE_NAME,serverUrl:t.SERVER_URL,serviceVersion:"1.75-dev",environment:t.ENVIRONMENT,transactionSampleRate:+t.TRANSACTION_SAMPLE_RATE}),[2]}}))})))}},600683:function(e,t,n){"use strict";n.r(t);n(788674);var o=n(475902),r=function(e,t){var o;void 0===t&&(t=null),(null===(o=window.featureToggles)||void 0===o?void 0:o[e])&&n(595684)("./".concat(t||e))};r("face_recognition_service","face_check_service"),r("face_photo_check_service","face_check_service"),r("class_mode_casting"),r("single_user_session_constraint"),r("course_end_date_filter","course_info_filter"),r("enableSobot","sobot"),r("enable_howxm","howxm"),n(305604),n(149572),n(284607),n(193929);var i,a;(0,o.default)((i="apm",null===(a=window.CONFIGS)||void 0===a?void 0:a[i]))},816203:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var o=function(){function e(){this.editing=!1,this.immutable=!1}return e.create=function(){var t=new e;return t.editing=!0,t.selected=!0,t},e}()},243407:function(e,t,n){"use strict";n.d(t,{Z:function(){return a},tv:function(){return i}});n(319601),n(496486),n(559061);var o=n(925706),r=function(){return(r=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};var i=function(){var e,t=null===(e=(0,o.FN)())||void 0===e?void 0:e.proxy,n=(0,o.qj)({route:null==t?void 0:t.$route});return(0,o.YP)((function(){return null==t?void 0:t.$route}),(function(e){n.route=e})),r(r({},(0,o.BK)(n)),{router:null==t?void 0:t.$router})},a=function(e,t){if(e){var n=new MutationObserver((function(e){t(e)}));return n.observe(e,{attributes:!0,childList:!0,characterData:!0,subtree:!0}),n}console.warn("MutationObserver:No document")}},117403:function(e,t,n){"use strict";n.r(t);var o,r,i,a=n(370538),s=n(385565),l=n.n(s),c=n(332446),u=n.n(c),d=n(942088),p=n.n(d),f=n(46737),v=n.n(f),h=n(322013),m=n.n(h),g=n(14975),y=n.n(g),w=n(349009),b=n.n(w),_=n(48496),C=n(754641),k=n(417127),x=n(810229),S=n(924193),T=n(697953),D=n(338576),I=n(129134),E=n(975636),N=n(944304),$=n(828819),R=n(676828),j=n(248802),P=n(163376),M=n(42561),O=n(256656),G=n(938101),A=n(376637),Z=n(833935),H=n(486595),F=n(788722),B=n(862165),z=n(158924),L=n(285526),U=n(917086),V=n(866473).locale;a.default.use(L.V);var q,Y={"en-US":k,"zh-CN":x,"zh-MO":S,"zh-TW":T,"th-TH":D,"id-ID":I,"ms-MY":E,"vi-VN":N},K=function(e){Y=_._.mergeWith(Y,e)};K({"en-US":u(),"zh-CN":p(),"zh-MO":_._.mergeWith(v(),U.Z),"zh-TW":_._.mergeWith(v(),U.Z),"th-TH":m(),"id-ID":y(),"ms-MY":u(),"vi-VN":b()}),K({"en-US":l().langs.us,"zh-CN":l().langs.cn,"zh-MO":l().langs.tw,"zh-TW":l().langs.tw,"th-TH":l().langs.th,"id-ID":l().langs.id,"ms-MY":l().langs.us,"vi-VN":l().langs.vn});var W=null===(o=document.querySelector("html"))||void 0===o?void 0:o.getAttribute("lang"),J=(0,C.getLang)(W||"zh-CN");V(Y[J]);var X=null===(r=document.querySelector("html"))||void 0===r?void 0:r.getAttribute("delivery-org"),Q=null===(i=window.orgSettings)||void 0===i?void 0:i.enterpriseMode;switch(X){case"BJGYJS":q={"en-US":j.dX,"zh-CN":j.ex,"zh-TW":j.lr,"zh-MO":j.lr};break;case"PU":q={"en-US":P.dX,"zh-CN":P.ex,"zh-TW":P.lr,"zh-MO":P.lr};break;case"NFA":q={"en-US":{},"zh-CN":{},"zh-TW":M.l,"zh-MO":{}};break;case"TP-DOE":q={"en-US":O.dX,"zh-CN":O.ex,"zh-TW":O.lr,"zh-MO":O.lr};break;case"APPLE":q={"en-US":G.dX,"zh-CN":G.ex,"zh-TW":G.lr,"zh-MO":G.lr};break;case"HDZYXY":q={"en-US":A.dX,"zh-CN":A.ex,"zh-TW":A.lr,"zh-MO":A.lr};break;case"XZZJ-ZHXX":q={"en-US":Z.dX,"zh-CN":Z.ex,"zh-TW":Z.lr,"zh-MO":Z.lr};break;case"XJTU-CJS":q={"en-US":H.dX,"zh-CN":H.ex,"zh-TW":H.lr,"zh-MO":H.lr};break;case"KJTX":q={"en-US":{},"zh-CN":F.e,"zh-TW":{},"zh-MO":{}};break;case"HJZH":q={"en-US":{},"zh-CN":z.e,"zh-TW":{},"zh-MO":{}};break;case"CGUST":q={"en-US":{},"zh-CN":B.ex,"zh-TW":B.lr,"zh-MO":B.$D};break;default:q=Q?{"en-US":R.dX,"zh-CN":R.ex,"zh-TW":R.lr,"zh-MO":R.lr}:{"en-US":$.dX,"zh-CN":$.ex,"zh-TW":$.lr,"zh-MO":$.lr}}t.default=new L.V({locale:J,messages:Y,customizeMessages:q,silentTranslationWarn:!0})},754641:function(e,t,n){"use strict";function o(e){return e?{"zh-MO":"zh-MO","en-GB":"en-US","en-US":"en-US","zh-CN":"zh-CN","zh-TW":"zh-TW","th-TH":"th-TH","id-ID":"id-ID","ms-MY":"ms-MY","vi-VN":"vi-VN"}[e]:"zh-CN"}n.d(t,{getLang:function(){return o}})},554174:function(e,t,n){"use strict";n.r(t),n.d(t,{addActivityComment:function(){return B},applyCommentLikeOperation:function(){return Y},checkTencentMeetingUserAuth:function(){return se},checkUserLarkAuth:function(){return R},createActivitiesInCourses:function(){return D},createActivity:function(){return p},createCalendarMeeting:function(){return I},deleteActivity:function(){return f},deleteActivityResource:function(){return x},deleteSubmissionAttachMarkUpload:function(){return G},getActivityCommentReplies:function(){return F},getActivityComments:function(){return Z},getActivityCommentsReplies:function(){return H},getActivityDetail:function(){return y},getActivityHaveDependents:function(){return C},getActivityReferences:function(){return K},getActivityResource:function(){return k},getClasinJoinUrl:function(){return m},getClassinWebcastUrl:function(){return g},getCommentCountWithType:function(){return J},getCompletionCriteria:function(){return h},getCourseActivities:function(){return b},getDingtalkWatchStats:function(){return le},getGroupSubmission:function(){return oe},getGroupSubmissions:function(){return j},getH5CoursewareViewUrl:function(){return ce},getHomeworkDuplicateRate:function(){return ie},getHomeworkInterScores:function(){return Q},getInterGroupScores:function(){return ee},getIntraGroupScores:function(){return te},getMeetingStatistics:function(){return S},getPageCommentStat:function(){return W},getScoreItems:function(){return T},getScoreRecords:function(){return w},getStudentSubmission:function(){return ne},getStudentSubmissions:function(){return P},getSubmissionAttachements:function(){return M},logActivityRead:function(){return E},logMgs:function(){return N},refreshMarkedAttachment:function(){return O},removeActivityComment:function(){return L},removeActivityCommentReply:function(){return q},replaceSubmissionCorrectUploadReference:function(){return A},replyActivityComment:function(){return U},reprocessLectureLiveReplay:function(){return _},trackSchedulePlay:function(){return $},updateActivity:function(){return v},updateActivityComment:function(){return z},updateActivityCommentReply:function(){return V},updateActivityResource:function(){return ue},updateCorrectUploads:function(){return ae},updateHomeworkAnnounceMarkStatus:function(){return re},updateHomeworkScoreAndComment:function(){return X},upsertH5CoursewareCmi:function(){return de}});n(141817),n(66992),n(319601),n(788674),n(333948);var o=n(409669),r=n.n(o),i=n(356264),a=n(920976),s=n(361835),l=n(743838),c=function(){return(c=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},u=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},d=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}};function p(e,t){return r().post("/api/courses/".concat(e,"/activities"),t)}function f(e,t){return void 0===t&&(t={}),r().delete("/api/activities/".concat(e),{params:t})}function v(e,t){return r().put("/api/activities/".concat(e),t)}function h(e,t){return r().get("/api/completion-criteria",{params:{activity_type:t,course_id:e}})}function m(e,t,n){return u(this,void 0,void 0,(function(){return d(this,(function(o){switch(o.label){case 0:return[4,r().get("/api/activies/classin/join-url",{params:{course_id:e,activity_id:t,user_id:n}})];case 1:return[2,o.sent().data.url]}}))}))}function g(e,t){return u(this,void 0,void 0,(function(){return d(this,(function(n){switch(n.label){case 0:return[4,r().get("/api/activities/classin/webcast-url",{params:{course_id:e,activity_id:t}})];case 1:return[2,n.sent().data.url]}}))}))}function y(e){return u(this,void 0,void 0,(function(){var t,n;return d(this,(function(o){switch(o.label){case 0:return[4,r().get("/api/activities/".concat(e))];case 1:return t=o.sent(),n=(0,i.camelizeKeys)(t.data),[2,(0,a.d8)(s.cS,n)]}}))}))}var w=function(e,t,n,o){return u(void 0,void 0,void 0,(function(){var l,c,u,p;return d(this,(function(d){switch(d.label){case 0:return l=(0,i.decamelizeKeys)({page:e,pageSize:t}),[4,r().get("/api/activity/".concat(n,"/submitter/").concat(o,"/score-records"),{params:l})];case 1:return c=d.sent(),u=(0,i.camelizeKeys)(c.data),p=(0,a.d8)(s.M_,u.records,{excludeExtraneousValues:!0}),[2,{page:e,pageSize:t,pages:u.pages,total:u.total,start:u.start,end:u.end,items:p}]}}))}))},b=function(e){return u(void 0,void 0,void 0,(function(){var t;return d(this,(function(n){switch(n.label){case 0:return[4,r().get("/api/courses/".concat(e,"/activities"))];case 1:return t=n.sent().data,[2,(0,a.d8)(s.cS,(0,i.camelizeKeys)(t.activities))]}}))}))};function _(e,t){return u(this,void 0,void 0,(function(){return d(this,(function(n){switch(n.label){case 0:return[4,r().post("/api/courses/lecture-live-activity/".concat(e,"/reprocess"),{replay_id:t})];case 1:return n.sent(),[2]}}))}))}function C(e,t){return u(this,void 0,void 0,(function(){return d(this,(function(n){switch(n.label){case 0:return[4,r().get("/api/activities/have-dependents",{params:{activity_ids:e,activity_type:t}})];case 1:return[2,n.sent().data.has_dependents]}}))}))}function k(e){return u(this,void 0,void 0,(function(){return d(this,(function(t){switch(t.label){case 0:return[4,r().get("/api/activities/".concat(e,"/resources"))];case 1:return[2,t.sent().data]}}))}))}function x(e,t){return u(this,void 0,void 0,(function(){return d(this,(function(n){return[2,r().delete("/api/activities/".concat(e,"/resources/").concat(t))]}))}))}function S(e,t,n){return u(this,void 0,void 0,(function(){var o;return d(this,(function(i){return o="".concat(e,"/api/meeting/").concat(t,"/metrics?group_by=activity,upload_ref,student&meeting_type=").concat(n),[2,r().get(o)]}))}))}function T(e){return u(this,void 0,void 0,(function(){var t,n;return d(this,(function(o){switch(o.label){case 0:return[4,r().get("/api/courses/".concat(e,"/grade-score-items"))];case 1:return t=o.sent(),n=(0,i.camelizeKeys)(t.data),[2,(0,a.d8)(s.p9,n,{excludeExtraneousValues:!1})]}}))}))}function D(e,t){var n=c(c({},e),{courses:t});return r().post("/api/courses/tencent-meeting/activities",n)}function I(e){return r().post("/api/calendar-meeting",e)}function E(e,t){return r().post("/api/course/activities-read/".concat(t),e)}function N(e,t){window.st&&!window.st.isCanTrack()||r().post("".concat(e,"/api/lecture-live"),t)}function $(e,t){return u(this,void 0,void 0,(function(){var n;return d(this,(function(o){return n=c(c({},t),{clientType:"web"}),[2,r().post("/api/lecture-live/schedule/".concat(e,"/player-visits"),(0,i.decamelizeKeys)(n))]}))}))}function R(){return r().get("/api/lark/authorization/check")}function j(e,t){return r().get("/api/activities/".concat(e,"/groups/").concat(t,"/submission_list"))}function P(e,t){return r().get("/api/activities/".concat(e,"/students/").concat(t,"/submission_list"))}function M(e){return r().get("/api/submissions/".concat(e,"/marked_attachments"))}function O(e,t){return r().get("/api/submissions/".concat(e,"/marked_attachments/").concat(t)).then((function(e){return e.data.marked_attachment}))}function G(e){return r().delete("/api/uploads/marked_attachment/".concat(e))}function A(e,t){return r().put("/api/uploads/references/".concat(e),{upload_id:t})}function Z(e,t,n,o,i,a){return r().get("/api/activities/".concat(e,"/comments?page=").concat(t,"&page_size=").concat(n,"&order_key=").concat(o,"&order=").concat(i,"&conditions=").concat(JSON.stringify(a)))}function H(e,t){return r().get("/api/activities/".concat(e,"/comments/replies"),{params:{comment_ids:t}})}function F(e,t,n,o){return r().get("/api/activities/".concat(e,"/comments/").concat(t,"/replies?page=").concat(n,"&page_size=").concat(o))}function B(e,t){return r().post("/api/activities/".concat(e,"/comments"),t)}function z(e,t,n){return r().put("/api/activities/".concat(e,"/comments/").concat(t),n)}function L(e,t){return r().delete("/api/activities/".concat(e,"/comments/").concat(t))}function U(e,t,n){return r().post("/api/activities/".concat(e,"/comments/").concat(t,"/reply"),n)}function V(e,t,n){return r().put("/api/activities/".concat(e,"/reply/").concat(t),n)}function q(e,t){return r().delete("/api/activities/".concat(e,"/reply/").concat(t))}function Y(e,t){return r().post("/api/activities/".concat(e,"/comments/operate"),t)}function K(e){return r().get("/api/activities/".concat(e,"/upload_references"))}function W(e,t){return r().get("/api/activities/".concat(e,"/comment/page-count?conditions=").concat(JSON.stringify(t)))}function J(e,t){return r().get("/api/activities/".concat(e,"/comment/count?conditions=").concat(JSON.stringify(t)))}function X(e,t,n,o){var a=(0,i.decamelizeKeys)(t);r()({method:"PUT",url:"/api/course/activities/".concat(e,"/submission/score?fields=id,score,instructor_comment,rubric_score,final_score&need_submission_correct=true"),data:a,transformResponse:function(e){var t=JSON.parse(e);if(t.id)return t;if(t.message)throw t.message;if(t.errors)throw t.errors;throw"unknown error"}}).then((function(e){n(e)})).catch((function(e){o(e)}))}function Q(e){return u(this,void 0,void 0,(function(){var t;return d(this,(function(n){switch(n.label){case 0:return[4,r().get("/api/homework/".concat(e,"/inter-scores"))];case 1:return t=n.sent(),[2,(0,i.camelizeKeys)(t.data)]}}))}))}function ee(e){return u(this,void 0,void 0,(function(){var t;return d(this,(function(n){switch(n.label){case 0:return[4,r().get("/api/homework/".concat(e,"/intra-scores"))];case 1:return t=n.sent(),[2,(0,i.camelizeKeys)(t.data)]}}))}))}function te(e,t){return u(this,void 0,void 0,(function(){var n;return d(this,(function(o){switch(o.label){case 0:return[4,r().get("/api/activities/".concat(e,"/group/").concat(t,"/intra_submission"))];case 1:return n=o.sent(),[2,(0,i.camelizeKeys)(n.data)]}}))}))}function ne(e,t){return u(this,void 0,void 0,(function(){return d(this,(function(n){switch(n.label){case 0:return[4,r().get("/api/course/activities/".concat(e,"/students/").concat(t,"/submission"))];case 1:return[2,n.sent().data]}}))}))}function oe(e,t){return u(this,void 0,void 0,(function(){return d(this,(function(n){switch(n.label){case 0:return[4,r().get("/api/activities/".concat(e,"/groups/").concat(t,"/submission"))];case 1:return[2,n.sent().data]}}))}))}function re(e,t,n,o){return u(this,void 0,void 0,(function(){var a;return d(this,(function(s){switch(s.label){case 0:return a=(0,i.decamelizeKeys)(t),[4,r().put("/api/homework/".concat(e,"/announce-mark-status"),a).then((function(e){return n(e)})).catch((function(e){return o(e)}))];case 1:return s.sent(),[2]}}))}))}function ie(e,t){return u(this,void 0,void 0,(function(){var n;return d(this,(function(o){switch(o.label){case 0:return n="/api/homework/".concat(e,"/duplicate-detect/rate?target_ids=").concat(t.join(",")),[4,r().get(n)];case 1:return[2,o.sent().data]}}))}))}function ae(e,t){return u(this,void 0,void 0,(function(){var n,o;return d(this,(function(a){switch(a.label){case 0:return n=(0,i.decamelizeKeys)(t),o="/api/course/activities/".concat(e,"/submissions/correct-uploads"),[4,r().put(o,n)];case 1:return[2,a.sent().data]}}))}))}function se(){return u(this,void 0,void 0,(function(){return d(this,(function(e){switch(e.label){case 0:return"/api/tencent_meeting/check-user-auth",[4,r().get("/api/tencent_meeting/check-user-auth")];case 1:return[2,e.sent().data]}}))}))}function le(e){return u(this,void 0,void 0,(function(){var t,n,o;return d(this,(function(s){switch(s.label){case 0:return t="/api/dingtalk-lives/".concat(e,"/watch-stats"),[4,r().get(t)];case 1:return n=s.sent(),o=(0,i.camelizeKeys)(n.data),[2,(0,a.d8)(l.j,o,{excludeExtraneousValues:!1})]}}))}))}function ce(e,t){return u(this,void 0,void 0,(function(){var n,o;return d(this,(function(a){switch(a.label){case 0:return n="/api/h5-courseware/".concat(e,"/upload/").concat(t,"/url"),[4,r().get(n)];case 1:return o=a.sent(),[2,(0,i.camelizeKeys)(o.data)]}}))}))}function ue(e,t,n){return u(this,void 0,void 0,(function(){return d(this,(function(o){return[2,r().put("/api/activities/".concat(e,"/resources/").concat(t),n)]}))}))}function de(e,t,n){return u(this,void 0,void 0,(function(){var o,a,s;return d(this,(function(l){switch(l.label){case 0:return o=(0,i.decamelizeKeys)({base64State:n}),a="/api/h5-courseware/".concat(e,"/upload/").concat(t,"/cmi"),[4,r().post(a,o)];case 1:return s=l.sent(),[2,(0,i.camelizeKeys)(s.data)]}}))}))}},860250:function(e,t,n){"use strict";n.r(t),n.d(t,{addCourse:function(){return S},assignActivityToModule:function(){return $},combineCourse:function(){return I},combineCourseContent:function(){return N},getAvaLives:function(){return h},getCanBeCombinedCourses:function(){return E},getCourse:function(){return m},getCourseEducators:function(){return w},getCourseHosts:function(){return y},getCourseInstructors:function(){return g},getCourseLives:function(){return v},getCourseModules:function(){return f},getCoursesAuditResource:function(){return k},getCoursesToMerged:function(){return R},getCoursesWithResourceNum:function(){return C},getMyCoursesByPage:function(){return T},getMySemesters:function(){return D},getOnoCourseVisitStat:function(){return x},getSubCourses:function(){return j},getUsersByGroupName:function(){return b},inspectCourse:function(){return _}});n(141817),n(66992),n(319601),n(788674),n(333948);var o=n(409669),r=n.n(o),i=n(920976),a=n(356264),s=n(605627),l=n(90139),c=n(48496),u=function(){return(u=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},d=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},p=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}};function f(e){return d(this,void 0,void 0,(function(){var t;return p(this,(function(n){switch(n.label){case 0:return[4,r().get("/api/courses/".concat(e,"/modules"))];case 1:return t=n.sent(),[2,(0,i.d8)(s.Module,t.data.modules)]}}))}))}function v(e,t){return d(this,void 0,void 0,(function(){var n,o;return p(this,(function(l){switch(l.label){case 0:return[4,r().get("/api/courses/".concat(e,"/extension-lives?source=").concat(t))];case 1:return n=l.sent(),o=(0,a.camelizeKeys)(n.data.lives),[2,(0,i.d8)(s.ChinamCloudLive,o)]}}))}))}function h(e,t,n,o){return d(this,void 0,void 0,(function(){var l,u,d;return p(this,(function(p){switch(p.label){case 0:return c._.assign(o,{pageIndex:e,pageSize:t}),[4,r().get("/api/courses/".concat(n,"/extension-lives"),{params:o})];case 1:return l=p.sent(),u=(0,a.camelizeKeys)(l.data.items),d=(0,i.d8)(s.AvaLiveInfo,u),[2,{page:e,pageSize:t,pages:l.data.pages,total:l.data.total,start:l.data.start,end:l.data.end,items:d}]}}))}))}function m(e,t){return d(this,void 0,void 0,(function(){var n;return p(this,(function(o){switch(o.label){case 0:return[4,r().get("/api/courses/".concat(e),{params:{fields:t}})];case 1:return n=o.sent().data,[2,(0,i.d8)(s.BaseCourse,(0,a.camelizeKeys)(n))]}}))}))}function g(e){return d(this,void 0,void 0,(function(){var t;return p(this,(function(n){switch(n.label){case 0:return[4,r().get("/api/courses/".concat(e,"/instructors"))];case 1:return t=n.sent(),[2,(0,i.d8)(l.n5,t.data.instructors)]}}))}))}function y(e,t){return d(this,void 0,void 0,(function(){var n;return p(this,(function(o){switch(o.label){case 0:return[4,r().get("/api/courses/".concat(e,"/hosts?type=").concat(t))];case 1:return n=o.sent(),[2,(0,i.d8)(l.n5,(0,a.camelizeKeys)(n.data.hosts),{excludeExtraneousValues:!0})]}}))}))}function w(e,t){return void 0===t&&(t=""),d(this,void 0,void 0,(function(){var n,o,s;return p(this,(function(c){switch(c.label){case 0:return n="/api/courses/".concat(e,"/educators"),t&&(n="".concat(n,"?fields=").concat(t)),[4,r().get(n)];case 1:return o=c.sent(),s=(0,a.camelizeKeys)(o.data.enrollments),[2,(0,i.d8)(l.JK,s)]}}))}))}function b(e,t){return d(this,void 0,void 0,(function(){var n;return p(this,(function(o){switch(o.label){case 0:return[4,r().get("/api/courses/".concat(e,"/group-users?group_name=").concat(t))];case 1:return n=o.sent(),[2,(0,i.d8)(l.n5,n.data.result)]}}))}))}function _(e){return d(this,void 0,void 0,(function(){return p(this,(function(t){return[2,r().put("/api/courses/".concat(e,"/inspect"))]}))}))}var C=function(e,t,n){return d(void 0,void 0,void 0,(function(){var o,l,c,u;return p(this,(function(d){switch(d.label){case 0:return o=(0,a.decamelizeKeys)({page:e,pageSize:t,conditions:n,includeChildrenTenant:1}),[4,r().get("/api/courses/statistic/resource-audit",{params:o})];case 1:return l=d.sent(),c=(0,a.camelizeKeys)(l.data.courses),u=(0,i.d8)(s.CourseWithResourceNum,c,{excludeExtraneousValues:!0}),[2,{page:e,pageSize:t,pages:l.data.pages,total:l.data.total,start:l.data.start,end:l.data.end,items:u}]}}))}))},k=function(e,t,n,o){return d(void 0,void 0,void 0,(function(){var l,c,u,d;return p(this,(function(p){switch(p.label){case 0:return l=(0,a.decamelizeKeys)({page:t,pageSize:n,conditions:o}),[4,r().get("/api/courses/".concat(e,"/resource-audit"),{params:l})];case 1:return c=p.sent(),u=(0,a.camelizeKeys)(c.data.audit_references),d=(0,i.d8)(s.CourseAuditReference,u,{excludeExtraneousValues:!0}),[2,{page:t,pageSize:n,pages:c.data.pages,total:c.data.total,start:c.data.start,end:c.data.end,items:d}]}}))}))};function x(e,t,n,o,l){return d(this,void 0,void 0,(function(){var c,u,d;return p(this,(function(p){switch(p.label){case 0:return c=(0,a.decamelizeKeys)({courseIds:e,startDate:n,endDate:o,statType:t,conditions:l}),[4,r().get("/api/courses/tpdoe/stat-students?",{params:c})];case 1:return u=p.sent(),d=(0,a.camelizeKeys)(u.data.result),[2,(0,i.d8)(s.OnoCourseStatUser,d)]}}))}))}function S(e){return d(this,void 0,void 0,(function(){var t;return p(this,(function(n){switch(n.label){case 0:return[4,r().post("/api/course",e)];case 1:return t=n.sent(),[2,(0,a.camelizeKeys)(t.data)]}}))}))}function T(e,t,n,o){return void 0===e&&(e=1),void 0===t&&(t=100),void 0===n&&(n=""),void 0===o&&(o={}),d(this,void 0,void 0,(function(){var i,s;return p(this,(function(l){switch(l.label){case 0:return i=(0,a.decamelizeKeys)({page:e,pageSize:t,fields:n,conditions:u({},o)}),[4,r().get("/api/my-courses",{params:i})];case 1:return s=l.sent(),[2,(0,a.camelizeKeys)(s.data)]}}))}))}function D(e){return void 0===e&&(e={}),d(this,void 0,void 0,(function(){var t;return p(this,(function(n){switch(n.label){case 0:return[4,r().get("/api/my-semesters",{params:(0,a.decamelizeKeys)(e)})];case 1:return t=n.sent(),[2,(0,a.camelizeKeys)(t.data.semesters)]}}))}))}function I(e){return d(this,void 0,void 0,(function(){var t;return p(this,(function(n){switch(n.label){case 0:return[4,r().post("/api/combine-courses",(0,a.decamelizeKeys)(e))];case 1:return t=n.sent(),[2,(0,a.camelizeKeys)(t.data)]}}))}))}function E(e){return d(this,void 0,void 0,(function(){var t;return p(this,(function(n){switch(n.label){case 0:return[4,r().get("/api/combine-courses",{params:{conditions:(0,a.decamelizeKeys)(e)}})];case 1:return t=n.sent(),[2,(0,a.camelizeKeys)(t.data)]}}))}))}function N(e,t){return d(this,void 0,void 0,(function(){return p(this,(function(n){return[2,r().post("/api/combine-courses/".concat(e,"/combine-contents"),t)]}))}))}function $(e,t){return d(this,void 0,void 0,(function(){return p(this,(function(n){return[2,r().post("/api/courses/".concat(e,"/assign-activity-to-module"),t)]}))}))}function R(e){return d(this,void 0,void 0,(function(){var t;return p(this,(function(n){switch(n.label){case 0:return[4,r().get("/api/combine-courses/".concat(e,"/courses-to-merged"))];case 1:return t=n.sent(),[2,(0,a.camelizeKeys)(t.data).courses]}}))}))}function j(e,t){return d(this,void 0,void 0,(function(){var n,o,i;return p(this,(function(s){switch(s.label){case 0:return n="/api/combine-courses/".concat(e,"/sub-courses"),o={},t&&(o.fields=t),[4,r().get(n,{params:o})];case 1:return i=s.sent(),[2,(0,a.camelizeKeys)(i.data).subCourses]}}))}))}},390701:function(e,t,n){"use strict";n.d(t,{getAlertPopupSettings:function(){return d},getCalendarMeetingOrgs:function(){return p},getLiveRecordOrgSetting:function(){return s},getOrgDepartments:function(){return l},getOrgPortalLogo:function(){return c},updateAlertPopupSetting:function(){return f},updateOrgPortalLogo:function(){return u}});n(141817),n(66992),n(788674),n(333948);var o=n(409669),r=n.n(o),i=(n(356264),n(628814),function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))}),a=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}};function s(e){return i(this,void 0,void 0,(function(){return a(this,(function(t){return[2,r().get("/api/orgs/".concat(e,"/live-record-settings"))]}))}))}var l=function(e){return i(void 0,void 0,void 0,(function(){return a(this,(function(t){return[2,r().get("/api/orgs/".concat(e,"/departments"))]}))}))},c=function(){return i(void 0,void 0,void 0,(function(){return a(this,(function(e){return[2,r().get("/api/portal-logo")]}))}))},u=function(e,t){return i(void 0,void 0,void 0,(function(){return a(this,(function(n){return[2,r().put("/api/orgs/".concat(e,"/portal-logo?upload_id=").concat(t))]}))}))};function d(e){return i(this,void 0,void 0,(function(){return a(this,(function(t){return[2,r().get("/api/orgs/".concat(e,"/alert-popup"))]}))}))}function p(){return i(this,void 0,void 0,(function(){return a(this,(function(e){return[2,r().get("/api/org")]}))}))}function f(e,t){return r().put("/api/orgs/".concat(e,"/alert-popup"),t)}},361835:function(e,t,n){"use strict";n.d(t,{Br:function(){return w},Fk:function(){return h},LQ:function(){return r},M0:function(){return v},M_:function(){return _},cS:function(){return p},p9:function(){return b}});n(141817);var o,r,i=n(413447),a=n(247251),s=n(526617),l=n(48496),c=(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),u=function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},d=["none","auditing","agree","reject"],p=(function(){function e(){}u([(0,i.C)()],e.prototype,"id",void 0),u([(0,i.C)()],e.prototype,"duration",void 0)}(),function(){function e(){}u([(0,i.C)()],e.prototype,"id",void 0),u([(0,i.C)()],e.prototype,"name",void 0),u([(0,i.C)()],e.prototype,"size",void 0),u([(0,i.C)()],e.prototype,"deleted",void 0),u([(0,i.C)()],e.prototype,"type",void 0),u([(0,i.C)()],e.prototype,"status",void 0),u([(0,i.C)()],e.prototype,"videoSrcType",void 0),u([(0,i.C)()],e.prototype,"allowDownload",void 0),u([(0,i.C)()],e.prototype,"audio",void 0),u([(0,i.C)()],e.prototype,"videos",void 0)}(),function(){function e(){}u([(0,i.C)()],e.prototype,"id",void 0),u([(0,i.C)()],e.prototype,"uploads",void 0)}(),function(){function e(){}u([(0,i.C)()],e.prototype,"id",void 0),u([(0,i.C)()],e.prototype,"videoQuiz",void 0)}(),function(){function e(){}u([(0,i.C)()],e.prototype,"cameraType",void 0),u([(0,i.C)()],e.prototype,"fileUrl",void 0),u([(0,i.C)()],e.prototype,"label",void 0)}(),function(){function e(){}u([(0,i.C)()],e.prototype,"duration",void 0),u([(0,i.C)()],e.prototype,"status",void 0)}(),function(){function e(){}u([(0,i.C)()],e.prototype,"id",void 0),u([(0,i.C)()],e.prototype,"name",void 0),u([(0,i.C)()],e.prototype,"mimetype",void 0),u([(0,i.C)()],e.prototype,"appId",void 0),u([(0,i.C)()],e.prototype,"properties",void 0)}(),function(){function e(){}u([(0,i.C)(),(0,a.w)((function(e){var t=e.value;return l.TimeUtils.toLocalDate(t)}),{toClassOnly:!0})],e.prototype,"startTime",void 0),u([(0,i.C)(),(0,a.w)((function(e){var t=e.value;return l.TimeUtils.toLocalDate(t)}),{toClassOnly:!0})],e.prototype,"endTime",void 0),u([(0,i.C)()],e.prototype,"videos",void 0)}(),function(){function e(){}return u([(0,i.C)()],e.prototype,"id",void 0),u([(0,i.C)()],e.prototype,"title",void 0),u([(0,i.C)()],e.prototype,"courseId",void 0),u([(0,i.C)()],e.prototype,"type",void 0),u([(0,i.C)()],e.prototype,"data",void 0),u([(0,i.C)(),(0,a.w)((function(e){var t=e.value;return l.TimeUtils.toLocalDate(t)}),{toClassOnly:!0})],e.prototype,"startTime",void 0),u([(0,i.C)(),(0,a.w)((function(e){var t=e.value;return l.TimeUtils.toLocalDate(t)}),{toClassOnly:!0})],e.prototype,"endTime",void 0),u([(0,i.C)(),(0,a.w)((function(e){var t=e.value;return l.TimeUtils.toLocalDate(t)}),{toClassOnly:!0})],e.prototype,"lastSubMeetingEndTime",void 0),u([(0,i.C)()],e.prototype,"canReprocessReplay",void 0),u([(0,i.C)()],e.prototype,"completionCriterion",void 0),u([(0,i.C)()],e.prototype,"completionCriterionKey",void 0),u([(0,i.C)()],e.prototype,"completionCriterionValue",void 0),u([(0,i.C)()],e.prototype,"interScoreMap",void 0),u([(0,i.C)()],e.prototype,"intraScoreMap",void 0),u([(0,i.C)(),(0,a.w)((function(e){return function(e){return l.TimeUtils.isAfterByNow(e.startTime)?"notStarted":e.lastSubMeetingEndTime&&l.TimeUtils.isAfterByNow(e.lastSubMeetingEndTime)||!e.endTime||l.TimeUtils.isAfterByNow(e.endTime)?"inProgress":"expired"}(e.obj)}))],e.prototype,"status",void 0),u([(0,i.C)(),(0,a.w)((function(e){var t=e.obj;return d[t.data.auditStatus]}))],e.prototype,"auditStatus",void 0),u([(0,i.C)(),(0,a.w)((function(e){var t=e.value;return l.TimeUtils.toLocalDate(t)}),{toClassOnly:!0})],e.prototype,"createdAt",void 0),u([(0,i.C)()],e.prototype,"createdBy",void 0),u([(0,i.C)()],e.prototype,"meetingHostUser",void 0),u([(0,i.C)()],e.prototype,"isBookedLive",void 0),u([(0,i.C)()],e.prototype,"bookedCount",void 0),u([(0,i.C)()],e.prototype,"tencentMeetingType",void 0),u([(0,i.C)()],e.prototype,"orgId",void 0),u([(0,i.C)()],e.prototype,"moduleId",void 0),u([(0,i.C)()],e.prototype,"syllabusId",void 0),u([(0,i.C)()],e.prototype,"uploads",void 0),u([(0,i.C)()],e.prototype,"interactionActivityAttributes",void 0),u([(0,i.C)()],e.prototype,"lessonResource",void 0),u([(0,i.C)()],e.prototype,"videoSuite",void 0),u([(0,i.C)()],e.prototype,"viewUrl",void 0),e}()),f=function(e){this.type=e,this.recurringType=-1},v=function(e){function t(){return e.call(this,"chinamcloud_live")||this}return c(t,e),t}(f),h=function(e){function t(){var t=e.call(this,"lesson")||this;return t.lessonType="lesson_replay",t}return c(t,e),t}(f),m=function(){function e(){this.leftSecond=0,this.progress=0,this.retryTimes=0}return u([(0,i.C)()],e.prototype,"leftSecond",void 0),u([(0,i.C)()],e.prototype,"progress",void 0),u([(0,i.C)()],e.prototype,"retryTimes",void 0),e}(),g=function(){function e(){}return u([(0,i.C)()],e.prototype,"label",void 0),u([(0,i.C)()],e.prototype,"muted",void 0),u([(0,i.C)()],e.prototype,"streamUrl",void 0),u([(0,i.C)()],e.prototype,"type",void 0),u([(0,i.C)()],e.prototype,"flvSrc",void 0),u([(0,i.C)()],e.prototype,"flvType",void 0),u([(0,i.C)()],e.prototype,"defaultProtocal",void 0),e}(),y=function(){function e(){}return u([(0,i.C)()],e.prototype,"cameraType",void 0),u([(0,i.C)()],e.prototype,"cameraId",void 0),u([(0,i.C)()],e.prototype,"mute",void 0),u([(0,i.C)()],e.prototype,"url",void 0),u([(0,i.C)()],e.prototype,"mediaProtocol",void 0),e}(),w=function(){function e(){this.description="",this.progress=null,this.streams=null,this.replayVideos=null,this.controllerConfig={},this.liveCaptionConfig={}}return u([(0,i.C)()],e.prototype,"instructorNames",void 0),u([(0,i.C)()],e.prototype,"description",void 0),u([(0,i.C)(),(0,s.D)((function(){return m}))],e.prototype,"progress",void 0),u([(0,i.C)(),(0,s.D)((function(){return g}))],e.prototype,"streams",void 0),u([(0,i.C)()],e.prototype,"status",void 0),u([(0,i.C)()],e.prototype,"replayId",void 0),u([(0,i.C)(),(0,s.D)((function(){return y}))],e.prototype,"replayVideos",void 0),u([(0,i.C)(),(0,a.w)((function(e){return e.value||{}}),{toClassOnly:!0})],e.prototype,"controllerConfig",void 0),u([(0,i.C)(),(0,a.w)((function(e){return e.value||{}}),{toClassOnly:!0})],e.prototype,"liveCaptionConfig",void 0),u([(0,i.C)(),(0,a.w)((function(e){return e.value.roomName}),{toClassOnly:!0})],e.prototype,"room",void 0),u([(0,i.C)()],e.prototype,"type",void 0),u([(0,i.C)()],e.prototype,"isBookedLive",void 0),u([(0,i.C)()],e.prototype,"bookedCount",void 0),e}(),b=function(){function e(){}return u([(0,i.C)()],e.prototype,"id",void 0),u([(0,i.C)()],e.prototype,"displayName",void 0),u([(0,i.C)()],e.prototype,"type",void 0),u([(0,i.C)()],e.prototype,"percentage",void 0),e}();!function(e){function t(){return null!==e&&e.apply(this,arguments)||this}c(t,e)}(f);!function(e){e[e.init=0]="init",e[e.running=1]="running",e[e.success=2]="success",e[e.failed=3]="failed",e[e.cancel=4]="cancel"}(r||(r={}));var _=function(){function e(){}return u([(0,i.C)()],e.prototype,"id",void 0),u([(0,i.C)()],e.prototype,"createdAt",void 0),u([(0,i.C)()],e.prototype,"scoreMethod",void 0),u([(0,i.C)()],e.prototype,"version",void 0),u([(0,i.C)()],e.prototype,"oldScore",void 0),u([(0,i.C)()],e.prototype,"score",void 0),u([(0,i.C)()],e.prototype,"oldFinalScore",void 0),u([(0,i.C)()],e.prototype,"finalScore",void 0),u([(0,i.C)()],e.prototype,"operatorName",void 0),u([(0,i.C)()],e.prototype,"operatorId",void 0),e}()},605627:function(e,t,n){"use strict";n.r(t),n.d(t,{AvaLiveInfo:function(){return v},BaseCourse:function(){return u},ChinamCloudLive:function(){return p},CourseAuditReference:function(){return y},CourseDetail:function(){return h},CourseForm:function(){return b},CourseType:function(){return o},CourseWithResourceNum:function(){return m},Module:function(){return d},OnoCourseStatUser:function(){return w},SelectedCourse:function(){return c},TopCourse:function(){return l},Upload:function(){return g},liveStatus:function(){return f}});var o,r=n(413447),i=n(247251),a=n(576201),s=function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},l=function(){function e(){}return s([(0,r.C)()],e.prototype,"id",void 0),s([(0,r.C)()],e.prototype,"name",void 0),s([(0,r.C)()],e.prototype,"courseCode",void 0),s([(0,r.C)()],e.prototype,"rank",void 0),e}(),c=function(){function e(){this.selected=!1}return s([(0,r.C)()],e.prototype,"id",void 0),s([(0,r.C)()],e.prototype,"orgId",void 0),s([(0,r.C)()],e.prototype,"name",void 0),s([(0,r.C)()],e.prototype,"selected",void 0),s([(0,r.C)()],e.prototype,"courseCode",void 0),e}(),u=function(){function e(){}return s([(0,r.C)()],e.prototype,"id",void 0),s([(0,r.C)()],e.prototype,"name",void 0),s([(0,r.C)()],e.prototype,"isProject",void 0),e}();!function(e){e[e.Normal=1]="Normal",e[e.Model=2]="Model",e[e.Test=3]="Test",e[e.Invalid=4]="Invalid",e[e.Trial=5]="Trial",e[e.Master=6]="Master",e[e.Project=8]="Project"}(o||(o={}));var d=function(){function e(){}return s([(0,i.w)((function(e){var t=e.value;return a.Z.toLocalDateTime(t)}),{toClassOnly:!0})],e.prototype,"createdAt",void 0),s([(0,i.w)((function(e){var t=e.value;return a.Z.toLocalDateTime(t)}),{toClassOnly:!0})],e.prototype,"updatedAt",void 0),e}(),p=function(){},f=["all","not_started","in_progress","finished"],v=function(){function e(){}return s([(0,r.C)()],e.prototype,"title",void 0),s([(0,r.C)()],e.prototype,"startTime",void 0),s([(0,r.C)()],e.prototype,"endTime",void 0),s([(0,r.C)(),(0,i.w)((function(e){var t=e.value;return f[t]}))],e.prototype,"liveState",void 0),s([(0,r.C)()],e.prototype,"url",void 0),e}(),h=function(){function e(){}return s([(0,r.C)()],e.prototype,"id",void 0),s([(0,r.C)()],e.prototype,"name",void 0),s([(0,r.C)()],e.prototype,"academicYear",void 0),s([(0,r.C)()],e.prototype,"compulsory",void 0),s([(0,r.C)()],e.prototype,"courseCode",void 0),s([(0,r.C)()],e.prototype,"org",void 0),s([(0,r.C)()],e.prototype,"semester",void 0),s([(0,r.C)()],e.prototype,"startDate",void 0),s([(0,r.C)()],e.prototype,"activityCount",void 0),e}(),m=function(){function e(){}return s([(0,r.C)()],e.prototype,"courseCode",void 0),s([(0,r.C)()],e.prototype,"orgId",void 0),s([(0,r.C)()],e.prototype,"id",void 0),s([(0,r.C)()],e.prototype,"name",void 0),s([(0,r.C)()],e.prototype,"courseType",void 0),s([(0,r.C)()],e.prototype,"courseResourceNum",void 0),s([(0,r.C)()],e.prototype,"agreeResourceNum",void 0),s([(0,r.C)()],e.prototype,"rejectResourceNum",void 0),s([(0,r.C)()],e.prototype,"auditingResourceNum",void 0),e}(),g=function(){function e(){}return s([(0,r.C)()],e.prototype,"id",void 0),s([(0,r.C)()],e.prototype,"name",void 0),s([(0,r.C)()],e.prototype,"size",void 0),s([(0,r.C)()],e.prototype,"type",void 0),s([(0,r.C)()],e.prototype,"allowDownload",void 0),e}(),y=function(){function e(){}return s([(0,r.C)()],e.prototype,"id",void 0),s([(0,r.C)()],e.prototype,"auditStatus",void 0),s([(0,r.C)()],e.prototype,"auditRemark",void 0),s([(0,r.C)()],e.prototype,"activityTitle",void 0),s([(0,r.C)()],e.prototype,"ccLicenseDescription",void 0),s([(0,r.C)()],e.prototype,"upload",void 0),e}(),w=function(){function e(){}return s([(0,r.C)()],e.prototype,"id",void 0),s([(0,r.C)()],e.prototype,"name",void 0),s([(0,r.C)()],e.prototype,"userNo",void 0),s([(0,r.C)()],e.prototype,"seatNumber",void 0),s([(0,r.C)()],e.prototype,"userVisitDuration",void 0),s([(0,r.C)()],e.prototype,"onlineVideoDuration",void 0),s([(0,r.C)()],e.prototype,"examDuration",void 0),e}(),b=function(){this.academicYear={id:0,sort:-1},this.academicYearId=0,this.compulsory=null,this.courseTemplate=-1,this.courseType=1,this.instructorIds=[],this.semester={id:0,sort:-1},this.semesterId=0}},772236:function(e,t,n){"use strict";n.d(t,{x:function(){return i}});var o=n(413447),r=function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},i=(function(){function e(){}r([(0,o.C)()],e.prototype,"id",void 0),r([(0,o.C)()],e.prototype,"description",void 0),r([(0,o.C)()],e.prototype,"sort",void 0),r([(0,o.C)()],e.prototype,"type",void 0)}(),function(){function e(){this.knowledgeNodeReferences=[]}return r([(0,o.C)()],e.prototype,"id",void 0),r([(0,o.C)()],e.prototype,"answerExplanation",void 0),r([(0,o.C)()],e.prototype,"correctAnswers",void 0),r([(0,o.C)()],e.prototype,"description",void 0),r([(0,o.C)()],e.prototype,"difficultyLevel",void 0),r([(0,o.C)()],e.prototype,"point",void 0),r([(0,o.C)()],e.prototype,"type",void 0),r([(0,o.C)()],e.prototype,"note",void 0),r([(0,o.C)()],e.prototype,"sort",void 0),r([(0,o.C)()],e.prototype,"parent",void 0),r([(0,o.C)()],e.prototype,"settings",void 0),r([(0,o.C)()],e.prototype,"knowledgeNodeReferences",void 0),e}())},576201:function(e,t,n){"use strict";n(747042);var o=n(480008),r="YYYY.MM.DD HH:mm:ss",i="Asia/ShangHai",a=function(){function e(){}return e.toLocalDateTime=function(e){return this.formatDatetime(e)},e.toDefaultDateTime=function(e){return o.utc(e).tz(i)},e.toUtcDateTime=function(e){return o.utc(e)},e.isAfterByNow=function(e){return"string"==typeof e?new Date(e)>=new Date:e>=new Date},e.isAfter=function(e,t){var n="string"==typeof e?new Date(e):e;return("string"==typeof t?new Date(t):t)>n},e.diffByHours=function(e,t){return void 0===t&&(t=null),t?o(t).diff(o(e),"hours"):o.utc().diff(o(e),"hours")},e.formatDatetime=function(e,t){return void 0===t&&(t=r),o(e).tz(i).format(t)},e.formatUtcDatetime=function(e,t){return void 0===t&&(t=r),o.utc(e).tz(i).format(t)},e.diffByMinutes=function(e,t){return void 0===t&&(t=null),t?o(t).diff(o(e),"minutes"):o.utc().diff(o(e),"minutes")},e.diffBySeconds=function(e,t){return void 0===t&&(t=null),t?o(t).diff(o(e),"seconds"):o.utc().diff(o(e),"seconds")},e.toYmd=function(e){return"string"==typeof e?o(e).format("YYYY.MM.DD"):o(e).tz(i).format("YYYY.MM.DD")},e.toHm=function(e){return"string"==typeof e?o(e).format("HH:mm"):o(e).tz(i).format("HH:mm")},e.toHms=function(e){return"string"==typeof e?o(e).format("HH:mm:ss"):o(e).tz(i).format("HH:mm:ss")},e.pad=function(e){return e>10?e:"0".concat(e).slice(-2)},e.secondsToHms=function(e){var t=Math.floor(e/60),n=e%60,o=Math.floor(t/60);return t%=60,"".concat(this.pad(o),":").concat(this.pad(t),":").concat(this.pad(n))},e.millisecondToHms=function(e){var t=Math.floor(e/1e3);return this.secondsToHms(t)},e.startOfToday=function(){return o().tz(i).startOf("day")},e.endOfToday=function(){return o.tz(i).endOf("day")},e.endOfDay=function(e){return o.tz(e,i).endOf("day").toDate()},e.startOfWeek=function(){return o().tz(i).startOf("week")},e.endOfWeek=function(){return o().tz(i).endOf("week")},e.toLocalDate=function(e){return o(e).toDate()},e.utcDateToLocal=function(e,t){return void 0===t&&(t="YYYY.MM.DD HH:mm"),o.utc(e).local().format(t)},e.localDateFormat=function(e,t){return void 0===t&&(t="YYYY.MM.DD HH.mm"),o(e).format(t)},e.todayRange=function(){return[this.startOfToday().toDate(),this.endOfToday().toDate()]},e.latestNDayRange=function(e){var t=this.endOfToday();return[this.endOfToday().subtract("days",e).add("seconds",1).toDate(),t.toDate()]},e.timeDifferenceMsg=function(e,t){var n=o(e),r=o(t);if(r.diff(n,"seconds")<0)return"-1";var i=r.diff(n,"days"),a=r.diff(n,"hours")-24*i,s=r.diff(n,"minutes")-60*r.diff(n,"hours"),l="";return l+=i<=0?"":"".concat(i,"days"),l+=a<=0?"":"".concat(a,"hours"),i>0?l:l+="".concat(s<=0?1:s,"minutes")},e}();t.Z=a},334647:function(e,t,n){"use strict";n(140561);var o=n(370538),r=function(){function e(){}return e.success=function(e,t,n){void 0===t&&(t=3),void 0===n&&(n=24),this.resetMessage({type:"success",content:e,duration:t,top:n})},e.warning=function(e,t,n){void 0===t&&(t=3),void 0===n&&(n=24),this.resetMessage({type:"warning",content:e,duration:t,top:n})},e.error=function(e,t,n){void 0===t&&(t=3),void 0===n&&(n=24),this.resetMessage({type:"error",content:e,duration:t,top:n})},e.resetMessage=function(e){var t=this,n=e.content,r=e.duration,i=e.top,a=e.type,s=this.messageList.findIndex((function(t){return t.type===a&&t.content===e.content}));s>=0||(this.messageList.push({type:e.type,content:e.content}),o.default.prototype.$Message.config({top:i}),o.default.prototype.$Message[a]({content:n,duration:r}),setTimeout((function(){t.messageList.splice(s,1)}),1e3*e.duration||3e3))},e.messageList=[],e}();t.Z=r},908308:function(e,t,n){"use strict";n.d(t,{kl:function(){return c},oe:function(){return u}});n(141817),n(66992),n(319601),n(788674),n(333948);var o=n(409669),r=n.n(o),i=(n(356264),n(413447)),a=function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},s=(function(){function e(){this.userId=0,this.userNo="",this.userName="",this.department="",this.role="",this.usageCount=0}a([(0,i.C)({name:"user_id"})],e.prototype,"userId",void 0),a([(0,i.C)({name:"user_no"})],e.prototype,"userNo",void 0),a([(0,i.C)({name:"user_name"})],e.prototype,"userName",void 0),a([(0,i.C)({name:"usage_count"})],e.prototype,"usageCount",void 0)}(),function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))}),l=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},c=function(){return s(void 0,void 0,void 0,(function(){return l(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,r().post("/api/ai-ppt/usage")];case 1:return[2,e.sent().data];case 2:return e.sent(),[2,null];case 3:return[2]}}))}))},u=function(){return s(void 0,void 0,void 0,(function(){return l(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,r().get("/api/ai-ppt/user/usage/count")];case 1:return[2,e.sent().data];case 2:return e.sent(),[2,null];case 3:return[2]}}))}))}},87873:function(e,t,n){"use strict";n.d(t,{e$:function(){return u},g6:function(){return l},gR:function(){return c},nD:function(){return d},qv:function(){return p}});n(132023),n(454747);var o=n(693604),r=n(496486),i=n.n(r),a=["doc","docx","ppt","pptx","xls","xlsx","pdf","txt"],s=a.concat(["jpg","jpeg","png","tif","tiff","webp","bmp"]),l=function(e){var t=(0,o.fileExtension)(e.name);return a.includes(t.toLowerCase())},c=function(e){var t=(0,o.fileExtension)(e.name);return s.includes(t.toLowerCase())},u=function(e){var t="";return function e(n){i().forEach(n,(function(n){"string"!=typeof n?(i().isObject(n)||i().isArray(n))&&e(n):t=n}))}(e),t},d=function(e){return"ABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(e)},p=function(e){var t=document.createElement("div");t.innerHTML=e;var n=t.querySelectorAll(".__blank__"),o=[];return n.forEach((function(e,t){o.push({alternates:[],content:"",sort:t,uuid:Number(e.getAttribute("data-id"))})})),o}},940571:function(e,t,n){"use strict";n.d(t,{N:function(){return a}});n(788674);var o=n(578345),r=n(863559),i=[{path:"/step-1",component:function(){return n.e(44583).then(n.bind(n,644583))},meta:{step:r.rw.SELECT}},{path:"/step-2",component:function(){return n.e(24609).then(n.bind(n,524609))},meta:{step:r.rw.COMBINE}},{path:"*",redirect:"/step-1"}],a=new o.Z({routes:i})},863559:function(e,t,n){"use strict";var o,r,i,a;n.d(t,{Tw:function(){return i},gW:function(){return a},lW:function(){return r},rw:function(){return o}}),function(e){e[e.SELECT=0]="SELECT",e[e.COMBINE=1]="COMBINE"}(o||(o={})),function(e){e[e.COMBINE=10]="COMBINE"}(r||(r={})),function(e){e.PRIVATE="private"}(i||(i={})),function(e){e[e.PRESET=0]="PRESET",e[e.UPLOAD=1]="UPLOAD"}(a||(a={}))},592734:function(e,t,n){"use strict";n.d(t,{c:function(){return f}});n(384944),n(491038),n(66992),n(747042),n(702707),n(133792),n(319601),n(470189),n(132023),n(454747),n(333948);var o,r=n(772147),i=n(225101),a=n(615233),s=n(747801),l=n(252890),c=(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),u=function(){return(u=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},d=function(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))},p=function(e){function t(n,o,r,i,a,c){void 0===a&&(a=new s.I),void 0===c&&(c=new l.b);var u=e.call(this,t.EVENT_NAME)||this;return u.id=n,u.name=o,u.courseCode=r,u.courseType=i,u.modules=a,u.activities=c,u.states={selected:!1},u}return c(t,e),t.fromObj=function(e){var n,o,r,a=s.I.fromObj(null!==(n=e.modules)&&void 0!==n?n:[]),c=l.b.fromObj((null!==(o=e.activities)&&void 0!==o?o:[]).map((function(t){return u(u({},t),{courseId:e.id})}))),d=i.lW[(null!==(r=i.lW[e.courseType])&&void 0!==r?r:"").toLocaleUpperCase()],p=new t(e.id,e.name,e.courseCode,d,a,c);return p.isCombine()&&(p.activities.getMountedActivities().toLeft(),p.state("selected",!0)),p},t.prototype.into=function(){var e=this,t=this.modules.map((function(t){return t.into().state("immutable",e.isCombine()).state("selectable",!e.isCombine())}));return this.isCombine()?(t.map((function(t){var n;t.children.forEach((function(t){var n;if("syllabus"===t.data.nodeType){var o=e.findSyllabusActivities(t.id).into().map((function(t){return t.state("immutable",e.isCombine()).state("selectable",!e.isCombine())}));t.state("immutable",e.isCombine()).state("selectable",!e.isCombine()),(n=t.children).unshift.apply(n,o)}}));var o=e.findModuleActivities(t.id).into().map((function(t){return t.state("immutable",e.isCombine()).state("selectable",!e.isCombine())}));return(n=t.children).unshift.apply(n,o),t})),a.O.fromObj({children:t})):a.O.fromObj({children:t})},t.prototype.state=function(e,t){return void 0===t?this.states[e]:(this.states[e]=t,this.emit(e),this)},t.prototype.isCombine=function(){return this.courseType===i.lW.COMBINE},t.prototype.onSelected=function(e){this.on("selected",e)},t.prototype.getRightActivities=function(e){return void 0===e&&(e=!1),this.activities.getRightActivities(e)},t.prototype.filter=function(e,t,n){this.activities.forEach((function(o){o.unselect(),!o.title.includes(t)||(!n||o.courseId!==n)&&n||"all"!==e&&o.type!==e?o.hide():o.show()}))},t.prototype.findModuleActivities=function(e){return this.activities.getActivitiesByMountPoint((function(t){return t.moduleId===e&&!t.syllabusId}))},t.prototype.findSyllabusActivities=function(e){return this.activities.getActivitiesByMountPoint((function(t){return t.syllabusId===e}))},t.EVENT_NAME="__course-status-change",t}(r.L),f=function(e){function t(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var o=e.apply(this,t)||this;return o.hasModify=!1,o.treeData=[],o.sort((function(e,t){return e.courseCode.localeCompare(t.courseCode)})),o.hasCombine()?o.treeData=o.into():o.onSelected((function(e){o.hasModify||(o.resetActivities(),o.treeData=o.into())})),o}return c(t,e),t.fromObj=function(e){1===e.length&&(e[0].courseType=i.lW.COMBINE);return new(t.bind.apply(t,d([void 0],e.map((function(e){return p.fromObj(e)})),!1)))},t.prototype.hasCombine=function(){return!!this.find((function(e){return e.isCombine()}))},t.prototype.modify=function(){this.hasModify=!0},t.prototype.modified=function(){return this.hasModify},t.prototype.into=function(){return this.getSelection().map((function(e){return e.into().children})).flat()},t.prototype.resetActivities=function(){this.forEach((function(e){return e.activities.forEach((function(e){e.rest()}))}))},t.prototype.getRightActivities=function(){var e=[];return this.forEach((function(t){e.push.apply(e,t.getRightActivities().get())})),e},t.prototype.getAllActivities=function(){var e=[];return this.forEach((function(t){e.push.apply(e,t.activities.get())})),e},t.prototype.getActivityTypes=function(){return Array.from(new Set(this.getAllActivities().map((function(e){return e.type}))))},t.prototype.findActivity=function(e,t){return this.getAllActivities().find((function(n){return n.id===e&&n.type===t}))},t.prototype.hasActivitySelected=function(){return!!this.getAllActivities().find((function(e){return e.selected}))},t.prototype.getSelection=function(){return this.filter((function(e){return e.state("selected")}))},t.prototype.onSelected=function(e){this.forEach((function(t){t.onSelected(e)}))},t}(i.aV)},468912:function(e,t,n){"use strict";n.r(t);var o=n(370538),r=n(285256),i=(n(141817),n(66992),n(788674),n(573210),n(333948),n(925706)),a=n(117403),s=(n(682772),n(409669)),l=n.n(s),c=n(920976),u=n(356264),d=(n(556977),n(413447)),p=n(247251),f=n(730381),v=n(993776),h=n.n(v),m=function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},g=function(){function e(){}return m([(0,d.C)()],e.prototype,"id",void 0),m([(0,d.C)(),(0,p.w)((function(e){var t=e.value,n=new(h())(1024),o=n.mul(n),r=new(h())(t),i="B";return r.gte(n)&&r.lt(o)?(i="K",r=r.div(n)):r.gte(o)&&(i="M",r=r.div(o)),r.mul(new(h())(10)).floor().div(new(h())(10)).toFixed()+i}))],e.prototype,"size",void 0),m([(0,d.C)({name:"last_updated_at"}),(0,p.w)((function(e){var t=e.value;return f(t).format("YYYY-MM-DD HH:mm:ss")}))],e.prototype,"lastUpdatedAt",void 0),m([(0,d.C)()],e.prototype,"status",void 0),m([(0,d.C)()],e.prototype,"name",void 0),m([(0,d.C)()],e.prototype,"url",void 0),e}(),y=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},w=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},b=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n},_=function(e,t){return y(void 0,void 0,void 0,(function(){return w(this,(function(n){switch(n.label){case 0:return[4,l().post("/api/courses/".concat(e,"/course-package/export"),t)];case 1:return[2,n.sent().data]}}))}))},C=function(e){return y(void 0,void 0,void 0,(function(){return w(this,(function(t){switch(t.label){case 0:return[4,l().get("/api/courses/".concat(e,"/course-package/status"))];case 1:return[2,t.sent().data.data]}}))}))},k=function(e){return y(void 0,void 0,void 0,(function(){return w(this,(function(t){switch(t.label){case 0:return[4,l().delete("/api/course-packages/".concat(e))];case 1:return[2,t.sent().data]}}))}))},x=function(e){return y(void 0,void 0,void 0,(function(){return w(this,(function(t){switch(t.label){case 0:return[4,l().post("/api/course-packages/".concat(e,"/save"))];case 1:return[2,t.sent().data]}}))}))},S=n(383228),T=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},D=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},I=(0,i.aZ)({props:{show:{type:Boolean,default:!1},courseName:{type:String,default:""},courseId:{type:Number}},setup:function(e){var t,n,o,r=this,s=Number(null!==(n=null!==(t=S("#courseId").val())&&void 0!==t?t:e.courseId)&&void 0!==n?n:0),l=(0,i.iH)(!0),c="[课程包]".concat(e.courseName),u=(0,i.qj)({name:c}),d={name:[{required:!0,validator:function(e,t,n){""===t.trim()?n(new Error(a.default.t("required_field"))):n()}}]},p=(0,i.iH)(),f=function(){var e=document.querySelector("export-course-package-modal");e&&(e.show=!1)},v=function(){return T(r,void 0,void 0,(function(){var e,t;return D(this,(function(n){switch(n.label){case 0:return[4,C(s)];case 1:return e=n.sent(),l.value=e,!l.value&&o&&(window.clearInterval(o),o=void 0,t=new CustomEvent("export-course-package-status-change"),window.dispatchEvent(t)),[2]}}))}))};return(0,i.bv)((function(){return T(r,void 0,void 0,(function(){return D(this,(function(e){switch(e.label){case 0:return[4,v()];case 1:return e.sent(),l.value&&(o=window.setInterval(v,1500)),[2]}}))}))})),(0,i.Jd)((function(){o&&(window.clearInterval(o),o=void 0)})),{close:f,submit:function(){return T(r,void 0,void 0,(function(){var e;return D(this,(function(t){switch(t.label){case 0:return l.value?(f(),[2]):p.value?[4,p.value.validate()]:[2];case 1:return t.sent()?[4,_(s,{name:u.name})]:[3,3];case 2:t.sent(),l.value=!0,e=new CustomEvent("export-course-package-status-change"),window.dispatchEvent(e),o||(o=window.setInterval(v,1500)),f(),t.label=3;case 3:return[2]}}))}))},visibleChange:function(e){return T(r,void 0,void 0,(function(){return D(this,(function(t){return e?(p.value&&(p.value.resetFields(),u.name=c),[2]):(f(),[2])}))}))},form:u,formRef:p,rules:d,processing:l}}}),E=n(551900),N=(0,E.Z)(I,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Modal",{attrs:{value:e.show,title:e.$t("coursePackage.make")},on:{"on-visible-change":e.visibleChange}},[e.processing?n("div",[e._v(e._s(e.$t("coursePackage.processing")))]):n("Form",{ref:"formRef",attrs:{model:e.form,rules:e.rules}},[n("FormItem",{attrs:{label:e.$t("coursePackage.searchPlaceholder"),prop:"name"}},[n("Input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1),e._v(" "),n("template",{slot:"footer"},[n("Button",{on:{click:e.close}},[e._v(e._s(e.$t("cancel")))]),e._v(" "),n("Button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary"},on:{click:e.submit}},[e._v(e._s(e.$t("confirm")))])],1)],2)}),[],!1,null,"86e92ccc",null).exports,$=n(966309),R=n(866473),j=n(922942),P=n(311610),M=n(202669),O=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},G=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},A=(0,i.aZ)({props:{value:{type:Boolean,required:!0},name:{type:String,required:!0}},setup:function(e,t){var n=this,o=(0,i.qj)({name:""}),r={name:[{required:!0,validator:function(e,t,n){""===t.trim()?n(new Error(a.default.t("required_field"))):n()}}]},s=(0,i.iH)();(0,i.YP)((function(){return e.name}),(function(e){o.name=e}));var l=function(){t.emit("input",!1)};return{form:o,rules:r,formRef:s,close:l,submit:function(){return O(n,void 0,void 0,(function(){return G(this,(function(e){switch(e.label){case 0:return s.value?[4,s.value.validate()]:[2];case 1:return e.sent()&&(t.emit("on-submit",o.name),l()),[2]}}))}))}}}}),Z=(0,E.Z)(A,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Modal",{attrs:{value:e.value,title:e.$t("edit")}},[n("Form",{ref:"formRef",attrs:{model:e.form,rules:e.rules}},[n("FormItem",{attrs:{label:e.$t("coursePackage.searchPlaceholder"),prop:"name"}},[n("Input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1),e._v(" "),n("template",{slot:"footer"},[n("Button",{on:{click:e.close}},[e._v(e._s(e.$t("cancel")))]),e._v(" "),n("Button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary"},on:{click:e.submit}},[e._v(e._s(e.$t("confirm")))])],1)],2)}),[],!1,null,null,null).exports,H=n(383228),F=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},B=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},z=(0,i.aZ)({components:{SvgIcon:P.Z,EditModal:Z,Breadcrumb:R.Breadcrumb,BreadcrumbItem:R.BreadcrumbItem},props:["courseId"],setup:function(e){var t,n=this,o=(0,i.iH)(""),r=(0,i.iH)(!1),s=(0,i.iH)(0),d=(0,i.iH)(""),p=(0,j.h0)((function(t,n){return function(e,t,n,o){return void 0===t&&(t=1),void 0===n&&(n=10),void 0===o&&(o=""),y(void 0,void 0,void 0,(function(){var r,i,a,s,d;return w(this,(function(p){switch(p.label){case 0:return[4,l().get("/api/courses/".concat(e,"/course-package"),{params:{page:t,page_size:n,keyword:o}})];case 1:return r=p.sent(),i=r.data.data,a=i.items,s=b(i,["items"]),(d=(0,u.camelizeKeys)(s)).items=(0,c.d8)(g,a),[2,d]}}))}))}(e.courseId,t,n,o.value)})),f=null===(t=(0,i.FN)())||void 0===t?void 0:t.proxy;(0,$.ORN)(window,"export-course-package-status-change",(function(){p.pageChanged(1)}));var v=function(e,t){s.value=e,d.value=t,r.value=!0},h=function(e){return F(n,void 0,void 0,(function(){return B(this,(function(t){switch(t.label){case 0:return[4,M.Z.open({title:a.default.t("info"),content:a.default.t("coursePackage.del"),type:"warning"})];case 1:return t.sent()?[4,k(e)]:[3,3];case 2:t.sent(),p.fetch(),t.label=3;case 3:return[2]}}))}))},m=function(e){window.open(e)},_=function(e){return F(n,void 0,void 0,(function(){return B(this,(function(t){switch(t.label){case 0:return[4,M.Z.open({title:a.default.t("info"),content:a.default.t("coursePackage.copy"),type:"warning"})];case 1:return t.sent()?[4,x(e)]:[3,3];case 2:t.sent(),f.$Message.success(a.default.t("save_success")),t.label=3;case 3:return[2]}}))}))},C=[{title:a.default.t("coursePackage.name"),key:"name",tooltip:!0},{title:a.default.t("created_at"),render:function(e,t){var n=null==t?void 0:t.row,o="--";return"success"!==n.status&&"fail"!==n.status||(o=n.lastUpdatedAt),e("div",[o])},tooltip:!0},{title:a.default.t("size"),key:"size"},{title:a.default.t("authz.status"),render:function(e,t){var n,o=null===(n=null==t?void 0:t.row)||void 0===n?void 0:n.status,r="";return r="success"===o?a.default.t("coursePackage.exportSuccess"):"progressing"===o?a.default.t("coursePackage.exporting"):a.default.t("coursePackage.exportFailed"),e("div",{class:"course-package-status"},[e("span",{class:["status","badge-".concat(o)]},[r])])}},{title:a.default.t("operation"),render:function(e,t){var n=null==t?void 0:t.row,o=function(){return e(R.Tooltip,{attrs:{placement:"top",content:a.default.t("delete")}},[e("span",{on:{click:function(){return h(n.id)}}},[e("i",{class:"font font-delete"})])])};return"success"===n.status?e("div",{class:"actions"},[[function(){return e(R.Tooltip,{attrs:{placement:"top",content:a.default.t("edit")}},[e("span",{on:{click:function(){return v(n.id,n.name)}}},[e("i",{class:"font font-edit"})])])},o,function(){return e(R.Tooltip,{attrs:{placement:"top",content:a.default.t("download")}},[e("span",{on:{click:function(){return m(n.url)}}},[e("i",{class:"font font-download"})])])}].map((function(e){return e()}))]):"progressing"===n.status?e("div"):e("div",[o()])}}];return(0,i.bv)((function(){p.fetch()})),{keyword:o,columns:C,page:p,showEditModal:r,packageName:d,changeName:function(e){return F(n,void 0,void 0,(function(){var t;return B(this,(function(n){switch(n.label){case 0:return[4,(o=s.value,r={name:e},y(void 0,void 0,void 0,(function(){return w(this,(function(e){switch(e.label){case 0:return[4,l().put("/api/course-packages/".concat(o,"?no_check=true"),r)];case 1:return[2,e.sent().data]}}))})))];case 1:return n.sent(),(t=p.data.items.find((function(e){return e.id===s.value})))&&(t.name=e),[2]}var o,r}))}))},edit:v,del:h,download:m,copy:_,search:function(){p.pageChanged(1)},back:function(){window.location.href="/course/".concat(e.courseId,"/content")},openModal:function(){var e=H("export-course-package-modal").get(0);e&&(e.show=!0)}}}}),L=(0,E.Z)(z,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"course-package-wrapper"},[n("div",{staticClass:"breadcrumb"},[n("a",{on:{click:e.back}},[e._v(e._s(e.$t("backParentList")))]),e._v("\n    |\n    "),n("a",{staticClass:"back-to-content",attrs:{href:"/course/"+e.courseId+"/content"}},[e._v("章节")]),e._v(" "),n("i",{staticClass:"font font-chevron-right"}),e._v(" "),n("span",[e._v("导出课程包")])]),e._v(" "),n("div",{staticClass:"course-package-header"},[n("Button",{attrs:{type:"primary"},on:{click:e.openModal}},[e._v(e._s(e.$t("coursePackage.make")))]),e._v(" "),n("Input",{staticStyle:{width:"220px"},attrs:{placeholder:e.$t("coursePackage.searchPlaceholder"),search:"","enter-button":""},on:{"on-search":e.search},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}})],1),e._v(" "),n("div",{staticClass:"course-package-list"},[n("Table",{attrs:{data:e.page.data.items,columns:e.columns,strip:!0}}),e._v(" "),n("div",{staticClass:"pagination"},[n("Page",{directives:[{name:"show",rawName:"v-show",value:e.page.data.pages>0,expression:"page.data.pages > 0"}],attrs:{total:e.page.data.total,"page-size":e.page.data.pageSize,current:e.page.data.page,"page-size-opts":[10,20,30,40],"show-elevator":"","show-sizer":"","show-total":""},on:{"on-change":e.page.pageChanged,"on-page-size-change":e.page.pageSizeChanged}})],1)],1),e._v(" "),n("EditModal",{attrs:{name:e.packageName},on:{"on-submit":e.changeName},model:{value:e.showEditModal,callback:function(t){e.showEditModal=t},expression:"showEditModal"}})],1)}),[],!1,null,"7df31617",null).exports;o.default.use(r.default),o.default.customElement("export-course-package-modal",N),o.default.customElement("course-package-list",L)},894856:function(e,t,n){"use strict";n.d(t,{NX:function(){return s},T0:function(){return a},rE:function(){return c},w7:function(){return l}});var o=n(413447),r=n(247251),i=function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},a=function(){function e(){this.type="course",this.nodeCount=0,this.resourceCount=0,this.studentCount=0,this.chapterCount=0}return e.prototype.getUrl=function(){return"/course/".concat(this.id)},e.prototype.getAverageScore=function(){throw new Error("Method not implemented.")},i([(0,o.C)()],e.prototype,"id",void 0),i([(0,o.C)({name:"display_name"})],e.prototype,"name",void 0),i([(0,o.C)({name:"small_cover"}),(0,o.C)({name:"cover"}),(0,r.w)((function(e){var t=e.obj;return t.small_cover||t.cover}))],e.prototype,"cover",void 0),i([(0,o.C)({name:"knowledge_node_count"})],e.prototype,"nodeCount",void 0),i([(0,o.C)({name:"activity_count"})],e.prototype,"resourceCount",void 0),i([(0,o.C)({name:"course_attributes"}),(0,r.w)((function(e){var t;return(null===(t=e.obj.course_attributes)||void 0===t?void 0:t.student_count)||0}))],e.prototype,"studentCount",void 0),i([(0,o.C)({name:"syllabus_count"}),(0,o.C)({name:"module_count"}),(0,r.w)((function(e){var t=e.obj;return(t.module_count||0)+(t.syllabus_count||0)}))],e.prototype,"chapterCount",void 0),i([(0,o.C)({name:"public_scope"})],e.prototype,"scope",void 0),i([(0,o.C)({name:"course_public_settings"}),(0,r.w)((function(e){var t;return!!(null===(t=e.obj.course_public_settings)||void 0===t?void 0:t.sign_up_charge_amount)}))],e.prototype,"isPaidCourse",void 0),i([(0,o.C)({name:"selected_certification"}),(0,r.w)((function(e){var t;return(null===(t=e.obj.selected_certification)||void 0===t?void 0:t.certification_title)||""}))],e.prototype,"certification",void 0),i([(0,o.C)(),(0,r.w)((function(e){var t=e.value;if(t)return t.map((function(e){var t=e.id,n=e.avatar_small_url;return{id:t,name:e.name,avatar:n}}))}))],e.prototype,"instructors",void 0),i([(0,o.C)({name:"is_started"})],e.prototype,"isStarted",void 0),i([(0,o.C)({name:"credit_state"}),(0,r.w)((function(e){return!!e.obj.credit_state}))],e.prototype,"isAir",void 0),e}(),s=function(){function e(){this.type="curriculum",this.nodeCount=0,this.resourceCount=0,this.studentCount=0,this.chapterCount=0,this.scope=""}return e.prototype.getUrl=function(){return"/curriculum/".concat(this.id)},e.prototype.getAverageScore=function(){throw new Error("Method not implemented.")},i([(0,o.C)()],e.prototype,"id",void 0),i([(0,o.C)()],e.prototype,"name",void 0),i([(0,o.C)()],e.prototype,"cover",void 0),i([(0,o.C)({name:"course_public_settings"}),(0,r.w)((function(e){var t;return!!(null===(t=e.obj.course_public_settings)||void 0===t?void 0:t.sign_up_charge_amount)}))],e.prototype,"isPaidCourse",void 0),i([(0,o.C)({name:"selected_certification"}),(0,r.w)((function(e){var t;return(null===(t=e.obj.selected_certification)||void 0===t?void 0:t.certification_title)||""}))],e.prototype,"certification",void 0),i([(0,o.C)({name:"is_started"})],e.prototype,"isStarted",void 0),i([(0,o.C)({name:"credit_state"}),(0,r.w)((function(e){return!!e.obj.credit_state}))],e.prototype,"isAir",void 0),e}(),l=function(){function e(){}return i([(0,o.C)({name:"course_count"})],e.prototype,"courseCount",void 0),i([(0,o.C)({name:"student_count"})],e.prototype,"studentCount",void 0),e}(),c=function(){function e(){}return i([(0,o.C)({name:"curriculum_count"})],e.prototype,"courseCount",void 0),i([(0,o.C)({name:"student_count"})],e.prototype,"studentCount",void 0),e}()},563507:function(e,t,n){"use strict";n.d(t,{H:function(){return r}});n(324603),n(339714),n(115306);var o=n(370538).default,r=function(e,t){var n=e;return t&&(n=e.replace(new RegExp(t,"g"),"<mark>".concat(t,"</mark>"))),o.prototype.$sanitize(n,{allowedTags:["mark"]})}},128351:function(e,t,n){"use strict";n.d(t,{zm:function(){return d}});n(702707),n(115306);var o=n(413447),r=n(526617),i=n(247251),a=n(23441),s=function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},l=function(){this.id=0,this.projectName="",this.certificationTitle="",this.studyThreshold=0},c=function(){function e(){this.name="",this.id=0}return s([(0,o.C)()],e.prototype,"name",void 0),s([(0,o.C)()],e.prototype,"id",void 0),e}(),u=function(){function e(){this.data={}}return s([(0,o.C)()],e.prototype,"data",void 0),e}(),d=function(){function e(){this.id=0,this.access="",this.studentsCount=0,this.classroomSchedule="",this.name="",this.compulsory=!1,this.courseCode="",this.coursePictures=[],this.publicScope="private",this.klass=new c,this.department=new c,this.grade=new c,this.courseClassification=new c,this.startDate="",this.endDate="",this.instructors=[],this.openedDepartments=[],this.openedRoles=[],this.selectedCertification=new l,this.courseAttributes=new u,this.modules=[],this.knowledgeGraphPublishType=""}return Object.defineProperty(e.prototype,"startDateDisplay",{get:function(){return this.startDate.replace(/-/g,".")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"endDateDisplay",{get:function(){return this.endDate.replace(/-/g,".")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sortedModules",{get:function(){return this.modules.sort((function(e,t){return e.sort-t.sort}))},enumerable:!1,configurable:!0}),s([(0,o.C)()],e.prototype,"id",void 0),s([(0,o.C)()],e.prototype,"access",void 0),s([(0,o.C)()],e.prototype,"studentsCount",void 0),s([(0,o.C)()],e.prototype,"classroomSchedule",void 0),s([(0,o.C)()],e.prototype,"name",void 0),s([(0,o.C)()],e.prototype,"compulsory",void 0),s([(0,o.C)()],e.prototype,"courseCode",void 0),s([(0,o.C)()],e.prototype,"coursePictures",void 0),s([(0,o.C)()],e.prototype,"publicScope",void 0),s([(0,o.C)()],e.prototype,"credit",void 0),s([(0,o.C)(),(0,r.D)((function(){return c})),(0,i.w)((function(e){return e.value||new c}),{toClassOnly:!0})],e.prototype,"klass",void 0),s([(0,o.C)(),(0,r.D)((function(){return c})),(0,i.w)((function(e){return e.value||new c}),{toClassOnly:!0})],e.prototype,"department",void 0),s([(0,o.C)(),(0,r.D)((function(){return c})),(0,i.w)((function(e){return e.value||new c}),{toClassOnly:!0})],e.prototype,"grade",void 0),s([(0,o.C)(),(0,r.D)((function(){return c})),(0,i.w)((function(e){return e.value||new c}),{toClassOnly:!0})],e.prototype,"courseClassification",void 0),s([(0,o.C)()],e.prototype,"startDate",void 0),s([(0,o.C)()],e.prototype,"endDate",void 0),s([(0,o.C)()],e.prototype,"isBlocked",void 0),s([(0,o.C)()],e.prototype,"instructors",void 0),s([(0,o.C)()],e.prototype,"openedDepartments",void 0),s([(0,o.C)()],e.prototype,"openedRoles",void 0),s([(0,o.C)()],e.prototype,"selectedCertification",void 0),s([(0,o.C)(),(0,r.D)((function(){return u}))],e.prototype,"courseAttributes",void 0),s([(0,o.C)(),(0,r.D)((function(){return f}))],e.prototype,"modules",void 0),s([a.F],e.prototype,"sortedModules",null),s([(0,o.C)()],e.prototype,"knowledgeGraphPublishType",void 0),e}(),p=function(){function e(){this.id=0,this.moduleId=0,this.sort=0,this.summary="",this.activities=[]}return s([(0,o.C)()],e.prototype,"id",void 0),s([(0,o.C)()],e.prototype,"moduleId",void 0),s([(0,o.C)()],e.prototype,"sort",void 0),s([(0,o.C)()],e.prototype,"summary",void 0),e}(),f=function(){function e(){this.id=0,this.name="",this.sort=0,this.syllabuses=[],this.activities=[]}return Object.defineProperty(e.prototype,"sortedSyllabuses",{get:function(){return this.syllabuses.sort((function(e,t){return e.sort-t.sort}))},enumerable:!1,configurable:!0}),s([(0,o.C)()],e.prototype,"id",void 0),s([(0,o.C)()],e.prototype,"name",void 0),s([(0,o.C)()],e.prototype,"sort",void 0),s([(0,o.C)(),(0,r.D)((function(){return p}))],e.prototype,"syllabuses",void 0),s([a.F],e.prototype,"sortedSyllabuses",null),e}()},959769:function(e,t,n){"use strict";n.d(t,{P5:function(){return c},bG:function(){return s},fK:function(){return l}});n(141817),n(66992),n(788674),n(333948);var o=n(117403),r=n(202669),i=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},a=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},s=function(){var e=!window.orgSettings.xjtuKnowledgeMode;return{tooltipCompletionRate:e?o.default.t("knowledgeGraph.statistics.nodeCompletenessRateDescription"):o.default.t("knowledgeGraph.statistics.xjtuNodeCompletenessRateDescription"),tooltipSingleCompletionRate:e?o.default.t("knowledgeGraph.statistics.nodeCompletenessRateDescription"):o.default.t("knowledgeGraph.statistics.xjtuSingleNodeCompletenessRateDescription"),tooltipMasteryRate:e?o.default.t("knowledgeGraph.statistics.nodeMasteryRateDescription"):o.default.t("knowledgeGraph.statistics.xjtuNodeMasteryRateDescription"),isNormalMode:e}},l=function(e){var t=e[0],n=e[1],s=e[2],l=e[3],c=e[4];return i(void 0,void 0,void 0,(function(){var e;return a(this,(function(i){switch(i.label){case 0:return e=function(e){var r=function(t){return e("div",{style:{display:"flex","align-items":"center",gap:"10px"}},[e("span",{style:{display:"inline-block",width:"4px",height:"4px","border-radius":"4px",background:"#70748C"}}),t])},i=[];return c>1&&i.push(r(o.default.t("knowledgeGraph.delTips.withChild",[c-1]))),n&&i.push(r(o.default.t("knowledgeGraph.delTips.withResource",[n]))),l&&i.push(r(o.default.t("knowledgeGraph.delTips.withCapture",[l]))),t&&i.push(r(o.default.t("knowledgeGraph.delTips.withActivity",[t]))),s&&i.push(r(o.default.t("knowledgeGraph.delTips.withSubject",[s]))),i.length>0?e("div",[e("div",{style:{"font-size":"16px","font-weight":500,padding:"10px","text-align":"center"}},o.default.t("knowledgeGraph.delTips.normal")),e("div",{style:{background:"#F5F5F5",padding:"12px 16px","border-radius":"3px"}},i)]):e("div",o.default.t("knowledgeGraph.delTips.normal"))},[4,r.Z.open({title:o.default.t("delete"),type:"warning",divider:c>1,width:c>1?480:416,render:e})];case 1:return[2,i.sent()]}}))}))},c=function(e){var t=e[0],n=e[1],s=e[2],l=e[3],c=e[4];return i(void 0,void 0,void 0,(function(){var e;return a(this,(function(i){switch(i.label){case 0:return e=function(e){var r=function(t){return e("div",{style:{display:"flex","align-items":"center",gap:"10px"}},[e("span",{style:{display:"inline-block",width:"4px",height:"4px","border-radius":"4px",background:"#70748C"}}),t])},i=[];return n&&i.push(r(o.default.t("knowledgeGraph.delTips.withResource",[n]))),l&&i.push(r(o.default.t("knowledgeGraph.delTips.withCapture",[l]))),t&&i.push(r(o.default.t("knowledgeGraph.delTips.withActivity",[t]))),s&&i.push(r(o.default.t("knowledgeGraph.delTips.withSubject",[s]))),i.length>0?e("div",[e("div",{style:{"font-size":"16px","font-weight":500,padding:"10px","text-align":"center"}},o.default.t("knowledgeGraph.delTips.batchDel",[c])),e("div",{style:{background:"#F5F5F5",padding:"12px 16px","border-radius":"3px"}},i)]):e("div",o.default.t("knowledgeGraph.delTips.batchDel",[c]))},[4,r.Z.open({title:o.default.t("delete"),type:"warning",divider:!!(t||n||s||l),width:480,render:e})];case 1:return[2,i.sent()]}}))}))}},82720:function(e,t,n){"use strict";n.d(t,{LH:function(){return u},Nb:function(){return d},Sk:function(){return c},W3:function(){return s},ci:function(){return p},wO:function(){return r},zx:function(){return f}});n(454747);var o,r,i=n(117403),a=n(156209),s=[{key:"undirected",name:i.default.t("knowledgeGraph.relatedNode")},{key:"prev",name:i.default.t("knowledgeGraph.preNode")},{key:"post",name:i.default.t("knowledgeGraph.postNode")}];!function(e){e.FOREST="forest",e.LEVEL="level",e.COMPLETENESS="completeness",e.MASTERY="mastery",e.KNOWLEDGE_TREE="knowledge-tree"}(r||(r={}));var l=[i.default.t("knowledgeGraph.viewByNode"),i.default.t("knowledgeGraph.viewByCompletion"),i.default.t("knowledgeGraph.viewByMastery")],c=(Object.keys(r).map((function(e,t){return{key:r[e],value:l[t]}})),[{key:r.COMPLETENESS,value:l[1]},{key:r.MASTERY,value:l[2]}]),u=((o={})[r.LEVEL]={course:a.KV[0],levelRelation:a.KV[0],nodes:a.KV},o[r.COMPLETENESS]={course:a.wR[0],levelRelation:a.wR[1],nodes:a.wR},o[r.MASTERY]={course:a.$e[0],levelRelation:a.$e[1],nodes:a.$e},o[r.KNOWLEDGE_TREE]={course:a.KV[0],levelRelation:a.KV[0],nodes:a.KV},o),d=[{key:"remember",value:i.default.t("knowledgeGraph.cognitiveDimension.remember")},{key:"understand",value:i.default.t("knowledgeGraph.cognitiveDimension.understand")},{key:"apply",value:i.default.t("knowledgeGraph.cognitiveDimension.apply")},{key:"analyze",value:i.default.t("knowledgeGraph.cognitiveDimension.analyze")},{key:"evaluate",value:i.default.t("knowledgeGraph.cognitiveDimension.evaluate")},{key:"create",value:i.default.t("knowledgeGraph.cognitiveDimension.create")}],p={remember:{backgroundColor:"#f4edff",color:"#a21fbf"},understand:{backgroundColor:"#d6e8ff",color:"#3471d3"},apply:{backgroundColor:"#b7e6e4",color:"#1ca5ad"},analyze:{backgroundColor:"#fef3c5",color:"#d49e33"},evaluate:{backgroundColor:"#fceccc",color:"#f28500"},create:{backgroundColor:"#fed1ca",color:"#df4b4b"}},f={};d.forEach((function(e){f[e.key]=e.value}))},643406:function(e,t,n){"use strict";n.d(t,{Y:function(){return o}});var o=new(n(370538).default)},640599:function(e,t,n){"use strict";n.d(t,{W:function(){return u}});n(339714);var o,r=n(730854),i=function(){function e(e){this.container=e;var t=this.container.getBoundingClientRect(),n=t.width,o=t.height;this.width=n,this.height=o,this.center={x:n/2,y:o/2},this.div=(0,r.Ys)(this.container).append("div").style("height","100%"),this.svg=this.div.append("svg").attr("viewBox","0, 0, ".concat(n,", ").concat(o)).style("display","block").style("overflow","visible").style("height","100%").style("width","100%"),this.g=this.svg.append("g")}return e.prototype.arrow=function(e,t,n,o){var r=Math.atan2(t.y-e.y,t.x-e.x),i=r+n*Math.PI/180,a=r-n*Math.PI/180;return[{x:t.x-Math.cos(i)*o,y:t.y-Math.sin(i)*o},{x:t.x-Math.cos(a)*o,y:t.y-Math.sin(a)*o}]},e.prototype.resize=function(e,t){this.width=e,this.height=t,this.svg.attr("viewBox","0, 0, ".concat(e,", ").concat(t)),this.center={x:e/2,y:t/2}},e.prototype.crossing=function(e,t){var n=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2));return[{x:e.x+e.r*(t.x-e.x)/n,y:e.y+e.r*(t.y-e.y)/n},{x:t.x-t.r*(t.x-e.x)/n,y:t.y-t.r*(t.y-e.y)/n}]},e}(),a=(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=function(e){function t(t){var n=e.call(this,t)||this;return n.simulation=(0,r.A4v)().on("tick",n.tick.bind(n)),n.defaultForces(),n}return a(t,e),t.prototype.defaultForces=function(){this.forceCenter(this.center).forceCharge(-300)},t.prototype.forceX=function(e){var t=e?(0,r.RUJ)(e):(0,r.RUJ)();return this.simulation.force("x",t),this},t.prototype.forceY=function(e){var t=e?(0,r.Mrm)(e):(0,r.Mrm)();return this.simulation.force("y",t),this},t.prototype.forceLink=function(e,t,n){void 0===t&&(t=.7);var o=(0,r.Fsl)(e).id((function(e){return e.id.toString()})).strength(t);return n&&(o=o.distance(n)),this.simulation.force("link",o),this},t.prototype.forceCollide=function(e,t,n){return void 0===t&&(t=.1),void 0===n&&(n=1),this.simulation.force("collide",(0,r.Hh)().radius((function(t){var o;return(null!==(o=t.r)&&void 0!==o?o:e)*n})).strength(t)),this},t.prototype.forceCenter=function(e){var t=e.x,n=e.y;return this.simulation.force("center",(0,r.wqt)(t,n)),this},t.prototype.forceCharge=function(e){return this.simulation.force("charge",(0,r.q5i)().strength(e)),this},t.prototype.data=function(e){return this.simulation.nodes(e),this},t.prototype.restart=function(e){return void 0===e&&(e=1),this.simulation.alpha(e).restart().tick(100),this},t}(i),l=(n(365069),n(323123),n(973571)),c=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),u=function(e){function t(t){var n=e.call(this,t)||this;return n.link=n.g.append("g").classed("link",!0).selectAll("path"),n.node=n.g.append("g").classed("node",!0).selectAll("circle"),n.text=n.g.append("g").classed("text",!0).selectAll("text"),n.zoomer=(0,l.UH)(n.div,n.width,n.height),(0,r.Ys)(n.container).call(n.zoomer).on("dblclick.zoom",null),n}return c(t,e),t.prototype.tick=function(){var e=this;this.node.attr("cx",(function(e){return e.x})).attr("cy",(function(e){return e.y})),this.text.attr("x",(function(e){return(0,l.zP)(e.x,e.r-4*e.level)})).attr("y",(function(e){return e.y})),this.link.attr("d",(function(t){var n=e.node.data().find((function(e){return e.id===t.source.id})),o=e.node.data().find((function(e){return e.id===t.target.id})),r=e.crossing({x:t.source.x,y:t.source.y,r:n.r-4*n.level},{x:t.target.x,y:t.target.y,r:o.r-4*o.level}),i=r[0],a=r[1];return"M ".concat(i.x," ").concat(i.y," L ").concat(a.x," ").concat(a.y)}))},t.prototype.wrapWord=function(e,t){e.each((function(e,n,o){for(var i,a,s,l,c,u=(0,r.Ys)(o[n]).text(e.name),d=u.text().split("").reverse(),p=null!==(a=null===(i=u.node())||void 0===i?void 0:i.getBoundingClientRect().height)&&void 0!==a?a:0,f=[],v=0,h=u.text(null).append("tspan").attr("line",v).attr("line-height",p);c=d.pop();)f.push(c),h.text(f.join("")),(null!==(l=null===(s=h.node())||void 0===s?void 0:s.getComputedTextLength())&&void 0!==l?l:0)>t&&(f.pop(),h.text(f.join("")),f=[c],h=u.append("tspan").text(c).attr("line",++v).attr("line-height",p));u.selectAll("tspan").attr("lines",v).attr("dy","0.3em")}))},t.prototype.resetZoom=function(){(0,r.Ys)(this.container).transition().call(this.zoomer.transform,r.CRH)},t.prototype.zoomIn=function(){(0,r.Ys)(this.container).transition().call(this.zoomer.scaleBy,2)},t.prototype.zoomOut=function(){(0,r.Ys)(this.container).transition().call(this.zoomer.scaleBy,.5)},t.prototype.resize=function(t,n){var o=this.container.getBoundingClientRect(),r=o.width,i=o.height;e.prototype.resize.call(this,null!=t?t:r,null!=n?n:i),this.zoomer&&this.zoomer.extent([[0,0],[this.width,this.height]])},t}(s)},159820:function(e,t,n){"use strict";n.d(t,{U_:function(){return a},ab:function(){return l},b7:function(){return c}});n(141817),n(66992),n(788674),n(333948);var o=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},r=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},i=function(e){return new Promise((function(t,n){var o=new Image;o.src=e,o.onload=function(){return t(o)}}))},a=new(function(){function e(){this.cache={}}return e.prototype.get=function(e){return this.cache[e]},e.prototype.add=function(e,t){return o(this,void 0,void 0,(function(){var n,o;return r(this,(function(r){switch(r.label){case 0:return n=this.cache,o=t,[4,i(e)];case 1:return n[o]=r.sent(),[2]}}))}))},e}()),s=[[n(328816),"node-sprite"]],l=function(){return o(void 0,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,Promise.all(s.map((function(e){var t=e[0],n=e[1];return a.add(t,n)})))];case 1:return e.sent(),[2,a]}}))}))},c=[[{sx:10,sy:10,sw:140,sh:140},{sx:210,sy:10,sw:95,sh:95},{sx:410,sy:10,sw:80,sh:80},{sx:610,sy:10,sw:80,sh:80},{sx:810,sy:10,sw:80,sh:80},{sx:1010,sy:10,sw:80,sh:80},{sx:1210,sy:10,sw:80,sh:80}],[{sx:0,sy:200,sw:155,sh:155},{sx:200,sy:200,sw:110,sh:110},{sx:400,sy:200,sw:95,sh:95},{sx:600,sy:200,sw:95,sh:95},{sx:800,sy:200,sw:95,sh:95},{sx:1e3,sy:200,sw:95,sh:95},{sx:1200,sy:200,sw:95,sh:95}]]},156209:function(e,t,n){"use strict";n.d(t,{wR:function(){return r.wR},KV:function(){return r.KV},$e:function(){return r.$e},OO:function(){return r.OO},LL:function(){return c}});var o,r=n(420566),i=(n(132023),n(730854)),a=n(640599),s=n(973571),l=(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),c=function(e){function t(t,n){void 0===n&&(n={});var o,a,s=this;return(s=e.call(this,t)||this).action=n,s.status={dragging:!1},s.menu=(0,i.Ue8)("div").style("position","absolute").style("z-index",1e4),s.menu.append("button").datum({}).text(null!==(a=null===(o=s.action.remove)||void 0===o?void 0:o.text)&&void 0!==a?a:"").style("font-size","12px").on("click",(function(e){s.action.remove&&s.action.remove.fn(e)})),s.svg.append("defs").append("marker").attr("id","arrow").attr("markerUnits","userSpaceOnUse").attr("viewBox","0 -5 10 10").attr("refX",10).attr("markerWidth",8).attr("markerHeight",8).attr("orient","auto").attr("stroke-width",1).attr("fill",r.OO).append("path").attr("d","M 0 -5 L 10 0 L 0 5"),s}return l(t,e),t.prototype.update=function(e,t){var n=this;0!==e.length&&(this.link=this.link.data(t,(function(e){return e.id})).join((function(e){return e.append("path").attr("id",(function(e){return"link-".concat(e.id)})).attr("stroke",r.OO).attr("stroke-dasharray","3,3").attr("marker-end",(function(e){return e.isDirected?"url(#arrow)":null}))}),(function(e){return e}),(function(e){return e.remove()})),this.node=this.node.data(e,(function(e){return e.id})).join((function(e){return e.append("circle").attr("cx",n.center.x).attr("cy",n.center.y).attr("id",(function(e){return"node-".concat(e.id)})).attr("r",(function(e){return e.r-4*e.level})).attr("fill",(function(e){return r.KV[e.level]})).on("contextmenu",(function(e){if(i.Ba6.preventDefault(),!e.current){var t=(0,i.Ys)("body").node(),o=n.menu.node();n.menu.select("button").datum(e);var r=[i.Ba6.pageX,i.Ba6.pageY],a=r[0],s=r[1];o.style.left="".concat(a,"px"),o.style.top="".concat(s+10,"px"),t.contains(o)||t.append(o);var l=n;document.addEventListener("click",(function e(){l.menu.node().remove(),document.removeEventListener("click",e)}))}})).call((0,s.LC)(n.simulation,n.status)).on("mouseover",(function(){var e=(0,i.Ys)(i.Ba6.target).datum();e.current||(n.node.filter((function(t){return!t.current&&e.id!==t.id})).transition().style("opacity",.1),n.text.filter((function(t){return!t.current&&e.id!==t.id})).transition().style("opacity",.1),n.link.filter((function(t){return![t.source.id,t.target.id].includes(e.id)})).transition().style("opacity",.1))})).on("mouseout",(function(){n.node.transition().style("opacity",null),n.link.transition().style("opacity",null),n.text.transition().style("opacity",null)}))}),(function(e){return e}),(function(e){return e.remove()})),this.text=this.text.data(e,(function(e){return e.id})).join((function(e){return e.append("text").attr("x",(function(e){return(0,s.zP)(e.x,e.r)})).attr("y",(function(e){return e.y})).attr("dy","0.3em").attr("dx","1em").style("user-select","none").text((function(e){return e.name}))}),(function(e){return e}),(function(e){return e.remove()})),this.wrapWord(this.text,100),this.data(e).forceLink(t,void 0,130).restart())},t}(a.W);n(623411)},476342:function(e,t,n){"use strict";n.d(t,{C:function(){return p},i:function(){return d}});n(682772),n(66992),n(747042),n(925438),n(324603),n(339714),n(470189),n(132023),n(115306),n(323123),n(573210),n(454747),n(333948);var o,r=n(730854),i=n(623411),a=n(159820),s=n(486992),l=n(643406),c=(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),u=function(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))},d=function(e){function t(t){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];var i=this,a=document.createElement("custom");(i=e.apply(this,u([a],n,!1))||this).container=t,i.nodes=[],i.links=[],i.transform=r.CRH,i.dpr=window.devicePixelRatio,i.hovering=!1,i.active=!1,i.maxAlpha=1,i.minAlpha=.1,i.hiddenNodeIds=new Set,i.selectedNodeId=-1,i.keywords="",i.canvas=(0,r.Ys)(t).append("canvas").node(),i.context=i.canvas.getContext("2d"),i.canvasZoomer=i.zoom(),i.resize();var s=null,c=500;return(0,r.Ys)(i.canvas).on("mousemove",i.mousemoveHandle.bind(i)).on("click",(function(){var e=r.Ba6;null===s?s=window.setTimeout((function(){s=null,i.clickHandle(e)}),c):(clearTimeout(s),s=null,i.doubleClickHandle())})).call(i.drag()).on("mousedown",(function(){l.Y.$emit("graphClick")})).call(i.canvasZoomer).on("dblclick.zoom",null),i.tooltipHtml&&(i.tooltip=(0,r.Ys)(i.container).append("div").attr("class","d3-tooltip").style("background-color","#464C5B").style("color","white").style("border-radius","5px").style("padding","10px").style("position","absolute").style("display","none").style("z-index","999")),i.animate(),i}return c(t,e),t.prototype.stage=function(){this.canvas.width=this.width*this.dpr,this.canvas.height=this.height*this.dpr,this.canvas.style.width="".concat(this.width,"px"),this.canvas.style.height="".concat(this.height,"px"),this.forceCenter({x:this.width/2,y:this.height/2})},t.prototype.tick=function(){},t.prototype.getRelationByNode=function(e){var t=e.id,n=new Set([t]),o=new Set;return this.links.filter((function(e){return e.source.id===t||e.target.id===t})).forEach((function(e){o.add(e.id),n.add(e.source.id),n.add(e.target.id)})),[this.nodes.filter((function(e){return n.has(e.id)})),this.links.filter((function(e){return o.has(e.id)}))]},t.prototype.isCollapsed=function(e){var t,n=((null===(t=e.knowledgeTreeNode)||void 0===t?void 0:t.children)||[])[0];return!!(null==n?void 0:n.id)&&this.hiddenNodeIds.has(n.id)},t.prototype.calcTooltipPosition=function(e){e.x;var t=e.y,n=this.getNodeRadius(e),o=n+10,r=n-10;return t=e.y<0?Math.abs(this.transform.y)-Math.abs(e.y)*this.transform.k-r:e.y*this.transform.k+this.transform.y-r,{x:e.x*this.transform.k+this.transform.x+o,y:t}},t.prototype.mousemoveHandle=function(){var e=this.getNode((0,r.Jzs)(this.canvas));if(e){this.hovering=!0;var t=this.getRelationByNode(e),n=t[0],o=t[1];if(n.forEach((function(e){e.hover=!0})),o.forEach((function(e){e.hover=!0})),this.tooltip&&this.tooltipHtml){var i=this.calcTooltipPosition(e);this.tooltip.style("display","block").style("top","".concat(i.y,"px")).style("left","".concat(i.x,"px")).html(this.tooltipHtml(e))}this.container.style.cursor="pointer"}else this.hovering=!1,this.nodes.forEach((function(e){return e.hover=!1})),this.links.forEach((function(e){return e.hover=!1})),this.tooltip&&this.tooltipHtml&&this.tooltip.style("display","none"),this.container.style.cursor="initial"},t.prototype.doubleClickHandle=function(){var e=this,t=this.getNode((0,r.Jzs)(this.canvas));if(t){this.collapseNode(t);var n=this.nodes.filter((function(n){return n.level===t.level&&!e.isCollapsed(n)&&n.id!==t.id}));n&&n.length>0&&n.forEach((function(t){e.collapseNode(t)})),this.action.dbClickNode&&this.action.dbClickNode(t),(0,r.Ys)(this.canvas).transition().call(this.canvasZoomer.translateTo,t.x,t.y).on("end",(function(){e.hovering=!1}))}},t.prototype.clickHandle=function(e){var t=this.getNode((0,r.Ebf)(this.canvas,e));if(this.nodes.forEach((function(e){return e.active=!1})),this.links.forEach((function(e){return e.active=!1})),t){this.selectedNodeId=t.id,this.active=!0;var n=this.getRelationByNode(t),o=n[0],i=n[1];this.action.clickNode&&this.action.clickNode(t.id),o.forEach((function(e){e.active=!0})),i.forEach((function(e){e.active=!0}))}else this.active=!1,this.action.clickOutside&&this.action.clickOutside()},t.prototype.findNode=function(e,t,n){var o=this;return void 0===n&&(n=20),this.nodes.find((function(r){return!o.hiddenNodeIds.has(r.id)&&Math.hypot(e-r.x,t-r.y)<n}))},t.prototype.getMousePosition=function(e){return Array.isArray(e)?this.transform.invert(e):this.transform.invert([e.x,e.y])},t.prototype.getNode=function(e){void 0===e&&(e=r.Ba6);var t=this.getMousePosition(e),n=t[0],o=t[1];return this.findNode(n,o)},t.prototype.zoom=function(){var e=this;return(0,r.sPX)().extent([[0,0],[this.width,this.height]]).scaleExtent([.3,4]).on("zoom",(function(){var t=r.Ba6.transform;e.transform=t,e.render(e.nodes,e.links)}))},t.prototype.resetZoom=function(){(0,r.Ys)(this.canvas).transition().call(this.canvasZoomer.transform,r.CRH)},t.prototype.zoomIn=function(){(0,r.Ys)(this.canvas).transition().call(this.canvasZoomer.scaleBy,2)},t.prototype.zoomOut=function(){(0,r.Ys)(this.canvas).transition().call(this.canvasZoomer.scaleBy,.5)},t.prototype.drag=function(){var e=this;return(0,r.ohM)().subject((function(){var t=e.getNode();return t&&(t.x=e.transform.applyX(t.x),t.y=e.transform.applyY(t.y)),t})).clickDistance(10).on("start",(function(){var t,n;r.Ba6.active||(e.simulation.alphaTarget(.1).restart(),t=e.getMousePosition(r.Ba6),r.Ba6.subject.fx=t[0],r.Ba6.subject.fy=t[1],n=e.getMousePosition(r.Ba6),r.Ba6.subject.x=n[0],r.Ba6.subject.y=n[1])})).on("drag",(function(){var t;t=e.getMousePosition(r.Ba6),r.Ba6.subject.fx=t[0],r.Ba6.subject.fy=t[1]})).on("end",(function(){r.Ba6.active||e.simulation.alphaTarget(0),r.Ba6.subject.fx=null,r.Ba6.subject.fy=null}))},t.prototype.setAlpha=function(e){e.alpha||(e.alpha=1),this.hovering?e.hover?e.alpha<this.maxAlpha&&(e.alpha+=.05):e.alpha>this.minAlpha&&(e.alpha-=.05):!e.active&&this.active?e.alpha>this.minAlpha&&(e.alpha-=.05):e.alpha<this.maxAlpha&&(e.alpha+=.05)},t.prototype.animate=function(){requestAnimationFrame(this.animate.bind(this)),this.render(this.nodes,this.links)},t.prototype.drawNormalNode=function(e){var t,n;this.context.beginPath(),this.context.fillStyle=e.color,this.context.arc(e.x,e.y,this.getNodeRadius(e),0,2*Math.PI),this.context.globalAlpha=null!==(t=e.alpha)&&void 0!==t?t:1,this.context.fill(),((null===(n=e.knowledgeTreeNode)||void 0===n?void 0:n.children)||[]).length>0&&(this.context.beginPath(),this.context.strokeStyle="white",this.context.arc(e.x,e.y,5,0,2*Math.PI),this.context.stroke(),this.isCollapsed(e)&&(this.context.beginPath(),this.context.moveTo(e.x,e.y-2),this.context.lineTo(e.x,e.y+2),this.context.stroke()),this.context.beginPath(),this.context.moveTo(e.x-2,e.y),this.context.lineTo(e.x+2,e.y),this.context.stroke()),this.context.closePath()},t.prototype.drawNodeToCanvas=function(e){var t=this;e.forEach((function(e){t.hiddenNodeIds.has(e.id)||t.drawNormalNode(e)}))},t.prototype.getLinkColor=function(e){return e.color},t.prototype.drawLinkToCanvas=function(e){var t=this;e.forEach((function(e){var n,o,r;if(!t.hiddenNodeIds.has(e.source.id)&&!t.hiddenNodeIds.has(e.target.id)){var i=[e.source,e.target],a=i[0],s=i[1],l=t.crossing({x:a.x,y:a.y,r:t.getNodeRadius(a)},{x:s.x,y:s.y,r:t.getNodeRadius(s)}),c=l[0],u=l[1],d=t.arrow(c,u,30,5),p=d[0],f=d[1];t.context.beginPath(),t.context.lineWidth=.6,t.context.strokeStyle=t.getLinkColor(e),t.context.moveTo(c.x,c.y),t.context.lineTo(u.x,u.y),e.id>=0?(t.context.globalAlpha=null!==(n=e.alpha)&&void 0!==n?n:1,t.context.setLineDash([3,3]),t.context.stroke()):(t.context.globalAlpha=null!==(o=e.alpha)&&void 0!==o?o:1,t.context.setLineDash([]),t.context.stroke()),t.context.closePath(),t.context.beginPath(),t.context.moveTo(p.x,p.y),t.context.lineTo(u.x,u.y),t.context.moveTo(f.x,f.y),t.context.lineTo(u.x,u.y),t.context.globalAlpha=null!==(r=e.alpha)&&void 0!==r?r:1,t.context.setLineDash([]),t.context.stroke(),t.context.closePath()}}))},t.prototype.drawTextToCanvas=function(e){var t=this;e.forEach((function(e){var n;if(!t.hiddenNodeIds.has(e.id)){t.context.fillStyle="#262833";var o=Math.min(14,14/t.transform.k);t.context.font=t.context.font.replace(/\d+\.?\d*/,o.toString()),t.context.textBaseline="middle",t.context.globalAlpha=null!==(n=e.alpha)&&void 0!==n?n:1,t.context.fillText(e.name,e.x+t.getNodeRadius(e)+o,e.y)}}))},t.prototype.render=function(e,t){this.dpr=window.devicePixelRatio,this.context.save(),this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.translate(this.transform.x*this.dpr,this.transform.y*this.dpr),this.context.scale(this.transform.k*this.dpr,this.transform.k*this.dpr),this.nodes.forEach(this.setAlpha.bind(this)),this.links.forEach(this.setAlpha.bind(this)),this.drawNodeToCanvas(e),this.drawLinkToCanvas(t),this.drawTextToCanvas(e),this.context.restore()},t.prototype.update=function(e,t,n){var o=this;void 0===n&&(n="");var r=e.length;e.forEach((function(e,t){e.x=t/r*o.width,e.y=t/r*o.height})),this.keywords=n.trim(),this.active=!1,this.nodes=e,this.links=t,this.render(this.nodes,this.links),this.data(this.nodes).forceLink(this.links,1,80).restart()},t.prototype.resize=function(){var t=this.container.getBoundingClientRect(),n=t.width,o=t.height;e.prototype.resize.call(this,n,o),this.stage(),this.canvasZoomer&&this.canvasZoomer.extent([[0,0],[this.width,this.height]])},t.prototype.reRender=function(){this.simulation.alphaTarget(0).stop(),this.simulation.restart()},t.prototype.collapseNode=function(e){var t,n,o,r=this;this.isCollapsed(e)?null===(n=null===(t=e.knowledgeTreeNode)||void 0===t?void 0:t.children)||void 0===n||n.forEach((function(e){e.id&&r.hiddenNodeIds.delete(e.id)})):(0,s.T$)((null===(o=e.knowledgeTreeNode)||void 0===o?void 0:o.children)||[],(function(e){e.id&&r.hiddenNodeIds.add(e.id)}))},t}(i.d),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.textColor="#fff",t.highlightTextColor="#FFAC33",t.selectedNodeId=-1,t.minAlpha=.4,t}return c(t,e),t.prototype.drawNormalNode=function(e){var t=this.getRadius(e),n=this.getSpriteSetting(e.level);this.selectedNodeId===e.id&&(n=this.getSpriteSetting(e.level,1)),this.context.drawImage(a.U_.get("node-sprite"),n.sx,n.sy,n.sw,n.sh,e.x-t,e.y-t,2*t,2*t),this.drawCollapsedMark(e)},t.prototype.getSpriteIndex=function(e){return-1===e?0:e<2?e:(e-2)%5+2},t.prototype.getSpriteSetting=function(e,t){void 0===t&&(t=0);var n=this.getSpriteIndex(e);return a.b7[t][n]},t.prototype.getNodeRadius=function(e){return this.getRadius(e)},t.prototype.getRadius=function(e){var t=16;return e.level<=0&&(t=32),1===e.level&&(t=20),e.id===this.selectedNodeId?t+4:t},t.prototype.fittingString=function(e,t){var n=this.context.measureText(e).width,o="…",r=this.context.measureText(o).width;if(n<=t||n<=r)return e;for(var i=e,a=e.length;n>=t-r&&a-- >0;)i=i.substring(0,a),n=this.context.measureText(i).width;if(i+=o,this.keywords){if(!e.includes(this.keywords)||i.includes(this.keywords))return i;var s=e.indexOf(this.keywords);i=this.keywords,n=this.context.measureText(i).width;var l=s-1,c=s+this.keywords.length,u=!1,d=!1;for(a=e.length-this.keywords.length;n<=t-2*r&&a-- >0;)d=!e[l],u=!e[c],i=(e[l]||"")+i+(e[c]||""),n=this.context.measureText(i).width,l--,c++;i=(d?"":o)+i+(u?"":o)}return i},t.prototype.drawTextToCanvas=function(e){var t=this,n=Math.min(14,14/this.transform.k);this.context.font=this.context.font.replace(/\d+\.?\d*/,n.toString()),this.context.textBaseline="middle",this.context.textAlign="center",e.forEach((function(e){var n;if(!t.hiddenNodeIds.has(e.id)){t.context.fillStyle=t.textColor,t.context.globalAlpha=null!==(n=e.alpha)&&void 0!==n?n:1;var o=t.getRadius(e),r=t.fittingString(e.name,140),i=t.context.measureText(r);if(t.keywords){t.context.save(),t.context.textAlign="left";var a=new RegExp("(".concat(t.keywords,")"),"ig"),s=r.split(a),l=0;s.forEach((function(n){n===t.keywords?t.context.fillStyle=t.highlightTextColor:t.context.fillStyle=t.textColor,t.context.fillText(n,e.x+l-i.width/2,e.y+o+10,150);var r=t.context.measureText(n).width;l+=r})),t.context.restore()}else t.context.fillText(r,e.x,e.y+o+10,150)}}))},t.prototype.findNode=function(e,t,n){var o=this;return void 0===n&&(n=20),this.nodes.find((function(r){return!o.hiddenNodeIds.has(r.id)&&Math.hypot(e-r.x,t-r.y)<n}))},t.prototype.findNodeCollapsedMark=function(e,t,n){var o=this;return void 0===n&&(n=20),this.nodes.find((function(n){if(o.hiddenNodeIds.has(n.id))return!1;var r=o.collapsedMarkPoint(n),i=r.x,a=r.y,s=r.r;return Math.hypot(e-i,t-a)<s}))},t.prototype.collapsedMarkPoint=function(e){var t=this.getRadius(e);return{x:e.x+t+5,y:e.y+t-15,r:7}},t.prototype.drawCollapsedMark=function(e){var t,n=this.collapsedMarkPoint(e),o=n.x,r=n.y,i=n.r;((null===(t=e.knowledgeTreeNode)||void 0===t?void 0:t.children)||[]).length>0&&(this.context.beginPath(),this.context.lineWidth=2,this.context.strokeStyle="#20BEC890",this.context.arc(o,r,i,0,2*Math.PI),this.context.stroke(),this.context.lineCap="round",this.isCollapsed(e)&&(this.context.beginPath(),this.context.moveTo(o,r-5),this.context.lineTo(o,r+5),this.context.stroke()),this.context.beginPath(),this.context.moveTo(o-5,r),this.context.lineTo(o+5,r),this.context.stroke())},t.prototype.getNodeCollapsedMark=function(e){void 0===e&&(e=r.Ba6);var t=this.getMousePosition(e),n=t[0],o=t[1];return this.findNodeCollapsedMark(n,o)},t.prototype.getLinkColor=function(e){return"#C5C8CE"},t.prototype.clickHandle=function(t){this.nodes.forEach((function(e){return e.active=!1})),this.links.forEach((function(e){return e.active=!1}));var n=this.getNodeCollapsedMark((0,r.Ebf)(this.canvas,t));if(n)return this.collapseNode(n),void(0,r.Ys)(this.canvas).transition().call(this.canvasZoomer.translateTo,n.x,n.y);e.prototype.clickHandle.call(this,t)},t}(d)},623411:function(e,t,n){"use strict";n.d(t,{d:function(){return c}});n(66992),n(185827),n(747042),n(925438),n(470189),n(454747),n(333948);var o,r=n(730854),i=n(640599),a=n(973571),s=(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),l=function(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))},c=function(e){function t(t,n,o){void 0===n&&(n={});var r=e.call(this,t)||this;return r.action=n,r.tooltipHtml=o,r.status={dragging:!1},r.minNodeRadius=4,r.defs=r.svg.append("defs"),r.tooltipHtml&&(r.tooltip=r.div.append("div").attr("class","d3-tooltip").style("background-color","#464C5B").style("color","white").style("border-radius","5px").style("padding","10px").style("position","absolute").style("display","none").style("z-index","999")),r}return s(t,e),t.prototype.defaultForces=function(){this.forceCharge(-500).forceX().forceY().forceCenter({x:this.width/2,y:this.height/2})},t.prototype.getNodeRadius=function(e){return Math.max(e.r-4*e.level,this.minNodeRadius)},t.prototype.getRelation=function(e){var t=(0,r.Ys)(e.target).datum().id,n=new Set([t]),o=new Set([]);return this.link.data().filter((function(e){return e.source.id===t||e.target.id===t})).forEach((function(e){o.add(e.id),n.add(e.source.id),n.add(e.target.id)})),[this.node.filter((function(e){return n.has(e.id)})),this.link.filter((function(e){return o.has(e.id)})),this.text.filter((function(e){return n.has(e.id)}))]},t.prototype.drawArrow=function(e){var t=this,n=e.map((function(e){return{type:e.id<0?"hollow":"solid",color:e.color}})).reduce((function(e,t){return e.find((function(e){return e.type===t.type&&e.color===t.color}))?l([],e,!0):l(l([],e,!0),[t],!1)}),[]);this.defs.selectAll("marker").remove(),n.forEach((function(e){var n=t.defs.append("marker").attr("id","arrow-".concat(e.color)).attr("markerUnits","userSpaceOnUse").attr("viewBox","0 -5 10 10").attr("refX",10).attr("markerWidth",8).attr("markerHeight",8).attr("orient","auto").attr("stroke-width",.3).append("path").attr("d","M 0 -5 L 10 0 L 0 5");"solid"===e.type?n.attr("fill",e.color):(n.attr("stroke",e.color),n.attr("fill","transparent"))}))},t.prototype.mouseoverHandle=function(){if(!this.status.dragging){var e=this.getRelation(r.Ba6),t=e[0],n=e[1],o=e[2];if(this.tooltip&&this.tooltipHtml){var i=(0,r.Ys)(r.Ba6.target),a=i.datum(),s=parseFloat(i.attr("cx")),l=parseFloat(i.attr("cy")),c=parseFloat(i.attr("r"));s+=c+10,l-=c-10,this.tooltip.style("display","block").style("top","".concat(l,"px")).style("left","".concat(s,"px")).html(this.tooltipHtml(a))}this.opacity(.1),this.opacityEle(null,t,n,o)}},t.prototype.mouseoutHandle=function(){this.status.dragging||(this.opacity(null),this.activeNode&&this.opacityEle(.1,this.node.filter(":not([active=true])"),this.link.filter(":not([active=true])"),this.text.filter(":not([active=true])")),this.tooltip&&this.tooltipHtml&&this.tooltip.style("display","none"))},t.prototype.clickHandle=function(e){if(!this.status.dragging){var t=this.getRelation(r.Ba6),n=t[0],o=t[1],i=t[2];this.activeNode=r.Ba6.target,this.removeActive(),this.opacity(.1),n.attr("active",!0),o.attr("active",!0),i.attr("active",!0),this.opacityEle(null,n,o,i),this.action.clickNode&&this.action.clickNode((0,r.Ys)(this.activeNode).datum().id)}},t.prototype.opacityEle=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];e?t.forEach((function(t){return t.transition().style("opacity",e)})):t.forEach((function(e){return e.transition().style("opacity",null)}))},t.prototype.opacity=function(e){this.opacityEle(e,this.node,this.link,this.text)},t.prototype.removeActive=function(){this.node.attr("active",null),this.link.attr("active",null),this.text.attr("active",null)},t.prototype.resetStyle=function(){this.activeNode=void 0,this.opacity(null),this.removeActive()},t.prototype.update=function(e,t){var n=this;this.drawArrow(t),this.node=this.node.data(e,(function(e){return e.id})).join((function(e){return e.append("circle").attr("cx",n.center.x).attr("cy",n.center.y).attr("id",(function(e){return"node-".concat(e.id)})).attr("r",(function(e){return n.getNodeRadius(e)})).attr("fill",(function(e){return e.color})).call((0,a.LC)(n.simulation,n.status)).on("mouseover",n.mouseoverHandle.bind(n)).on("mouseout",n.mouseoutHandle.bind(n)).on("click",n.clickHandle.bind(n))}),(function(e){return e}),(function(e){return e.remove()})),this.link=this.link.data(t,(function(e){return e.id})).join((function(e){return e.append("path").attr("id",(function(e){return"link-".concat(e.id)})).attr("stroke",(function(e){return e.color})).attr("stroke-width",.3).attr("stroke-dasharray",(function(e){return e.id<0?null:"3,3"})).attr("marker-end",(function(e){return e.isDirected?"url(#arrow-".concat(e.color,")"):null}))}),(function(e){return e}),(function(e){return e.remove()})),this.text=this.text.data(e).join((function(e){return e.append("text").attr("x",(function(e){return e.x})).attr("y",(function(e){return e.y})).attr("font-size",(function(e){return 0===e.id?16:13})).style("font-weight",(function(e){return 0===e.id?"500":null})).attr("dy","0.3em").attr("dx","1em").style("user-select","none").text((function(e){return e.name})).attr("fill","#262833")}),(function(e){return e}),(function(e){return e.remove()})),setTimeout((function(){var e=n.container.getBoundingClientRect(),t=e.width,o=e.height,r=n.g.node().getBoundingClientRect(),i=r.width,a=r.height,s=Math.hypot(t,o),l=Math.hypot(i,a),c=s/l>1?1:s/l;s/l<1&&n.zoomer.scaleBy(n.svg.transition(),c,[n.center.x,n.center.y])}),100),this.data(e).forceLink(t,1,50).restart()},t.prototype.resize=function(t,n){var o=this.container.getBoundingClientRect(),r=o.width,i=o.height;e.prototype.resize.call(this,null!=t?t:r,null!=n?n:i)},t}(i.W)},973571:function(e,t,n){"use strict";n.d(t,{LC:function(){return i},UH:function(){return a},zP:function(){return r}});var o=n(730854),r=function(e,t){return void 0===t&&(t=0),(null!=e?e:0)+t},i=function(e,t){return(0,o.ohM)().on("start",(function(){e.alphaTarget(.3).restart(),o.Ba6.subject.fx=o.Ba6.subject.x,o.Ba6.subject.fy=o.Ba6.subject.y,t&&(t.dragging=!0)})).on("drag",(function(){o.Ba6.subject.fx=o.Ba6.x,o.Ba6.subject.fy=o.Ba6.y})).on("end",(function(){t&&(t.dragging=!1),o.Ba6.active||e.alphaTarget(0),o.Ba6.subject.fx=void 0,o.Ba6.subject.fy=void 0}))},a=function(e,t,n){return e.style("transform-origin","top left"),(0,o.sPX)().extent([[0,0],[t,n]]).scaleExtent([-1,8]).on("zoom",(function(){var t=o.Ba6.transform;e.style("transform","translate(".concat(t.x,"px, ").concat(t.y,"px) scale(").concat(t.k,")")),e.selectAll("text").attr("font-size",Math.min(14,14/t.k)),e.select(".link").selectAll("path").attr("stroke-width",Math.min(.3,.3/t.k)),e.selectAll("marker").attr("stroke-width",Math.min(.3,.3/t.k)).attr("refX",Math.min(10,10/t.k)).selectAll("path").attr("d","M 0 ".concat(-Math.min(5,5/t.k)," L ").concat(Math.min(10,10/t.k)," 0 L 0 ").concat(Math.min(5,5/t.k)))}))}},146176:function(e,t,n){"use strict";n.d(t,{X:function(){return r}});var o=n(925706),r=function(){return{depth:(0,o.f3)("treeDepth")}}},950426:function(e,t,n){"use strict";n.d(t,{Im:function(){return h},K6:function(){return _},Rf:function(){return y},Sc:function(){return m},TG:function(){return p},aG:function(){return b},ch:function(){return u},e$:function(){return v},jV:function(){return d},n8:function(){return g},no:function(){return f},uU:function(){return w}});n(141817),n(66992),n(788674),n(333948);var o=n(409669),r=n.n(o),i=n(920976),a=n(356264),s=n(152489),l=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},c=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},u=function(e){return l(void 0,void 0,void 0,(function(){var t,n;return c(this,(function(o){switch(o.label){case 0:return[4,r().get("/api/course/".concat(e,"/problem-graph"))];case 1:return t=o.sent(),n=t.data.data,[2,(0,i.d8)(s.if,n)]}}))}))},d=function(e,t){return l(void 0,void 0,void 0,(function(){return c(this,(function(n){switch(n.label){case 0:return[4,r().put("/api/problem-level/".concat(e),t)];case 1:return[2,n.sent().data]}}))}))},p=function(e,t){return l(void 0,void 0,void 0,(function(){return c(this,(function(n){switch(n.label){case 0:return[4,r().post("/api/course/".concat(e,"/problem-graph/relations"),(0,i.ZE)(t))];case 1:return[2,n.sent().data]}}))}))},f=function(e,t){return l(void 0,void 0,void 0,(function(){return c(this,(function(n){switch(n.label){case 0:return[4,r().put("/api/problem-level/".concat(e,"/sort"),t)];case 1:return[2,n.sent().data]}}))}))},v=function(e,t){return l(void 0,void 0,void 0,(function(){return c(this,(function(n){switch(n.label){case 0:return[4,r().delete("/api/course/".concat(e,"/problem-graph/relation/").concat(t))];case 1:return n.sent(),[2]}}))}))},h=function(e,t){return l(void 0,void 0,void 0,(function(){var n;return c(this,(function(o){switch(o.label){case 0:return[4,r().post("/api/course/".concat(e,"/problem-graph/relations/batch"),{data:(0,i.ZE)(t)})];case 1:return n=o.sent(),[2,(0,i.d8)(s.TF,n.data.data)]}}))}))},m=function(e,t){return l(void 0,void 0,void 0,(function(){return c(this,(function(n){switch(n.label){case 0:return[4,r().delete("/api/course/".concat(e,"/problem-graph/relations/batch"),{data:t})];case 1:return n.sent(),[2]}}))}))},g=function(e,t){return l(void 0,void 0,void 0,(function(){return c(this,(function(n){switch(n.label){case 0:return[4,r().post("/api/course/".concat(e,"/problem-graph-status"),{status:t})];case 1:return n.sent(),[2]}}))}))},y=function(e,t){return l(void 0,void 0,void 0,(function(){var n;return c(this,(function(o){switch(o.label){case 0:return[4,r().post("/api/course/".concat(e,"/problem"),(0,a.decamelizeKeys)(t))];case 1:return n=o.sent(),[2,(0,i.d8)(s.tc,n.data)]}}))}))},w=function(e,t){return l(void 0,void 0,void 0,(function(){var n;return c(this,(function(o){switch(o.label){case 0:return[4,r().put("/api/course/".concat(e,"/problem/").concat(t.id),(0,a.decamelizeKeys)(t))];case 1:return n=o.sent(),[2,(0,i.d8)(s.tc,n.data)]}}))}))},b=function(e,t){return l(void 0,void 0,void 0,(function(){return c(this,(function(n){switch(n.label){case 0:return[4,r().delete("/api/course/".concat(e,"/problem/").concat(t))];case 1:return n.sent(),[2]}}))}))},_=function(e,t){return l(void 0,void 0,void 0,(function(){return c(this,(function(n){switch(n.label){case 0:return[4,r().delete("/api/course/".concat(e,"/problems/batch"),{data:t})];case 1:return n.sent(),[2]}}))}))}},467691:function(e,t,n){"use strict";n.d(t,{B:function(){return p},v:function(){return d}});n(141817),n(66992),n(788674),n(454747),n(333948);var o=n(925706),r=n(866473),i=n(117403),a=n(202669),s=n(154803),l=n(950426),c=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},u=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},d=(0,o.iH)(!1),p=function(){var e=(0,o.Fl)((function(){var e;return(null===(e=s.jx.value)||void 0===e?void 0:e.getFlatProblems())||[]})),t=(0,o.Fl)((function(){return e.value.filter((function(e){return e.checked}))})),n=(0,o.Fl)((function(){return!!e.value.length&&e.value.every((function(e){return e.checked}))}));return(0,o.YP)(d,(function(e){return c(void 0,void 0,void 0,(function(){var t,n,r,i,a,l,c;return u(this,(function(u){switch(u.label){case 0:return((null===(t=s.jx.value)||void 0===t?void 0:t.getCollapsedRoots())||[]).length?(null===(n=s.jx.value)||void 0===n||n.unManageAll(),null===(r=s.jx.value)||void 0===r||r.expandAll(),[4,(0,o.Y3)()]):[3,2];case 1:u.sent(),null===(i=s.jx.value)||void 0===i||i.repaintEndpoints(),null===(a=s.jx.value)||void 0===a||a.connect(),s.xN.value=(null===(l=s.jx.value)||void 0===l?void 0:l.isCollapsedAll)||!1,u.label=2;case 2:return null===(c=s.jx.value)||void 0===c||c.getFlatProblems().forEach((function(t){var n,o;e?null===(n=t.connector)||void 0===n||n.disabledDragToConnect():null===(o=t.connector)||void 0===o||o.enabledDragToConnect()})),[2]}}))}))})),{batchDeleteProblemsMode:d,problems:e,checkedProblems:t,isCheckedAll:n,toggleCheckAll:function(){var t,o=n.value;null===(t=e.value)||void 0===t||t.forEach((function(e){e.checked=!o}))},del:function(){return c(void 0,void 0,void 0,(function(){var n,c,p,f,v;return u(this,(function(u){switch(u.label){case 0:return[4,a.Z.open({title:i.default.t("delete"),type:"warning",content:i.default.t("problemGraph.batchDeleteProblemTips",[t.value.length])})];case 1:if(!u.sent())return[2];n=t.value.map((function(e){return e.id})),u.label=2;case 2:return u.trys.push([2,5,6,7]),[4,(0,l.K6)(s.N7.value.id,n)];case 3:return u.sent(),null===(c=s.jx.value)||void 0===c||c.unManageAll(),t.value.forEach((function(e){var t;null===(t=s.jx.value)||void 0===t||t.removeProblem(e)})),[4,(0,o.Y3)()];case 4:return u.sent(),null===(p=s.jx.value)||void 0===p||p.repaintEndpoints(),null===(f=s.jx.value)||void 0===f||f.connect(),s.xN.value=(null===(v=s.jx.value)||void 0===v?void 0:v.isCollapsedAll)||!1,r.Message.success(i.default.t("delete_success")),[3,7];case 5:return u.sent(),r.Message.error(i.default.t("delete_error")),[3,7];case 6:return d.value=!!e.value.length,[7];case 7:return[2]}}))}))},cancel:function(){var t;d.value=!1,null===(t=e.value)||void 0===t||t.forEach((function(e){e.checked=!1}))}}}},152489:function(e,t,n){"use strict";n.d(t,{TF:function(){return v},if:function(){return f},tc:function(){return p}});n(141817),n(586535),n(66992),n(747042),n(702707),n(140561),n(199244),n(651532),n(132023),n(454747),n(333948);var o=n(821525),r=n(172045),i=n(526617),a=n(247251),s=n(413447),l=n(920976),c=n(204441),u=function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},d=function(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))},p=function(){function e(){this.relations=[],this.knowledgeNodes=[],this.active=!1,this.collapsed=!1,this.showing=!0,this.numberOfFolds=0,this.uuid=(0,r.Z)(),this.version=0,this.checked=!1}return e.clone=function(t){var n=new e;return n.id=t.id,n.name=t.name,n.description=t.description,n.cognitiveDimension=t.cognitiveDimension,n.levelId=t.levelId,n.knowledgeNodes=t.knowledgeNodes,n.sort=t.sort,n.level=t.level,n},e.prototype.validRelation=function(e,t){return e===this.id||t===this.id},e.prototype.getRelation=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(1===e.length)return this.relations.find((function(t){return t.id===e[0]}));var n=e[0],o=e[1];return this.validRelation(n,o)?this.relations.find((function(e){return e.isRelation([n,o])})):void 0},e.prototype.addRelation=function(e){this.validRelation(e.problemId,e.relatedProblemId)&&(this.getRelation(e.problemId,e.relatedProblemId)||this.relations.push(e))},e.prototype.removeRelation=function(e){this.relations="number"==typeof e?this.relations.filter((function(t){return t.id!==e})):this.relations.filter((function(t){return!t.isRelation(e)}))},e.prototype.activated=function(){this.active=!0},e.prototype.deactivate=function(){this.active=!1},e.prototype.setConnector=function(e){this._connector=e},Object.defineProperty(e.prototype,"elId",{get:function(){return"".concat((0,c.p3)(this.id),"-").concat(this.uuid)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"connector",{get:function(){return this._connector},enumerable:!1,configurable:!0}),u([(0,i.D)((function(){return v}))],e.prototype,"relations",void 0),u([(0,a.w)((function(e){var t=e.value;return"none"===t?"":t})),(0,s.C)({name:"cognitive_dimension"})],e.prototype,"cognitiveDimension",void 0),u([(0,s.C)({name:"level_id"})],e.prototype,"levelId",void 0),u([(0,a.w)((function(e){return e.obj.knowledge_nodes.map((function(e){return e.knowledge_node}))})),(0,s.C)({name:"knowledge_nodes"})],e.prototype,"knowledgeNodes",void 0),e}(),f=function(){function e(){this.problems=[]}return e.clone=function(t){var n=new e;return n.id=t.id,n.courseId=t.courseId,n.description=t.description,n},e.prototype.getProblemByUuid=function(e){return this.problems.find((function(t){return t.uuid===e}))},e.prototype.getProblemIndexByUuid=function(e){return this.problems.findIndex((function(t){return t.uuid===e}))},e.prototype.resortProblemViaIndex=function(){var e=[],t=1;this.problems.forEach((function(n){if(n.showing&&!n.collapsed){for(;e.includes(t);)t++;n.sort=t,e.push(t)}else e.push(n.sort)}))},e.prototype.fixCollapsedProblemSort=function(){var e=new Map;this.problems.forEach((function(t){e.has(t.id)||e.set(t.id,[]),e.get(t.id).push(t)})),e.forEach((function(e){if(e.length>1){var t=e.find((function(e){return!e.collapsed}));t&&e.forEach((function(e){e.sort=t.sort}))}}))},e.prototype.sortProblem=function(e,t){if(this.level!==c.aC.FIRST){var n=this.problems.filter((function(e){return e.collapsed}));e+=n.length,t+=n.length}var o=this.problems.splice(e,1)[0];this.problems.splice(t,0,o),this.resortProblemViaIndex(),this.fixCollapsedProblemSort()},e.prototype.getSortData=function(){return(0,c.Tw)(this.problems.map((function(e){return{id:e.id,sort:e.sort}})),"id")},e.prototype.insert=function(e,t){var n,o=Array.isArray(e)?e:[e];(n=this.problems).splice.apply(n,d([t,0],o,!1))},e.prototype.insertAfter=function(e,t){var n=this.getProblemIndexByUuid(e.uuid);-1!==n&&this.insert(t,n+1)},e.prototype.insertBefore=function(e,t){var n=this.getProblemIndexByUuid(e.uuid);-1!==n&&this.insert(t,n)},e.prototype.moveProblemToFrontByVersions=function(e){var t=this;if(this.level!==c.aC.FIRST){this.problems.sort((function(e,t){return e.sort-t.sort}));var n=e.flatMap((function(e){return t.problems.filter((function(t){return t.version===e}))})),o=this.problems.filter((function(e){return!e.collapsed}));this.problems=d(d([],n,!0),o,!0)}},Object.defineProperty(e.prototype,"count",{get:function(){return(0,c.Tw)(this.problems,"id").length},enumerable:!1,configurable:!0}),u([(0,s.C)({name:"course_id"})],e.prototype,"courseId",void 0),u([(0,a.w)((function(e){var t=e.value;return c.aC[t.toUpperCase()]}))],e.prototype,"level",void 0),u([(0,a.w)((function(e){var t=e.obj,n=c.aC[t.level.toUpperCase()];return t.problems.map((function(e){var t=(0,l.d8)(p,e);return t.level=n,t}))}),{toClassOnly:!0})],e.prototype,"problems",void 0),e}(),v=function(){function e(){}return e.clone=function(t){var n=new e;return n.id=t.id,n.problemId=t.problemId,n.relatedProblemId=t.relatedProblemId,n},e.prototype.isRelation=function(e){if("number"==typeof e)return this.problemId===e||this.relatedProblemId===e;var t,n;if(Array.isArray(e)?(t=e[0],n=e[1]):(0,o.Kn2)(e)&&(t=e.problemId,n=e.relatedProblemId),!t||!n||t===n)return!1;var r=[this.problemId,this.relatedProblemId];return r.includes(t)&&r.includes(n)},u([(0,s.C)({name:"problem_id"})],e.prototype,"problemId",void 0),u([(0,s.C)({name:"related_problem_id"})],e.prototype,"relatedProblemId",void 0),e}()},204441:function(e,t,n){"use strict";n.d(t,{$e:function(){return s},Tw:function(){return l},aC:function(){return o},d0:function(){return r},p3:function(){return a},qL:function(){return c},sX:function(){return i}});n(66992),n(185827),n(470189),n(454747),n(333948);var o,r,i,a=function(e){return"".concat("PROBLEM-").concat(e)},s=function(e,t){var n=[];return function e(o,r,i){if(i.filter((function(e){return e})).length===t){var a=[];i.forEach((function(e,t){e&&a.push(o[t])})),n.push(a)}else if(r!==o.length){var s=r+1;i[r]=1,e(o,s,i),i[r]=0,e(o,s,i)}}(e,0,Array(e.length).fill(0)),n},l=function(e,t){var n=new Set;return e.filter((function(e){return!n.has(e[t])&&n.add(e[t])}))},c=function(e,t){return e.reduce((function(e,n){var o=n[t];return e[o]||(e[o]=[]),e[o].push(n),e}),{})};!function(e){e[e.FIRST=1]="FIRST",e[e.SECOND=2]="SECOND",e[e.THIRD=3]="THIRD"}(o||(o={})),function(e){e.from=function(t){switch(Number(t)){case 1:return e.FIRST;case 2:return e.SECOND;case 3:return e.THIRD;default:return console.warn("Unexpected level ".concat(t)),e.FIRST}},e.gt=function(t,n){return e.from(t)>e.from(n)};var t=function(t,n){var o=n(t.valueOf());if(e[o])return e.from(o)};e.next=function(e){return t(e,(function(e){return e+1}))},e.prev=function(e){return t(e,(function(e){return e-1}))}}(o||(o={})),function(e){e[e.HOLLOW=0]="HOLLOW",e[e.SOLID=1]="SOLID"}(r||(r={})),function(e){e.A="A",e.B="B"}(i||(i={})),function(e){e.get=function(t,n){return[t,n].some((function(e){return o.from(e)===o.FIRST}))?e.A:e.B}}(i||(i={}))},547454:function(e,t,n){"use strict";n.d(t,{_:function(){return l}});n(141817),n(66992),n(788674),n(117727),n(333948);var o=n(925706),r=n(356264),i=n(922942),a=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},s=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},l=function(e,t,n){var l=(0,o.qj)({keyword:"",order:[]}),c=(0,o.iH)({page:0,pageSize:0,pages:0,total:0,items:[]}),u=(0,o.iH)(!1),d=(0,i.h0)((function(e,o){return u.value=!0,t(n,l,e,o).finally((function(){u.value=!1}))}));return(0,o.bv)((function(){return a(void 0,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,d.fetch()];case 1:return e.sent(),[2]}}))}))})),(0,o.YP)((function(){return e.keyword}),(function(e){l.keyword=e})),(0,o.YP)(l,(function(){return a(void 0,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,d.fetch(1)];case 1:return e.sent(),[2]}}))}))})),{conditions:l,data:c,pagination:d,sortChange:function(e){var t=e.key,n=e.order;l.order="normal"===n?[]:[(0,r.decamelize)(t),n]},loading:u}}},154803:function(e,t,n){"use strict";n.d(t,{$E:function(){return D},N7:function(){return m},Q7:function(){return v},Uz:function(){return C},Vl:function(){return g},Wq:function(){return b},_T:function(){return T},dE:function(){return w},dT:function(){return x},g$:function(){return S},jx:function(){return I},nQ:function(){return h},q:function(){return k},wZ:function(){return y},xN:function(){return E},yw:function(){return _}});n(132023);var o,r,i,a,s,l,c,u,d,p=n(925706),f=n(462149),v=(0,p.XI)(),h=(0,p.iH)(!1),m=(0,p.iH)({id:0,name:""}),g=(0,p.iH)(f.QO.UNPUBLISHED),y=(null===(o=window.globalData)||void 0===o?void 0:o.courseRoles.includes("instructor"))||(null===(r=window.globalData)||void 0===r?void 0:r.courseRoles.includes("instructor_assistant")),w=null===(i=window.globalData)||void 0===i?void 0:i.courseRoles.includes("student"),b=(null===(a=window.globalData)||void 0===a?void 0:a.user.id)||0,_=null===(l=null===(s=window.globalData)||void 0===s?void 0:s.course)||void 0===l?void 0:l.isSimulatingInstructor,C=(0,p.iH)(!1),k=null===(c=window.featureToggles)||void 0===c?void 0:c.enableKnowledgeReferenceCapture,x=null===(u=window.orgSettings)||void 0===u?void 0:u.enableChinamCloudGraph,S=null===(d=window.featureToggles)||void 0===d?void 0:d.enableKnowledgeReferencePublicResource,T=(0,p.iH)(!1),D=(0,p.iH)(""),I=(0,p.iH)(),E=(0,p.iH)(!1)},486992:function(e,t,n){"use strict";n.d(t,{Nw:function(){return p},RB:function(){return u},T$:function(){return c},T3:function(){return d}});n(747042),n(319601),n(454747);var o=n(370538),r=n(965284),i=n.n(r),a=n(154803),s=function(){return(s=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},l=function(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))},c=function(e,t){return function e(n,o,r){return void 0===o&&(o=0),n.map((function(n,i){var a=s({},n);return a.children&&(a.children=e(a.children,o+1,a)),t(a,o,i,r),a}))}(e)},u=function(e){return"exam"===e.type?"/course/".concat(a.N7.value.id,"/learning-activity#/exam/").concat(e.id):"/course/".concat(a.N7.value.id,"/learning-activity#/").concat(e.id)},d=function(e){return Number.isFinite(e)?"".concat(e,"%"):"-"},p=function(e){o.default.prototype.$sanitize||o.default.use(i());var t=o.default.prototype.$sanitize,n=i().defaults,r=l([],n.allowedTags,!0),a=s({},n.allowedAttributes),c=l(["p","video","source","img","iframe","span","strong","em","s","u"],["h1","h2","h3","h4","h5","h6"],!0);return r.push.apply(r,c),c.forEach((function(e){a[e]||(a[e]=[])})),a.video.push("src"),a.video.push("controls"),a.video.push("width"),a.video.push("height"),a.video.push("controlslist"),a.video.push("oncontextmenu"),a.source.push("src"),a.source.push("type"),a.img.push("src"),a.iframe.push("src"),Object.keys(a).forEach((function(e){a[e].push("style")})),t(e,{allowedTags:r,allowedAttributes:a})}},724445:function(e,t,n){"use strict";n.d(t,{C9:function(){return p},U2:function(){return k},VN:function(){return d},Xo:function(){return b},d8:function(){return w},eb:function(){return v},ip:function(){return f},w1:function(){return C}});n(569720),n(454747);var o,r=n(413447),i=n(526617),a=n(247251),s=n(405835),l=n(48496),c=(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),u=function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},d=function(){function e(){this.orgId=0,this.creditAssigned=0,this.creditUsed=0,this.userCreditUsed=0,this.userCreditAssigned=0,this.courseCreditUsed=0,this.courseCreditAssigned=0}return Object.defineProperty(e.prototype,"creditRemaining",{get:function(){return this.creditAssigned-this.creditUsed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userCreditRemaining",{get:function(){return this.userCreditAssigned-this.userCreditUsed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"courseCreditRemaining",{get:function(){return this.courseCreditAssigned-this.courseCreditUsed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"creditPercentages",{get:function(){var e=this.calcCreditPercentage(this.userCreditUsed),t=this.calcCreditPercentage(this.userCreditRemaining),n=this.calcCreditPercentage(this.courseCreditUsed),o=this.calcCreditPercentage(this.courseCreditRemaining),r=this.calcCreditPercentage(this.creditRemaining),i={creditUserUsedPercent:e,creditUserUnusedPercent:t,creditCourseUsedPercent:n,creditCourseUnusedPercent:o,creditRemainingPercent:r},a=100-(e+t+n+o+r);if(a<0){var s=-1/0,l=null;Object.entries(i).forEach((function(e){var t=e[0],n=e[1];n>s&&(s=n,l=t)})),null!==l&&(i[l]=s+a)}return i},enumerable:!1,configurable:!0}),e.prototype.calcCreditPercentage=function(e){if(!e)return 0;var t=Math.floor(e/this.creditAssigned*100);return Math.max(t,1)},e}(),p=function(){this.userId=0,this.userNo="",this.userName="",this.department="",this.role="",this.creditAssigned=0,this.creditUsed=0,this.creditRemaining=0,this.creditUsedPercent=0,this.status="",this.isLowAirCredit=!1,this.creditState={}},f=function(){function e(){this.userRole="",this.creditAssigned=0,this.creditUsed="",this.moduleCreditUsed={},this.material=0,this.onlineVideo=0,this.lesson=0,this.classroom=0,this.chatbot=0,this.homework=0,this.forum=0,this.exam=0,this.subjectLib=0,this.textOptimization=0,this.usageCount=0}return u([(0,r.C)({name:"user"}),(0,i.D)((function(){return h}))],e.prototype,"user",void 0),u([(0,r.C)({name:"user_role"})],e.prototype,"userRole",void 0),u([(0,r.C)({name:"credit_assigned"})],e.prototype,"creditAssigned",void 0),u([(0,r.C)({name:"credit_used"})],e.prototype,"creditUsed",void 0),u([(0,r.C)({name:"module_credit_used"})],e.prototype,"moduleCreditUsed",void 0),u([(0,r.C)({name:"material"}),(0,a.w)((function(e){var t,n;return null!==(n=null===(t=e.obj.module_credit_used)||void 0===t?void 0:t.material)&&void 0!==n?n:0}))],e.prototype,"material",void 0),u([(0,r.C)({name:"online_video"}),(0,a.w)((function(e){var t,n;return null!==(n=null===(t=e.obj.module_credit_used)||void 0===t?void 0:t.online_video)&&void 0!==n?n:0}))],e.prototype,"onlineVideo",void 0),u([(0,r.C)({name:"lesson"}),(0,a.w)((function(e){var t,n;return null!==(n=null===(t=e.obj.module_credit_used)||void 0===t?void 0:t.lesson)&&void 0!==n?n:0}))],e.prototype,"lesson",void 0),u([(0,r.C)({name:"classroom"}),(0,a.w)((function(e){var t,n;return null!==(n=null===(t=e.obj.module_credit_used)||void 0===t?void 0:t.classroom)&&void 0!==n?n:0}))],e.prototype,"classroom",void 0),u([(0,r.C)({name:"Chat"}),(0,a.w)((function(e){var t,n;return null!==(n=null===(t=e.obj.module_credit_used)||void 0===t?void 0:t.Chat)&&void 0!==n?n:0}))],e.prototype,"chatbot",void 0),u([(0,r.C)({name:"homework"}),(0,a.w)((function(e){var t,n;return null!==(n=null===(t=e.obj.module_credit_used)||void 0===t?void 0:t.homework)&&void 0!==n?n:0}))],e.prototype,"homework",void 0),u([(0,r.C)({name:"forum"}),(0,a.w)((function(e){var t,n;return null!==(n=null===(t=e.obj.module_credit_used)||void 0===t?void 0:t.forum)&&void 0!==n?n:0}))],e.prototype,"forum",void 0),u([(0,r.C)(),(0,a.w)((function(e){var t,n;return null!==(n=null===(t=e.obj.module_credit_used)||void 0===t?void 0:t.exam)&&void 0!==n?n:0}))],e.prototype,"exam",void 0),u([(0,r.C)(),(0,a.w)((function(e){var t,n;return null!==(n=null===(t=e.obj.module_credit_used)||void 0===t?void 0:t.subject_lib)&&void 0!==n?n:0}))],e.prototype,"subjectLib",void 0),u([(0,r.C)(),(0,a.w)((function(e){var t,n;return null!==(n=null===(t=e.obj.module_credit_used)||void 0===t?void 0:t.TextOptimizationGenerator)&&void 0!==n?n:0}))],e.prototype,"textOptimization",void 0),u([(0,r.C)({name:"usage_count"})],e.prototype,"usageCount",void 0),e}(),v=function(){function e(){this.instructors=0,this.creditUsed=0,this.usageCount=0,this.studentsCount=0}return u([(0,r.C)({name:"course"}),(0,i.D)((function(){return y}))],e.prototype,"course",void 0),u([(0,r.C)({name:"instructors"})],e.prototype,"instructors",void 0),u([(0,r.C)({name:"credit_used"})],e.prototype,"creditUsed",void 0),u([(0,r.C)({name:"usage_count"})],e.prototype,"usageCount",void 0),u([(0,r.C)({name:"students_count"})],e.prototype,"studentsCount",void 0),e}(),h=(function(){function e(){this.userCounts=0,this.creditAssigned=0,this.creditUsed=0,this.usedRatio=0,this.avgUserCredit=0}u([(0,r.C)({name:"user_counts"})],e.prototype,"userCounts",void 0),u([(0,r.C)({name:"credit_assigned"})],e.prototype,"creditAssigned",void 0),u([(0,r.C)({name:"credit_used"})],e.prototype,"creditUsed",void 0),u([(0,r.C)(),(0,a.w)((function(e){var t=e.obj;return(0,s.D)(t.credit_used,t.credit_assigned)}))],e.prototype,"usedRatio",void 0),u([(0,r.C)(),(0,a.w)((function(e){var t=e.obj;return Math.round(t.credit_used/t.user_counts)}))],e.prototype,"avgUserCredit",void 0)}(),function(){function e(){this.courseCounts=0,this.creditAssigned=0,this.creditUsed=0,this.userUsedCounts=0,this.courseStudentCounts=0,this.usedRatio=0,this.avgCourseCreditUsed=0,this.avgUserTimes=0}u([(0,r.C)({name:"course_counts"})],e.prototype,"courseCounts",void 0),u([(0,r.C)({name:"credit_assigned"})],e.prototype,"creditAssigned",void 0),u([(0,r.C)({name:"credit_used"})],e.prototype,"creditUsed",void 0),u([(0,r.C)({name:"user_used_counts"})],e.prototype,"userUsedCounts",void 0),u([(0,r.C)({name:"course_student_counts"})],e.prototype,"courseStudentCounts",void 0),u([(0,r.C)(),(0,a.w)((function(e){var t=e.obj;return(0,s.D)(t.credit_used,t.credit_assigned)}))],e.prototype,"usedRatio",void 0),u([(0,r.C)(),(0,a.w)((function(e){var t=e.obj;return Math.round(t.credit_used/t.course_counts)}))],e.prototype,"avgCourseCreditUsed",void 0),u([(0,r.C)(),(0,a.w)((function(e){var t=e.obj;return Math.round(t.user_used_counts/t.course_student_counts)}))],e.prototype,"avgUserTimes",void 0)}(),function(){function e(){}return Object.defineProperty(e.prototype,"creditStateStatus",{get:function(){var e,t;return null!==(t=null===(e=this.creditState)||void 0===e?void 0:e.status)&&void 0!==t?t:""},enumerable:!1,configurable:!0}),u([(0,r.C)({name:"id"})],e.prototype,"id",void 0),u([(0,r.C)({name:"name"})],e.prototype,"name",void 0),u([(0,r.C)({name:"user_no"})],e.prototype,"userNo",void 0),u([(0,r.C)({name:"department"})],e.prototype,"department",void 0),u([(0,r.C)({name:"credit_state"}),(0,i.D)((function(){return p}))],e.prototype,"creditState",void 0),u([(0,r.C)()],e.prototype,"creditStateStatus",null),e}()),m=function(){function e(){}return u([(0,r.C)()],e.prototype,"id",void 0),u([(0,r.C)()],e.prototype,"name",void 0),u([(0,r.C)()],e.prototype,"code",void 0),u([(0,r.C)()],e.prototype,"sort",void 0),e}(),g=function(){function e(){}return u([(0,r.C)()],e.prototype,"id",void 0),u([(0,r.C)()],e.prototype,"name",void 0),u([(0,r.C)()],e.prototype,"academicYearId",void 0),u([(0,r.C)()],e.prototype,"isActive",void 0),u([(0,r.C)()],e.prototype,"realName",void 0),u([(0,r.C)(),(0,i.D)((function(){return m}))],e.prototype,"academicYear",void 0),e}(),y=function(){function e(){}return Object.defineProperty(e.prototype,"creditStateStatus",{get:function(){var e,t;return null!==(t=null===(e=this.creditState)||void 0===e?void 0:e.status)&&void 0!==t?t:""},enumerable:!1,configurable:!0}),u([(0,r.C)({name:"id"})],e.prototype,"id",void 0),u([(0,r.C)({name:"name"})],e.prototype,"name",void 0),u([(0,r.C)({name:"course_code"})],e.prototype,"courseCode",void 0),u([(0,r.C)({name:"academic_year"}),(0,i.D)((function(){return m}))],e.prototype,"academicYear",void 0),u([(0,r.C)({name:"semester"}),(0,i.D)((function(){return g}))],e.prototype,"semester",void 0),u([(0,r.C)(),(0,i.D)((function(){return h}))],e.prototype,"teachers",void 0),u([(0,r.C)({name:"credit_state"}),(0,i.D)((function(){return b}))],e.prototype,"creditState",void 0),u([(0,r.C)()],e.prototype,"creditStateStatus",null),e}(),w=function(){function e(){this.department="",this.academicYear="",this.semester="",this.courseCode="",this.instructors="",this.klass=""}return u([(0,r.C)({name:"department"}),(0,a.w)((function(e){var t,n=e.value;return null!==(t=null==n?void 0:n.name)&&void 0!==t?t:""}))],e.prototype,"department",void 0),u([(0,r.C)({name:"academic_year"}),(0,a.w)((function(e){var t,n=e.value;return null!==(t=null==n?void 0:n.name)&&void 0!==t?t:""}))],e.prototype,"academicYear",void 0),u([(0,r.C)({name:"semester"}),(0,a.w)((function(e){var t,n=e.value;return null!==(t=null==n?void 0:n.name)&&void 0!==t?t:""}))],e.prototype,"semester",void 0),u([(0,r.C)({name:"course_code"})],e.prototype,"courseCode",void 0),u([(0,r.C)({name:"instructors"}),(0,a.w)((function(e){var t=e.value;return Array.isArray(t)?t.map((function(e){return e.name})).join(", "):""}))],e.prototype,"instructors",void 0),u([(0,r.C)({name:"klass"}),(0,a.w)((function(e){var t,n=e.value;return null!==(t=null==n?void 0:n.name)&&void 0!==t?t:""}))],e.prototype,"klass",void 0),e}(),b=function(){function e(){this.department="",this.instructors="",this.name="",this.semester="",this.status="",this.academicYear="",this.courseCode="",this.creditAssigned=0,this.creditUsed=0,this.creditRemaining=0,this.creditUsedPercent=0,this.courseId=0,this.creditState={}}return u([(0,r.C)({name:"academic_year"})],e.prototype,"academicYear",void 0),u([(0,r.C)({name:"course_code"})],e.prototype,"courseCode",void 0),u([(0,r.C)({name:"credit_assigned"})],e.prototype,"creditAssigned",void 0),u([(0,r.C)({name:"credit_used"})],e.prototype,"creditUsed",void 0),u([(0,r.C)({name:"credit_remaining"})],e.prototype,"creditRemaining",void 0),u([(0,r.C)({name:"credit_used_percent"})],e.prototype,"creditUsedPercent",void 0),u([(0,r.C)({name:"course_id"})],e.prototype,"courseId",void 0),e}(),_=function(){function e(){this.remark="",this.updatedAt="",this.auditor=null,this.read=!1,this._disabled=!1,this._checked=!1}return u([(0,r.C)()],e.prototype,"id",void 0),u([(0,r.C)(),(0,i.D)((function(){return h}))],e.prototype,"user",void 0),u([(0,r.C)({name:"applied_credits"})],e.prototype,"appliedCredits",void 0),u([(0,r.C)({name:"approved_credits"})],e.prototype,"approvedCredits",void 0),u([(0,r.C)()],e.prototype,"reason",void 0),u([(0,r.C)()],e.prototype,"status",void 0),u([(0,r.C)()],e.prototype,"remark",void 0),u([(0,r.C)({name:"created_at"}),(0,a.w)((function(e){var t=e.value;return l.TimeUtils.toLocalDateTime(t)}),{toClassOnly:!0})],e.prototype,"createdAt",void 0),u([(0,r.C)({name:"updated_at"}),(0,a.w)((function(e){var t=e.value;return l.TimeUtils.toLocalDateTime(t)}),{toClassOnly:!0})],e.prototype,"updatedAt",void 0),u([(0,r.C)(),(0,i.D)((function(){return h}))],e.prototype,"auditor",void 0),u([(0,r.C)()],e.prototype,"read",void 0),u([(0,r.C)({name:"target_type"})],e.prototype,"targetType",void 0),e}(),C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),t}(_),k=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),u([(0,r.C)(),(0,i.D)((function(){return y}))],t.prototype,"course",void 0),t}(_)},405835:function(e,t,n){"use strict";n.d(t,{D:function(){return o}});var o=function(e,t,n){if(void 0===n&&(n=1),0===t)return 0;var o=Math.pow(10,n);return Math.floor(e/t*100*o)/o};new Intl.NumberFormat("en-US")},617966:function(e,t,n){"use strict";n.d(t,{$I:function(){return p},D4:function(){return u},jZ:function(){return c}});var o,r=n(413447),i=n(526617),a=n(997204),s=(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),l=function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},c=function(){function e(){this.firstVisitTime="",this.courseCount=0,this.topicCount=0,this.likedCount=0,this.interactionCount=0,this.homeworkCount=0,this.examCount=0}return l([(0,r.C)({name:"first_visit_time"})],e.prototype,"firstVisitTime",void 0),l([(0,r.C)({name:"course_count"})],e.prototype,"courseCount",void 0),l([(0,r.C)({name:"topic_count"})],e.prototype,"topicCount",void 0),l([(0,r.C)({name:"liked_count"})],e.prototype,"likedCount",void 0),l([(0,r.C)({name:"interaction_count"})],e.prototype,"interactionCount",void 0),l([(0,r.C)({name:"homework_count"})],e.prototype,"homeworkCount",void 0),l([(0,r.C)({name:"exam_count"})],e.prototype,"examCount",void 0),e}(),u={ONGOING:"in_progress",FINISHED:"ended",INCOMING:"not_started"},d=function(){function e(){this.finalScore=0,this.publishType=""}return l([(0,r.C)()],e.prototype,"finalScore",void 0),l([(0,r.C)()],e.prototype,"publishType",void 0),e}(),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.instructors=[],t}return s(t,e),l([(0,r.C)()],t.prototype,"id",void 0),l([(0,r.C)({name:"displayName"})],t.prototype,"name",void 0),l([(0,r.C)()],t.prototype,"startDate",void 0),l([(0,r.C)()],t.prototype,"cover",void 0),l([(0,r.C)(),(0,i.D)((function(){return a.Mb}))],t.prototype,"instructors",void 0),l([(0,r.C)(),(0,i.D)((function(){return a.UV}))],t.prototype,"academicYear",void 0),l([(0,r.C)(),(0,i.D)((function(){return a.hO}))],t.prototype,"semester",void 0),t}(function(){function e(){this.submittedHomeworkCount=0,this.submittedExamCount=0,this.forumCount=0,this.topicCount=0,this.questionnaireCount=0,this.attendanceRate=0,this.interactionRate=0,this.completeness=0,this.visitDuration=0}return l([(0,r.C)()],e.prototype,"submittedHomeworkCount",void 0),l([(0,r.C)()],e.prototype,"submittedExamCount",void 0),l([(0,r.C)()],e.prototype,"forumCount",void 0),l([(0,r.C)()],e.prototype,"topicCount",void 0),l([(0,r.C)()],e.prototype,"questionnaireCount",void 0),l([(0,r.C)()],e.prototype,"attendanceRate",void 0),l([(0,r.C)()],e.prototype,"interactionRate",void 0),l([(0,r.C)()],e.prototype,"completeness",void 0),l([(0,r.C)()],e.prototype,"visitDuration",void 0),l([(0,r.C)(),(0,i.D)((function(){return d}))],e.prototype,"score",void 0),e}())},570345:function(e,t,n){"use strict";n.d(t,{$L:function(){return u},Aj:function(){return y},Fj:function(){return f},JV:function(){return w},LT:function(){return b},Q_:function(){return g},SA:function(){return h},Yw:function(){return p},Z$:function(){return v},ZD:function(){return d},th:function(){return _},ty:function(){return m}});n(141817),n(66992),n(788674),n(333948);var o=n(409669),r=n.n(o),i=n(920976),a=n(356264),s=n(524137),l=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},c=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},u=function(e){return l(void 0,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:return[4,r().post("/api/project",{name:e})];case 1:return[2,t.sent()]}}))}))},d=function(e,t,n,o){return void 0===n&&(n=1),void 0===o&&(o=10),l(void 0,void 0,void 0,(function(){var l,u,d,p,f;return c(this,(function(c){switch(c.label){case 0:return l="id,name,instructors(id,name,email,user_no,avatar_small_url),classroom_schedule",window.orgSettings.isXjtuKnowledgeForestMode&&(l+=",knowledge_node_count"),u=(0,a.decamelizeKeys)({page:n,pageSize:o,fields:l,conditions:{classify_type:"recently_started",display_project_list:!0,keyword:e,hasKnowledgeNode:t}}),[4,r().get("/api/my-courses",{params:u})];case 1:if(void 0===(d=c.sent()).data.courses)throw new Error("invalid response");return p=(0,a.camelizeKeys)(d.data.courses),f=(0,i.d8)(s.IK,p,{excludeExtraneousValues:!0,exposeDefaultValues:!0}),[2,{page:d.data.page,pageSize:d.data.page_size,pages:d.data.pages,total:d.data.total,items:f}]}}))}))},p=function(e,t,n,o,u){return void 0===o&&(o=1),void 0===u&&(u=10),l(void 0,void 0,void 0,(function(){var l,d,p,f;return c(this,(function(c){switch(c.label){case 0:return l=(0,a.decamelizeKeys)({conditions:{keyword:e,applyStatus:t,hasKnowledgeNode:n},page:o,pageSize:u}),[4,r().get("/api/projects",{params:l})];case 1:return d=c.sent(),p=(0,a.camelizeKeys)(d.data.items),f=(0,i.d8)(s.IK,p,{excludeExtraneousValues:!0,exposeDefaultValues:!0}),[2,{page:d.data.page,pageSize:d.data.page_size,pages:d.data.pages,total:d.data.total,items:f}]}}))}))},f=function(e){return l(void 0,void 0,void 0,(function(){return c(this,(function(t){return[2,r().post("/api/projects/".concat(e,"/apply"))]}))}))},v=function(e,t,n,o){return l(void 0,void 0,void 0,(function(){var l,u,d,p;return c(this,(function(c){switch(c.label){case 0:return l=(0,a.decamelizeKeys)({conditions:o,page:t,pageSize:n}),[4,r().get("/api/projects/".concat(e,"/apply"),{params:l})];case 1:return u=c.sent(),d=(0,a.camelizeKeys)(u.data.items),p=(0,i.d8)(s.Zq,d,{excludeExtraneousValues:!0,exposeDefaultValues:!0}),[2,{page:u.data.page,pageSize:u.data.page_size,pages:u.data.pages,total:u.data.total,items:p}]}}))}))},h=function(e,t,n){return l(void 0,void 0,void 0,(function(){return c(this,(function(o){return[2,r().put("/api/projects/".concat(e,"/audit/").concat(t),{status:n})]}))}))},m=function(e,t){return l(void 0,void 0,void 0,(function(){var n,o;return c(this,(function(l){switch(l.label){case 0:return[4,r().put("/api/project/".concat(e),t)];case 1:return n=l.sent(),o=(0,a.camelizeKeys)(n.data),[2,(0,i.d8)(s.IK,o)]}}))}))},g=function(e,t){return l(void 0,void 0,void 0,(function(){return c(this,(function(n){switch(n.label){case 0:return[4,r().post("/api/project/".concat(e,"/share-resource"),t)];case 1:return[2,n.sent()]}}))}))},y=function(e,t){return l(void 0,void 0,void 0,(function(){return c(this,(function(n){switch(n.label){case 0:return[4,r().put("/api/project/".concat(e,"/share-resource"),t)];case 1:return[2,n.sent()]}}))}))},w=function(e,t){return l(void 0,void 0,void 0,(function(){var n,o,l;return c(this,(function(c){switch(c.label){case 0:return n=(0,a.decamelizeKeys)({conditions:t}),[4,r().get("/api/project/".concat(e,"/share-resource"),{params:n})];case 1:return o=c.sent(),l=(0,a.camelizeKeys)(o.data),[2,(0,i.d8)(s.Xo,l,{excludeExtraneousValues:!0})]}}))}))},b=function(e,t){return l(void 0,void 0,void 0,(function(){return c(this,(function(n){switch(n.label){case 0:return[4,r().delete("/api/project/".concat(e,"/share-resource"),{params:t})];case 1:return[2,n.sent()]}}))}))},_=function(e){return l(void 0,void 0,void 0,(function(){return c(this,(function(t){return[2,r().delete("/api/course/".concat(e))]}))}))}},524137:function(e,t,n){"use strict";n.d(t,{IK:function(){return v},Xo:function(){return h},Zq:function(){return f}});var o,r=n(413447),i=n(526617),a=n(247251),s=n(48496),l=(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),c=function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},u=function(){function e(){}return c([(0,r.C)()],e.prototype,"id",void 0),c([(0,r.C)()],e.prototype,"name",void 0),e}(),d=function(){function e(){}return c([(0,r.C)()],e.prototype,"name",void 0),c([(0,r.C)()],e.prototype,"id",void 0),c([(0,r.C)()],e.prototype,"userNo",void 0),e}(),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l(t,e),c([(0,r.C)(),(0,i.D)((function(){return u}))],t.prototype,"department",void 0),t}(d),f=function(){function e(){}return c([(0,r.C)()],e.prototype,"id",void 0),c([(0,r.C)()],e.prototype,"status",void 0),c([(0,r.C)(),(0,a.w)((function(e){var t=e.value;return s.TimeUtils.toLocalDate(t)}),{toClassOnly:!0})],e.prototype,"createdAt",void 0),c([(0,r.C)(),(0,i.D)((function(){return p}))],e.prototype,"user",void 0),e}(),v=function(){function e(){this.knowledgeNodeCount=void 0,this.owners=[],this.ownerIds=[],this.enrolledProject=!0,this.audit=void 0}return c([(0,r.C)()],e.prototype,"id",void 0),c([(0,r.C)()],e.prototype,"name",void 0),c([(0,r.C)()],e.prototype,"knowledgeNodeCount",void 0),c([(0,r.C)({name:"classroomSchedule"})],e.prototype,"description",void 0),c([(0,r.C)({name:"instructors"}),(0,i.D)((function(){return d}))],e.prototype,"owners",void 0),c([(0,r.C)()],e.prototype,"enrolledProject",void 0),c([(0,r.C)(),(0,i.D)((function(){return f}))],e.prototype,"audit",void 0),e}(),h=function(){function e(){this.refParentId=null}return c([(0,r.C)()],e.prototype,"id",void 0),c([(0,r.C)()],e.prototype,"name",void 0),c([(0,r.C)(),(0,a.w)((function(e){var t=e.value;return s.TimeUtils.toLocalDate(t)}),{toClassOnly:!0})],e.prototype,"createdAt",void 0),c([(0,r.C)()],e.prototype,"createdById",void 0),c([(0,r.C)()],e.prototype,"refParentId",void 0),c([(0,r.C)()],e.prototype,"upload",void 0),c([(0,r.C)()],e.prototype,"allowDownload",void 0),c([(0,r.C)()],e.prototype,"knowledgeCount",void 0),c([(0,r.C)()],e.prototype,"knowledgeNodes",void 0),e}()},218818:function(e,t,n){var o=n(383228);e.exports={props:["announcement"],data:()=>({}),computed:{cookieKey(){return"user-".concat(o("#userId").data("id"),"-announcement-").concat(this.announcement.id,"-closed")}},methods:{isShow(){return!o.cookie(this.cookieKey)},close(){return o.cookie(this.cookieKey,1,{expires:1,path:"/"}),this.$forceUpdate()}}}},680102:function(e,t,n){e.exports=n.p+"assets/js/vue/images/doubt-7af1fdb7.svg"},328816:function(e,t,n){e.exports=n.p+"assets/images/knowledge-node/node-sprite-becc535b.png"},953977:function(e,t,n){e.exports=n.p+"assets/images/large/course-cover-default-rectangle-85f43926.png"},731480:function(e,t,n){e.exports=n.p+"assets/images/large/course-cover-default-74db89b7.png"},32326:function(e,t,n){e.exports=n.p+"assets/images/large/project-cover-b3c161b4.png"},191882:function(e,t,n){e.exports=n.p+"assets/js/vue/images/project-65346cd6.png"},128955:function(e,t,n){"use strict";n.r(t);var o=n(887854),r=n.n(o),i=n(295348),a=n.n(i),s=new(r())({id:"info",use:"info-usage",viewBox:"0 0 14 14",content:'<symbol xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 14 14" id="info">\n<style type="text/css">\n\t#info .st0{fill-rule:evenodd;clip-rule:evenodd;fill:currentColor;}\n</style>\n<title>icon/alert/常规</title>\n<desc>Created with Sketch.</desc>\n<g>\n\t<path id="info_Combined-Shape" class="st0" d="M7,1c3.3,0,6,2.7,6,6s-2.7,6-6,6s-6-2.7-6-6S3.7,1,7,1z M7.6,5.8H6.4v3.6l-0.6,0v0.9h2.4\n\t\tV9.4l-0.6,0V5.8z M6.4,5.8H5.8v0.9h0.6V5.8z M7,3.4c-0.5,0-0.9,0.4-0.9,0.9S6.5,5.2,7,5.2s0.9-0.4,0.9-0.9S7.5,3.4,7,3.4z" />\n</g>\n</symbol>'});a().add(s);t.default=s},816237:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var o=n(709564),r=n(383228),i={name:"AlertMessages",components:{vueAlert:o.default},props:["messages","modal"],methods:{close(){var e=this.messages.map((e=>e.id));this.$http.put("/api/alert/messages/read",{ids:e}).then((e=>{"ok"===e.body.status&&this.$emit("close-modal")}))},toCourse(e){window.location.href="/course/".concat(e,"/content")}},data:()=>({deliveryOrg:r("html").attr("delivery-org")})},a=(0,n(551900).Z)(i,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",["KWNC"===e.deliveryOrg?n("Modal",{staticClass:"kwnc-modal",attrs:{scrollable:"",closable:!1,"mask-closable":!1,styles:{top:"200px"},width:"700px"},model:{value:e.modal,callback:function(t){e.modal=t},expression:"modal"}},[n("div",{attrs:{slot:"header"},slot:"header"},[e._v("\n      "+e._s(e.$i18n.t("alert.notification"))+"\n    ")]),e._v(" "),n("vueAlert",{attrs:{type:"warning",message:e.$i18n.t("alert.unread_popup_tip")}}),e._v(" "),e._l(e.messages,(function(t){return n("div",{key:t.id,staticClass:"message kwnc-style",on:{click:function(n){return e.toCourse(t.course_id)}}},[n("span",{staticClass:"content"},[e._v("\n        "+e._s(t.message)+"\n      ")]),e._v(" "),n("span",{staticClass:"alert-created-time"},[e._v("\n        "+e._s(e._f("datetime")(t.created_at))+"\n      ")]),e._v(" "),"rollcall"===t.category?n("span",{staticClass:"rollcall-alert-text"},[e._v("\n        "+e._s(e.$i18n.t("alert.rollcall_warning"))+"\n      ")]):"learning_activity"===t.category?n("span",{staticClass:"rollcall-alert-text"},[e._v("\n        "+e._s(e.$i18n.t("alert.learning_activity_warning"))+"\n      ")]):"course_completeness"===t.category?n("span",{staticClass:"rollcall-alert-text"},[e._v("\n        "+e._s(e.$i18n.t("alert.course_completeness_warning"))+"\n      ")]):e._e()])})),e._v(" "),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{on:{click:e.close}},[e._v(e._s(e.$i18n.t("alert.iAlreadyKnow")))])],1)],2):n("Modal",{attrs:{scrollable:"",closable:!1,"mask-closable":!1,width:"700px"},model:{value:e.modal,callback:function(t){e.modal=t},expression:"modal"}},[n("div",{attrs:{slot:"header"},slot:"header"},[n("i",{staticClass:"alert-icon font font-alert-tag"}),e._v("\n      "+e._s(e.$i18n.t("alert."+e.messages[0].category)+e.$i18n.t("alert.title"))+"\n    ")]),e._v(" "),e._l(e.messages,(function(t){return n("div",{key:t.id,staticClass:"message"},["learning_activity"===t.category?n("i",{staticClass:"alert-icon font icon-font",class:"font-"+t.type}):e._e(),e._v(" "),n("span",{staticClass:"content"},[e._v("\n        "+e._s(t.message)+"\n      ")])])})),e._v(" "),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{on:{click:e.close}},[e._v(e._s(e.$i18n.t("alert.iAlreadyKnow")))])],1)],2)],1)}),[],!1,null,"352f8841",null).exports},618511:function(e,t,n){"use strict";n.d(t,{default:function(){return i}});var o=n(218818),r=n.n(o)(),i=(0,n(551900).Z)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.isShow()?n("div",{staticClass:"header-warning"},[n("span",{staticClass:"content"},[e._v("\n    "+e._s(e.announcement.content)+"\n  ")]),e._v(" "),n("i",{staticClass:"font font-close right",on:{click:e.close}})]):e._e()}),[],!1,null,"507ad83a",null).exports},453432:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var o=n(925706),r=(0,o.aZ)({name:"Confirm",props:{value:{type:Boolean,default:!1},title:{type:String,default:""},showIcon:{type:Boolean,default:!0},message:{type:String,default:""},okText:{type:String,default:"ok"},cancelText:{type:String,default:"cancel"}},setup:function(e,t){var n=(0,o.iH)(!1);(0,o.YP)((function(){return e.value}),(function(e){n.value=e}));return{visible:n,handle:function(e){t.emit("input",!1),e?t.emit("onOk"):t.emit("onCancel")}}}}),i=(0,n(551900).Z)(r,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"confirm"},[o("Modal",{attrs:{title:e.title,"ok-text":e.okText,width:"480","cancel-text":e.cancelText},on:{"on-cancel":function(t){return e.handle(!1)},"on-ok":function(t){return e.handle(!0)}},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[o("div",[e.showIcon?o("img",{attrs:{src:n(680102),alt:""}}):e._e(),e._v(" "),o("p",{staticClass:"modal-message"},[e._v(e._s(e.message))])])])],1)}),[],!1,null,"dc39a122",null).exports},200657:function(e,t,n){"use strict";n.d(t,{Z:function(){return T}});n(324603),n(339714),n(788674);var o=n(866473),r=n(311610),i=n(117403),a={name:"node-content",props:["node"],render(e){var t,n,a=this.node,s=this.node.tree.vm,l=null!==(t=this.node.tree.options.validate)&&void 0!==t?t:function(){return!0},c=null!==(n=this.node.tree.options.save)&&void 0!==n?n:function(){return Promise.resolve(!0)},u=(e,t)=>{if(l(e,t))try{c(e,t,e.text).then((n=>{n&&(s.$emit("node:saved",e),e.stopEditing(t))}))}catch(e){console.log(e)}};if(a.isEditing){var d=a.text;this.$nextTick((e=>{this.$refs.editCtrl.focus()}));return e("span",{style:{"flex-grow":1,display:"flex",gap:"10px","align-items":"center"}},[e("input",{domProps:{value:a.text,type:"text"},attrs:{maxlength:"50"},class:"tree-input",on:{input(e){d=e.target.value,!1},blur(){},keyup(e){13===e.keyCode&&u(a,d)},mouseup(e){e.stopPropagation()}},ref:"editCtrl"}),e(o.Button,{class:"editing-mode-btn",style:{padding:"0 6px",height:"30px","border-radius":"6px",color:"var(--primary-brand-color)","font-size":"16px"},on:{click(){u(a,d)}}},[e(o.Tooltip,{props:{placement:"top",content:i.default.t("confirm"),transfer:!0}},[e(r.Z,{props:{name:"save"}})])]),e(o.Button,{class:"editing-mode-btn",style:{padding:"0 8px",height:"30px","border-radius":"6px",color:"var(--primary-brand-color)","font-size":"12px"},on:{click(){Number.isNaN(Number(a.id))?a.tree.remove(a):a.stopEditing(a.text)}}},[e(o.Tooltip,{props:{placement:"top",content:i.default.t("cancel"),transfer:!0}},[e(r.Z,{props:{name:"close"}})])])])}return s.$scopedSlots.default?s.$scopedSlots.default({node:this.node}):e("span",{domProps:{innerHTML:a.text}})}},s=n(551900),l=(0,s.Z)(a,undefined,undefined,!1,null,"bcb2b174",null).exports,c={name:"extra-content",props:["node"],render(e){var t=this.node.tree.vm;return t.$scopedSlots.extra?t.$scopedSlots.extra({node:this.node}):e("")}},u=(0,s.Z)(c,undefined,undefined,!1,null,null,null).exports,d={name:"right-content",props:["node"],render(e){var t=this.node.tree.vm;return t.$scopedSlots.right?t.$scopedSlots.right({node:this.node}):e("")}},p=(0,s.Z)(d,undefined,undefined,!1,null,null,null).exports,f={props:["node","visibleChildren","options"],components:{Icon:o.Icon},render(e){var t=this.node.tree.vm;return t.$scopedSlots.expand?t.$scopedSlots.expand({node:this.node}):this.visibleChildren.length>0?e("span",{class:["arrow"===this.options.expandIcon?"tree-arrow":"tree-expand",{expanded:this.node.states.expanded,"has-child":(this.node.children.length||this.node.isBatch)&&this.visibleChildren.length>0},this.options.direction]},["arrow"===this.options.expandIcon?e(o.Icon,{attrs:{type:"md-arrow-dropright",size:18,color:"#70748C"}}):e("i")]):e("span",{class:"arrow"===this.options.expandIcon?"tree-arrow":"tree-expand"})}},v={name:"Node",inject:["tree"],props:["node","options"],components:{NodeContent:l,ExtraContent:u,RightContent:p,ExpandNode:(0,s.Z)(f,undefined,undefined,!1,null,null,null).exports},watch:{node(){this.node.vm=this,this.node.tree.vm.$scopedSlots.extra&&this.node.tree.vm.$scopedSlots.extra({node:this.node})}},data(){return this.node.vm=this,{loading:!1}},computed:{padding(){return"".concat(this.node.depth*(this.options.paddingLeft?this.options.paddingLeft:this.options.nodeIndent),"px")},nodeClass(){var e=this.node.states,t=this.hasChildren(),n={"has-child":t,expanded:t&&e.expanded,selected:e.selected&&this.options.selectable,disabled:e.disabled,matched:e.matched,dragging:e.dragging,loading:this.loading,draggable:e.draggable,immutable:e.immutable};return this.options.checkbox&&(n.checked=e.checked,n.indeterminate=e.indeterminate),n},visibleChildren(){return this.node.children.filter((function(e){return e&&e.visible()}))}},methods:{onNodeFocus(){this.tree.activeElement=this.node},focus(){this.$refs.anchor.focus(),this.node.select()},check(){this.node.checked()?this.node.uncheck():this.node.check()},select(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).ctrlKey,t=this.options,n=this.tree,o=this.node;if(n.$emit("node:clicked",o),t.checkbox&&t.checkOnSelect)return!t.parentSelect&&this.hasChildren()?this.toggleExpand():this.check(e);t.multiple?o.selected()?e?o.unselect():1!==this.tree.selectedNodes.length&&(n.unselectAll(),o.select()):o.select(e):o.selected()&&e?o.unselect():o.select()},toggleExpand(){this.hasChildren()&&this.node.toggleExpand()},hasChildren(){return this.node.hasChildren()},startEditing(){this.tree._editingNode&&this.tree._editingNode.stopEditing(),this.node.startEditing()},stopEditing(){this.node.stopEditing()},handleMouseDown(e){this.options.dnd&&this.tree.vm.startDragging(this.node,e)},handleMouseover(e){this.tree.vm.draggableNode&&e.currentTarget.classList.add("dragging"),e.currentTarget.classList.add("is-hover")},handleMouseout(e){e.currentTarget.classList.remove("dragging"),e.currentTarget.classList.remove("is-hover")},handleDblclick(){this.node.isEditing||this.node.tree._editingNode||this.options.editing&&this.node.editable()&&this.startEditing()}}},h=(0,s.Z)(v,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("li",{staticClass:"tree-node",class:e.nodeClass,attrs:{role:"treeitem","data-id":e.node.id},on:{mouseover:function(t){return t.stopPropagation(),e.handleMouseover(t)},mouseout:function(t){return t.stopPropagation(),e.handleMouseout(t)}}},[n("div",{staticClass:"tree-content-wrapper",style:["ltr"==e.options.direction?{"margin-left":e.padding}:{"margin-right":e.padding}],on:{click:e.select}},[n("div",{staticClass:"tree-content"},[n("expand-node",{attrs:{options:e.options,node:e.node,"visible-children":e.visibleChildren},nativeOn:{click:function(t){return e.toggleExpand(t)}}}),e._v(" "),e.options.checkbox?n("i",{staticClass:"tree-checkbox",class:{checked:e.node.states.checked,indeterminate:e.node.states.indeterminate},on:{click:function(t){return t.stopPropagation(),e.check(t)}}}):e._e(),e._v(" "),n("span",{ref:"anchor",staticClass:"tree-anchor",class:{"no-child":!((e.node.children.length||e.node.isBatch)&&e.visibleChildren.length>0)},attrs:{tabindex:"-1"},on:{focus:e.onNodeFocus,dblclick:e.handleDblclick}},[n("node-content",{attrs:{node:e.node}})],1)],1),e._v(" "),n("extra-content",{staticClass:"tree-extra",attrs:{node:e.node},nativeOn:{click:function(t){return e.select(t)}}}),e._v(" "),n("right-content",{staticClass:"tree-right",attrs:{node:e.node}})],1),e._v(" "),n("transition",{attrs:{name:"l-fade"}},[e.hasChildren()&&e.node.states.expanded?n("ul",{staticClass:"tree-children",style:{"--padding-left":e.padding}},e._l(e.visibleChildren,(function(t){return n("node",{key:t.id,attrs:{node:t,options:e.options}})})),1):e._e()])],1)}),[],!1,null,null,null).exports,m={name:"DragNode",props:["target"],computed:{content(){var e,t=this.target.ele.cloneNode(!0);return null===(e=t.querySelector("ul"))||void 0===e||e.remove(),t.innerHTML},style(){if(void 0===this.target.top)return"display: none";var e=this.target.ele.querySelector(".tree-content-wrapper").clientHeight,t=this.target.ele.clientWidth,n=this.getElementLeft(this.target.ele);return{top:"".concat(this.target.top-e/2,"px"),left:"".concat(n,"px"),height:"".concat(e,"px"),width:"".concat(t,"px"),background:"#eee",opacity:"0.8"}}},methods:{getElementLeft(e){for(var t=e.offsetLeft,n=e.offsetParent;null!==n;)t+=n.offsetLeft,n=n.offsetParent;return t}}},g=(0,s.Z)(m,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{staticClass:"tree-dragnode",style:e.style,domProps:{innerHTML:e._s(e.content)}})}),[],!1,null,null,null).exports,y=n(225873),w=n(998009);function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){C(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var k={direction:"ltr",multiple:!0,checkbox:!1,checkOnSelect:!1,autoCheckChildren:!0,autoDisableChildren:!0,checkDisabledChildren:!0,parentSelect:!1,keyboardNavigation:!0,nodeIndent:24,minFetchDelay:0,fetchData:null,propertyNames:null,deletion:!1,dnd:!1,editing:!1,selectable:!0,onFetchError(e){throw e}},x={emptyText:"Nothing found!",textMatcher(e,t){var n=new RegExp(e,"i").test(t.text);return!(n&&t.parent&&new RegExp(e,"i").test(t.parent.text))&&n},plainList:!1,showChildren:!0},S={name:"Tree",components:{TreeNode:h,DraggableNode:g},mixins:[y.Z,w.Z],provide:e=>({tree:null}),props:{data:{},options:{type:Object,default:e=>({})},filter:String,dimensions:{type:Array,default:()=>[]},tag:{type:String,default:"div"}},data(){var e=_(_({},k),this.options);return e.filter=_(_({},x),e.filter),{model:[],tree:null,loading:!1,opts:e,matches:[],draggableNode:null,draggableEle:null}},computed:{visibleModel(){return this.model.filter((function(e){return e&&e.visible()}))},visibleMatches(){return this.matches.filter((function(e){return e&&e.visible()}))},listenChange(){return{filter:this.filter,dimensions:this.dimensions}}},watch:{listenChange(e){this.tree.filter(e)}}},T=(0,s.Z)(S,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n(e.tag,{tag:"component",class:{tree:!0,"tree-loading":this.loading,"tree--draggable":!!this.draggableNode},attrs:{role:"tree"}},[e.filter&&0==e.matches.length?[n("div",{staticClass:"tree-filter-empty",domProps:{innerHTML:e._s(e.opts.filter.emptyText)}})]:[n("ul",{staticClass:"tree-root",on:{dragstart:e.onDragStart}},[e.opts.filter.plainList&&e.matches.length>0?e._l(e.visibleMatches,(function(t){return n("TreeNode",{key:t.id,attrs:{node:t,options:e.opts}})})):e._l(e.visibleModel,(function(t){return n("TreeNode",{key:t.id,attrs:{node:t,options:e.opts}})}))],2)],e._v(" "),e.draggableNode?n("DraggableNode",{attrs:{target:e.draggableNode}}):e._e()],2)}),[],!1,null,null,null).exports},177597:function(e,t,n){"use strict";n.r(t);var o=n(336986),r=n(973402),i=(0,n(551900).Z)(r.Z,o.s,o.x,!1,null,"59ea8b82",null);t.default=i.exports},438589:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return _}});n(747042),n(788674);var o=n(887757),r=n.n(o),i=(n(535666),n(925706)),a=n(860250),s=n(815115),l=n(730381),c=n(866473),u=n(117403),d=n(409669),p=n.n(d);function f(e,t,n,o,r,i,a){try{var s=e[i](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(o,r)}function v(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var i=e.apply(t,n);function a(e){f(i,o,r,a,s,"next",e)}function s(e){f(i,o,r,a,s,"throw",e)}a(void 0)}))}}var h=function(){var e=v(r().mark((function e(t){var n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p().get("/api/courses/".concat(t,"/group-sets?preload_id=-1&fields=id,group_set_id,name,members,leaders,created_at,sort"));case 2:return n=e.sent,e.abrupt("return",n.data.group_sets);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=v(r().mark((function e(t,n){var o;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p().post("/api/courses/".concat(t,"/ask-question"),n);case 2:return o=e.sent,e.abrupt("return",o.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),g=function(){var e=v(r().mark((function e(t,n){var o;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p().put("/api/ask-questions/".concat(t),n);case 2:return o=e.sent,e.abrupt("return",o.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),y=function(){var e=v(r().mark((function e(t){var n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p().get("/api/course/".concat(t,"/students"));case 2:return n=e.sent,e.abrupt("return",n.data.students);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function w(e,t,n,o,r,i,a){try{var s=e[i](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(o,r)}var b=(0,i.aZ)({components:{ModuleSyllabusSelect:s.Z},props:{courseId:{require:!1},activity:{require:!1},moduleId:{require:!1},syllabusId:{require:!1},inSyllabus:{require:!1,default:!0}},setup(e){var t=(0,i.iH)({moduleId:0,syllabusId:0,question:"",type:"select_student",num:1,groupSetId:0}),n=(0,i.iH)(),o=l().format("YYYY.MM.DD HH:mm"),s=(0,i.Fl)((()=>{var t;return!(null===(t=e.activity)||void 0===t||!t.end_time)})),d=(0,i.Fl)((()=>{var e="";return t.value.moduleId&&(e="module_".concat(t.value.moduleId)),t.value.syllabusId&&(e+="_syllabus_".concat(t.value.syllabusId)),e})),p=(0,i.iH)(!1),f=(0,i.iH)([]),v=(0,i.iH)([]),b=(0,i.iH)([]),_=(0,i.Fl)((()=>Array(Math.min(b.value.length,10)).fill(0).map(((e,t)=>({label:"".concat(t+1),value:t+1}))))),C=(0,i.Fl)((()=>f.value.map((e=>{var t;return{label:"".concat(e.name," (").concat(u.default.t("ask-question.groupCount",[(null===(t=e.groups)||void 0===t?void 0:t.length)||0]),")"),value:e.id}})))),k=(0,i.Fl)((()=>b.value.length?"":u.default.t("ask-question.student-not-data"))),x={groupSetId:[{validator:(e,t,n)=>{if(t){var o,r=f.value.find((e=>e.id===t));null!=r&&null!==(o=r.groups)&&void 0!==o&&o.length?n():n(new Error(u.default.t("ask-question.select-group-tips2"))),n()}else n(new Error(u.default.t("ask-question.select-group-tips1")))},trigger:"change",type:"number"}],num:[{validator:(e,t,n)=>{t?n():n(new Error(u.default.t("ask-question.select-student-tips")))},trigger:"custom",type:"number"}]},S=()=>{p.value=!1},T=e=>new Promise((t=>{n.value.validateField(e,(e=>{t(!e)}))})),D=function(){var n,i=(n=r().mark((function n(){var i,a,s;return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=!0,"select_student"!==t.value.type){n.next=7;break}return n.next=4,T("num");case 4:a=n.sent,n.next=10;break;case 7:return n.next=9,T("groupSetId");case 9:a=n.sent;case 10:if(a){n.next=12;break}return n.abrupt("return");case 12:s={module_id:t.value.moduleId,syllabus_id:t.value.syllabusId||void 0,type:t.value.type,question:t.value.question,title:o},"select_student"===t.value.type?s.select_num=t.value.num:(s.select_num=1,s.group_set_id=t.value.groupSetId),null!==(i=e.activity)&&void 0!==i&&i.id?g(e.activity.id,s).then((()=>{S(),c.Message.success(u.default.t("ask-question.edit-tips")),window.location.reload()})):m(e.courseId,s).then((()=>{S(),c.Message.success(u.default.t("ask-question.create-tips")),window.location.reload()}));case 15:case"end":return n.stop()}}),n)})),function(){var e=this,t=arguments;return new Promise((function(o,r){var i=n.apply(e,t);function a(e){w(i,o,r,a,s,"next",e)}function s(e){w(i,o,r,a,s,"throw",e)}a(void 0)}))});return function(){return i.apply(this,arguments)}}();return(0,i.YP)((()=>e.activity),(()=>{var n,o,r,i,a,s,l,c,u;e.activity&&(t.value={moduleId:null===(n=e.activity)||void 0===n?void 0:n.module_id,syllabusId:null===(o=e.activity)||void 0===o?void 0:o.syllabus_id,question:null===(r=e.activity)||void 0===r||null===(i=r.data)||void 0===i?void 0:i.question,type:null===(a=e.activity)||void 0===a?void 0:a.type,num:null===(s=e.activity)||void 0===s||null===(l=s.data)||void 0===l?void 0:l.select_num,groupSetId:null===(c=e.activity)||void 0===c||null===(u=c.data)||void 0===u?void 0:u.group_set_id})}),{immediate:!0}),(0,i.bv)((()=>{var n,o,r,i,s,l,c,u,d;(h(e.courseId).then((e=>{f.value=e})),(0,a.getCourseModules)(e.courseId).then((n=>{v.value=n;var o=v.value.slice(-1)[0]||{id:0},r=o.syllabuses.slice(-1)[0]||{id:0};e.inSyllabus&&(e.moduleId||e.syllabusId?(t.value.moduleId=e.moduleId,t.value.syllabusId=e.syllabusId):(t.value.moduleId=o.id,t.value.syllabusId=r.id))})),y(e.courseId).then((e=>{b.value=e,t.value.num=e.length?1:0})),e.activity)&&(t.value={moduleId:null===(n=e.activity)||void 0===n?void 0:n.module_id,syllabusId:null===(o=e.activity)||void 0===o?void 0:o.syllabus_id,question:null===(r=e.activity)||void 0===r||null===(i=r.data)||void 0===i?void 0:i.question,type:null===(s=e.activity)||void 0===s?void 0:s.type,num:null===(l=e.activity)||void 0===l||null===(c=l.data)||void 0===c?void 0:c.select_num,groupSetId:null===(u=e.activity)||void 0===u||null===(d=u.data)||void 0===d?void 0:d.group_set_id})})),{formData:t,visible:p,options:_,groupSetOptions:C,moduleSyllabusId:d,modules:v,disabled:s,moduleChange:e=>{t.value.moduleId=e.module_id,t.value.syllabusId=e.syllabus_id},rules:x,submit:D,cancel:S,formRef:n,selectStudentPlaceholder:k}}}),_=(0,n(551900).Z)(b,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Modal",{ref:"modal",staticClass:"ask-question-modal",attrs:{title:e.$t("ask-question.name"),width:640},scopedSlots:e._u([{key:"footer",fn:function(){return[n("div",{staticClass:"flex"},[n("Button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v(e._s(e.$t("confirm")))]),e._v(" "),n("Button",{on:{click:e.cancel}},[e._v(e._s(e.$t("cancel")))])],1)]},proxy:!0}]),model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[n("Form",{ref:"formRef",attrs:{"label-width":120,"label-position":"left",rules:e.rules,model:e.formData}},[n("FormItem",{attrs:{label:e.$t("h5_courseware.module/syllabus")}},[n("ModuleSyllabusSelect",{attrs:{value:e.moduleSyllabusId,"modules-syllabus":e.modules,allowSelectBlank:!e.inSyllabus},on:{"on-module-change":e.moduleChange}})],1),e._v(" "),n("FormItem",{attrs:{label:e.$t("ask-question.question")+"("+e.$t("ask-question.optional")+")",prop:"question"}},[n("Input",{attrs:{type:"textarea",disabled:e.disabled,maxlength:200,"show-word-limit":""},model:{value:e.formData.question,callback:function(t){e.$set(e.formData,"question",t)},expression:"formData.question"}})],1),e._v(" "),n("FormItem",{attrs:{label:e.$t("ask-question.type")}},[n("RadioGroup",{model:{value:e.formData.type,callback:function(t){e.$set(e.formData,"type",t)},expression:"formData.type"}},[n("Radio",{attrs:{label:"select_student",disabled:e.disabled}},[e._v(e._s(e.$t("ask-question.select-student")))]),e._v(" "),n("Radio",{attrs:{label:"select_group",disabled:e.disabled}},[e._v(e._s(e.$t("ask-question.select-group")))])],1)],1),e._v(" "),n("FormItem",{directives:[{name:"show",rawName:"v-show",value:"select_student"===e.formData.type,expression:"formData.type === 'select_student'"}],attrs:{label:e.$t("ask-question.select-num"),prop:"num"}},[n("Select",{staticStyle:{width:"260px"},attrs:{disabled:e.disabled,placeholder:e.selectStudentPlaceholder,"not-found-text":e.$t("ask-question.student-not-data")},model:{value:e.formData.num,callback:function(t){e.$set(e.formData,"num",t)},expression:"formData.num"}},e._l(e.options,(function(e,t){return n("Option",{key:t,attrs:{value:e.value,label:e.label}})})),1)],1),e._v(" "),n("FormItem",{directives:[{name:"show",rawName:"v-show",value:"select_group"===e.formData.type,expression:"formData.type === 'select_group'"}],attrs:{label:e.$t("ask-question.plan"),prop:"groupSetId"}},[n("Select",{staticStyle:{width:"260px"},attrs:{disabled:e.disabled,placeholder:e.$t("ask-question.choose-group-set-tips"),"not-found-text":e.$t("ask-question.no-group-set")},model:{value:e.formData.groupSetId,callback:function(t){e.$set(e.formData,"groupSetId",t)},expression:"formData.groupSetId"}},e._l(e.groupSetOptions,(function(e,t){return n("Option",{key:t,attrs:{value:e.value,label:e.label}})})),1)],1)],1)],1)}),[],!1,null,"513101dd",null).exports},163223:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});n(66992),n(651532),n(333948);var o,r=n(925706),i=n(966309),a=n(117403),s=(0,r.aZ)({props:{value:{type:String,required:!0},viewMap:{type:Map,default:(o=new Map,o.set("outline",a.default.t("knowledgeGraph.outlineView")),o.set("mindmap",a.default.t("knowledgeGraph.mindMap")),o.set("graph",a.default.t("knowledgeGraph.title")),o)}},setup:function(e,t){var n=t.emit,o=(0,r.iH)(!1),a=(0,i.NCN)(e,"value",n,{eventName:"input"});return{selected:a,visible:o,onClick:function(e){o.value=!1,a.value=e}}}}),l=(0,n(551900).Z)(s,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"root"},[n("Dropdown",{attrs:{trigger:"custom",visible:e.visible,placement:"bottom-start"},on:{"on-clickoutside":function(t){e.visible=!1}}},[n("div",{staticClass:"box"},[n("div",{staticClass:"btn view-select-btn",on:{click:function(t){e.visible=!0}}},[n("i",{staticClass:"font",class:"font-"+e.selected+"-view"}),e._v("\n        "+e._s(e.viewMap.get(e.selected))+"\n        "),n("Icon",{attrs:{type:"ios-arrow-down"}})],1),e._v(" "),e.$slots.default?n("Divider",{staticClass:"divider",attrs:{type:"vertical"}}):e._e(),e._v(" "),e._t("default")],2),e._v(" "),n("DropdownMenu",{attrs:{slot:"list"},slot:"list"},e._l(e.viewMap,(function(t){var o=t[0],r=t[1];return n("DropdownItem",{key:o,class:{active:o===e.selected},nativeOn:{click:function(t){return e.onClick(o)}}},[n("i",{staticClass:"font",class:"font-"+o+"-view"}),e._v(" "),n("span",{staticClass:"text"},[e._v(e._s(r))])])})),1)],1)],1)}),[],!1,null,"4c093916",null).exports},14491:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var o=n(925706),r=n(966309),i=n(563507),a=(0,o.aZ)({name:"TeachingCalendarViewModal",props:{keyword:{type:String},value:{type:Boolean,required:!0},model:{type:Object,required:!0}},setup:function(e,t){return{show:(0,r.NCN)(e,"value",t.emit,{eventName:"input"}),highlightKeyword:i.H}}}),s=(0,n(551900).Z)(a,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Modal",{attrs:{title:e.$t("teachingCalendar.detail"),width:600,"mask-closable":!1,"footer-hide":"",transfer:!1},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[e.model.course?n("h2",[e._v(e._s(e.model.course.name)+"("+e._s(e.model.course.courseCode)+")")]):e._e(),e._v(" "),n("Form",{attrs:{"label-width":100,"label-position":"left"}},[n("FormItem",{attrs:{label:e.$t("teachingCalendar.week")}},[n("span",[e._v(e._s(e.model.teachingWeek?e.model.teachingWeek.sequence:0))])]),e._v(" "),n("FormItem",{attrs:{label:e.$t("teachingCalendar.teachingType")}},[n("span",[e._v(e._s(e.model.type))])]),e._v(" "),n("FormItem",{attrs:{label:e.$t("teachingCalendar.content")}},[n("span",{domProps:{innerHTML:e._s(e.highlightKeyword(e.model.content,e.keyword))}})]),e._v(" "),n("FormItem",{attrs:{label:e.$t("teachingCalendar.hours")}},[n("span",[e._v(e._s(e.model.hours))])]),e._v(" "),n("FormItem",{attrs:{label:e.$t("teachingCalendar.instructor")}},[n("span",[e._v(e._s(e.model.instructor))])]),e._v(" "),n("FormItem",{attrs:{label:e.$t("teachingCalendar.location")}},[n("span",[e._v(e._s(e.model.location))])]),e._v(" "),n("FormItem",{attrs:{label:e.$t("teachingCalendar.teachingTime")}},[n("span",[e._v(e._s(e.model.teachingTime))])])],1)],1)}),[],!1,null,"5dd5350e",null).exports},894065:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var o,r=n(495334),i=n(866473),a=(n(891911),o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=function(e,t,n,o){var r,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(i<3?r(a):i>3?r(t,n,a):r(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),s([(0,r.fI)({default:!0})],t.prototype,"fix",void 0),t=s([(0,r.wA)({components:{Spin:i.Spin,Icon:i.Icon}})],t)}(r.w3),c=(0,n(551900).Z)(l,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"loading-overlay-container"},[n("Spin",{attrs:{fix:e.fix}},[n("svg",{staticClass:"svg-icon loading-spinner"},[n("use",{attrs:{"xlink:href":"#loading-spinner"}})]),e._v(" "),n("div",{staticClass:"hint"},[e._v(e._s(e.$t("loading")))])])],1)}),[],!1,null,"468001bb",null).exports},992665:function(e,t,n){"use strict";n.d(t,{Z:function(){return y}});n(141817),n(66992),n(185827),n(747042),n(702707),n(140561),n(651532),n(788674),n(324603),n(339714),n(132023),n(323123),n(454747),n(333948);var o=n(925706),r=n(496486),i=n.n(r),a=n(938823),s=n(863296),l=n(462149),c=n(427372),u=n(534662),d=n(948150),p=n(662061),f=n(486992),v=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},h=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},m=function(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))},g=(0,o.aZ)({props:{orgId:{type:Number,default:0},courseId:{type:Number,default:0},activityId:{type:Number,default:0},activityType:{type:String},knowledgeNodeIds:{type:String,default:""}},components:{ToolbarWrapper:d.Z,Tree:a.ZP,NoData:c.Z,KnowledgeNodeTag:u.Z},setup:function(e,t){var n=this,r=(0,o.iH)(null),a=(0,o.iH)(),c=(0,o.iH)(!0),u=(0,o.iH)([]),d=(0,o.iH)({autoCheckChildren:!1,nodeIndent:30,checkbox:!0,filter:{emptyText:"",showChildren:!1,textMatcher:function(e,t){return new RegExp(e,"i").test(t.text)}}}),g=(0,o.iH)(!1),y=(0,o.iH)(""),w=(0,o.iH)(!1),b=(0,o.iH)([]),_=(0,o.iH)([]),C=(0,o.iH)([]),k=(0,o.iH)(!1),x=function(){var t={orgId:e.orgId,courseId:e.courseId,activityId:e.activityId,activityType:e.activityType,knowledgeNodeIds:_.value.length>0?i().map(_.value,(function(e){return e.id})):[]},n=new CustomEvent("knowledge-node-changed-event",{detail:t});window.dispatchEvent(n)},S=function(){var e=i().cloneDeep(u.value);(0,f.T$)(e,(function(){0}));var t=e[0];t&&(t.state||(t.state=new l.bU),t.state.selected=!0),a.value.tree.setModel(e),c.value=0===e.length;var n=a.value.opts,o=n.multiple,s=n.checkbox,d=a.value.selected(),p=a.value.checked();r.value=s?{selected:o?d:d[0]||null,checked:p}:{selected:o?d:d[0]||null}},T=function(){if(0!==e.courseId){var t=[];k.value&&C.value.length>0?t=i().map(C.value,(function(e){return e.id})):e.knowledgeNodeIds&&(t=i().map(e.knowledgeNodeIds.split(","),(function(e){return parseInt(e,0)})));var n=a.value.tree.find((function(e){return t.includes(e.id)}),!0);if(function(e,t){var n=t.reduce((function(e,t,n){return e.set(t,n),e}),new Map);e.sort((function(e,t){return(n.get(e.id)||0)-(n.get(t.id)||0)}))}(n,t),0===n.length)return _.value=[],void(C.value=[]);i().forEach(n,(function(e){e.check()})),_.value=m([],n,!0),C.value=m([],n,!0)}};(0,o.YP)((function(){return e.courseId}),(function(){0!==e.courseId&&v(n,void 0,void 0,(function(){var t;return h(this,(function(n){switch(n.label){case 0:return t=u,[4,(0,p.$H)(e.courseId)];case 1:return t.value=n.sent(),S(),[2]}}))}))}),{immediate:!0});return(0,o.YP)([function(){return e.knowledgeNodeIds},c],(function(e,t){var n,o,r,s;c.value||(n=t[0],o=i().map(n.split(","),(function(e){return parseInt(e,0)})),r=i().filter(o,(function(e){return!i().isNaN(e)})),s=a.value.tree.find((function(e){return r.includes(e.id)}),!0),i().forEach(s,(function(e){i().isEmpty(e)||e.uncheck()})),T())})),s.Z.$on("refreshNodesInfo",(function(){k.value=!0,C.value=[],T()})),{treeModel:r,treeComponentRef:a,treeData:b,noData:c,options:d,loading:g,showModal:w,filter:y,savedKnowledgeNode:_,selectedKnowledgeNode:C,selectedCount:(0,o.Fl)((function(){return C.value.length})),hasSelected:(0,o.Fl)((function(){return C.value.length>0})),openModal:function(){w.value=!0,T()},closeModal:function(){0===e.activityId?C.value=[]:(i().forEach(C.value,(function(e){e.uncheck()})),i().forEach(_.value,(function(e){e.check()})),C.value=m([],_.value,!0)),y.value="",w.value=!1,S()},save:function(){_.value=m([],C.value,!0),y.value="",x(),t.emit("after-selected-nodes",_.value),w.value=!1},add:function(){},search:function(e){y.value=e},treeFilterHandle:function(e,t){c.value=0===e.length&&!!t,t||a.value.collapseAll();var n=[];e.forEach((function(e){e.hasChildren()&&e.recurseDown((function(e){new RegExp(t,"i").test(e.text)&&n.push(e)}),!0)})),n.forEach((function(e){e.state("visible",!0),e.recurseUp((function(e){e.expand(),e.state("visible",!0)}))}))},nodeCheckedHandle:function(){C.value=a.value.checked()},deleteNodeTag:function(e,n){var o="saved"===e?_:C,r=i().findIndex(o.value,{id:n.id});if(-1!==r){o.value.splice(r,1);var s=a.value.find((function(e){return e.id===n.id}));s&&s.uncheck()}"saved"===e&&(x(),t.emit("after-selected-nodes",_.value))},onVisibleChange:function(e){e||S()}}}}),y=(0,n(551900).Z)(g,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"activity-knowledge-node-setting",attrs:{"ng-non-bindable":""}},[n("div",{staticClass:"setting-content"},[n("Button",{staticStyle:{margin:"2px 8px 2px 0"},attrs:{type:"default",icon:"md-add",loading:e.loading},on:{click:function(t){return e.openModal()}}},[e._v("\n      "+e._s(e.$t("knowledgeGraph.relatedNode"))+"\n    ")]),e._v(" "),e._l(e.savedKnowledgeNode,(function(t,o){return n("KnowledgeNodeTag",{key:o,attrs:{"course-id":e.courseId,content:t.text,size:"large",closable:!0},on:{"delete-node-tag":function(n){return e.deleteNodeTag("saved",t)}}})}))],2),e._v(" "),n("Modal",{staticClass:"knowledge-node-setting-modal",attrs:{title:e.$t("knowledgeGraph.relatedNode"),width:1e3,"z-index":1006,transfer:""},on:{"on-cancel":e.closeModal,"on-visible-change":e.onVisibleChange},model:{value:e.showModal,callback:function(t){e.showModal=t},expression:"showModal"}},[n("div",{staticClass:"content"},[n("div",{staticClass:"tree-wrapper"},[n("ToolbarWrapper",{attrs:{divider:""}},[n("div",{staticStyle:{height:"30px"}},[n("Button",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],on:{click:function(t){return e.add("sibling")}}},[n("Icon",{attrs:{type:"md-add"}}),e._v("\n              "+e._s(e.$t("knowledgeGraph.addSibling"))+"\n            ")],1),e._v(" "),n("Button",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],on:{click:function(t){return e.add("child")}}},[n("Icon",{attrs:{type:"md-add"}}),e._v("\n              "+e._s(e.$t("knowledgeGraph.addChild"))+"\n            ")],1),e._v(" "),n("Input",{attrs:{search:"",placeholder:e.$t("knowledgeGraph.nodeName")},on:{"on-search":e.search}})],1)]),e._v(" "),n("div",{staticClass:"tree-container",style:{padding:e.noData?"24px":null,"padding-top":e.noData?"8px":null}},[n("Tree",{ref:"treeComponentRef",attrs:{options:e.options,data:e.treeData,filter:e.filter},on:{"tree:filtered":e.treeFilterHandle,"node:checked":e.nodeCheckedHandle,"node:unchecked":e.nodeCheckedHandle},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.node;return[n("div",{staticClass:"tree-content-with-tooltip"},[n("Tooltip",{directives:[{name:"ellipsis",rawName:"v-ellipsis"}],attrs:{placement:"top",content:o.text,transfer:""}},[n("span",[e._v(e._s(o.text))])])],1)]}}]),model:{value:e.treeModel,callback:function(t){e.treeModel=t},expression:"treeModel"}}),e._v(" "),e.noData?n("NoData",[e._v("\n            "+e._s(e.$t("knowledgeGraph.noContent"))+"\n          ")]):e._e()],1)],1),e._v(" "),n("div",{staticClass:"selected-wrapper"},[n("div",[e._v(e._s(e.$t("knowledgeGraph.selectedNode",[e.selectedCount])))]),e._v(" "),e.hasSelected?n("div",{staticClass:"selected-list"},e._l(e.selectedKnowledgeNode,(function(t,o){return n("KnowledgeNodeTag",{key:o,attrs:{"course-id":e.courseId,content:t.text,size:"large",closable:!0},on:{"delete-node-tag":function(n){return e.deleteNodeTag("selected",t)}}})})),1):n("NoData",[e._v("\n          "+e._s(e.$t("knowledgeGraph.relationMessage"))+"\n        ")])],1)]),e._v(" "),n("div",{staticClass:"modal-footer",attrs:{slot:"footer"},slot:"footer"},[n("div",{staticClass:"btn-primary btn-default",on:{click:e.save}},[e._v(e._s(e.$t("ok")))]),e._v(" "),n("div",{staticClass:"btn-minor btn-default",on:{click:e.closeModal}},[e._v(e._s(e.$t("cancel")))])])])],1)}),[],!1,null,"3f9177c3",null).exports},37423:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});n(66992),n(747042),n(651532),n(319601),n(333948);var o=n(925706),r=n(117403),i=n(496486),a=n(82720),s=function(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))},l=["none","remember","understand","apply","analyze","evaluate","create"],c=(0,o.aZ)({props:{value:{type:[String,Array],default:"",validate:function(e){return"string"==typeof e?(0,i.includes)(l,e):(0,i.every)(e,(function(e){return(0,i.includes)(l,e)}))}},multiple:{type:Boolean,default:!1},placeholder:{type:String,default:r.default.t("knowledgeGraph.cognitiveDimension.all")},width:{type:[Number,String],default:200},height:{type:[Number,String],default:32},withColor:{type:Boolean,default:!1},canSelectUnspecified:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1}},setup:function(e,t){var n=(0,o.iH)(),i=(0,o.Fl)((function(){return e.canSelectUnspecified?s([{key:"none",value:r.default.t("knowledgeGraph.cognitiveDimension.unspecified")}],a.Nb,!0):a.Nb})),l=(0,o.Fl)((function(){return!e.multiple||"object"==typeof n.value&&1===n.value.length?1:0})),c=(0,o.Fl)((function(){var t={},n="string"==typeof e.width?parseInt(e.width,10):e.width,o="string"==typeof e.height?parseInt(e.height,10):e.height,r={width:"".concat(n,n<=100?"%":"px"),height:"".concat(o,"px")};return Object.assign(t,r),t})),u=new Map([["remember",{background:"#f4edff",color:"#8547e8",border:"1px solid #8547e8"}],["understand",{background:"#eff6ff",color:"#3471d3",border:"1px solid #3471d3"}],["apply",{background:"#e4fafa",color:"#0e7d84",border:"1px solid #0e7d84"}],["analyze",{background:"#fff9c6",color:"#a78304",border:"1px solid #a78304"}],["evaluate",{background:"#fff5e5",color:"#ec8201",border:"1px solid #ec8201"}],["create",{background:"#feeeee",color:"#f85353",border:"1px solid #f85353"}]]);(0,o.bv)((function(){n.value=e.value})),(0,o.YP)((function(){return e.value}),(function(){n.value=e.value}));var d=(0,o.Fl)((function(){if(!e.multiple&&e.withColor&&n.value)return"colorful-style ".concat(n.value)}));return{dimension:n,customStyle:c,availableCognitiveDimensions:i,maxCount:l,colorfulStyle:d,optionStyle:function(t){var n={};if(e.withColor){var o=u.get(t);Object.assign(n,{padding:"1px 4px",fontSize:"12px",fontWeight:400,lineHeight:"18px",borderRadius:"4px"},o)}return n},maxPlaceholder:function(e){return"".concat(r.default.t("select")).concat(e).concat(r.default.t("item"))},onChange:function(e){n.value=e,t.emit("input",e)}}}}),u=(0,n(551900).Z)(c,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Select",{class:e.colorfulStyle,style:e.customStyle,attrs:{placeholder:e.placeholder,"max-tag-count":e.maxCount,multiple:e.multiple,"max-tag-placeholder":e.maxPlaceholder,disabled:e.disabled,clearable:""},on:{"on-change":e.onChange},model:{value:e.dimension,callback:function(t){e.dimension=t},expression:"dimension"}},e._l(e.availableCognitiveDimensions,(function(t){return n("Option",{key:t.key,attrs:{value:t.key,label:t.value}},[n("span",{style:e.optionStyle(t.key)},[e._v(e._s(t.value))])])})),1)}),[],!1,null,"21986838",null).exports},119292:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var o={inject:["course"]},r=(0,n(551900).Z)(o,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"course-name"},[n("Tooltip",{attrs:{content:e.course.name,placement:"top"}},[e._v("\n    "+e._s(e.course.name)+"\n  ")])],1)}),[],!1,null,"5e509a4e",null).exports},860635:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var o=n(154803),r="relative",i={props:{fixed:{type:Boolean,default:!1},mask:{type:Boolean,default(){return this.fixed}},width:{type:Number,default:()=>o.wZ?400:600},button:{type:Boolean,default:!0},closeButton:{type:Boolean,default:!1},value:{type:Boolean,default:!1},parentPosition:{type:[String,Boolean],default:r}},data(){return{open:this.value,maskHeight:0}},computed:{isShowMask(){return this.open&&this.mask}},watch:{value(e){this.open=e},open(e){this.$emit("on-visible-change",e),e?this.$emit("on-open"):this.$emit("on-close")}},methods:{toggleDrawer(){this.open=!this.open,this.$emit("input",this.open)},closeDrawer(){this.open=!1,this.$emit("input",this.open)},onAfterLeave(){this.$refs.eleRef&&(this.$refs.eleRef.style.width=0)},onBeforeEnter(){this.$refs.eleRef.style.width="".concat(this.width,"px")}},mounted(){var e=this.$refs.eleRef,t=e.parentElement;if(""===t.style.position&&(!0===this.parentPosition?t.style.position=r:this.parentPosition&&(t.style.position=this.parentPosition)),!this.fixed){var n=e.getBoundingClientRect().top;e.style.height="calc(100vh - ".concat(n,"px)")}e.style.width=this.open?"".concat(this.width,"px"):"0px",this.maskHeight=e.clientHeight}},a=(0,n(551900).Z)(i,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"eleRef",staticClass:"drawer-wrapper",class:{fixed:e.fixed}},[n("transition",{attrs:{name:"move-right"},on:{"after-leave":e.onAfterLeave,"before-enter":e.onBeforeEnter}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.open,expression:"open"}],staticClass:"drawer-content",style:{width:e.width+"px"}},[e._t("default")],2)]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.button||e.closeButton&&e.open,expression:"button || (closeButton && open)"}],staticClass:"handle-btn",class:{open:e.open},style:{right:e.open?e.width-1+"px":""},on:{click:e.toggleDrawer}},[n("Icon",{attrs:{type:"ios-arrow-forward"}}),e._v(" "),e.open?e._e():n("span",{staticClass:"text"},[e._v(e._s(e.$t("knowledgeGraph.attributes")))])],1),e._v(" "),e.isShowMask?n("div",{staticClass:"mask",style:{height:e.maskHeight+"px"},on:{click:e.closeDrawer}}):e._e()],1)}),[],!1,null,"e52c956e",null).exports},718630:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var o={},r=(0,n(551900).Z)(o,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"knowledge-header"},[n("div",{staticClass:"name"},[e._t("default")],2),e._v(" "),n("div",{staticClass:"center"},[e._t("center")],2),e._v(" "),n("div",{staticClass:"group"},[e._t("btn-group")],2)])}),[],!1,null,"68a08ee1",null).exports},427372:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var o=n(676736),r=n.n(o),i={props:{imgStyle:{type:Object,default:()=>{}}},data:()=>({svg:r()})},a=(0,n(551900).Z)(i,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"nothing"},[n("img",{style:e.imgStyle,attrs:{src:e.svg,alt:""}}),e._v(" "),n("div",{staticClass:"desc"},[e._t("default")],2)])}),[],!1,null,"e3af625e",null).exports},804992:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var o=n(925706),r=n(117403),i=n(89413),a=(n(714743),n(312980),(0,o.aZ)({components:{Echarts:i.Z},props:{data:{type:Array,required:!0},colors:{type:Array},left:{type:Number,default:70}},setup:function(e){return{options:(0,o.Fl)((function(){var t={legend:{show:!0,orient:"vertical",left:"".concat(Number(e.left)+75,"px"),top:"middle",icon:"circle",itemHeight:12,formatter:function(t){var n=e.data.find((function(e){return e.name===t}));return n?"".concat(t,": ").concat(r.default.t("knowledgeGraph.statistics.people",[n.value])):t}},series:[{type:"pie",radius:["45%","75%"],avoidLabelOverlap:!1,hoverOffset:5,itemStyle:{borderColor:"#fff",borderWidth:2},label:{show:!1},labelLine:{show:!1},center:["".concat(e.left),"50%"],data:e.data}]};return e.colors&&(t.color=e.colors),e.data.every((function(e){return 0===e.value}))&&(t.legend.selectedMode=!1,t.color=["#f0f1f3"],t.series[0].silent=!0,t.series[0].itemStyle.borderWidth=0),t}))}}})),s=(0,n(551900).Z)(a,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"statistics-card"},[n("div",{staticClass:"title"},[e._t("default")],2),e._v(" "),n("Echarts",{staticClass:"chart",attrs:{options:e.options,autoresize:""}})],1)}),[],!1,null,"b5c3aaa6",null).exports},864251:function(e,t,n){"use strict";n.d(t,{Z:function(){return p}});n(682772),n(140561);var o=n(925706),r=n(462149),i=n(117403),a=n(496486),s=(0,o.aZ)({props:{value:{type:Object,required:!0}},setup:function(e,t){var n=t.emit,r=(0,o.iH)(null),s=(0,o.qj)({content:e.value.data.content}),l={content:[{required:!0,trigger:"blur",message:i.default.t("fieldRequired"),pattern:/\S+/}]},c=(0,o.Fl)((function(){return e.value})),u=(0,o.iH)(0),d="",p=function(e,t,n){return(0,a.tap)((0,a.cloneDeep)(e),(function(e){return(0,a.set)(e,t,n)}))},f=function(e,t){n("input",p(c.value,e,t))};(0,o.YP)((function(){return s.content}),(function(){f("data.content",s.content)}));var v=function(){n("delete",e.value)};return(0,o.bv)((function(){u.value=e.value.data.referCount})),{confirmForm:function(){r.value.validate((function(e){var t;e&&(t=p(c.value,"isEditing",!1),(t=p(t,"data.content",s.content)).confirmed=!0,n("input",t))}))},local:c,update:f,deleteItem:v,cancel:function(){s.content=d,f("isEditing",!1),c.value.confirmed||(0,o.Y3)((function(){v()}))},formState:s,ruleValidate:l,formRef:r,referCount:u,onChange:function(e){e?u.value+=1:u.value-=1},edit:function(){d=c.value.data.content,f("isEditing",!0)},originalContent:d}}}),l=n(551900),c=(0,l.Z)(s,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"item"},[n("Checkbox",{staticClass:"checkbox",attrs:{value:e.local.selected},on:{input:function(t){return e.update("selected",t)},"on-change":e.onChange}},[n("span")]),e._v(" "),n("div",{staticClass:"content"},[e.local.isEditing?n("div",{staticClass:"w-full"},[n("Form",{ref:"formRef",attrs:{model:e.formState,rules:e.ruleValidate}},[n("FormItem",{attrs:{prop:"content"}},[n("Input",{staticClass:"w-full",attrs:{maxlength:"200","show-word-limit":"",type:"textarea",placeholder:e.$t("knowledgeGraph.inputTeachingObjective")},model:{value:e.formState.content,callback:function(t){e.$set(e.formState,"content",t)},expression:"formState.content"}})],1)],1),e._v(" "),n("div",{staticClass:"item-footer"},[n("div"),e._v(" "),n("div",[n("span",{staticClass:"confirm",on:{click:e.confirmForm}},[e._v(e._s(e.$t("ok")))]),e._v(" "),n("span",{on:{click:e.cancel}},[e._v(e._s(e.$t("cancel")))])])])],1):n("div",{staticClass:"w-full"},[n("div",{staticClass:"text"},[e._v("\n        "+e._s(e.local.data.content)+"\n      ")]),e._v(" "),n("div",{staticClass:"item-footer"},[n("span",{staticClass:"info"},[e._v(e._s(e.$t("knowledgeGraph.relatedNode"))+": "+e._s(e.referCount))]),e._v(" "),n("div",{staticClass:"right"},[n("span",{staticClass:"edit",on:{click:e.edit}},[e._v(e._s(e.$t("edit")))]),e._v(" "),n("span",{staticClass:"delete",on:{click:e.deleteItem}},[e._v(e._s(e.$t("delete")))])])])])])],1)}),[],!1,null,"7548236c",null).exports,u=n(427372),d=(0,o.aZ)({components:{EditItem:c,NoData:u.Z},props:{value:{type:Array,required:!0}},setup:function(e){var t=(0,o.Fl)((function(){return e.value})),n=(0,o.Fl)((function(){return t.value.find((function(e){return e.isEditing}))}));return{localItems:t,add:function(){var e=new r.PP(new r.Ju);e.isEditing=!0,e.selected=!0,e.confirmed=!1,e.data.referCount=1,t.value.unshift(e)},onDelete:function(e){var n=t.value.indexOf(e);t.value.splice(n,1)},editingItem:n}}}),p=(0,l.Z)(d,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.localItems.length>0?n("div",{staticClass:"teaching-objective-select"},[n("Button",{attrs:{type:"primary",disabled:!!e.editingItem},on:{click:e.add}},[n("i",{staticClass:"font font-add-new-elem"}),e._v("\n    "+e._s(e.$t("new"))+"\n  ")]),e._v(" "),n("div",{staticClass:"w-full item-list"},e._l(e.localItems,(function(t,o){return n("EditItem",{key:t.data.id,staticClass:"item",on:{delete:e.onDelete},model:{value:e.localItems[o],callback:function(t){e.$set(e.localItems,o,t)},expression:"localItems[index]"}})})),1)],1):n("div",{staticClass:"teaching-objective-select no-data-container"},[n("NoData",{staticClass:"no-data"},[e._v(e._s(e.$t("knowledgeGraph.noTeachingObjective")))]),e._v(" "),n("Button",{staticClass:"add",attrs:{type:"primary"},on:{click:e.add}},[n("i",{staticClass:"font font-add-new-elem"}),e._v("\n    "+e._s(e.$t("new"))+"\n  ")])],1)}),[],!1,null,"411273ed",null).exports},553319:function(e,t,n){"use strict";n.d(t,{Z:function(){return Te}});var o=n(925706),r=n(154803),i=(n(141817),n(66992),n(747042),n(788674),n(324603),n(339714),n(132023),n(573210),n(454747),n(333948),n(866473)),a=n(117403),s=n(938823),l=n(48496),c=n(146176),u=n(662061),d=n(462149),p=n(486992),f=n(82720),v=(0,o.aZ)({props:{node:{type:Object,required:!0}},setup:function(e){var t=(0,o.Fl)((function(){return{prev:e.node.data.prevRelation.map((function(e){return e.name})).join(" \\ "),post:e.node.data.postRelation.map((function(e){return e.name})).join(" \\ "),undirected:e.node.data.undirectedRelation.map((function(e){return e.name})).join(" \\ ")}})),n=(0,o.Fl)((function(){return f.W3.filter((function(e){return t.value[e.key].length}))})),r=(0,o.iH)(!1);return{showingRelationTypes:n,relations:t,expanded:r,toggleExpand:function(e,t){t>0||(r.value=!r.value)}}}}),h=n(551900),m=(0,h.Z)(v,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"relation-node-wrapper"},[e._l(e.showingRelationTypes,(function(t,o){return[n("transition",{key:t.key,attrs:{name:"move-up"}},[0===o||e.expanded?n("div",{staticClass:"item",class:{expanded:e.expanded,"ml-18":o>0},on:{click:function(t){return e.toggleExpand(t,o)}}},[0===o&&e.showingRelationTypes.length>1?n("Icon",{staticClass:"icon",attrs:{type:"ios-arrow-down"}}):e._e(),e._v(" "),n("Tooltip",{directives:[{name:"ellipsis",rawName:"v-ellipsis"}],attrs:{content:e.relations[t.key],placement:"top",transfer:""}},[n("span",[e._v("\n            "+e._s(t.name)+":\n            "+e._s(e.relations[t.key])+"\n          ")])])],1):e._e()])]}))],2)}),[],!1,null,"05c814c7",null).exports,g=n(959769),y=(n(491038),n(185827),n(140561),n(470189),function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))}),w=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},b=function(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))},_=function(e,t){var n=t||(0,o.f3)("course",{id:0});n.id||console.error("course id is invalid");var r=function(t){return y(void 0,void 0,void 0,(function(){var n,o,r;return w(this,(function(i){return n=e.value.findAll((function(e){return t.includes(e.id)})),o=n.reduce((function(e,t){return b(b(b(b([],e,!0),t.data.prevRelation,!0),t.data.postRelation,!0),t.data.undirectedRelation,!0)}),[]).map((function(e){return e.relationId})),o=Array.from(new Set(o)),r=function(e,t){var n=e.findIndex((function(e){return e.relationId===t}));n>-1&&e.splice(n,1)},e.value.recurseDown((function(e){o.forEach((function(t){r(e.data.postRelation,t),r(e.data.prevRelation,t),r(e.data.undirectedRelation,t)}))})),[2]}))}))};return{addNew:function(){return y(void 0,void 0,void 0,(function(){return w(this,(function(t){return e.value.append(d.DZ.create()),[2]}))}))},addSibling:function(t){var n;t.isRoot()?e.value.append(d.DZ.create()):(e.value.append(t.parent,d.DZ.create()),null===(n=t.expandTop)||void 0===n||n.call(t))},addChild:function(t){var n=e.value.find((function(e){return t.id===e.id}));n&&n.length&&(t=n[0]),t.expandTop(),e.value.append(t,d.DZ.create()),t.expand()},remove:function(e){return y(void 0,void 0,void 0,(function(){return w(this,(function(t){switch(t.label){case 0:return[4,(0,u.iY)(e.id)];case 1:return t.sent(),r([e.id]),e.remove(),[2]}}))}))},batchRemove:function(){return y(void 0,void 0,void 0,(function(){var t,o;return w(this,(function(i){switch(i.label){case 0:return t=e.value.checked(),o=[],(0,p.T$)(t,(function(e){Number.isNaN(e.id)||o.push(Number(e.id))})),0===o.length?[2]:[4,(0,u.Dr)(n.id,o)];case 1:return i.sent(),r(o),t.forEach((function(e){e.remove()})),[2]}}))}))}}},C=n(64976),k=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},x=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},S=(0,o.aZ)({props:{node:{type:Object,required:!0},tree:{type:Object,required:!0}},setup:function(e,t){var n=this,i=(0,o.Vh)(e,"tree"),s=_(i),u=(0,c.X)().depth,d=(0,o.iH)(!1),p=(0,o.Fl)((function(){return!!e.node.tree.vm.draggableNode})),f=function e(t){for(var n=t.data.activityRefCount,o=t.data.resourceRefCount,r=t.data.subjectRefCount,i=t.data.captureRefCount,a=1,s=t.children||[],l=0;l<s.length;l++){var c=e(s[l]);n+=c[0],o+=c[1],r+=c[2],i+=c[3],a+=c[4]}return[n,o,r,i,a]},v=function(){return k(n,void 0,void 0,(function(){var t;return x(this,(function(n){switch(n.label){case 0:return t=f(e.node),[4,(0,g.fK)(t)];case 1:return n.sent()?[4,s.remove(e.node)]:[3,3];case 2:n.sent(),l.UniqueToast.success(a.default.t("delete_success")),n.label=3;case 3:return[2]}}))}))},h=function(e){!function(e){return e.depth+1>=u}(e)?s.addChild(e):l.UniqueToast.error(a.default.t("knowledgeGraph.maxDepthTip"))},m=(0,o.Fl)((function(){return!r.yw&&!r.Uz.value&&r.wZ}));return{handleMouseDown:function(t){t.preventDefault(),e.node.vm.handleMouseDown(t)},dragging:p,handleOption:function(n,o){switch(n.stopPropagation(),o){case"addSibling":return s.addSibling(e.node),C.Z.$emit("close-drawer");case"addChild":return h(e.node),C.Z.$emit("close-drawer");case"delete":return v();case"relation":return e.node.$emit("relation:setting",e.node);case"cognitiveDimension":return t.emit("show-edit-cognitive-dimension-popper");case"attribute":return C.Z.$emit("show-drawer");case"batchDelete":return e.node.$emit("batch-delete")}},del:v,add:function(e,t){"peer"===e&&(s.addSibling(t),C.Z.$emit("close-drawer")),"child"===e&&(h(t),C.Z.$emit("close-drawer"))},canEdit:m,depth:u,visible:d,onVisibleChange:function(e){d.value=e},editDisabled:r.nQ}}}),T=(0,h.Z)(S,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{on:{mousedown:function(e){e.stopPropagation()}}},[n("Dropdown",{attrs:{trigger:"click",placement:"bottom-start"},on:{"on-visible-change":e.onVisibleChange}},[n("Tooltip",{attrs:{transfer:"",placement:"top",disabled:e.dragging||!e.canEdit||e.visible,"transfer-class-name":"knowledge-graph-outline-tooltip"}},[n("span",{staticClass:"drag-hand",class:{fluctuation:e.canEdit,"menu-visible":e.visible&&e.canEdit},on:{mousedown:e.handleMouseDown}},[n("span",{staticClass:"circle-button",class:{green:e.visible}})]),e._v(" "),n("div",{attrs:{slot:"content"},slot:"content"},[e._v("\n        "+e._s(e.$t("knowledgeGraph.dragNodeTip"))+"\n        "),n("br"),e._v("\n        "+e._s(e.$t("knowledgeGraph.moreTip"))+"\n      ")])]),e._v(" "),e.canEdit?n("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[e.editDisabled?e._e():n("DropdownItem",{attrs:{name:"addSibling"},nativeOn:{click:function(t){return e.handleOption(t,"addSibling")}}},[n("i",{staticClass:"font font-sibling-node"}),e._v("\n        "+e._s(e.$t("knowledgeGraph.siblingNode"))+"\n      ")]),e._v(" "),e.node.depth<e.depth-1&&!e.editDisabled?n("DropdownItem",{attrs:{name:"addChild"},nativeOn:{click:function(t){return e.handleOption(t,"addChild")}}},[n("i",{staticClass:"font font-mind-child"}),e._v("\n        "+e._s(e.$t("knowledgeGraph.childNode"))+"\n      ")]):e._e(),e._v(" "),e.editDisabled?e._e():n("DropdownItem",{attrs:{name:"relation"},nativeOn:{click:function(t){return e.handleOption(t,"relation")}}},[n("i",{staticClass:"font font-relation"}),e._v("\n        "+e._s(e.$t("knowledgeGraph.relation"))+"\n      ")]),e._v(" "),n("DropdownItem",{attrs:{divided:!e.editDisabled,name:"cognitiveDimension"},nativeOn:{click:function(t){return e.handleOption(t,"cognitiveDimension")}}},[n("i",{staticClass:"font font-cognitive-dimension"}),e._v("\n        "+e._s(e.$t("knowledgeGraph.cognitiveDimension.name"))+"\n      ")]),e._v(" "),n("DropdownItem",{attrs:{name:"attribute"},nativeOn:{click:function(t){return e.handleOption(t,"attribute")}}},[n("i",{staticClass:"font font-attribute"}),e._v("\n        "+e._s(e.$t("knowledgeGraph.attributes"))+"\n      ")]),e._v(" "),e.editDisabled?e._e():n("DropdownItem",{attrs:{divided:"",name:"delete"},nativeOn:{click:function(t){return e.handleOption(t,"batchDelete")}}},[n("SvgIcon",{staticClass:"batch-delete-icon",attrs:{name:"batch-delete"}}),e._v("\n        "+e._s(e.$t("batch_delete"))+"\n      ")],1),e._v(" "),e.editDisabled?e._e():n("DropdownItem",{attrs:{name:"delete"},nativeOn:{click:function(t){return e.handleOption(t,"delete")}}},[n("i",{staticClass:"font font-batch-operation-delete"}),e._v("\n        "+e._s(e.$t("knowledgeGraph.delete"))+"\n      ")])],1):e._e()],1)],1)}),[],!1,null,"7db6fcd3",null).exports,D=n(225873),I=n(998009),E=n(558794),N=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},$=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},R=(0,o.aZ)({name:"NodeContent",props:["node"],components:{TooltipExt:E.Z},setup:function(e){var t=this,n=(0,o.iH)(),i=(0,o.iH)(e.node.text),a=(0,o.iH)(!1),s=function(o,r){return N(t,void 0,void 0,(function(){var t,a,s,l,c,u;return $(this,(function(d){switch(d.label){case 0:return t=o.tree.options.validate||function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return!0},a=o.tree.options.save||function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Promise.resolve(!0)},t(o,r)?[4,a(o,r,o.text)]:[3,2];case 1:return d.sent(),o.data.text=r,o.tree.vm.$emit("node:saved",o),o.stopEditing(r),null===(c=n.value)||void 0===c||c.blur(),e.node.vm.setFocus(),[3,3];case 2:"string"==typeof e.node.id?(s=e.node.parent,o.remove(),null==(l=null===(u=null==s?void 0:s.children)||void 0===u?void 0:u[s.children.length-1])||l.vm.setFocus()):(i.value=e.node.text,e.node.vm.setFocus()),d.label=3;case 3:return[2]}}))}))},l=(0,o.Fl)((function(){return!r.yw&&!r.Uz.value&&(r.wZ&&!r.nQ.value)}));return(0,o.YP)((function(){return e.node.isEditing}),(function(){e.node.isEditing&&"string"==typeof e.node.id&&(0,o.Y3)((function(){var t;null===(t=n.value)||void 0===t||t.focus(),e.node.vm.select()}))}),{immediate:!0}),(0,o.YP)((function(){return e.node.text}),(function(){i.value=e.node.text})),{nodeText:i,stopEditing:s,handleBlur:function(){s(e.node,i.value),a.value=!1},editCtrl:n,startEditing:function(){e.node.startEditing()},onKeyDown:function(e){e.stopPropagation(),9!==e.keyCode&&13!==e.keyCode||e.preventDefault()},setBlur:function(){var e;null===(e=n.value)||void 0===e||e.blur()},canEdit:l,editName:function(){l.value&&(a.value=!0,(0,o.Y3)((function(){var e;null===(e=n.value)||void 0===e||e.focus()})))},editMode:a}}}),j=(0,h.Z)(R,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"content-area"},[e.editMode||e.node.isEditing?n("div",{staticClass:"tree-content"},[n("span",{staticClass:"content"},[e._v(e._s(e.nodeText))]),e._v(" "),n("input",{ref:"editCtrl",staticClass:"tree-textarea",attrs:{type:"text",readonly:!e.canEdit},domProps:{value:e.nodeText},on:{blur:e.handleBlur,keydown:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.setBlur(t)},e.onKeyDown],input:function(t){e.nodeText=t.target.value},mousedown:function(t){return t.stopPropagation(),e.startEditing(t)}}})]):n("div",{staticClass:"tree-content-with-tooltip",on:{click:e.editName,mousedown:function(e){e.stopPropagation()}}},[n("TooltipExt",{attrs:{text:e.nodeText,"transfer-class-name":"knowledge-graph-outline-tooltip"}})],1)])}),[],!1,null,"46c5beb1",null).exports,P=n(36568),M=n.n(P),O={props:["node","visibleChildren","options","allowFacetsAndFragments"],render(e){var t=this.node.tree.vm;return t.$scopedSlots.expand?t.$scopedSlots.expand({node:this.node}):this.visibleChildren.length>0?e("span",M()([{class:["triangle",{expanded:this.node.states.expanded,"has-child":this.node.children.length&&this.visibleChildren.length>0},this.options.direction],style:{visibility:this.allowFacetsAndFragments?"hidden":"visible"}},{on:{mousedown:e=>e.stopPropagation()}}])):e("span",M()([{class:"triangle"},{on:{mousedown:e=>e.stopPropagation()}}]))}},G=(0,h.Z)(O,undefined,undefined,!1,null,null,null).exports,A=(n(319601),n(494101)),Z=function(){return(Z=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},H=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},F=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},B=function(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))},z=(0,o.aZ)({name:"NodeAttribute",props:["node"],components:{TooltipExt:E.Z,RelationItem:A.Z},setup:function(e){var t,n=this,i=(null===(t=window.featureToggles)||void 0===t?void 0:t.isCognitiveDimensionOpen)||!1,s=(0,o.iH)(!1),c=(0,o.iH)(""),d=(0,o.Fl)((function(){return B(B(B([],(e.node.data.prevRelation||[]).map((function(e){return Z(Z({},e),{relationType:"prev"})})),!0),(e.node.data.postRelation||[]).map((function(e){return Z(Z({},e),{relationType:"post"})})),!0),(e.node.data.undirectedRelation||[]).map((function(e){return Z(Z({},e),{relationType:"undirected"})})),!0)})),p=(0,o.Fl)((function(){return!r.yw&&!r.Uz.value&&r.wZ})),v=function(){return H(n,void 0,void 0,(function(){return F(this,(function(t){switch(t.label){case 0:return[4,(0,u.r8)(e.node.id,{cognitiveDimension:c.value})];case 1:return t.sent(),e.node.data.cognitiveDimension=c.value,s.value=!1,l.Toast.success(a.default.t("air.updateSuccess")),[2]}}))}))};return{isCognitiveDimensionOpen:i,relationList:d,showEditCognitiveDimensionPopper:s,cognitiveDimension:c,cognitiveDimensions:f.Nb,canEdit:p,onPopperShow:function(){c.value=e.node.data.cognitiveDimension},updateCognitiveDimension:v,closePoptip:function(t){e.node.data.cognitiveDimension===t&&(s.value=!1)},openPopper:function(){s.value=!0},remove:function(){c.value="none",v()},editDisabled:r.nQ}}}),L={name:"TreeNode",inject:["tree","allowFacetsAndFragments"],props:["node","options"],components:{NodeContent:j,ExpandNode:G,NodeAttribute:(0,h.Z)(z,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"attribute-area",class:{"hide-attribute":0===e.relationList.length&&e.node.data.cognitiveDimension&&"none"===e.node.data.cognitiveDimension}},[n("Poptip",{attrs:{placement:"bottom",padding:"16px",width:"310",transfer:"","transfer-class-name":"edit-cognitive-dimension-poptip",disabled:!e.canEdit},on:{"on-popper-show":e.onPopperShow},model:{value:e.showEditCognitiveDimensionPopper,callback:function(t){e.showEditCognitiveDimensionPopper=t},expression:"showEditCognitiveDimensionPopper"}},[e.isCognitiveDimensionOpen&&e.node.data.cognitiveDimension&&"none"!==e.node.data.cognitiveDimension?n("div",{staticClass:"cognitive-dimension",class:e.node.data.cognitiveDimension,on:{mousedown:function(e){e.stopPropagation()}}},[e._v("\n      "+e._s(e.$t("knowledgeGraph.cognitiveDimension."+e.node.data.cognitiveDimension))+"\n    ")]):e._e(),e._v(" "),n("div",{staticClass:"poptip-content",attrs:{slot:"content"},slot:"content"},[n("div",{staticClass:"poptip-header"},[n("span",{staticClass:"title"},[e._v(e._s(e.$t("knowledgeGraph.cognitiveDimension.setUp")))]),e._v(" "),n("span",{staticClass:"remove",on:{click:e.remove}},[e._v(e._s(e.$t("remove")))])]),e._v(" "),n("RadioGroup",{staticClass:"cognitive-imension-radio-group",attrs:{type:"button"},on:{"on-change":e.updateCognitiveDimension},model:{value:e.cognitiveDimension,callback:function(t){e.cognitiveDimension=t},expression:"cognitiveDimension"}},e._l(e.cognitiveDimensions,(function(t){return n("Radio",{key:t.key,class:t.key,attrs:{value:t.key,label:t.key},nativeOn:{click:function(n){return e.closePoptip(t.key)}}},[n("span",[e._v(e._s(t.value))])])})),1)],1)]),e._v(" "),e._l(e.relationList.slice(0,3),(function(t){return n("div",{key:t.id},[n("RelationItem",{attrs:{node:e.node,relation:t,"can-edit-relation":e.canEdit&&!e.editDisabled,"can-delete":e.canEdit&&!e.editDisabled}})],1)})),e._v(" "),n("Poptip",{attrs:{placement:"bottom",padding:"0"}},[e.relationList.length>3?n("div",{staticClass:"all-relation",on:{mousedown:function(e){e.stopPropagation()}}},[e._v("\n      "+e._s(e.$t("exam.scoreSetting.total"))+" "+e._s(e.relationList.length)+" "+e._s(e.$t("item"))+"\n    ")]):e._e(),e._v(" "),n("div",{staticClass:"poptip-content",attrs:{slot:"content"},on:{mousedown:function(e){e.stopPropagation()}},slot:"content"},e._l(e.relationList,(function(t){return n("div",{key:t.id},[n("RelationItem",{attrs:{node:e.node,relation:t,"can-edit-relation":!1,"can-delete":e.canEdit&&!e.editDisabled}})],1)})),0)])],2)}),[],!1,null,"66e56700",null).exports,Point:T},watch:{node(){this.node.vm=this}},data(){return this.node.vm=this,{loading:!1}},computed:{padding(){return"".concat(this.node.depth*(this.options.paddingLeft?this.options.paddingLeft:this.options.nodeIndent),"px")},nodeClass(){var e=this.node.states,t=this.hasChildren();return{"has-child":t,expanded:t&&e.expanded,selected:e.selected&&this.options.selectable,disabled:e.disabled,matched:e.matched,dragging:e.dragging,loading:this.loading,draggable:e.draggable,immutable:e.immutable}},visibleChildren(){return this.node.children.filter((e=>e&&e.visible()))},currentNode(){var e;return null===(e=this.tree.selectedNodes)||void 0===e?void 0:e[0]}},methods:{onNodeFocus(){this.tree.activeElement=this.node},select(){this.node.select()},toggleExpand(){this.hasChildren()&&this.node.toggleExpand()},hasChildren(){return this.node.hasChildren()},startEditing(){this.tree._editingNode&&this.tree._editingNode.stopEditing(),this.node.startEditing()},stopEditing(){this.node.stopEditing()},handleMouseDown(e){this.options.dnd&&this.tree.vm.startDragging(this.node,e)},handleMouseover(e){this.tree.vm.draggableNode?e.currentTarget.classList.add("dragging"):e.currentTarget.classList.add("is-hover")},handleMouseout(e){e.currentTarget.classList.remove("dragging"),e.currentTarget.classList.remove("is-hover")},handleKeyDown(e){9!==e.keyCode||this.node.isEditing||(e.preventDefault(),e.stopPropagation(),this.$refs.pointRef.add("child",this.currentNode)),13!==e.keyCode||this.node.isEditing||(e.preventDefault(),e.stopPropagation(),this.$refs.pointRef.add("peer",this.currentNode))},setFocus(){this.$nextTick((()=>{this.$refs.treeNodeRef.focus(),this.node.select()}))},showCognitiveDimensionPopper(){this.$refs.nodeAttributeRef.openPopper()},showDrawer(){this.node.isEditing||C.Z.$emit("show-drawer")}},mounted(){"number"==typeof this.node.id&&C.Z.$on("click-outside",(e=>{this.$refs.treeNodeRef&&!this.$refs.treeNodeRef.contains(e.target)&&this.node.unselect()}))}},U=(0,h.Z)(L,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("li",{staticClass:"tree-node",class:e.nodeClass,attrs:{role:"treeitem","data-id":e.node.id},on:{mouseover:function(t){return t.stopPropagation(),e.handleMouseover(t)},mouseout:function(t){return t.stopPropagation(),e.handleMouseout(t)}}},[n("div",{ref:"treeNodeRef",staticClass:"tree-content-wrapper",style:["ltr"==e.options.direction?{"padding-left":e.padding}:{"padding-right":e.padding}],attrs:{tabindex:"-1"},on:{click:e.select,mousedown:function(t){return t.stopPropagation(),e.showDrawer(t)},keydown:e.handleKeyDown,focus:e.onNodeFocus}},[n("div",{staticClass:"tree-content"},[n("ExpandNode",{attrs:{options:e.options,node:e.node,"visible-children":e.visibleChildren,"allow-facets-and-fragments":e.allowFacetsAndFragments},nativeOn:{click:function(t){return e.toggleExpand(t)}}}),e._v(" "),n("Point",{key:e.node.id,ref:"pointRef",attrs:{tree:e.node.tree.vm,node:e.node},on:{"show-edit-cognitive-dimension-popper":e.showCognitiveDimensionPopper}}),e._v(" "),n("span",{staticClass:"tree-anchor"},[n("NodeContent",{attrs:{node:e.node}}),e._v(" "),!e.allowFacetsAndFragments&&!e.node.states.expanded&&e.node.children.length>0?n("span",{staticClass:"number"},[e._v("\n          "+e._s(e.node.children.length)+"\n        ")]):e._e()],1)],1),e._v(" "),n("NodeAttribute",{ref:"nodeAttributeRef",attrs:{node:e.node}})],1),e._v(" "),n("transition",{attrs:{name:"l-fade"}},[e.hasChildren()&&e.node.states.expanded?n("ul",{staticClass:"tree-children",style:{"--padding-left":e.padding}},e._l(e.visibleChildren,(function(t){return n("TreeNode",{key:t.id,attrs:{node:t,options:e.options}})})),1):e._e()])],1)}),[],!1,null,"c153c96c",null).exports,V={name:"DragNode",props:["target"],computed:{style(){if(void 0===this.target.top)return"display: none";var e=this.target.ele.querySelector(".tree-content-wrapper").clientHeight;return{top:"".concat(this.target.top-e/2,"px"),left:"".concat(this.target.left+10,"px"),height:"48px",background:"#eee",opacity:"0.8"}}}},q=(0,h.Z)(V,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tree-dragnode",style:e.style},[n("span",{staticClass:"text"},[e._v(e._s(e.target.node.text))]),e._v(" "),e.target.node.children.length>0?n("span",{staticClass:"number"},[e._v("\n    "+e._s(e.target.node.children.length)+"\n  ")]):e._e()])}),[],!1,null,null,null).exports;function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function K(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){W(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function W(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var J={direction:"ltr",multiple:!0,checkOnSelect:!1,autoCheckChildren:!0,autoDisableChildren:!0,checkDisabledChildren:!0,parentSelect:!1,keyboardNavigation:!0,nodeIndent:28,minFetchDelay:0,fetchData:null,propertyNames:null,deletion:!1,dnd:!1,editing:!1,selectable:!0,onFetchError(e){throw e}},X={emptyText:"Nothing found!",textMatcher(e,t){var n=new RegExp(e,"i").test(t.text);return!(n&&t.parent&&new RegExp(e,"i").test(t.parent.text))&&n},plainList:!1,showChildren:!0},Q={name:"TreeRoot",components:{TreeNode:U,DraggableNode:q},mixins:[D.Z,I.Z],provide:e=>({tree:null}),props:{data:{},options:{type:Object,default:()=>({})},treeLoading:{type:Boolean,required:!0},canAddNewNode:{type:Boolean,required:!0}},data(){var e=K(K({},J),this.options);return e.filter=K(K({},X),e.filter),{model:[],tree:null,loading:!1,opts:e,matches:[],draggableNode:null,draggableEle:null}},methods:{addNew(){this.tree.vm.$emit("add-new-node")}},computed:{visibleModel(){return this.model.filter((e=>e&&e.visible()))}}},ee=(0,h.Z)(Q,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:{"tree-loading":this.loading,"tree--draggable":!!this.draggableNode},attrs:{role:"tree"}},[n("ul",{staticClass:"tree-root",on:{dragstart:e.onDragStart}},[e._l(e.visibleModel,(function(t){return n("TreeNode",{key:t.id,attrs:{node:t,options:e.opts}})})),e._v(" "),e.canAddNewNode&&0===e.visibleModel.length&&!e.treeLoading?n("div",{staticClass:"add-area"},[n("span",{staticClass:"circle-button"}),e._v(" "),n("span",{on:{click:e.addNew}},[e._v(e._s(e.$t("knowledgeGraph.addFirstNodeTip")))])]):e._e()],2),e._v(" "),e.draggableNode?n("DraggableNode",{attrs:{target:e.draggableNode}}):e._e()],1)}),[],!1,null,null,null).exports,te=n(243407),ne=(n(384944),n(133792),n(311610)),oe=n(948150),re=n(427372),ie=n(156209),ae=function(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))},se=(0,o.aZ)({props:{node:{type:Object,required:!0}},setup:function(e,t){var n,r=(0,o.Fl)((function(){var t=[];return e.node.tree.model.forEach((function e(n){t.push({id:n.id,name:n.text,level:n.depth,r:16}),n.children&&n.children.forEach(e)})),t})),i=(0,o.Fl)((function(){var t=[];return e.node.data.prevRelation.forEach((function(n){t.push({id:n.relationId,source:n.id,target:e.node.id,isDirected:!0})})),e.node.data.postRelation.forEach((function(n){t.push({id:n.relationId,source:e.node.id,target:n.id,isDirected:!0})})),e.node.data.undirectedRelation.forEach((function(n){t.push({id:n.relationId,source:e.node.id,target:n.id,isDirected:!1})})),t})),s=(0,o.Fl)((function(){var t=i.value.reduce((function(e,t){return ae(ae([],e,!0),[t.source,t.target],!1)}),[e.node.id]),n=r.value.filter((function(e){return t.includes(e.id)})),o=n.findIndex((function(t){return t.id===e.node.id}));if(o>-1){var a=n.splice(o,1)[0];a.current=!0,a.r=24,n.unshift(a)}return n})),l=(0,o.iH)(),c=(0,o.Fl)((function(){return!!t.slots.default}));return(0,o.bv)((function(){(n=new ie.LL(l.value,{remove:{fn:function(n){var o=e.node.data.prevRelation.find((function(e){return e.id===n.id})),r="prev";o||(o=e.node.data.postRelation.find((function(e){return e.id===n.id})),r="post"),o||(o=e.node.data.undirectedRelation.find((function(e){return e.id===n.id})),r="undirected"),o&&t.emit("delete-relation",o,r)},text:a.default.t("knowledgeGraph.delRelation")}})).update(s.value,i.value)})),(0,o.YP)(i,(function(){n.update(s.value,i.value)})),{graphRef:l,show:c}}}),le=(0,h.Z)(se,(function(){var e=this.$createElement;return(this._self._c||e)("div",{ref:"graphRef",staticClass:"graph-wrapper"})}),[],!1,null,"056a12d0",null).exports,ce=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},ue=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},de=(0,o.aZ)({components:{ToolbarWrapper:oe.Z,SvgIcon:ne.Z,Tree:s.ZP,NoData:re.Z,NodeRelationGraph:le},props:{value:{type:Boolean,default:!1},node:{type:Object,default:function(){return{}}}},setup:function(e,t){var n=this,r=(0,o.iH)("list"),a=(0,o.iH)(),s=(0,o.f3)("course",{id:0}),l=(0,o.f3)("allowedRelationTypes",{prev:!0,post:!0,undirected:!0}),c=(0,o.iH)(0),p=(0,o.iH)(""),v=(0,o.iH)(""),h=(0,o.iH)(!1),m=(0,o.qj)({prev:[],post:[],undirected:[]}),g=(0,o.Fl)((function(){return[m.prev,m.post,m.undirected].flat().length})),y=(0,o.iH)({checkbox:!0,autoCheckChildren:!1,nodeIndent:30,filter:{emptyText:"",showChildren:!1,textMatcher:function(e,t){return new RegExp(e,"i").test(t.text)}}}),w=(0,o.iH)(!0),b=function(){var e=a.value.checked(),t=[m.prev,m.post,m.undirected].flat().map((function(e){return e.id})),n=e.filter((function(e){return!t.includes(e.id)}));w.value=0===n.length},_=function(e){return a.value.find((function(t){return t.id===e}))[0]};return{tab:r,treeOptions:y,treeRef:a,relationCount:c,relations:m,relationTypes:f.W3,keyword:p,filter:v,allowedRelationTypes:l,hasRelation:g,noData:h,disabled:w,treeFilterHandle:function(e,t){h.value=0===e.length&&!!t,t||a.value.collapseAll();var n=[];e.forEach((function(e){e.hasChildren()&&e.recurseDown((function(e){new RegExp(t,"i").test(e.text)&&n.push(e)}),!0)})),n.forEach((function(e){e.state("visible",!0),e.recurseUp((function(e){e.expand(),e.state("visible",!0)}))}))},search:function(){v.value=p.value},modalVisibleChange:function(n){if(t.emit("input",n),n){a.value.setModel(e.node.tree.model),a.value.find((function(t){return t.id===e.node.id})).forEach((function(e){e.state("disabled",!0),e.parent&&e.parent.state("disabled",!0),e.children.forEach((function(e){e.state("disabled",!0)}))}));var o=e.node.data,r=o.prevRelation,i=o.postRelation,s=o.undirectedRelation,l=[r,i,s].flat().map((function(e){return e.id}));if(c.value=l.length,m.prev=r,m.post=i,m.undirected=s,l.length>0)a.value.findAll((function(e){return l.includes(e.id)})).forEach((function(e){e.check(),e.state("disabled",!0)}))}},nodeCheckedHandle:function(){return b()},add:function(t){return ce(n,void 0,void 0,(function(){var n,o,r,l,p,f,v,h;return ue(this,(function(m){switch(m.label){case 0:n=Array.from(a.value.checked().filter((function(e){return!e.disabled()}))),o="post"===t?n.map((function(t){return{source:e.node.id,target:t.id,isDirected:!0,nodeName:t.text}})):"prev"===t?n.map((function(t){return{target:e.node.id,source:t.id,isDirected:!0,nodeName:t.text}})):n.map((function(t){return{target:e.node.id,source:t.id,isDirected:!1,nodeName:t.text}})),m.label=1;case 1:return m.trys.push([1,3,,4]),[4,(0,u.Hi)(s.id,{relations:o})];case 2:return m.sent().forEach((function(n){var o=n.source===e.node.id?n.target:n.source,r=_(o),i=e.node,a=d.A5.create(o,r.text,n.id),s=d.A5.create(e.node.id,i.text,n.id);n.isDirected?"prev"===t?(i.data.prevRelation.push(a),r.data.postRelation.push(s)):(i.data.postRelation.push(a),r.data.prevRelation.push(s)):(i.data.undirectedRelation.push(a),r.data.undirectedRelation.push(s)),c.value++})),n.forEach((function(e){e.state("disabled",!0)})),[3,4];case 3:return r=m.sent(),(l=null===(h=null===(v=null===(f=null===(p=r.response)||void 0===p?void 0:p.data)||void 0===f?void 0:f.errors)||void 0===v?void 0:v.relations)||void 0===h?void 0:h.filter((function(e){return e.is_directed}))[0].is_directed[0])&&i.Message.error(l),[3,4];case 4:return b(),[2]}}))}))},del:function(e,t){return ce(n,void 0,void 0,(function(){var n,o,r,i,l,d;return ue(this,(function(p){switch(p.label){case 0:return[4,(0,u.LM)(s.id,[e.relationId])];case 1:return p.sent(),n=m[t].findIndex((function(t){return t.relationId===e.relationId})),(o=m[t].splice(n,1)[0])&&(r=_(o.id),"undirected"===t?(i=r.data.undirectedRelation.findIndex((function(t){return t.relationId===e.id})),r.data.undirectedRelation.splice(i,1)):"prev"===t?(l=r.data.postRelation.findIndex((function(t){return t.relationId===e.id})),r.data.postRelation.splice(l,1)):(d=r.data.prevRelation.findIndex((function(t){return t.relationId===e.id})),r.data.prevRelation.splice(d,1))),a.value.find((function(t){return t.id===e.id})).forEach((function(e){e.state("disabled",!1),e.uncheck()})),c.value--,[2]}}))}))}}}}),pe=(0,h.Z)(de,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Modal",{attrs:{value:e.value,transfer:"",width:1e3,"class-name":"relation-setting-modal","footer-hide":""},on:{"on-visible-change":e.modalVisibleChange},scopedSlots:e._u([{key:"header",fn:function(){return[e._v(e._s(e.$t("knowledgeGraph.relationshipSettingWithName",[e.node.text])))]},proxy:!0}])},[e._v(" "),n("div",{staticClass:"relation-setting-content"},[n("div",{staticClass:"tree-wrapper"},[n("ToolbarWrapper",{attrs:{divider:""}},[n("div",[e.allowedRelationTypes.undirected?n("Button",{attrs:{disabled:e.disabled},on:{click:function(t){return e.add()}}},[n("Icon",{attrs:{type:"md-add"}}),e._v("\n            "+e._s(e.$t("knowledgeGraph.addRelation"))+"\n          ")],1):e._e(),e._v(" "),e.allowedRelationTypes.prev?n("Button",{attrs:{disabled:e.disabled},on:{click:function(t){return e.add("prev")}}},[n("Icon",{attrs:{type:"md-add"}}),e._v("\n            "+e._s(e.$t("knowledgeGraph.addPrev"))+"\n          ")],1):e._e(),e._v(" "),e.allowedRelationTypes.post?n("Button",{attrs:{disabled:e.disabled},on:{click:function(t){return e.add("post")}}},[n("Icon",{attrs:{type:"md-add"}}),e._v("\n            "+e._s(e.$t("knowledgeGraph.addPost"))+"\n          ")],1):e._e(),e._v(" "),n("Input",{attrs:{search:"",placeholder:e.$t("knowledgeGraph.nodeName")},on:{"on-search":e.search},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}})],1)]),e._v(" "),n("div",{staticClass:"tree-container",style:{padding:e.noData?"24px":null,"padding-top":e.noData?"8px":null}},[n("Tree",{ref:"treeRef",attrs:{options:e.treeOptions,filter:e.filter},on:{"tree:filtered":e.treeFilterHandle,"node:checked":e.nodeCheckedHandle,"node:unchecked":e.nodeCheckedHandle},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.node;return[n("div",{staticClass:"tree-content-with-tooltip"},[n("Tooltip",{directives:[{name:"ellipsis",rawName:"v-ellipsis"}],attrs:{placement:"top",content:o.text,transfer:""}},[n("span",[e._v(e._s(o.text))])])],1)]}}])}),e._v(" "),e.noData?n("NoData",[e._v("\n          "+e._s(e.$t("knowledgeGraph.noContent"))+"\n        ")]):e._e()],1)],1),e._v(" "),n("div",{staticClass:"pane-wrapper",style:{background:"graph"===e.tab?"#f7f7f7":""}},[n("ToolbarWrapper",[n("div",{staticClass:"flex-between"},[n("div",[e._v(e._s(e.$t("knowledgeGraph.relationCount",[e.relationCount])))]),e._v(" "),n("div",{staticClass:"btn-group"},[n("button",{class:{active:"list"===e.tab},on:{click:function(t){e.tab="list"}}},[n("SvgIcon",{attrs:{name:"list"}}),e._v("\n              "+e._s(e.$t("knowledgeGraph.list"))+"\n            ")],1),e._v(" "),n("button",{class:{active:"graph"===e.tab},on:{click:function(t){e.tab="graph"}}},[n("SvgIcon",{attrs:{name:"tree"}}),e._v("\n              "+e._s(e.$t("knowledgeGraph.graph"))+"\n            ")],1)])])]),e._v(" "),"list"===e.tab?n("div",{staticClass:"pane-content"},[e.hasRelation?n("div",{staticClass:"relation-detail"},[e._l(e.relationTypes,(function(t){return[e.relations[t.key].length?n("div",{key:t.key,staticClass:"relation-list"},[n("div",{staticClass:"relation-type"},[e._v(e._s(t.name)+":")]),e._v(" "),n("div",{staticClass:"relation-tag"},e._l(e.relations[t.key],(function(o){return n("Tag",{key:o.id,attrs:{size:"large",closable:""},on:{"on-close":function(n){e.del(o,t.key)}}},[n("Tooltip",{directives:[{name:"ellipsis",rawName:"v-ellipsis"}],attrs:{placement:"top",content:o.name,transfer:""}},[n("span",[e._v(e._s(o.name))])])],1)})),1)]):e._e()]}))],2):n("NoData",[e._v("\n          "+e._s(e.$t("knowledgeGraph.relationTips"))+"\n        ")])],1):"graph"===e.tab?n("div",{staticClass:"pane-content"},[e.value?n("NodeRelationGraph",{attrs:{node:e.node},on:{"delete-relation":e.del}}):e._e()],1):e._e()],1)])])}),[],!1,null,"20d66e1a",null).exports,fe=n(103085),ve=n(334647),he=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},me=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},ge=function(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))},ye=(0,o.aZ)({components:{ToolbarWrapper:oe.Z,SvgIcon:ne.Z,Tree:s.ZP,NoData:re.Z},props:{value:{type:Boolean,default:!1},node:{type:Object,default:function(){return{}}}},setup:function(e,t){var n=this,r=(0,o.iH)(),i=_(r).batchRemove,s=(0,o.iH)(""),l=(0,o.iH)(""),c=(0,o.iH)(!1),u=(0,o.iH)({checkbox:!0,autoCheckChildren:!1,nodeIndent:30,filter:{emptyText:"",showChildren:!1,textMatcher:function(e,t){return new RegExp(e,"i").test(t.text)}}}),d=(0,o.iH)(!0),p=(0,o.iH)([]),f=(0,o.Fl)((function(){return p.value.length})),v=function(){var e,t;p.value=ge([],(null===(t=null===(e=r.value)||void 0===e?void 0:e.tree)||void 0===t?void 0:t.checkedNodes)||new fe.a,!0)},h=function(e){for(var t,n,o=e.parent;o&&o.checked();)o.state("checked",!1),null===(n=null===(t=r.value)||void 0===t?void 0:t.tree)||void 0===n||n.uncheck(o),o=o.parent;e.hasChildren()&&e.children.forEach((function(e){e.visible()&&e.uncheck()})),v()};return{treeOptions:u,treeRef:r,keyword:s,filter:l,noData:c,disabled:d,treeFilterHandle:function(e,t){c.value=0===e.length&&!!t,t||r.value.collapseAll();var n=[];e.forEach((function(e){e.hasChildren()&&e.recurseDown((function(e){new RegExp(t,"i").test(e.text)&&n.push(e)}),!0)})),n.forEach((function(e){e.state("visible",!0),e.recurseUp((function(e){e.expand(),e.state("visible",!0)}))}))},search:function(){l.value=s.value},modalVisibleChange:function(n){t.emit("input",n),n&&(r.value.setModel(e.node.tree.model),p.value=[])},nodeCheckedHandle:function(e){e.hasChildren()&&e.children.forEach((function(e){e.visible()&&e.check()})),v()},nodeUnCheckedHandle:h,checkedNodes:p,checkedNodesCount:f,cancelChecked:function(e){e.uncheck(),h(e)},del:function(){return he(n,void 0,void 0,(function(){var n,o;return me(this,(function(s){switch(s.label){case 0:return t.emit("input",!1),n=function(e){var t=e.reduce((function(e,t){return e.activityCount+=t.data.activityRefCount||0,e.resourceCount+=t.data.resourceRefCount||0,e.nodeSubjectRefCount+=t.data.subjectRefCount||0,e.nodeCaptureRefCount+=t.data.captureRefCount||0,e.nodeCount+=1,e}),{activityCount:0,resourceCount:0,nodeSubjectRefCount:0,nodeCaptureRefCount:0,nodeCount:0});return[t.activityCount,t.resourceCount,t.nodeSubjectRefCount,t.nodeCaptureRefCount,t.nodeCount]}(p.value),[4,(0,g.P5)(n)];case 1:if(!s.sent())return[3,5];s.label=2;case 2:return s.trys.push([2,4,,5]),[4,i()];case 3:return s.sent(),p.value=[],e.node.tree.setModel(r.value.model),ve.Z.success(a.default.t("delete_success")),[3,5];case 4:return o=s.sent(),ve.Z.error(o.message),[3,5];case 5:return[2]}}))}))},cancel:function(){t.emit("input",!1)}}}}),we=(0,h.Z)(ye,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Modal",{attrs:{value:e.value,transfer:"",width:1e3,"class-name":"batch-delete-modal",styles:{top:"40px"}},on:{"on-visible-change":e.modalVisibleChange},scopedSlots:e._u([{key:"header",fn:function(){return[e._v(e._s(e.$t("knowledgeGraph.batchDeleteNodeTip")))]},proxy:!0},{key:"footer",fn:function(){return[n("Button",{staticClass:"cancel-btn",on:{click:e.cancel}},[e._v(e._s(e.$t("cancel")))]),e._v(" "),n("Button",{attrs:{type:"error",disabled:0===e.checkedNodesCount},on:{click:e.del}},[e._v(e._s(e.$t("batch_delete")))])]},proxy:!0}])},[e._v(" "),n("div",{staticClass:"delete-tip"},[n("i",{staticClass:"font font-alert-warning"}),e._v(" "),n("div",{staticClass:"title"},[e._v(e._s(e.$t("knowledgeGraph.batchDeleteTip")))])]),e._v(" "),n("div",{staticClass:"batch-delete-content"},[n("div",{staticClass:"tree-wrapper"},[n("div",{staticClass:"toolbar-wrapper"},[n("Input",{attrs:{search:"",placeholder:e.$t("knowledgeGraph.nodeName")},on:{"on-search":e.search},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}})],1),e._v(" "),n("div",{staticClass:"tree-container",style:{padding:e.noData?"24px":null,"padding-top":e.noData?"8px":null}},[n("Tree",{ref:"treeRef",attrs:{options:e.treeOptions,filter:e.filter},on:{"tree:filtered":e.treeFilterHandle,"node:checked":e.nodeCheckedHandle,"node:unchecked":e.nodeUnCheckedHandle},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.node;return[n("div",{staticClass:"tree-content-with-tooltip"},[n("Tooltip",{directives:[{name:"ellipsis",rawName:"v-ellipsis"}],attrs:{placement:"top",content:o.text,transfer:""}},[n("span",[e._v(e._s(o.text))])])],1)]}}])}),e._v(" "),e.noData?n("NoData",[e._v("\n          "+e._s(e.$t("knowledgeGraph.noContent"))+"\n        ")]):e._e()],1)]),e._v(" "),n("div",{staticClass:"pane-wrapper"},[n("ToolbarWrapper",[n("div",{staticClass:"flex-between"},[n("div",[e._v(e._s(e.$t("knowledgeGraph.selectedNode",[e.checkedNodesCount])))])])]),e._v(" "),n("div",{staticClass:"tag-wrapper"},e._l(e.checkedNodes,(function(t){return n("Tag",{key:t.id,attrs:{size:"large",closable:""},on:{"on-close":function(n){return e.cancelChecked(t)}}},[n("Tooltip",{directives:[{name:"ellipsis",rawName:"v-ellipsis"}],attrs:{placement:"top",content:t.data.text,transfer:""}},[n("span",[e._v(e._s(t.data.text))])])],1)})),1)],1)])])}),[],!1,null,"466d3eaa",null).exports,be=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},_e=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},Ce=function(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))},ke=(0,o.aZ)({components:{TreeRoot:ee,RelativeNode:m,Point:T,RelationSettingModal:pe,BatchDeleteModal:we},props:{keyword:{type:String,default:""},dimensions:{type:Array,default:function(){return[]}}},setup:function(e,t){var n,f,v,h=this,m=(0,te.tv)().route,g=(0,o.iH)(null),y=(0,o.iH)([]),w=(0,o.iH)(null),b=(0,o.iH)(null),C=(0,c.X)().depth,k=(0,o.f3)("course",{id:0}),x=0;m.value&&(x=Number.isNaN(Number(null!==(n=m.value.query.node_id)&&void 0!==n?n:0))?0:Number(null!==(f=m.value.query.node_id)&&void 0!==f?f:0));var S=(0,o.iH)(!1),T=(0,o.iH)(""),D=(0,o.iH)(!0),I=(null===(v=window.featureToggles)||void 0===v?void 0:v.isCognitiveDimensionOpen)||!1,E=(0,o.iH)(!1),N=(0,o.iH)(),$=(0,o.iH)(!1),R=_(w),j=(0,o.iH)(!1),P=(0,o.iH)();(0,o.YP)((function(){return e.keyword}),(function(e){T.value=e}));var M=function(e,t,n){return be(h,void 0,void 0,(function(){var o,r,a,s,l,c,d,p,f,v;return _e(this,(function(h){switch(h.label){case 0:if(t===n)return[2,Promise.resolve(!0)];h.label=1;case 1:return h.trys.push([1,6,,7]),"string"!=typeof e.id?[3,3]:(o={name:t,parentId:0},(null===(d=e.parent)||void 0===d?void 0:d.id)&&!Number.isNaN(Number(e.parent.id))&&(o.parentId=e.parent.id),[4,(0,u.cf)(k.id,o)]);case 2:return r=h.sent(),e.id=r.id,[3,5];case 3:return[4,(0,u.r8)(e.id,{name:t})];case 4:h.sent(),h.label=5;case 5:return a=e.tree,s=function(n){n.id===e.id&&(n.name=t)},a.recurseDown((function(e){e.data.prevRelation.forEach(s),e.data.postRelation.forEach(s),e.data.undirectedRelation.forEach(s)})),[2,Promise.resolve(!0)];case 6:return(l=h.sent()).isAxiosError?(c=null===(v=null===(f=null===(p=l.response.data)||void 0===p?void 0:p.errors)||void 0===f?void 0:f.name)||void 0===v?void 0:v[0],i.Message.error(c),[2,Promise.resolve(!1)]):[2,Promise.resolve(!1)];case 7:return[2]}}))}))},O=function(){var e=!0;w.value.tree.recurseDown((function(t){t.checked()||(e=!1)})),S.value=e},G=(0,o.Fl)((function(){return!r.yw&&!r.Uz.value&&(r.wZ&&!r.nQ.value)}));(0,o.bv)((function(){return be(h,void 0,void 0,(function(){var e,n,o,i,a,s,l;return _e(this,(function(c){switch(c.label){case 0:return $.value=!0,[4,(0,u.$H)(k.id)];case 1:return e=c.sent(),n=0,(0,p.T$)(e,(function(){n++})),t.emit("on-filtered",n),(o=e[0])&&(o.states||(o.states=new d.bU),o.states.selected=!0),r.Q7.value=w.value,r.Q7.value.tree.setModel(e),0!==x&&0!==(i=r.Q7.value.tree.find((function(e){return e.id===x}),!1)).length&&(i[0].select(),i[0].expandTop(!1)),D.value=0===e.length,a=w.value.opts.multiple,s=w.value.selected(),l=w.value.checked(),g.value={selected:a?s:s[0]||null,checked:l},$.value=!1,[2]}}))}))}));var A=function(e,t,n){if(e.parent===t.parent&&[s.Pw.BELOW,s.Pw.ABOVE].includes(n))return!1;var o=function(e){var t=[];return e.recurseDown((function(e){t.push.apply(t,Ce(Ce(Ce([],e.data.postRelation.map((function(e){return e.id})),!1),e.data.prevRelation.map((function(e){return e.id})),!1),e.data.undirectedRelation.map((function(e){return e.id})),!1))})),t}(e),r=function(e){var t=[];return e.root.recurseDown((function(e){return t.push(e.id)})),t}(t).filter((function(t){return t!==e.id}));return o.some((function(e){return r.includes(e)}))};return{treeOptions:{modelParse:r.wZ?null:{masteryRate:"masteryRate",masteryRank:"masteryRank",completenessRate:"completenessRate",completenessRank:"completenessRank"},editing:r.wZ&&!r.nQ.value,autoCheckChildren:!1,nodeIndent:28,depth:C,dnd:!(r.yw||r.Uz.value||!r.wZ)&&{onDragFinish:function(e,t,n){var o,r,l,c,d,p,f,v;return be(this,void 0,void 0,(function(){var h,m;return _e(this,(function(g){switch(g.label){case 0:if(function(e,t,n){return n===s.Pw.ON&&t.depth+1+(e.depthWithChildren()+1)>C}(e,t,n))return i.Message.error(a.default.t("knowledgeGraph.move.overMaxDepth")),[2,!1];if(A(e,t,n))return i.Message.error(a.default.t("knowledgeGraph.move.relation")),[2,!1];if(function(e,t,n){var o,r;switch(n){case s.Pw.ON:r=t.find((function(t){return t.text===e.text&&t.id!==e.id}),!1);break;case s.Pw.ABOVE:case s.Pw.BELOW:r=(null!==(o=t.parent)&&void 0!==o?o:t.tree).find((function(t){return t.text===e.text&&t.id!==e.id}),!1,!1);break;default:return!0}return!!t.tree.isNode(r)||!!(Array.isArray(r)&&r.length>0)}(e,t,n))return i.Message.error(a.default.t("knowledgeGraph.move.duplicate")),[2,!1];h=0,m=0,n===s.Pw.ON?(h=null!==(r=null===(o=t.last())||void 0===o?void 0:o.id)&&void 0!==r?r:0,m=t.id):n===s.Pw.ABOVE?(m=null!==(c=null===(l=t.parent)||void 0===l?void 0:l.id)&&void 0!==c?c:0,h=null!==(p=null===(d=t.prev())||void 0===d?void 0:d.id)&&void 0!==p?p:0):n===s.Pw.BELOW&&(m=null!==(v=null===(f=t.parent)||void 0===f?void 0:f.id)&&void 0!==v?v:0,h=t.id),g.label=1;case 1:return g.trys.push([1,3,,4]),[4,(0,u.Ib)(k.id,{curId:e.id,parentId:m,prevId:h})];case 2:return g.sent(),[2,!0];case 3:return g.sent(),[2,!1];case 4:return[2]}}))}))}},filter:{emptyText:"",showChildren:!1,textMatcher:function(e,t){return new RegExp(e,"i").test(t.text)},dimensionMatcher:function(e,t){return e.includes(t.data.cognitiveDimension)}},validate:function(e,t){if(!(t=null==t?void 0:t.trim()))return l.UniqueToast.error(a.default.t("knowledgeGraph.validate.notNull")),!1;var n=e.parent||{children:e.tree.model};if(n){var o=n.children.filter((function(t){return t!==e})).some((function(e){return e.text===t}));return o&&l.UniqueToast.error(a.default.t("knowledgeGraph.validate.sameName")),!o}return!!t},save:M},treeModel:g,treeData:y,treeComponentRef:w,checkAll:S,filter:T,noData:D,toggleCheckAll:function(e){e?w.value.tree.checkAll():w.value.tree.uncheckAll()},nodeCheckedHandle:O,nodeEditingStopHandle:M,nodeAddOrRemoveHandle:function(e){D.value=0===e.tree.model.length,O(),D.value&&S.value&&(S.value=!1)},treeFilterHandle:function(e,n){D.value=0===e.length&&!!n,n||w.value.collapseAll();var o=[];e.forEach((function(e){e.hasChildren()&&e.recurseDown((function(e){new RegExp(n,"i").test(e.text)&&o.push(e)}),!0)})),o.forEach((function(e){e.state("visible",!0),e.recurseUp((function(e){e.expand(),e.state("visible",!0)}))}));var r=w.value.tree.nodeCount();t.emit("on-filtered",r)},isCognitiveDimensionOpen:I,pointRef:b,nodeRelationSettingModalOpen:function(e){E.value=!0,N.value=e},showRelationSettingModal:E,currentRelationSettingNode:N,loading:$,addNewNode:function(){R.addNew()},canAddNewNode:G,showBatchDeleteModal:j,currentBatchDeleteNode:P,batchDeleteModalOpen:function(e){j.value=!0,P.value=e}}}}),xe=(0,h.Z)(ke,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tree-wrapper"},[n("TreeRoot",{ref:"treeComponentRef",attrs:{data:e.treeData,options:e.treeOptions,"tree-loading":e.loading,"can-add-new-node":e.canAddNewNode},on:{"node:checked":e.nodeCheckedHandle,"node:unchecked":e.nodeCheckedHandle,"node:added":e.nodeAddOrRemoveHandle,"node:removed":e.nodeAddOrRemoveHandle,"tree:filtered":e.treeFilterHandle,"node:relation:setting":e.nodeRelationSettingModalOpen,"add-new-node":e.addNewNode,"node:batch-delete":e.batchDeleteModalOpen},model:{value:e.treeModel,callback:function(t){e.treeModel=t},expression:"treeModel"}}),e._v(" "),n("RelationSettingModal",{attrs:{node:e.currentRelationSettingNode},model:{value:e.showRelationSettingModal,callback:function(t){e.showRelationSettingModal=t},expression:"showRelationSettingModal"}}),e._v(" "),n("BatchDeleteModal",{attrs:{node:e.currentBatchDeleteNode},model:{value:e.showBatchDeleteModal,callback:function(t){e.showBatchDeleteModal=t},expression:"showBatchDeleteModal"}})],1)}),[],!1,null,"63049f0e",null).exports,Se=(0,o.aZ)({name:"Content",components:{Tree:xe},props:{keyword:{type:String},dimensions:{type:Array,default:function(){return[]}}},setup:function(e){var t=(0,o.iH)("tree"),n=(0,o.iH)(),i=(0,o.iH)(""),a=(0,o.f3)("course",{name:"",id:0}),s=(0,o.iH)([]),l=(0,o.iH)(0),c=function(){l.value=n.value.$refs.treeComponentRef.tree.nodeCount()};(0,o.YP)(n,(function(e){e&&(e.$refs.treeComponentRef.$on("node:added",c),e.$refs.treeComponentRef.$on("node:removed",c))})),(0,o.YP)((function(){return e.keyword}),(function(){e.keyword?i.value=e.keyword:i.value=""})),(0,o.YP)((function(){return e.dimensions}),(function(){s.value=e.dimensions}));var u=(0,o.Fl)((function(){return!r.yw&&!r.Uz.value&&(r.wZ&&r.nQ.value)})),d=(0,o.Fl)((function(){return!r.yw&&!r.Uz.value&&(!r.nQ.value&&r.wZ)})),p=(0,o.Fl)((function(){return r.dE||r.Uz.value}));return{tab:t,treeRef:n,filter:i,totalNode:l,search:function(e){i.value=e},filteredHandle:function(e){l.value=e},canEdit:d,canImportData:u,hideSearch:p,selectedDimensions:s,onDimensionSelected:function(e){s.value=e},course:a,clickOutside:function(e){C.Z.$emit("click-outside",e)}}}}),Te=(0,h.Z)(Se,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"content-wrapper",on:{click:function(t){return e.clickOutside(t)}}},[n("div",{staticClass:"content"},[n("div",{staticClass:"title"},[n("i",{staticClass:"circle-button"}),e._v(" "),n("span",{staticClass:"course-name"},[e._v(e._s(e.course.name))]),e._v(" "),n("span",{staticClass:"course-icon"},[e._v(e._s(e.$t("knowledgeGraph.course")))])]),e._v(" "),"tree"===e.tab?n("Tree",{ref:"treeRef",attrs:{keyword:e.filter,dimensions:e.selectedDimensions},on:{"on-filtered":e.filteredHandle}}):e._e()],1)])}),[],!1,null,"25000174",null).exports},183825:function(e,t,n){"use strict";n.d(t,{Z:function(){return Ft}});n(141817),n(66992),n(319601),n(788674),n(333948);var o,r,i=n(925706),a=n(966309),s=n(117403),l=n(922942),c=n(365693),u=n(114698),d=n(14491),p=n(563507),f=n(661510),v=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},h=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},m=(0,i.aZ)({name:"TeachingCalendarList",components:{TeachingCalendarViewModal:d.Z,Pagination:f.Z},props:{keyword:{type:String,required:!0}},setup:function(e){var t=this,n=[{title:s.default.t("courseName"),key:"courseName",width:150,slot:"courseName"},{title:s.default.t("cloudClassroom.courseCode"),key:"courseCode",width:120,slot:"courseCode"},{title:s.default.t("teachingCalendar.content"),slot:"content",width:200},{title:s.default.t("teachingCalendar.instructor"),key:"instructor",width:150,slot:"instructor"},{title:s.default.t("teachingCalendar.location"),key:"location",width:150,slot:"location"},{title:s.default.t("teachingCalendar.teachingTime"),key:"teachingTime",width:200,slot:"teachingTime"},{title:s.default.t("teachingCalendar.operation"),key:"operation",width:90,slot:"operation"}],o=(0,i.iH)(new c.Qj),r=function(n,o){return v(t,void 0,void 0,(function(){return h(this,(function(t){return[2,(0,u.rR)(e.keyword,n,o)]}))}))},a=(0,l.h0)(r);a.fetch();var d=(0,i.iH)(!1);return{columns:n,page:a,openDetail:function(e){o.value=e,d.value=!0},currentCalendar:o,fetchData:r,showDetailModal:d,highlightKeyword:p.H}}}),g=m,y=n(551900),w=(0,y.Z)(g,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"teaching-calendar-wrapper"},[n("div",{staticClass:"list-wrapper"},[n("Table",{staticClass:"table",attrs:{columns:e.columns,data:e.page.data.items,height:"558"},scopedSlots:e._u([{key:"courseName",fn:function(t){var o=t.row;return[n("Tooltip",{directives:[{name:"ellipsis",rawName:"v-ellipsis"}],attrs:{transfer:"",content:o.course.name}},[e._v("\n          "+e._s(o.course.name||"--")+"\n        ")])]}},{key:"courseCode",fn:function(t){var o=t.row;return[n("Tooltip",{directives:[{name:"ellipsis",rawName:"v-ellipsis"}],attrs:{transfer:"",content:o.course.courseCode}},[e._v("\n          "+e._s(o.course.courseCode||"--")+"\n        ")])]}},{key:"content",fn:function(t){var o=t.row;return[n("div",{staticClass:"calendar-content"},[n("Tooltip",{directives:[{name:"ellipsis",rawName:"v-ellipsis"}],attrs:{transfer:"",content:o.content}},[n("div",{attrs:{slot:"content"},domProps:{innerHTML:e._s(e.highlightKeyword(o.content,e.keyword)||"--")},slot:"content"}),e._v(" "),n("span",{domProps:{innerHTML:e._s(e.highlightKeyword(o.content,e.keyword)||"--")}})])],1)]}},{key:"instructor",fn:function(t){var o=t.row;return[n("Tooltip",{directives:[{name:"ellipsis",rawName:"v-ellipsis"}],attrs:{transfer:"",content:o.instructor}},[e._v("\n          "+e._s(o.instructor||"--")+"\n        ")])]}},{key:"location",fn:function(t){var n=t.row;return[e._v("\n        "+e._s(n.location||"--")+"\n      ")]}},{key:"teachingTime",fn:function(t){var n=t.row;return[e._v("\n        "+e._s(n.teachingTime||"--")+"\n      ")]}},{key:"operation",fn:function(t){var o=t.row;return[n("div",{staticClass:"operation-area"},[n("Tooltip",{staticClass:"op-item",attrs:{transfer:"",content:e.$t("view"),placement:"top"}},[n("i",{staticClass:"font font-resource-view",on:{click:function(t){return t.stopPropagation(),e.openDetail(o)}}})])],1)]}}])}),e._v(" "),e.page.data.total>10?n("div",{staticClass:"pagination"},[n("Pagination",{attrs:{total:e.page.data.total,"page-size":e.page.data.pageSize,current:e.page.data.page,"page-size-opts":[10,20,30,50],"show-elevator":"","show-sizer":""},on:{"on-change":e.page.pageChanged,"on-page-size-change":e.page.pageSizeChanged}})],1):e._e()],1),e._v(" "),n("TeachingCalendarViewModal",{attrs:{keyword:e.keyword,model:e.currentCalendar},model:{value:e.showDetailModal,callback:function(t){e.showDetailModal=t},expression:"showDetailModal"}})],1)}),[],!1,null,"61bad350",null),b=w.exports,_=n(662061),C=n(154803),k=n(462149),x=(n(747042),n(454747),n(558794)),S=n(311610),T=n(427372),D=(0,i.aZ)({components:{NoData:T.Z,Tooltip:x.Z,SvgIcon:S.Z},props:{data:{type:Array,default:function(){return[]}},showViewBtn:{type:Boolean,default:!1}},setup:function(e,t){var n=e.showViewBtn;return{renderTree:function(e,o){var r=o.data;return e("span",[e(S.Z,{props:{name:"facet-tree"}}),e("span",{class:"tree-title"},[e(x.Z,{props:{text:r.name}})]),e("span",{class:"count"},"(".concat(r.fragmentCount,")")),n&&e("a",{class:"view",on:{click:function(e){r.selected&&e.stopPropagation(),t.emit("on-view-btn-click",r.id)}}},s.default.t("view"))])},selectChangeHandle:function(e,n){t.emit("on-node-click",n.id)}}}}),I=D,E=(0,y.Z)(I,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"facet-tree-wrapper"},[e.data.length>0?n("div",[n("div",[e._t("default")],2),e._v(" "),n("Tree",{attrs:{data:e.data,render:e.renderTree},on:{"on-select-change":e.selectChangeHandle}})],1):n("NoData",[e._v(e._s(e.$t("knowledgeGraph.noFacetAndFragment")))])],1)}),[],!1,null,"a1163c08",null),N=E.exports,$=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},R=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},j=n(370538),P=n(486992),M=(0,i.aZ)({props:{fragment:Object,isSelected:{type:Boolean,default:!1}},setup:function(){return{sanitize:P.Nw}}}),O=M,G=(0,y.Z)(O,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"fragment-card-wrapper",class:{selected:e.isSelected}},[n("div",{staticClass:"content leading-5.5 max-h-50 overflow-y-hidden"},[n("div",{domProps:{innerHTML:e._s(e.sanitize(e.fragment.content))}}),e._v(" "),n("div",{staticClass:"mask"})])])}),[],!1,null,"6ee80039",null),A=G.exports,Z=(0,i.aZ)({props:{fragment:Object},setup:function(){return{sanitize:P.Nw}}}),H=Z,F=(0,y.Z)(H,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"fragment-detail-wrapper"},[n("div",{staticClass:"source-wrapper"},["WEB"===e.fragment.source?n("div",{staticClass:"item"},[n("section",{staticClass:"row"},[n("label",{staticClass:"text-right w-28"},[e._v(e._s(e.$t("knowledgeGraph.webSource")))]),e._v(" "),n("div",{staticClass:"truncate max-w-80"},[n("Tooltip",{directives:[{name:"ellipsis",rawName:"v-ellipsis"}],attrs:{placement:"top",content:e.fragment.detail.name,transfer:""}},[n("span",[e._v(e._s(e.fragment.detail.name))])])],1)]),e._v(" "),n("section",{staticClass:"row my-1"},[n("label",{staticClass:"text-right w-28"},[e._v(e._s(e.$t("knowledgeGraph.link")))]),e._v(" "),n("div",{staticClass:"truncate max-w-80"},[n("a",{attrs:{href:e.fragment.detail.url,target:"_blank"}},[e._v("\n            "+e._s(e.fragment.detail.url)+"\n          ")])])])]):"BOOK"===e.fragment.source?n("div",{staticClass:"item"},[n("section",{staticClass:"row"},[n("label",{staticClass:"text-right w-28"},[e._v(e._s(e.$t("knowledgeGraph.bookSource")))]),e._v(" "),n("div",{staticClass:"book-wrapper"},[n("div",{staticClass:"book truncate max-w-70"},[n("Tooltip",{directives:[{name:"ellipsis",rawName:"v-ellipsis"}],attrs:{placement:"top",content:e.fragment.detail.book,transfer:""}},[n("span",[e._v("\n                "+e._s(e.fragment.detail.book)+"\n              ")])])],1),e._v(" "),n("div",[e._v("("+e._s(e.$t("knowledgeGraph.pageFormat",[e.fragment.detail.page]))+")")])])]),e._v(" "),n("section",{staticClass:"row my-1"},[n("label",{staticClass:"text-right w-28"},[e._v(e._s(e.$t("knowledgeGraph.isbn")))]),e._v(" "),n("div",{staticClass:"truncate max-w-80"},[e._v("\n          "+e._s(e.fragment.detail.isbn)+"\n        ")])])]):n("div",{staticClass:"item"},[e.fragment.detail.description?n("section",{staticClass:"row"},[n("label",{staticClass:"text-right w-28"},[e._v(e._s(e.$t("knowledgeGraph.otherSource")))]),e._v(" "),n("div",{staticClass:"text truncate max-w-80"},[n("Tooltip",{directives:[{name:"ellipsis",rawName:"v-ellipsis"}],attrs:{placement:"top",content:e.fragment.detail.description,transfer:""}},[n("span",[e._v("\n              "+e._s(e.fragment.detail.description)+"\n            ")])])],1)]):n("section",{staticClass:"row my-1"},[n("label",{staticClass:"text-right w-28"},[e._v(e._s(e.$t("knowledgeGraph.noSource")))]),e._v(" "),n("div")])])]),e._v(" "),n("div",{staticClass:"w-full overflow-y-auto content-wrapper"},[n("div",{staticClass:"text-14px content",domProps:{innerHTML:e._s(e.sanitize(e.fragment.content))}})])])}),[],!1,null,"66f4f4d3",null),B=F.exports,z=(0,i.aZ)({components:{FacetTree:N,NoData:T.Z,FragmentCard:A,FragmentDetail:B},props:{value:{type:Boolean,default:!1},facets:{type:Array,default:function(){return[]}},fragments:{type:Array,default:function(){return[]}},currentFacetId:Number},setup:function(e,t){var n=(0,i.iH)(),o=(0,i.Fl)((function(){var t=[];return(0,P.T$)(e.facets,(function(e){t.push(e)})),t.find((function(t){return t.id===e.currentFacetId}))}));return(0,i.YP)((function(){return e.fragments}),(function(e){e&&(n.value=e[0])})),{currentFragment:n,currentFacet:o,selectedFragment:function(t){n.value=e.fragments.find((function(e){return e.id===t}))},toggleOpen:function(e){t.emit("input",e)},nodeClickHandle:function(e){t.emit("on-change-facet",e)}}}}),L=z,U=(0,y.Z)(L,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Modal",{staticClass:"facet-detail-modal",attrs:{value:e.value,"footer-hide":"",title:e.$t("knowledgeGraph.facetNFragment"),transfer:!1,width:"85%"},on:{"on-visible-change":e.toggleOpen}},[e.value?n("div",{staticClass:"modal-content"},[n("div",{staticClass:"left"},[n("div",{staticClass:"modal-content-header"},[e._v(e._s(e.$t("knowledgeGraph.facet")))]),e._v(" "),n("FacetTree",{staticClass:"pd-10-20",attrs:{data:e.facets},on:{"on-node-click":e.nodeClickHandle}})],1),e._v(" "),e.fragments.length?n("div",{staticClass:"right"},[n("div",{staticClass:"fragment-list"},[n("div",{staticClass:"modal-content-header"},[n("span",[e._v(e._s(e.$t("knowledgeGraph.fragmentsOfFacet1")))]),e._v(" "),n("span",{staticClass:"facet-name"},[e._v(e._s(e.currentFacet&&e.currentFacet.name))]),e._v(" "),n("span",[e._v(e._s(e.$t("knowledgeGraph.fragmentsOfFacet2")))])]),e._v(" "),n("div",{staticClass:"pd-10-20"},e._l(e.fragments,(function(t){return n("FragmentCard",{key:t.id,staticClass:"mb-10",attrs:{fragment:t,isSelected:e.currentFragment&&e.currentFragment.id===t.id},nativeOn:{click:function(n){return e.selectedFragment(t.id)}}})})),1)]),e._v(" "),n("div",{staticClass:"fragment-detail pd-10-20"},[n("FragmentDetail",{attrs:{fragment:Object.assign({},e.currentFragment)}})],1)]):n("div",{staticClass:"right"},[n("NoData",[e._v(e._s(e.$t("knowledgeGraph.noFragment")))])],1)]):e._e()])}),[],!1,null,"7e9f2bfa",null),V=U.exports,q=function(){return(q=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},Y=Object.assign(V,{init:function(e){var t=new j.default({data:function(){return{value:!1,facets:[],fragments:[],currentFacetId:void 0}},methods:{input:function(e){this.value=e,this.$emit("input",e)},onChangeFacet:function(e){this.$emit("on-change-facet",e)}},render:function(e){return e(V,{props:q({},this.$data),on:{input:this.input,"on-change-facet":this.onChangeFacet}})}});return t.$mount(),e.append(t.$el),t}}),K=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},W=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},J=function(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))},X=(0,i.aZ)({components:{FacetTree:N},props:{nodeId:{type:Number,required:!0}},setup:function(e){var t,n=this,o=(0,i.iH)([]),r=(0,i.iH)(!1),a=(0,i.iH)(0),s=(0,i.f3)("facetDetailModalStatus",{opened:!1}),l=function(){var e=(0,i.iH)(0),t=(0,i.iH)(0);return{loadFacets:function(e,t){return $(void 0,void 0,void 0,(function(){return R(this,(function(n){switch(n.label){case 0:return[4,(0,_.Pf)(e,t)];case 1:return[2,n.sent()]}}))}))},loadFragments:function(e,t){return(0,_.jV)(e,t)},totalFacetCount:e,totalFragmentCount:t,calculateFragmentCounts:function(n){e.value=0,t.value=0,n.forEach((function(n){e.value+=n.facetCount,t.value+=n.fragmentCount}))}}}(),c=l.loadFacets,u=l.totalFacetCount,d=l.totalFragmentCount,p=l.calculateFragmentCounts,f=(0,i.Fl)((function(){var e=function(e){var t=null;return o.value.forEach((function(n){n.id===e&&(t=n);var o=n.children.find((function(t){return t.id===e}));o&&(t=o)})),t}(a.value);if(e){if(e.children.length){var t=e.fragments;return e.children.forEach((function(e){t=J(J([],t,!0),e.fragments,!0)})),t}return e.fragments}return[]})),v=(0,i.f3)("relationContext",{}),h=function(e){a.value=e,t&&(t.value=!0,t.currentFacetId=a.value,t.facets=o.value,t.fragments=f.value)};return(0,i.YP)(r,(function(e){e||(s.opened=!1)})),(0,i.m0)((function(){return K(n,void 0,void 0,(function(){var t;return W(this,(function(n){switch(n.label){case 0:return[4,c(C.N7.value.id,e.nodeId)];case 1:return t=n.sent(),o.value=t,p(t),[2]}}))}))})),(0,i.bv)((function(){var e,n;(t=Y.init(null!==(n=null===(e=null==v?void 0:v.fragmentModalInject)||void 0===e?void 0:e.value)&&void 0!==n?n:document.body)).$on("input",(function(e){r.value=e})),t.$on("on-change-facet",(function(e){h(e)}))})),{facets:o,totalFacetCount:u,totalFragmentCount:d,showModal:r,fragments:f,currentFacetId:a,showDetail:function(e){return K(n,void 0,void 0,(function(){return W(this,(function(t){switch(t.label){case 0:return r.value=!0,s.opened=!0,[4,h(e)];case 1:return t.sent(),[2]}}))}))},reloadFragments:h}}}),Q=(0,y.Z)(X,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"facet-wrapper"},[n("FacetTree",{attrs:{data:e.facets,showViewBtn:!0},on:{"on-view-btn-click":e.showDetail}},[n("span",{staticStyle:{color:"#70748c"}},[e._v("\n      "+e._s(e.$t("knowledgeGraph.facetAndFragmentCount",[e.totalFacetCount,e.totalFragmentCount]))+"\n    ")])])],1)}),[],!1,null,null,null).exports,ee=(n(132023),n(496486)),te=n(681423),ne=n(37423),oe=n(864251),re=(n(651532),function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))}),ie=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},ae=function(){this.referType="teaching_objective",this.itemAdded=[],this.itemDeleted=[],this.itemChecked=[],this.itemUnchecked=[],this.itemUpdated=[]},se=function(e,t){var n=function(t){return t.map((function(t){return{referType:e.referType,referId:t.data.id}}))};return Promise.all([re(void 0,void 0,void 0,(function(){return ie(this,(function(o){return 0===e.itemChecked.length?[2,!1]:[2,(0,_.JS)(t,n(e.itemChecked))]}))})),re(void 0,void 0,void 0,(function(){return ie(this,(function(o){return 0===e.itemUnchecked.length?[2,!1]:[2,(0,_.VJ)(t,n(e.itemUnchecked))]}))})),function(){if(0===e.itemUpdated.length)return!1;var t=e.itemUpdated.map((function(e){return{content:e.data.content,id:e.data.id}}));return(0,_.fL)(C.N7.value.id,t)}(),function(){if(0===e.itemAdded.length)return!1;var n=e.itemAdded.map((function(e){return{content:e.data.content,referKnowledgeNodeId:e.selected?t:void 0}}));return(0,_.SH)(C.N7.value.id,n)}(),function(){if(0===e.itemDeleted.length)return!1;var t=e.itemDeleted.map((function(e){return e.data.id}));return(0,_.fZ)(C.N7.value.id,t)}()])},le=n(494101),ce=function(){return(ce=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},ue=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},de=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},pe=function(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))},fe=(0,i.aZ)({components:{SvgIcon:S.Z,TeachingObjectiveSelect:oe.Z,CognitiveDimensionSelect:ne.Z,RelationItem:le.Z},props:{node:{type:Object,required:!0},nodeDetail:{type:Object,required:!0}},setup:function(e){var t,n=this,o=(0,i.iH)({name:""}),r=(0,i.f3)(k.iv),a=(0,i.iH)(),l=(0,i.iH)(),c=(0,i.iH)(),u=(0,i.iH)(""),d=(0,i.iH)("none");(0,i.m0)((function(){o.value.name=e.nodeDetail.name,u.value=e.nodeDetail.description||"",d.value=e.nodeDetail.cognitiveDimension}));var p={name:[{required:!C.nQ.value,trigger:"blur",message:s.default.t("fieldRequired"),pattern:/\S+/},{type:"string",max:255,trigger:"change"}]},f=(0,i.iH)(!1),v=(0,i.iH)([]),h=(0,i.iH)([]),m=(0,i.iH)([]),g=(0,i.Fl)((function(){return m.value.filter((function(e){return e.selected}))})),y=function(){return ue(n,void 0,void 0,(function(){return de(this,(function(t){switch(t.label){case 0:return m.value=[],[4,r.value.fetch()];case 1:return t.sent(),[2,(0,_.F)(C.N7.value.id).then((function(t){v.value=t,m.value=t.map((function(t){var n=e.nodeDetail.teachingObjectives.map((function(e){return e.id}))||[];return new k.PP(t,n.includes(t.id))})),h.value=(0,ee.cloneDeep)(m.value)}))]}}))}))},w=new ae,b=(0,i.iH)({name:!1,cognitiveDimension:!1,description:!1}),x=(0,i.iH)(),S=function(t){var r;"name"===t&&(null===(r=x.value)||void 0===r||r.validate((function(t){t&&ue(n,void 0,void 0,(function(){return de(this,(function(t){switch(t.label){case 0:return[4,(0,_.r8)(e.nodeDetail.id,{name:o.value.name})];case 1:return t.sent(),e.node.data&&e.node.data.text?e.node.data.text=o.value.name:e.node&&(e.node.name=o.value.name),b.value.name=!1,[2]}}))}))}))),"description"===t&&ue(n,void 0,void 0,(function(){return de(this,(function(t){switch(t.label){case 0:return[4,(0,_.r8)(e.nodeDetail.id,{description:u.value})];case 1:return t.sent(),b.value.description=!1,[2]}}))})),"cognitiveDimension"===t&&ue(n,void 0,void 0,(function(){var t;return de(this,(function(n){switch(n.label){case 0:return[4,(0,_.r8)(e.nodeDetail.id,{cognitiveDimension:d.value||"none"})];case 1:return n.sent(),((null===(t=e.node)||void 0===t?void 0:t.data)||e.node).cognitiveDimension=d.value||"none",b.value.cognitiveDimension=!1,[2]}}))}))},T=(0,i.Fl)((function(){return!C.yw&&!C.Uz.value&&(C.wZ&&r.value.edit)})),D=(null===(t=window.featureToggles)||void 0===t?void 0:t.isCognitiveDimensionOpen)||!1,I=(0,i.Fl)((function(){return pe([],(e.nodeDetail.prevRelation||[]).map((function(e){return ce(ce({},e),{relationType:"prev"})})),!0)})),E=(0,i.Fl)((function(){return pe([],(e.nodeDetail.postRelation||[]).map((function(e){return ce(ce({},e),{relationType:"post"})})),!0)})),N=(0,i.Fl)((function(){return pe([],(e.nodeDetail.undirectedRelation||[]).map((function(e){return ce(ce({},e),{relationType:"undirected"})})),!0)}));return{confirmAll:function(){return ue(n,void 0,void 0,(function(){var t,n,o,r,i,a;return de(this,(function(s){switch(s.label){case 0:for(t=0,n=h.value;t<n.length;t++){if(""===(o=n[t]).data.content&&o.isEditing&&o.selected)return[2];o.isEditing=!1}f.value=!1,h.value=h.value.filter((function(e){return""!==e.data.content})),w=function(e,t){var n=new ae,o=new Map,r=new Map;e.forEach((function(e){return o.set(e.data.id,e)})),t.forEach((function(e){return r.set(e.data.id,e)})),t.forEach((function(e){o.get(e.data.id)||n.itemAdded.push(e)})),e.forEach((function(e){r.get(e.data.id)||n.itemDeleted.push(e)}));var i=[];return t.forEach((function(e){o.get(e.data.id)&&i.push([o.get(e.data.id),e])})),i.forEach((function(e){var t=e[0],o=e[1];t.selected!==o.selected&&(o.selected?n.itemChecked.push(o):n.itemUnchecked.push(o)),t.data.content!==o.data.content&&n.itemUpdated.push(o)})),n}(m.value,h.value),m.value=(0,ee.cloneDeep)(h.value),s.label=1;case 1:return s.trys.push([1,4,,5]),[4,se(w,e.nodeDetail.id)];case 2:return s.sent(),w=new ae,[4,y()];case 3:return s.sent(),[3,5];case 4:return r=s.sent(),te.Z.error((0,ee.flatten)((0,ee.values)(null===(a=null===(i=null==r?void 0:r.response)||void 0===i?void 0:i.data)||void 0===a?void 0:a.errors)).join(",")),[3,5];case 5:return[2]}}))}))},cancelAll:function(){h.value=(0,ee.cloneDeep)(m.value)},form:o,showModal:f,teachingObjectivesSelectItems:h,ruleValidate:p,editMode:b,formRef:x,handelSubmit:S,candelEdit:function(){y()},teachingObjectiveEditItems:g,knowledgeNode:r,canEditNode:T,isInstructor:C.wZ,editDisabled:C.nQ,isCognitiveDimensionOpen:D,cognitiveDimensionChanged:function(e){d.value=e,S("cognitiveDimension")},prevRelationList:I,postRelationList:E,undirectedRelationList:N,editModeToggle:function(e){if(T.value){if("name"===e){if(C.nQ.value)return;b.value.name=!b.value.name,(0,i.Y3)((function(){var e;null===(e=l.value)||void 0===e||e.focus({cursor:"end"})}))}"cognitiveDimension"===e&&(b.value.cognitiveDimension=!b.value.cognitiveDimension,(0,i.Y3)((function(){console.log(c)}))),"description"===e&&(b.value.description=!b.value.description,(0,i.Y3)((function(){var e;null===(e=a.value)||void 0===e||e.focus()})))}},descInputRef:a,nameInputRef:l,description:u,cognitiveDimension:d,selectRef:c}}}),ve=(0,y.Z)(fe,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[e.nodeDetail?[n("div",{staticClass:"section name"},[n("label",{attrs:{for:""}},[e._v(e._s(e.$t("knowledgeGraph.nodeName")))]),e._v(" "),n("Form",{ref:"formRef",attrs:{model:e.form,"label-position":"top",rules:e.ruleValidate},nativeOn:{submit:function(t){return t.preventDefault(),e.handelSubmit("name")}}},[n("FormItem",{attrs:{prop:"name"}},[e.editMode.name?e._e():n("Tooltip",{attrs:{content:e.$t("knowledgeGraph.clickHereToEdit"),placement:"top",transfer:"","transfer-class-name":"knowledge-graph-outline-tooltip",disabled:!e.canEditNode||e.editDisabled}},[n("span",{on:{click:function(t){return e.editModeToggle("name")}}},[e._v(e._s(e.form.name))])]),e._v(" "),e.editMode.name&&!e.editDisabled?n("Input",{ref:"nameInputRef",staticClass:"w-full",attrs:{maxlength:"255"},on:{"on-blur":function(t){return e.handelSubmit("name")}},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}}):e._e()],1)],1)],1),e._v(" "),e._l(e.nodeDetail.labels,(function(t){return n("div",{key:t.key,staticClass:"section"},[n("label",{attrs:{for:""}},[e._v(e._s(t.key))]),e._v(" "),n("div",{staticClass:"text"},[e._v("\n        "+e._s(t.value)+"\n      ")])])})),e._v(" "),e.isCognitiveDimensionOpen?n("div",{staticClass:"section"},[n("label",{attrs:{for:""}},[e._v(e._s(e.$t("knowledgeGraph.cognitiveDimension.name")))]),e._v(" "),"none"===e.cognitiveDimension||e.editMode.cognitiveDimension?e.editMode.cognitiveDimension?n("CognitiveDimensionSelect",{ref:"selectRef",attrs:{value:e.cognitiveDimension,width:100,placeholder:e.$t("knowledgeGraph.cognitiveDimension.select"),"with-color":!0,"can-select-unspecified":!1},on:{input:e.cognitiveDimensionChanged}}):n("Tooltip",{attrs:{content:e.$t("knowledgeGraph.clickHereToEdit"),placement:"top",transfer:"","transfer-class-name":"knowledge-graph-outline-tooltip",disabled:!e.canEditNode}},[n("div",{staticClass:"no-data",on:{click:function(t){return e.editModeToggle("cognitiveDimension")}}},[e._v("\n          "+e._s(e.$t("knowledgeGraph.cognitiveDimension.noData"))+"\n        ")])]):n("Tooltip",{attrs:{content:e.$t("knowledgeGraph.clickHereToEdit"),placement:"top",transfer:"","transfer-class-name":"knowledge-graph-outline-tooltip",disabled:!e.canEditNode}},[n("div",{staticClass:"text dimension",class:e.cognitiveDimension,on:{click:function(t){return e.editModeToggle("cognitiveDimension")}}},[e._v("\n          "+e._s(e.$t("knowledgeGraph.cognitiveDimension."+e.cognitiveDimension))+"\n        ")])])],1):e._e(),e._v(" "),n("div",{staticClass:"section description"},[n("label",{attrs:{for:""}},[e._v(e._s(e.$t("knowledgeGraph.desc")))]),e._v(" "),e.description&&!e.editMode.description?n("Tooltip",{attrs:{content:e.$t("knowledgeGraph.clickHereToEdit"),placement:"top",transfer:"","transfer-class-name":"knowledge-graph-outline-tooltip",disabled:!e.canEditNode}},[n("div",{staticClass:"text",on:{click:function(t){return e.editModeToggle("description")}}},[e._v("\n          "+e._s(e.description)+"\n        ")])]):e.editMode.description?n("Input",{ref:"descInputRef",staticClass:"w-full",attrs:{maxlength:"100",placeholder:e.$t("knowledgeGraph.descPlaceholder"),"show-word-limit":"",type:"textarea"},on:{"on-blur":function(t){return e.handelSubmit("description")}},model:{value:e.description,callback:function(t){e.description=t},expression:"description"}}):n("Tooltip",{attrs:{content:e.$t("knowledgeGraph.clickHereToEdit"),placement:"top",transfer:"","transfer-class-name":"knowledge-graph-outline-tooltip",disabled:!e.canEditNode}},[n("div",{staticClass:"no-data",on:{click:function(t){return e.editModeToggle("description")}}},[e._v(e._s(e.$t("knowledgeGraph.noDesc")))])])],1),e._v(" "),n("div",{staticClass:"section"},[n("label",{attrs:{for:""}},[e._v(e._s(e.$t("knowledgeGraph.nodeRelation")))]),e._v(" "),n("div",{staticClass:"undirected-area"},[n("div",{staticClass:"title"},[e._v(e._s(e.$t("knowledgeGraph.related")))]),e._v(" "),e.undirectedRelationList.length>0?n("div",{staticClass:"relation-area"},e._l(e.undirectedRelationList,(function(t){return n("div",{key:t.id},[n("RelationItem",{attrs:{node:e.node,relation:t,"can-edit-relation":!1,"show-prefix":!1}})],1)})),0):n("div",{staticClass:"no-data"},[e._v(e._s(e.$t("knowledgeGraph.notSet")))])]),e._v(" "),n("div",{staticClass:"prev-area"},[n("div",{staticClass:"title"},[e._v(e._s(e.$t("knowledgeGraph.prevRelation")))]),e._v(" "),e.prevRelationList.length>0?n("div",{staticClass:"relation-area"},e._l(e.prevRelationList,(function(t){return n("div",{key:t.id},[n("RelationItem",{attrs:{node:e.node,relation:t,"can-edit-relation":!1,"show-prefix":!1}})],1)})),0):n("div",{staticClass:"no-data"},[e._v(e._s(e.$t("knowledgeGraph.notSet")))])]),e._v(" "),n("div",{staticClass:"post-area"},[n("div",{staticClass:"title"},[e._v(e._s(e.$t("knowledgeGraph.postRelation")))]),e._v(" "),e.postRelationList.length>0?n("div",{staticClass:"relation-area"},e._l(e.postRelationList,(function(t){return n("div",{key:t.id},[n("RelationItem",{attrs:{node:e.node,relation:t,"can-edit-relation":!1,"show-prefix":!1}})],1)})),0):n("div",{staticClass:"no-data"},[e._v(e._s(e.$t("knowledgeGraph.notSet")))])])]),e._v(" "),n("div",{staticClass:"section"},[n("label",{attrs:{for:""}},[e._v(e._s(e.$t("knowledgeGraph.teachingObjective")))]),e._v(" "),e.nodeDetail.teachingObjectives.length>0?n("ul",{staticClass:"objectives"},e._l(e.nodeDetail.teachingObjectives,(function(t){return n("li",{key:t.id},[e._v("\n          "+e._s(t.content)+"\n        ")])})),0):e._e(),e._v(" "),e.canEditNode?n("a",{on:{click:function(t){e.showModal=!0}}},[n("i",{staticClass:"font font-edit edit-color"}),e._v("\n        "+e._s(e.$t("edit"))+"\n      ")]):e._e(),e._v(" "),e.canEditNode||0!==e.nodeDetail.teachingObjectives.length?e._e():n("div",{staticClass:"no-data"},[e._v("\n        "+e._s(e.$t("knowledgeGraph.noTeachingObjective"))+"\n      ")])]),e._v(" "),n("Modal",{attrs:{width:"600",title:e.$t("knowledgeGraph.editTeachingObjective")},model:{value:e.showModal,callback:function(t){e.showModal=t},expression:"showModal"}},[e.showModal?n("TeachingObjectiveSelect",{model:{value:e.teachingObjectivesSelectItems,callback:function(t){e.teachingObjectivesSelectItems=t},expression:"teachingObjectivesSelectItems"}}):e._e(),e._v(" "),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{staticClass:"ok",attrs:{type:"primary"},on:{click:function(){e.confirmAll()}}},[e._v("\n          "+e._s(e.$t("ok"))+"\n        ")]),e._v(" "),n("Button",{on:{click:function(){e.showModal=!1,e.cancelAll()}}},[e._v("\n          "+e._s(e.$t("cancel"))+"\n        ")])],1)],1)]:e._e()],2)}),[],!1,null,"4f04c20d",null).exports,he=(n(323123),n(391737)),me=n(356264),ge=n(202669),ye=(0,i.aZ)({components:{SvgIcon:S.Z},props:{item:{type:Object,required:!0}},setup:function(e,t){var n=t.emit,o=(0,i.Fl)((function(){return!C.yw&&!C.Uz.value&&C.wZ})),r=(0,i.Fl)((function(){return!C.yw&&(C.Uz.value||!C.wZ)}));return{destory:function(){n("delete",e.item)},preview:function(){n("preview",e.item)},knowledgeNode:(0,i.f3)(k.iv),canEditReference:o,canViewCompleteness:r}}}),we=(0,y.Z)(ye,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"item"},[n("div",{staticClass:"image"},[n("SvgIcon",{staticClass:"font",attrs:{name:"capture"}})],1),e._v(" "),n("div",{staticClass:"body"},[n("div",{staticClass:"name"},[n("Tooltip",{attrs:{content:e.item.name,placement:"top"}},[e._v("\n        "+e._s(e.item.name)+"\n      ")])],1),e._v(" "),e.item.deleted?n("div",{staticClass:"deleted"},[e._v(e._s(e.$t("commentAndQuestion.captureDeleted")))]):e._e()]),e._v(" "),n("div",{staticClass:"action"},[n("div",{staticClass:"button-area"},[e.canEditReference&&e.knowledgeNode.edit?n("Tooltip",{attrs:{transfer:"",content:e.$t("delete"),placement:"top"}},[n("i",{staticClass:"font font-delete",on:{click:e.destory}})]):e._e(),e._v(" "),e.item.deleted?e._e():n("Tooltip",{attrs:{transfer:"",content:e.$t("view"),placement:"top"}},[n("i",{staticClass:"font font-resource-view",on:{click:e.preview}})])],1),e._v(" "),e.canViewCompleteness?n("div",{staticClass:"completeness-area",class:e.item.viewed?"bg-green":"bg-orange"},[e.item.viewed?n("span",[e._v(e._s(e.$t("knowledgeGraph.finished")))]):n("span",[e._v(e._s(e.$t("knowledgeGraph.notFinished")))])]):e._e()])])}),[],!1,null,"5744982e",null).exports,be=n(693604),_e=(0,i.aZ)({components:{SvgIcon:S.Z},props:{item:{type:Object,required:!0}},setup:function(e,t){var n=t.emit,o=(0,i.Fl)((function(){return!C.yw&&!C.Uz.value&&C.wZ})),r=(0,i.Fl)((function(){return!C.yw&&(C.Uz.value||!C.wZ)})),a=(0,i.f3)(k.iv);return{fileTypeByExtension:be.fileTypeByExtension,destory:function(){n("delete",e.item)},preview:function(){n("preview",e.item)},knowledgeNode:a,canEditReference:o,canViewCompleteness:r}}}),Ce=(0,y.Z)(_e,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"item"},[n("div",{staticClass:"image"},[n("i",{staticClass:"font upload-icon",class:"font-file-"+e.fileTypeByExtension(e.item)})]),e._v(" "),n("div",{staticClass:"body"},[n("div",{staticClass:"name"},[n("Tooltip",{attrs:{content:e.item.name,placement:"top"}},[e._v("\n        "+e._s(e.item.name)+"\n      ")])],1),e._v(" "),e.item.deleted?n("div",{staticClass:"deleted"},[e._v(e._s(e.$t("commentAndQuestion.fileDeleted")))]):e._e()]),e._v(" "),n("div",{staticClass:"action"},[n("div",{staticClass:"button-area"},[e.canEditReference&&e.knowledgeNode.edit?n("Tooltip",{attrs:{transfer:"",content:e.$t("delete"),placement:"top"}},[n("i",{staticClass:"font font-delete",on:{click:e.destory}})]):e._e(),e._v(" "),e.item.deleted?e._e():n("Tooltip",{attrs:{transfer:"",content:e.$t("view"),placement:"top"}},[n("i",{staticClass:"font font-resource-view",on:{click:e.preview}})])],1),e._v(" "),e.canViewCompleteness?n("div",{staticClass:"completeness-area",class:e.item.viewed?"bg-green":"bg-orange"},[e.item.viewed?n("span",[e._v(e._s(e.$t("knowledgeGraph.finished")))]):n("span",[e._v(e._s(e.$t("knowledgeGraph.notFinished")))])]):e._e()])])}),[],!1,null,"9d4da4d6",null).exports,ke=n(730381),xe=(0,i.aZ)({name:"activity-lock",props:{activity:{type:Object,required:!0}},components:{TooltipExt:x.Z},setup:function(e,t){}}),Se=(0,y.Z)(xe,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Poptip",{staticClass:"activity-lock",attrs:{placement:"right-start",trigger:"hover",width:"370",title:e.$t("h5_courseware.prerequisites")},scopedSlots:e._u([{key:"content",fn:function(){return[n("div",{staticClass:"prerequisites-tips"},e._l(e.activity.prerequisites,(function(t,o){return n("div",{key:o,staticClass:"prerequisite",class:{finished:t.completionCriterion.hasCompleted&&t.completionCriterion.isInProgress,unpublished:!t.completionCriterion.isInProgress}},[n("span",{staticClass:"activity-type"},[e._v(e._s(e.$t("activityType."+t.activityType)))]),e._v(" "),n("div",{staticClass:"truncate-text activity-title"},[n("TooltipExt",{attrs:{text:t.title}})],1),e._v(" "),n("span",{staticClass:"activity-read-info"},[e._v("\n          (\n          "),n("span",[e._v(e._s(t.completionCriterion.completionInfo))]),e._v("\n          )\n        ")]),e._v(" "),n("div",{staticClass:"activity-completion-criterion"},[e._v(e._s(t.completionCriterion.criterionText))]),e._v(" "),n("div",{staticClass:"medium-divider"})])})),0)]},proxy:!0}])},[n("i",{staticClass:"font font-thin-lock"})])}),[],!1,null,"35e9091e",null).exports,Te=n(576201),De=n(48496),Ie=n(383228),Ee=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},Ne=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},$e=(0,i.aZ)({props:{activity:{type:Object,required:!0}},setup:function(e){var t=this,n=(0,i.f3)(k.iv),o=(0,i.Fl)((function(){var t,n;return(null===(n=null===(t=e.activity)||void 0===t?void 0:t.data)||void 0===n?void 0:n.mediaFragments)||[]})),r=(0,i.iH)(!0),a=(0,i.Fl)((function(){return o.value.length>2&&r.value?o.value.slice(0,2):o.value})),l=(0,i.Fl)((function(){return!C.yw&&!C.Uz.value&&C.wZ})),c=(0,i.Fl)((function(){return!C.yw&&(C.Uz.value||!C.wZ)}));return{mediaFragments:o,filterMediaFragments:a,collapsed:r,toggleCollapse:function(){r.value=!r.value},viewFragment:function(t){e.activity.isLocked?((0,he.useAngularScope)().lockedActivity=(0,me.decamelizeKeys)(e.activity),Ie("#prerequisites-confirmation-popup").foundation("reveal","open")):window.open("".concat((0,P.RB)(e.activity),"?startTime=").concat(Math.floor(t.startTs/1e3)),"_blank")},deleteFragmentHandler:function(o){return Ee(t,void 0,void 0,(function(){return Ne(this,(function(t){switch(t.label){case 0:return[4,ge.Z.open({title:s.default.t("delete"),type:"warning",divider:!1,width:416,content:s.default.t("knowledgePoint.deleteConfirm")})];case 1:return t.sent()?[4,(0,_.tA)(e.activity.id,e.activity.data.knowledgeReferenceId,o.chapterId)]:[2];case 2:return t.sent(),De.Toast.success(s.default.t("delete_success")),n.value.fetch(),[2]}}))}))},millisecondToHms:function(e){return Te.Z.millisecondToHms(e)},canEditReference:l,canViewCompleteness:c}}}),Re=(0,y.Z)($e,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"fragments"},[e._l(e.filterMediaFragments,(function(t,o){return n("div",{key:o,staticClass:"fragmemnt-item"},[n("div",{staticClass:"detail"},[n("div",{staticClass:"name"},[e._v(e._s(e.$t("knowledgePoint.mediaFragments")+"："+t.chapterName))]),e._v(" "),n("div",{staticClass:"time"},[n("span",[e._v(e._s(e.millisecondToHms(t.duration)))]),e._v(" "),n("span",{staticClass:"splitLine"}),e._v(" "),n("span",[e._v(e._s(e.millisecondToHms(t.startTs))+" - "+e._s(e.millisecondToHms(t.endTs)))])])]),e._v(" "),n("div",{staticClass:"item-action"},[n("div",{staticClass:"button-area"},[n("Tooltip",{attrs:{transfer:"",content:e.$t("delete"),placement:"top"}},[e.canEditReference?n("span",{on:{click:function(n){return e.deleteFragmentHandler(t)}}},[n("i",{staticClass:"font font-delete"})]):e._e()]),e._v(" "),n("Tooltip",{attrs:{transfer:"",content:e.$t("view"),placement:"top"}},[n("a",{attrs:{target:"_blank"},on:{click:function(n){return e.viewFragment(t)}}},[n("i",{staticClass:"font font-resource-view"})])])],1),e._v(" "),e.canViewCompleteness?n("div",{staticClass:"completeness-area",class:"full"===t.completeness?"bg-green":"bg-orange"},["full"===t.completeness?n("span",[e._v(e._s(e.$t("knowledgeGraph.finished")))]):n("span",[e._v(e._s(e.$t("knowledgeGraph.notFinished")))])]):e._e()])])})),e._v(" "),e.mediaFragments.length>2?n("div",{staticClass:"collapsed",on:{click:e.toggleCollapse}},[e._v("\n    "+e._s(e.collapsed?e.$t("knowledgePoint.fragmentsExpand",[e.mediaFragments.length]):e.$t("problemGraph.collapseAll"))+"\n    "),n("i",{staticClass:"font font-up-arrow",class:{"rotate-180":e.collapsed}})]):e._e()],2)}),[],!1,null,"e8542cea",null).exports,je=(0,i.aZ)({props:{item:{type:Object,required:!0}},components:{activityLock:Se,VideoFragments:Re},setup:function(e){var t=e.item,n=(0,i.Fl)((function(){return["homework","forum","exam"].includes(t.type)})),o=(0,i.Fl)((function(){var e=new Date;if(t.startTime&&"string"==typeof t.startTime&&(t.startTime=Te.Z.toLocalDate(t.startTime)),t.endTime&&"string"==typeof t.endTime&&(t.endTime=Te.Z.toLocalDate(t.endTime)),!t.published)return["unpublished",s.default.t("activityPublish.unpublished")];if(t.published){if(t.startTime>e)return["scheduleNotStart",'<i class="font font-time-clock icon-clock"></i>'.concat(s.default.t("activityPublish.startByDate",[ke(t.startTime).format("MM-DD")]))];if(t.startTime<=e){if(t.endTime&&t.endTime>e)return["scheduleStartAndHasEndTime",'<i class="font font-time-clock icon-clock"></i>'.concat(s.default.t("activityPublish.scheduleStartAndHasEndTime",[ke(t.endTime).format("MM-DD")]))];if(!t.endTime)return!1}if(t.endTime<e)return["activityPublishExpired",s.default.t("activityStatus.expired")]}return!1})),r=(0,i.Fl)((function(){return!C.yw&&(!!C.Uz.value||!C.wZ)})),a=(0,i.Fl)((function(){return!!C.yw||!C.Uz.value&&C.wZ}));return{getActivityGreyIcon:function(e){var t=(0,be.replaceActivityTypeKey)(e.type);return"font-syllabus-".concat(t)},publishStatus:o,isInstructor:C.wZ,hasScore:n,canViewScore:r,canViewPublishStatus:a}}}),Pe=(0,y.Z)(je,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"activity"},[n("div",{staticClass:"item list-item"},[n("div",{staticClass:"image"},[n("i",{staticClass:"font",class:e.getActivityGreyIcon(e.item)})]),e._v(" "),e.item.isLocked?n("activityLock",{staticClass:"activity-prerequisites",attrs:{activity:e.item}}):e._e(),e._v(" "),n("div",{staticClass:"body"},[n("div",{staticClass:"content"},[n("span",{staticClass:"title"},[n("Tooltip",{attrs:{content:e.item.title,placement:"top",transfer:""}},[e._v("\n            "+e._s(e.item.title)+"\n          ")])],1),e._v(" "),e.canViewScore?n("div",{staticClass:"info"},[n("section",[e._v(e._s(e.$t("live.type"))+"："+e._s(e.$t("activityType."+e.item.type)))]),e._v(" "),e.hasScore?n("section",[n("Divider",{attrs:{type:"vertical"}}),e._v(" "),n("span",[e._v(e._s(e.$t("knowledgeGraph.finalScore"))+":")]),e._v(" "),e.item.scorePublished?e._e():n("span",[e._v(e._s(e.$t("knowledgeGraph.scoreUnpublished")))]),e._v(" "),e.item.scorePublished&&null===e.item.score?n("span",[e._v("--")]):e._e(),e._v(" "),e.item.scorePublished&&null!==e.item.score?n("span",[e._v(e._s(e.item.score))]):e._e()],1):e._e()]):e._e()]),e._v(" "),n("div",{staticClass:"other"},[e.canViewPublishStatus&&e.publishStatus?n("span",{staticClass:"publish-status",class:e.publishStatus[0],domProps:{innerHTML:e._s(e.publishStatus[1])}}):n("span"),e._v(" "),e._t("default")],2)])],1),e._v(" "),n("VideoFragments",{attrs:{activity:e.item}})],1)}),[],!1,null,"6f85fbf1",null).exports,Me=(0,i.aZ)({props:{value:Array},components:{ActivityItem:Pe,NoData:T.Z},setup:function(e,t){var n=t.emit,o=(0,a.NCN)(e,"value",n,{passive:!0,deep:!0,eventName:"input"}),r=(0,a.PL)((function(){return(0,_.qF)(C.N7.value.id)}),[],{immediate:!0}).state,s=(0,i.iH)(""),l=(0,i.iH)(void 0);return{filterdItems:(0,i.Fl)((function(){return r.value.filter((function(e){return e.title.includes(s.value)})).filter((function(e){return!l.value||e.type===l.value}))})),keyword:s,activityTypes:["homework","exam","forum","lesson","material","online_video","interaction","web_link","page"],activityType:l,selected:o,activityViewUrl:P.RB}}}),Oe=(0,y.Z)(Me,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"action"},[n("div",[e._v(e._s(e.$t("knowledgeGraph.activityCount",[e.filterdItems.length])))]),e._v(" "),n("div",[n("Select",{staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:e.$t("allType")},model:{value:e.activityType,callback:function(t){e.activityType=t},expression:"activityType"}},e._l(e.activityTypes,(function(t){return n("Option",{key:t,attrs:{value:t}},[e._v(e._s(e.$t("activityType."+t)))])})),1),e._v(" "),n("Input",{staticStyle:{width:"auto"},attrs:{suffix:"ios-search",placeholder:e.$t("enter_keyword")},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}})],1)]),e._v(" "),n("div",{staticClass:"list"},[n("CheckboxGroup",{model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}},e._l(e.filterdItems,(function(t){return n("div",{key:t.type+t.id,staticClass:"select-item"},[n("Checkbox",{attrs:{label:t.dbKey}},[n("span")]),e._v(" "),n("ActivityItem",{staticClass:"item",attrs:{item:t}},[n("a",{staticClass:"view",attrs:{href:e.activityViewUrl(t),target:"_blank"}},[e._v(e._s(e.$t("view")))])])],1)})),0)],1),e._v(" "),0===e.filterdItems.length?n("NoData",{staticClass:"no-data"},[e._v("\n    "+e._s(e.$t("userStudio.noLive"))+"\n  ")]):e._e()],1)}),[],!1,null,"611e5c51",null).exports,Ge=(n(324603),n(339714),n(115306),(0,i.aZ)({components:{TooltipExt:x.Z,SvgIcon:S.Z},props:{item:{type:Object,required:!0},index:{type:Number,default:1}},setup:function(e,t){var n=t.emit,o=(0,i.f3)("course",{id:0,type:0}),r=(0,i.FN)(),a=(0,i.Fl)((function(){return e.item.type.replace(new RegExp("_","g"),"-")})),l=(0,i.Fl)((function(){return e.item instanceof k.rH})),c=(0,i.Fl)((function(){if(!l)return"";var t=e.item.source;return t.isMakeupExam?"".concat(t.name,"(").concat(s.default.t("examActivity.questionType.makeUp"),")"):t.name})),u=(0,i.Fl)((function(){return s.default.t("subjectType.".concat((0,me.camelize)(e.item.type)))})),d=(0,i.Fl)((function(){return!C.yw&&!C.Uz.value&&C.wZ}));return{remove:function(){n("remove-subject",e.item)},preview:function(){n("preview-subject",e.index)},prettyShowSubject:function(e){if(!r)return"";var t=r.proxy.$sanitize;return(0,De.sanitizeDisplaySubjectText)(t,e,s.default)},toSource:function(){l&&window.open(e.item.getSourceUrl(o.id),"_blank")},subjectIcon:a,subjectType:u,knowledgeNode:(0,i.f3)(k.iv),canEditReference:d,sourceText:c,isExamSubject:l}}})),Ae=(0,y.Z)(Ge,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"item"},[n("div",{staticClass:"subject-type"},[n("SvgIcon",{attrs:{name:e.subjectIcon}}),e._v(" "),n("span",[e._v(e._s(e.subjectType))])],1),e._v(" "),n("div",{staticClass:"subject-content"},[n("span",[e._v(e._s(e.prettyShowSubject(e.item.description)))])]),e._v(" "),e.isExamSubject?n("div",{staticClass:"subject-source"},[n("div",{staticClass:"source-label"},[e._v(e._s(e.$t("source"))+":")]),e._v(" "),n("div",{staticClass:"source-value",on:{click:e.toSource}},[n("TooltipExt",{attrs:{text:e.sourceText}})],1),e._v(" "),n("div",{staticClass:"operation-wrapper"},[e.canEditReference&&e.knowledgeNode.edit?n("Tooltip",{attrs:{transfer:"",content:e.$t("delete"),placement:"top"}},[n("i",{staticClass:"font font-delete",on:{click:e.remove}})]):e._e(),e._v(" "),n("Tooltip",{attrs:{transfer:"",content:e.$t("view"),placement:"top"}},[n("i",{staticClass:"font font-resource-view",on:{click:e.preview}})])],1)]):e._e()])}),[],!1,null,"1f5c6695",null).exports,Ze=(n(185827),n(569720),n(426833),n(118539)),He=n(920313),Fe=n(222309),Be=n(932193),ze=n(437110),Le=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},Ue=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},Ve=function(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))},qe=(0,i.aZ)({name:"ReferenceSubjectLib",components:{ReferenceSubject:Ae,CourseLibTree:Ze.Z,NoData:T.Z},props:{type:{type:String,require:!0},value:{type:Array,require:!0}},setup:function(e,t){var n,o,r,a=this,l=null!==(r=null===(o=null===(n=window.globalData)||void 0===n?void 0:n.course)||void 0===o?void 0:o.id)&&void 0!==r?r:0,c=(0,i.iH)("exam"),u=(0,i.iH)("all"),d=(0,i.iH)(""),p=(0,i.iH)([]),f=(0,i.iH)(),v=(0,i.iH)([]),h=(0,i.iH)(!1),m=(0,i.iH)(!1),g=(0,i.iH)(),y=(0,i.iH)([]),w=(0,i.qj)({exam:{},course:{}}),b=((0,i.f3)(k.iv),(0,i.iH)([])),_=(0,i.Fl)((function(){var e,t,n,o,r=[{value:"all",text:s.default.t("subjectType.all")},{value:"single_selection",text:s.default.t("subjectType.singleSelection")},{value:"multiple_selection",text:s.default.t("subjectType.multipleSelection")},{value:"true_or_false",text:s.default.t("subjectType.trueOrFalse")}];return(null===(e=window.featureToggles)||void 0===e?void 0:e.fillInBlankSubject)&&r.push({value:"fill_in_blank",text:s.default.t("subjectType.fillInBlank")}),r.push({value:"short_answer",text:s.default.t("subjectType.shortAnswer")}),(null===(t=window.featureToggles)||void 0===t?void 0:t.analysisSubject)&&r.push({value:"analysis",text:s.default.t("subjectType.analysis")}),(null===(n=window.featureToggles)||void 0===n?void 0:n.matchingSubject)&&r.push({value:"matching",text:s.default.t("subjectType.matching")}),(null===(o=window.featureToggles)||void 0===o?void 0:o.clozeSubject)&&r.push({value:"cloze",text:s.default.t("subjectType.cloze")}),r.push({value:"media",text:s.default.t("subjectType.media")}),r})),C=(0,i.Fl)((function(){return"exam"===e.type?s.default.t("knowledgeGraph.noExam"):s.default.t("knowledgeGraph.noQuestionBank")})),x=(0,i.Fl)((function(){return"course"!==e.type||g.value?s.default.t("knowledgeGraph.noQuestion"):s.default.t("knowledgeGraph.noSelectedLib")})),S=(0,i.Fl)((function(){var t,n;return"exam"===e.type?null===(t=f.value)||void 0===t?void 0:t.title:null===(n=g.value)||void 0===n?void 0:n.title})),T=function(n){"exam"===e.type&&f.value?w[e.type][f.value.id]=Ve([],n,!0):"course"===e.type&&g.value&&(w[e.type][g.value.id]=Ve([],n,!0)),t.emit("updateSelectedSubjectData",w)},D=function(e){var t=f.value?e.filter((function(e){return b.value.includes(e)})):e;0===v.value.length?(h.value=!1,m.value=!1):t.length===v.value.length?(h.value=!1,m.value=!0):t.length>0?(h.value=!0,m.value=!1):(h.value=!1,m.value=!1)},I=function(){var e=[];f.value?e=w.exam[f.value.id]||[]:g.value&&(e=w.course[g.value.id]||[]),y.value=e,D(y.value)},E=function(){c.value="exam",u.value="all",d.value="",I()},N=function(e){return Le(a,void 0,void 0,(function(){var t,n;return Ue(this,(function(o){switch(o.label){case 0:return e?(t="makeup"===c.value,n=v,[4,(0,Be.QU)(e.id,t,d.value,u.value)]):(b.value=[],[2]);case 1:return n.value=o.sent(),b.value=v.value.map((function(e){return e.id})),[2]}}))}))},$=function(e){return Le(a,void 0,void 0,(function(){var t;return Ue(this,(function(n){switch(n.label){case 0:return e?(t=v,[4,(0,ze.yY)(e,d.value,u.value)]):[2];case 1:return t.value=n.sent(),[2]}}))}))},R=(0,i.Fl)((function(){return p.value.length>0||He.RV.value.length>0}));return(0,i.bv)((function(){return Le(a,void 0,void 0,(function(){var t;return Ue(this,(function(n){switch(n.label){case 0:return E(),"exam"!==e.type?[3,4]:(t=p,[4,(0,Be.uW)(l)]);case 1:return t.value=n.sent(),p.value.length>0?(f.value=p.value[0],[4,N(p.value[0])]):[3,3];case 2:n.sent(),n.label=3;case 3:return[3,6];case 4:return[4,(0,He.eI)(l,0,0)];case 5:n.sent(),n.label=6;case 6:return[2]}}))}))})),{examPaperType:c,selectSubjectType:u,keyword:d,exams:p,selectedExam:f,selectedLibNode:g,subjects:v,checkSubjectIds:y,selectedSubjectCache:w,indeterminate:h,checkAll:m,search:function(){return Le(a,void 0,void 0,(function(){var t;return Ue(this,(function(n){switch(n.label){case 0:return"exam"!==e.type?[3,2]:[4,N(f.value)];case 1:return n.sent(),[3,4];case 2:return[4,$(null===(t=g.value)||void 0===t?void 0:t.id)];case 3:n.sent(),n.label=4;case 4:return I(),[2]}}))}))},enabledSubjectTypes:_,noDataMessage:C,noQuestionMessage:x,selectExam:function(e){return Le(a,void 0,void 0,(function(){return Ue(this,(function(t){switch(t.label){case 0:return f.value=e,[4,N(e)];case 1:return t.sent(),I(),[2]}}))}))},viewTitle:S,selectedSubjectChange:function(e){D(e),T(e)},handleCheckAll:function(){h.value=!1;var e=v.value.map((function(e){return e.id}));m.value?y.value=f.value?Ve(Ve([],y.value,!0),e,!0):e:y.value=f.value?y.value.filter((function(t){return!e.includes(t)})):[],T(y.value)},redirect:function(){var t,n,o="";o="exam"===e.type?"/course/".concat(l,"/learning-activity/full-screen#/exam/").concat(null===(t=f.value)||void 0===t?void 0:t.id):"/subject-lib/".concat(null===(n=g.value)||void 0===n?void 0:n.id,"/preview"),window.open(o,"_blank")},treeNodes:He.RV,toggleFolderExpand:function(e){return Le(a,void 0,void 0,(function(){var t;return Ue(this,(function(n){switch(n.label){case 0:return e.expand?[3,2]:[4,(0,Fe.Bz)(l,e.id)];case 1:return t=n.sent(),e.children=De._.map(t,He.oO),[3,3];case 2:e.children=[],n.label=3;case 3:return e.expand=!e.expand,[2]}}))}))},updateSelectedLib:function(e){return Le(a,void 0,void 0,(function(){return Ue(this,(function(t){switch(t.label){case 0:return g.value=e,[4,$(e.id)];case 1:return t.sent(),E(),[2]}}))}))},hasData:R}}}),Ye=(0,y.Z)(qe,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"reference-subject-lib-content"},[e.hasData?n("div",{staticClass:"content"},[n("div",{staticClass:"left"},["exam"===e.type?n("div",{staticClass:"exam-items-wrapper"},e._l(e.exams,(function(t){return n("div",{key:t.id,class:{"exam-item":!0,selected:e.selectedExam&&e.selectedExam.id===t.id},on:{click:function(n){return e.selectExam(t)}}},[n("i",{staticClass:"font font-syllabus-exam"}),e._v(" "),n("div",{staticClass:"title"},[n("Tooltip",{directives:[{name:"ellipsis",rawName:"v-ellipsis"}],attrs:{content:t.title,transfer:"",placement:"top"}},[n("span",[e._v(e._s(t.title))])])],1)])})),0):n("div",{staticClass:"course-subject-lib-tree"},[n("course-lib-tree",{attrs:{"tree-nodes":e.treeNodes},on:{toggleFolderExpand:e.toggleFolderExpand,updateSelectedLib:e.updateSelectedLib}})],1)]),e._v(" "),n("div",{staticClass:"right"},[e.selectedExam||e.selectedLibNode?n("div",{staticClass:"top"},[n("div",{staticClass:"title"},[n("Tooltip",{directives:[{name:"ellipsis",rawName:"v-ellipsis"}],attrs:{content:e.viewTitle,transfer:"",placement:"top"}},[n("span",[e._v(e._s(e.viewTitle))])]),e._v(" "),n("Tooltip",{attrs:{content:e.$t("view"),transfer:"",placement:"top"}},[e.viewTitle?n("i",{staticClass:"font font-view-new",on:{click:e.redirect}}):e._e()])],1),e._v(" "),n("div",{staticClass:"filters"},[n("div",{staticClass:"checkbox-wrapper"},[n("Checkbox",{attrs:{indeterminate:e.indeterminate},on:{"on-change":e.handleCheckAll},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[n("span",{staticClass:"checkbox-tip"},[e._v(e._s(e.$t("knowledgeGraph.numOfQuestion",[e.subjects.length])))])])],1),e._v(" "),n("div",{staticClass:"condition"},["exam"===e.type?n("Select",{staticStyle:{width:"160px"},on:{"on-change":e.search},model:{value:e.examPaperType,callback:function(t){e.examPaperType=t},expression:"examPaperType"}},[n("Option",{attrs:{value:"exam"}},[e._v(e._s(e.$t("examActivity.questionType.exam")))]),e._v(" "),n("Option",{attrs:{value:"makeup"}},[e._v(e._s(e.$t("examActivity.questionType.makeUp")))])],1):e._e(),e._v(" "),n("Select",{staticStyle:{width:"160px"},on:{"on-change":e.search},model:{value:e.selectSubjectType,callback:function(t){e.selectSubjectType=t},expression:"selectSubjectType"}},e._l(e.enabledSubjectTypes,(function(t){return n("Option",{key:t.value,attrs:{value:t.value}},[e._v("\n                "+e._s(t.text)+"\n              ")])})),1),e._v(" "),n("Input",{attrs:{search:"",placeholder:e.$t("enter_keyword")},on:{"on-search":e.search},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}})],1)])]):e._e(),e._v(" "),n("div",{staticClass:"subject-list"},[e.subjects.length>0?n("div",{staticClass:"subject-wrapper"},[n("CheckboxGroup",{staticClass:"subject-item",on:{"on-change":e.selectedSubjectChange},model:{value:e.checkSubjectIds,callback:function(t){e.checkSubjectIds=t},expression:"checkSubjectIds"}},e._l(e.subjects,(function(e,t){return n("Checkbox",{key:e.id,attrs:{label:e.id}},[n("ReferenceSubject",{staticClass:"reference-subject",attrs:{item:e,index:t}})],1)})),1)],1):n("NoData",[e._v(e._s(e.noQuestionMessage))])],1)])]):n("NoData",[e._v(e._s(e.noDataMessage))])],1)}),[],!1,null,"158d36b1",null).exports,Ke=function(){return(Ke=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},We=(0,i.aZ)({name:"ReferenceSubjectModal",components:{ReferenceSubjectLib:Ye},props:{value:{type:Boolean,default:!1}},setup:function(e,t){var n=t.emit,o=(0,a.NCN)(e,"value",n,{eventName:"input"}),r=(0,i.iH)("exam-activity"),s=(0,i.iH)({}),l=(0,i.iH)({}),c=(0,i.Fl)((function(){return Object.values(s.value).reduce((function(e,t){return e+t.length}),0)+Object.values(l.value).reduce((function(e,t){return e+t.length}),0)})),u=(0,i.Fl)((function(){return window.featureToggles.enableCourseSubjectLib}));return{show:o,activeTab:r,onVisibleChange:function(e){e||(s.value={},l.value={},n("on-close"))},save:function(){var e=[];Object.entries(s.value).forEach((function(t){var n=t[0],o=t[1];e.push({parentType:"exam_activity",parentId:n,subjectIds:o})})),Object.entries(l.value).forEach((function(t){var n=t[0],o=t[1];e.push({parentType:"subject_lib",parentId:n,subjectIds:o})})),n("on-ok",e)},close:function(){o.value=!1,r.value="exam-activity"},enableCourseSubjectLib:u,selectedSubjectCount:c,updateExamSelectedSubjects:function(e){s.value=Ke({},e.exam)},updateLibSelectedSubjects:function(e){l.value=Ke({},e.course)}}}}),Je=(0,y.Z)(We,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Modal",{staticClass:"reference-subject-modal",attrs:{title:e.$t("knowledgeGraph.referenceSubject"),width:"1000"},on:{"on-visible-change":e.onVisibleChange},scopedSlots:e._u([{key:"footer",fn:function(){return[n("Button",{on:{click:e.close}},[e._v(e._s(e.$t("cancel")))]),e._v(" "),n("Button",{staticClass:"ok",attrs:{disabled:0===e.selectedSubjectCount,type:"primary"},on:{click:e.save}},[e._v("\n      "+e._s(e.$t("ok"))+"\n    ")]),e._v("\n    "+e._s(e.$t("knowledgeGraph.questionSelectedTip",[e.selectedSubjectCount]))+"\n  ")]},proxy:!0}]),model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[n("Tabs",{staticClass:"tabs",attrs:{name:"subject-tab",animated:!1},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[n("TabPane",{attrs:{label:e.$t("activityType.exam"),name:"exam-activity",tab:"subject-tab"}},[e.show?n("ReferenceSubjectLib",{attrs:{type:"exam"},on:{updateSelectedSubjectData:e.updateExamSelectedSubjects}}):e._e()],1),e._v(" "),e.enableCourseSubjectLib?n("TabPane",{attrs:{label:e.$t("subjectLib.course"),name:"course-subject-lib",tab:"subject-tab"}},[e.show?n("ReferenceSubjectLib",{attrs:{type:"course"},on:{updateSelectedSubjectData:e.updateLibSelectedSubjects}}):e._e()],1):e._e()],1)],1)}),[],!1,null,"7d1aa02b",null).exports,Xe=(n(470189),n(947475)),Qe=n(953115),et=n(383228),tt=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},nt=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},ot=(0,i.aZ)({name:"CaptureList",components:{DatePickerExt:Qe.Z,SvgIcon:S.Z,TooltipExt:x.Z},props:{tabName:{type:String,default:"mine"},associatedIds:{type:Array,default:function(){return[]}}},emits:["on-selection-change"],setup:function(e,t){var n=this,o=t.emit,r=(0,i.iH)(),a=(0,i.Fl)((function(){return new Set(e.associatedIds)})),c=(0,i.qj)({}),u=(0,i.iH)(!1),d=(0,i.qj)({timerange:[],keyword:""}),p=(0,l.h0)((function(t,o){return void 0===t&&(t=1),void 0===o&&(o=10),tt(n,void 0,void 0,(function(){var n;return nt(this,(function(r){switch(r.label){case 0:return"mine"===e.tabName?[4,(0,_.O)(t,o,d)]:[3,2];case 1:return n=r.sent(),[3,4];case 2:return[4,(0,_.$p)(t,o,d)];case 3:n=r.sent(),r.label=4;case 4:return n.items.forEach((function(e){var t=a.value.has(e.id);e._checked=t||Boolean(c[e.id]),e._disabled=t})),u.value=n.items.length>0&&n.items.every((function(e){return e._checked})),[2,n]}}))}))})),f={shortcuts:[{text:s.default.t("filter.range.week"),value:function(){return[ke().subtract(6,"days").startOf("day").toDate(),ke().endOf("day").toDate()]}},{text:s.default.t("filter.range.month"),value:function(){return[ke().subtract(29,"days").startOf("day").toDate(),ke().endOf("day").toDate()]}},{text:s.default.t("filter.range.year"),value:function(){return[ke().subtract(1,"years").startOf("day").toDate(),ke().endOf("day").toDate()]}}]};return(0,i.YP)((function(){return e.tabName}),(function(){return p.fetch(1)}),{immediate:!0}),(0,Xe.oh)(d,(function(){return p.fetch(1)}),{debounce:300}),{selection:r,columns:[{type:"selection",width:30,align:"center"},{title:"Name",key:"name",slot:"name"}],page:p,onSelectionChange:function(e){u.value=p.data.items.length>0&&e.length===p.data.items.length,e.filter((function(e){return!e._disabled})).forEach((function(e){c[e.id]=e})),o("on-selection-change",Object.values(c))},selectAll:u,toggleSelectAll:function(){u.value?p.data.items.forEach((function(e){e._disabled||(e._checked=!0,c[e.id]=e)})):p.data.items.forEach((function(e){e._disabled||(e._checked=!1),delete c[e.id]})),o("on-selection-change",Object.values(c))},conditions:d,getTime:function(e){if(!e.schedule)return"--";var t=e.schedule,n=De.TimeUtils.toYmd(t.startTime),o="".concat(De.TimeUtils.toHm(t.startTime)," - ").concat(De.TimeUtils.toHm(t.endTime)),r=De.TimeUtils.toLocalDate(t.startTime).getDay()||7,i=s.default.t("weekly.".concat(r));return"".concat(n," ").concat(i," ").concat(o)},getCourseTip:function(e){if(!e.schedule)return"--";var t=e.schedule.course;return t?"".concat(t.name,"(").concat(t.code,")"):"--"},selectedCaptureIdMap:c,selectRow:function(e){e._disabled||p.data.items.filter((function(t){return t.id===e.id})).forEach((function(e){e._checked=!e._checked,e._checked?c[e.id]=e:delete c[e.id],u.value=p.data.items.length>0&&p.data.items.every((function(e){return e._checked})),o("on-selection-change",Object.values(c))}))},previewCapture:function(e){document.fullscreenElement&&document.exitFullscreen();var t=(0,he.useAngularScope)();e.type="capture",t.$broadcast("previewFiles",[e],e),et("#file-previewer").foundation("reveal","open")},datePickerOptions:f}}}),rt=(0,y.Z)(ot,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"capture-list"},[n("div",{staticClass:"capture-filter-area"},[n("div",{staticClass:"left-area"},[n("Checkbox",{on:{"on-change":e.toggleSelectAll},model:{value:e.selectAll,callback:function(t){e.selectAll=t},expression:"selectAll"}},[e._v("\n        "+e._s(e.$t("knowledgeGraph.captureCountTip",[e.page.data.total]))+"\n      ")])],1),e._v(" "),n("div",{staticClass:"right-area"},[n("div",[e._v(e._s(e.$t("knowledgeGraph.date")))]),e._v(" "),n("DatePickerExt",{staticStyle:{width:"240px"},attrs:{type:"datetimerange",options:e.datePickerOptions,placement:"bottom-end",format:"yyyy-MM-dd",placeholder:e.$t("knowledgeGraph.startTime")+"  -  "+e.$t("knowledgeGraph.endTime")},model:{value:e.conditions.timerange,callback:function(t){e.$set(e.conditions,"timerange",t)},expression:"conditions.timerange"}}),e._v(" "),n("Input",{staticStyle:{width:"200px"},attrs:{placeholder:e.$t("knowledgeGraph.courseNewName")+" / "+e.$t("knowledgeGraph.captureName"),clearable:""},model:{value:e.conditions.keyword,callback:function(t){e.$set(e.conditions,"keyword",t)},expression:"conditions.keyword"}},[n("Icon",{attrs:{slot:"suffix",type:"ios-search"},slot:"suffix"})],1)],1)]),e._v(" "),n("Table",{ref:"selection",attrs:{"show-header":!1,columns:e.columns,data:e.page.data.items,height:384},on:{"on-selection-change":e.onSelectionChange},scopedSlots:e._u([{key:"name",fn:function(t){var o=t.row;return[n("div",{staticClass:"name-column",on:{click:function(t){return t.stopPropagation(),e.selectRow(o)}}},[n("div",{staticClass:"svg-area"},[n("SvgIcon",{staticClass:"font",attrs:{name:"capture"}})],1),e._v(" "),n("div",{staticClass:"name-area"},[n("div",{staticClass:"capture-title"},[n("TooltipExt",{attrs:{text:o.name}})],1),e._v(" "),n("div",{staticClass:"more-info"},[n("div",[e._v("\n              "+e._s(e.$t("course"))+"：\n              "),n("TooltipExt",{attrs:{text:e.getCourseTip(o)}})],1),e._v(" "),n("div",[e._v(e._s(e.$t("knowledgeGraph.time"))+"："+e._s(e.getTime(o)))])])]),e._v(" "),n("div",{staticClass:"button-area",on:{click:function(t){return t.stopPropagation(),e.previewCapture(o)}}},[n("Tooltip",{attrs:{placement:"top",content:e.$t("view"),transfer:""}},[n("SvgIcon",{staticClass:"operate-icon",attrs:{name:"preview-open"}})],1)],1)])]}}])}),e._v(" "),n("div",{staticClass:"pagination-area"},[n("Page",{directives:[{name:"show",rawName:"v-show",value:e.page.data.total>0,expression:"page.data.total > 0"}],attrs:{total:e.page.data.total,"page-size":e.page.data.pageSize,current:e.page.data.page,"page-size-opts":[10,20,30,40],"show-elevator":""},on:{"on-change":e.page.pageChanged,"on-page-size-change":e.page.pageSizeChanged}})],1)],1)}),[],!1,null,"3e0dfea9",null).exports,it=(0,i.aZ)({name:"ReferenceCaptureModal",components:{CaptureList:rt},props:{value:{type:Boolean,default:!1},associatedIds:{type:Array,default:function(){return[]}}},emits:["on-ok"],setup:function(e,t){var n=t.emit,o=(0,a.NCN)(e,"value",n,{eventName:"input"}),r=(0,i.iH)("mine"),s=(0,i.iH)([]),l=(0,i.iH)([]),c=(0,i.Fl)((function(){return s.value.length+l.value.length}));return{show:o,activeTab:r,onVisibleChange:function(e){e||(s.value=[],l.value=[],r.value="mine")},save:function(){var e=[];s.value.forEach((function(t){e.push({referType:"capture",referId:t.id})})),l.value.forEach((function(t){e.push({referType:"capture",referId:t.id})})),n("on-ok",e),o.value=!1},close:function(){o.value=!1},selectedCaptureCount:c,updateSelectedMyCaptures:function(e){s.value=e},updateSelectedOtherCaptures:function(e){l.value=e}}}}),at=(0,y.Z)(it,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Modal",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],staticClass:"reference-capture-modal",attrs:{"class-name":"vertical-center-modal","mask-closable":!1,"z-index":100,title:e.$t("knowledgeGraph.referenceCapture"),width:"900"},on:{"on-visible-change":e.onVisibleChange},scopedSlots:e._u([{key:"footer",fn:function(){return[n("Button",{on:{click:e.close}},[e._v(e._s(e.$t("cancel")))]),e._v(" "),n("Button",{staticClass:"ok",attrs:{disabled:0===e.selectedCaptureCount,type:"primary"},on:{click:e.save}},[e._v("\n      "+e._s(e.$t("ok"))+"\n    ")]),e._v("\n    "+e._s(e.$t("knowledgeGraph.captureSelectedTip",[e.selectedCaptureCount]))+"\n  ")]},proxy:!0}]),model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[e.show?n("Tabs",{staticClass:"tabs",attrs:{name:"capture-tab",animated:!1},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[n("TabPane",{attrs:{label:e.$t("knowledgeGraph.myCapture"),name:"mine"}},[n("CaptureList",{attrs:{"tab-name":"mine","associated-ids":e.associatedIds},on:{"on-selection-change":e.updateSelectedMyCaptures}})],1),e._v(" "),n("TabPane",{attrs:{label:e.$t("knowledgeGraph.publicCapture"),name:"other"}},[n("CaptureList",{attrs:{"tab-name":"other","associated-ids":e.associatedIds},on:{"on-selection-change":e.updateSelectedOtherCaptures}})],1)],1):e._e()],1)}),[],!1,null,"044239b3",null).exports,st=(0,i.aZ)({components:{SvgIcon:S.Z},props:{item:{type:Object,required:!0}},setup:function(e,t){var n=t.emit;return{preview:function(){n("preview",e.item)},canViewCompleteness:(0,i.Fl)((function(){return!C.yw&&(C.Uz.value||!C.wZ)}))}}}),lt=(0,y.Z)(st,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"item"},[n("div",{staticClass:"image"},[n("SvgIcon",{staticClass:"file-icon",attrs:{name:"icon-"+e.item.type}})],1),e._v(" "),n("div",{staticClass:"body"},[n("div",{staticClass:"name"},[n("Tooltip",{attrs:{content:e.item.title,placement:"top"}},[e._v("\n        "+e._s(e.item.title)+"\n      ")])],1)]),e._v(" "),n("div",{staticClass:"action"},[n("div",{staticClass:"button-area"},[n("Tooltip",{attrs:{transfer:"",content:e.$t("view"),placement:"top"}},[n("i",{staticClass:"font font-resource-view",on:{click:e.preview}})])],1)])])}),[],!1,null,"1cf0400d",null).exports,ct=n(383228),ut=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},dt=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},pt=(0,i.aZ)({components:{Subject:Ae,ReferenceUpload:Ce,NoData:T.Z,ActivitySelect:Oe,ActivityItem:Pe,ChinamCloudResource:lt,ReferenceSubjectModal:Je,ReferenceCapture:we,ReferenceCaptureModal:at},props:{node:{type:Object,required:!0}},setup:function(e){var t=this,n=e.node,o=(0,i.f3)(k.iv);(0,a.ORN)(window,"filesSelected",(function(e){return ut(t,void 0,void 0,(function(){return dt(this,(function(t){switch(t.label){case 0:return[4,(0,_.JS)(n.id,e.detail.map((function(e){return{referId:e.resource_reference_id?e.resource_reference_id:e.id,referType:e.resource_reference_id?"resource_reference":"upload"}})))];case 1:return t.sent(),o.value.fetch(),[2]}}))}))})),(0,i.m0)((function(){n.data&&(n.data.resourceRefCount=o.value.knowledgeNodeDetail.uploads.length,n.data.activityRefCount=o.value.knowledgeNodeDetail.activities.length,n.data.captureRefCount=o.value.knowledgeNodeDetail.captures.length,n.data.subjectRefCount=o.value.knowledgeNodeDetail.subjects.length)}));var r,l,c=(0,i.iH)("upload"),u=(0,i.iH)(!1),d=(0,i.iH)(!1),p=(0,i.iH)(!1),f=function(e){return String.fromCharCode(65+e%26)},v=(0,i.iH)(0),h=(0,i.Fl)((function(){return o.value.knowledgeNodeDetail.subjects[v.value]})),m=function(e){return["single_selection","multiple_selection","true_or_false"].includes(e)},g=function(){var e=h.value,t=(0,me.decamelizeKeys)(e);return t.is_objective=m(e.type),t.index=v.value,t.show_note=C.wZ,t.source_text=t.source.is_makeup_exam?"".concat(t.source.name,"(").concat(s.default.t("examActivity.questionType.makeUp"),")"):t.source.name,t.sub_subjects&&t.sub_subjects.forEach((function(e){e.show_answer=t.show_answer,e.show_explanation=t.show_explanation,e.is_objective=m(e.type),e.type_str=s.default.t("subjectType.".concat((0,me.camelize)(e.type))),e.difficulty_label="".concat(s.default.t("subject.difficultyLevel"),": ").concat(s.default.t("difficultyLevel.".concat(e.difficulty_level))),"matching"===e.type&&(e.shuffile_sub_subjects=(0,ee.shuffle)(e.sub_subjects))})),"matching"===t.type&&(t.shuffile_sub_subjects=(0,ee.shuffle)(t.sub_subjects)),t.type_str=s.default.t("subjectType.".concat((0,me.camelize)(e.type))),t.source_url=e.getSourceUrl(C.N7.value.id),t.difficulty_label="".concat(s.default.t("subject.difficultyLevel"),": ").concat(s.default.t("difficultyLevel.".concat(t.difficulty_level))),t},y=(0,i.Fl)((function(){return 0===v.value})),w=(0,i.Fl)((function(){return v.value===o.value.knowledgeNodeDetail.subjects.length-1})),b=(0,i.iH)(!0),x=(0,i.Fl)((function(){var e=[],t=[],n=[];return o.value.knowledgeNodeDetail.externalResources.forEach((function(o){"ppt"===o.type?e.push(o):"video"===o.type?n.push(o):t.push(o)})),{ppts:e,files:t,videos:n}}));(0,i.bv)((function(){var e=document.querySelector("#file-previewer");if(!C.wZ&&e){var t=(0,he.useAngularScope)(e);r=t.$on("previewFile",(function(e,t){o.value.knowledgeNodeDetail.id&&("capture"===t.type?(0,_.rR)(o.value.knowledgeNodeDetail.courseId,o.value.knowledgeNodeDetail.id,t.id,t.code):(0,_.LX)(o.value.knowledgeNodeDetail.courseId,o.value.knowledgeNodeDetail.id,t.id,t.type))})),l=t.$on("previewFileCloseEvent",(function(){o.value.fetch()}))}})),(0,i.Jd)((function(){r&&r(),l&&l()}));var S=(0,i.Fl)((function(){return o.value.knowledgeNodeDetail.activities.map((function(e){return e.dbKey}))})),T=(0,i.iH)([]),D=function(e){return e.map((function(e){var t=e.split(":"),n=t[0];return{referId:t[1],referType:n}}))},I=(0,i.Fl)((function(){return!C.yw&&!C.Uz.value&&(C.wZ&&"external_resource"!==c.value)})),E=(0,i.Fl)((function(){return!C.yw&&(C.Uz.value||!C.wZ)})),N=(0,i.Fl)((function(){return o.value.knowledgeNodeDetail.captures.map((function(e){return e.id}))})),$=(0,i.Fl)((function(){return o.value.knowledgeNodeDetail?o.value.knowledgeNodeDetail.captures.map((function(e){return e.id})):[]})),R=(0,i.Fl)((function(){return o.value.knowledgeNodeDetail.uploads.length})),j=(0,i.Fl)((function(){return[{label:"upload",name:s.default.t("knowledgeGraph.referenceResource"),count:R.value,enabled:!0},{label:"external_resource",name:s.default.t("knowledgeGraph.chinamCloudResource"),count:o.value.knowledgeNodeDetail.externalResources.length,enabled:C.dT},{label:"capture",name:s.default.t("knowledgeGraph.referenceCapture"),count:o.value.knowledgeNodeDetail.captures.length,enabled:C.q},{label:"subject",name:s.default.t("knowledgeGraph.referenceSubject"),count:o.value.knowledgeNodeDetail.subjects.length,enabled:!0},{label:"activity",name:s.default.t("knowledgeGraph.referenceActivity"),count:o.value.knowledgeNodeDetail.activities.length,enabled:!0}].filter((function(e){return e.enabled}))})),M=(0,i.iH)(null),O=(0,i.iH)(null),G=(0,a.h4X)(M).width,A=(0,a.h4X)(O,{width:0,height:0}).width,Z=function(e){var t=document.createElement("span");t.style.visibility="hidden",t.style.position="absolute",t.id="fengkuang",t.style.whiteSpace="nowrap",t.style.font="500 13px sans-serif",t.textContent="".concat(e.name,"(").concat(e.count,")"),document.body.appendChild(t);var n=t.offsetWidth;return document.body.removeChild(t),n+22},H=(0,i.Fl)((function(){return G.value-A.value-60})),F=(0,i.Fl)((function(){for(var e=[],t=0,n=0,o=j.value;n<o.length;n++){var r=o[n],i=Z(r);if(!(t+i<=H.value))break;e.push(r),t+=i}return e})),B=(0,i.Fl)((function(){return j.value.slice(F.value.length)}));return{add:function(){if("upload"===c.value){var e=(0,he.useAngularService)("fileSelectModel"),t=(0,ee.map)(o.value.knowledgeNodeDetail.uploads,(function(e){return e.id}));e.nodeId=n.id,e.selectedIds=t,e.disabledIds=t,e.limitTypes=["file","document","video","image","audio","scorm","swf","wmpkg","link","evercam"],ct("#file-select").foundation("reveal","open")}else"activity"===c.value?(u.value=!0,T.value=(0,ee.cloneDeep)(S.value)):"subject"===c.value?p.value=!0:"capture"===c.value&&(d.value=!0)},type:c,knowledgeNode:o,deleteUpload:function(e){return ut(t,void 0,void 0,(function(){return dt(this,(function(t){switch(t.label){case 0:return[4,ge.Z.open({title:s.default.t("delete"),divider:!1,type:"warning",width:416,content:s.default.t("knowledgeGraph.deleteResourceReferenceConfirm")})];case 1:return t.sent()?[4,(0,_.VJ)(n.id,[{referType:e.resourceReferenceId?"resource_reference":"upload",referId:e.resourceReferenceId?e.resourceReferenceId:e.id}])]:[2];case 2:return t.sent(),o.value.fetch(),[2]}}))}))},preview:function(e){document.fullscreenElement&&document.exitFullscreen(),(0,he.useAngularScope)().$broadcast("previewFiles",o.value.knowledgeNodeDetail.uploads,e),ct("#file-previewer").foundation("reveal","open")},showModal:u,showReferenceSubjectModal:p,selectedActivities:S,confirmActivities:function(){return ut(t,void 0,void 0,(function(){var e,t;return dt(this,(function(r){switch(r.label){case 0:return(e=(0,ee.difference)(T.value,S.value)).length?[4,(0,_.JS)(n.id,D(e))]:[3,2];case 1:r.sent(),r.label=2;case 2:return(t=(0,ee.difference)(S.value,T.value)).length?[4,(0,_.VJ)(n.id,D(t))]:[3,4];case 3:r.sent(),r.label=4;case 4:return o.value.fetch(),[2]}}))}))},tmpSelectedActivities:T,cancelActivities:function(){return ut(t,void 0,void 0,(function(){return dt(this,(function(e){return T.value=(0,ee.cloneDeep)(S.value),[2]}))}))},deleteActivity:function(e){return ut(t,void 0,void 0,(function(){var t;return dt(this,(function(r){switch(r.label){case 0:return[4,ge.Z.open({title:s.default.t("delete"),type:"warning",divider:!1,width:416,content:s.default.t("knowledgeGraph.deleteActivityReferenceConfirm")})];case 1:return r.sent()?(t="".concat("exam"===e.type?"exam_activity":"learning_activity",":").concat(e.id),[4,(0,_.VJ)(n.id,D([t]))]):[2];case 2:return r.sent(),o.value.fetch(),[2]}}))}))},viewActivity:function(e){e.isLocked?((0,he.useAngularScope)().lockedActivity=(0,me.decamelizeKeys)(e),ct("#prerequisites-confirmation-popup").foundation("reveal","open")):window.open((0,P.RB)(e),"_blank")},activityViewUrl:P.RB,canEditReference:I,canViewCompleteness:E,viewCompletenessWithoutMediaFragments:function(e){var t,n;return!(null===(n=null===(t=e.data)||void 0===t?void 0:t.mediaFragments)||void 0===n?void 0:n.length)},previewSubject:function(e){document.fullscreenElement&&document.exitFullscreen(),v.value=e;var t=document.querySelector("#subject-detail-popup"),n=(0,he.useAngularScope)(t);n.subject=g(),n.showSource=!0,n.optionIdxToChar=f,n.disabledPrev=y.value,n.disabledNext=w.value,n.course_id=C.N7.value.id,n.clickCheckbox=function(e){return e.preventDefault()},n.inSubmission=!0,n.prev=function(){v.value>0&&(v.value-=1,n.subject=g(),n.disabledPrev=y.value,n.disabledNext=w.value)},n.next=function(){v.value<o.value.knowledgeNodeDetail.subjects.length-1&&(v.value+=1,n.subject=g(),n.disabledPrev=y.value,n.disabledNext=w.value)},n.getSubIndex=function(e){return(n.subject.sub_subjects||[]).filter((function(e){return"paragraph_desc"!==e.type})).findIndex((function(t){return t.id===e}))},n.close=function(){ct("#subject-detail-popup").foundation("reveal","close")},b.value&&(b.value=!1,ct("#subject-detail-popup").foundation("reveal","open"),n.close()),ct("#subject-detail-popup").foundation("reveal","open")},deleteSubject:function(e){return ut(t,void 0,void 0,(function(){return dt(this,(function(t){switch(t.label){case 0:return[4,ge.Z.open({title:s.default.t("delete"),divider:!1,type:"warning",width:416,content:s.default.t("knowledgeGraph.deleteSubjectReferenceConfirm")})];case 1:return t.sent()?[4,(0,_.VJ)(n.id,[{referType:"subject",referId:e.id}])]:[2];case 2:return t.sent(),o.value.fetch(),[2]}}))}))},updateNodeSubjectRef:function(e){return ut(t,void 0,void 0,(function(){var t;return dt(this,(function(r){switch(r.label){case 0:return t=[],e.forEach((function(e){e.subjectIds.forEach((function(n){t.push({referId:n,referType:"subject",parentId:e.parentId,parentType:e.parentType})}))})),[4,(0,_.JS)(n.id,t)];case 1:return r.sent(),o.value.fetch(),p.value=!1,[2]}}))}))},enableKnowledgeReferenceCapture:C.q,getFileIcon:function(e){return"font-file-".concat(e)},relatedResourceCount:R,containerEl:M,addBtnEl:O,visibleTabs:F,dropdownTabs:B,handleDropdownClick:function(e){c.value=e},showCaptureModal:d,previewCapture:function(e){document.fullscreenElement&&document.exitFullscreen();var t=(0,he.useAngularScope)();o.value.knowledgeNodeDetail.captures.forEach((function(e){e.type="capture"})),t.$broadcast("previewFiles",o.value.knowledgeNodeDetail.captures,e),ct("#file-previewer").foundation("reveal","open")},associatedCaptureIds:$,updateNodeCaptureRef:function(e){return ut(t,void 0,void 0,(function(){var t;return dt(this,(function(r){switch(r.label){case 0:return(t=(0,ee.difference)(e.map((function(e){return e.referId})),N.value)).length?[4,(0,_.JS)(n.id,t.map((function(e){return{referId:e,referType:"capture"}})))]:[3,2];case 1:r.sent(),r.label=2;case 2:return o.value.fetch(),[2]}}))}))},deleteCapture:function(e){return ut(t,void 0,void 0,(function(){return dt(this,(function(t){switch(t.label){case 0:return[4,ge.Z.open({title:s.default.t("delete"),divider:!1,type:"warning",width:416,content:s.default.t("knowledgeGraph.deleteCaptureReferenceConfirm")})];case 1:return t.sent()?[4,(0,_.VJ)(n.id,[{referType:"capture",referId:e.id}])]:[2];case 2:return t.sent(),o.value.fetch(),[2]}}))}))},groupedExternalResources:x,previewExternalResource:function(e){return ut(t,void 0,void 0,(function(){var t;return dt(this,(function(n){switch(n.label){case 0:return[4,(0,_.o6)(C.N7.value.id,e.id)];case 1:return(t=n.sent())&&window.open(t,"_blank"),[2]}}))}))},enableKnowledgeExternalResource:C.dT}}}),ft=(0,y.Z)(pt,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.knowledgeNode.knowledgeNodeDetail?n("div",{ref:"containerEl",staticClass:"container"},[n("div",{ref:"actionEl",staticClass:"action"},[n("RadioGroup",{staticClass:"types",model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},[e._l(e.visibleTabs,(function(t){return n("Radio",{key:t.label,attrs:{label:t.label}},[n("span",{staticClass:"tab-name"},[e._v(e._s(t.name))]),e._v(" "),n("span",{staticClass:"tab-count"},[e._v(e._s("("+t.count+")"))])])})),e._v(" "),e.dropdownTabs.length>0?n("Dropdown",{on:{"on-click":e.handleDropdownClick}},[n("div",{staticClass:"dropdown-btn",class:{selected:e.dropdownTabs.map((function(e){return e.label})).includes(e.type)}},[n("span",{staticClass:"text"},[e._v(e._s(e.$t("more")))]),e._v(" "),n("SvgIcon",{staticClass:"dropdown-icon",attrs:{name:"arrow-down"}})],1),e._v(" "),n("DropdownMenu",{attrs:{slot:"list"},slot:"list"},e._l(e.dropdownTabs,(function(t){return n("DropdownItem",{key:t.label,attrs:{name:t.label,selected:e.type===t.label}},[e._v("\n            "+e._s(t.name)+"("+e._s(t.count)+")\n          ")])})),1)],1):e._e()],2),e._v(" "),e.canEditReference&&e.knowledgeNode.edit?n("Button",{ref:"addBtnEl",staticClass:"add",attrs:{type:"primary",size:"small"},on:{click:e.add}},[n("i",{staticClass:"font font-add-new-elem"}),e._v("\n      "+e._s(e.$t("add"))+"\n    ")]):e._e()],1),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"upload"===e.type,expression:"type === 'upload'"}],staticClass:"list"},[e._l(e.knowledgeNode.knowledgeNodeDetail.uploads,(function(t){return n("ReferenceUpload",{key:t.id,staticClass:"list-item",attrs:{item:t},on:{delete:e.deleteUpload,preview:e.preview}})})),e._v(" "),0===e.knowledgeNode.knowledgeNodeDetail.uploads.length?n("NoData",{staticClass:"no-data"},[e._v("\n      "+e._s(e.$t("knowledgeGraph.noReferenceResource"))+"\n    ")]):e._e()],2),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"external_resource"===e.type&&e.enableKnowledgeExternalResource,expression:"type === 'external_resource' && enableKnowledgeExternalResource"}],staticClass:"list external-resource-group-wrap"},[e.groupedExternalResources.files.length>0?n("div",{staticClass:"group-item"},[n("span",{staticClass:"group-name"},[e._v(e._s(e.$t("h5_courseware.file")))]),e._v(" "),e._l(e.groupedExternalResources.files,(function(t){return n("ChinamCloudResource",{key:t.id,staticClass:"list-item",attrs:{item:t},on:{preview:e.previewExternalResource}})}))],2):e._e(),e._v(" "),e.groupedExternalResources.ppts.length>0?n("div",{staticClass:"group-item"},[n("span",{staticClass:"group-name"},[e._v("PPT")]),e._v(" "),e._l(e.groupedExternalResources.ppts,(function(t){return n("ChinamCloudResource",{key:t.id,staticClass:"list-item",attrs:{item:t},on:{preview:e.previewExternalResource}})}))],2):e._e(),e._v(" "),e.groupedExternalResources.videos.length>0?n("div",{staticClass:"group-item"},[n("span",{staticClass:"group-name"},[e._v(e._s(e.$t("resourceType.video")))]),e._v(" "),e._l(e.groupedExternalResources.videos,(function(t){return n("ChinamCloudResource",{key:t.id,staticClass:"list-item",attrs:{item:t},on:{preview:e.previewExternalResource}})}))],2):e._e()]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"capture"===e.type&&e.enableKnowledgeReferenceCapture,expression:"type === 'capture' && enableKnowledgeReferenceCapture"}],staticClass:"list"},[e._l(e.knowledgeNode.knowledgeNodeDetail.captures,(function(t){return n("ReferenceCapture",{key:t.id,staticClass:"list-item",attrs:{item:t},on:{delete:e.deleteCapture,preview:e.previewCapture}})})),e._v(" "),0===e.knowledgeNode.knowledgeNodeDetail.captures.length?n("NoData",{staticClass:"no-data"},[e._v("\n      "+e._s(e.$t("knowledgeGraph.noReferenceCapture"))+"\n    ")]):e._e()],2),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"subject"===e.type,expression:"type === 'subject'"}],staticClass:"list"},[e._l(e.knowledgeNode.knowledgeNodeDetail.subjects,(function(t,o){return n("Subject",{key:t.id,staticClass:"list-item",attrs:{item:t,index:o},on:{"preview-subject":e.previewSubject,"remove-subject":e.deleteSubject}})})),e._v(" "),0===e.knowledgeNode.knowledgeNodeDetail.subjects.length?n("NoData",{staticClass:"no-data"},[e._v("\n      "+e._s(e.$t("knowledgeGraph.noReferenceSubject"))+"\n    ")]):e._e()],2),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"activity"===e.type,expression:"type === 'activity'"}],staticClass:"list"},[e._l(e.knowledgeNode.knowledgeNodeDetail.activities,(function(t){return n("ActivityItem",{key:t.id,attrs:{item:t}},[n("div",{staticClass:"item-action"},[n("div",{staticClass:"button-area"},[e.canEditReference&&e.knowledgeNode.edit?n("Tooltip",{attrs:{transfer:"",content:e.$t("delete"),placement:"top"}},[n("i",{staticClass:"font font-delete",on:{click:function(n){return e.deleteActivity(t)}}})]):e._e(),e._v(" "),n("Tooltip",{attrs:{transfer:"",content:e.$t("view"),placement:"top"}},[n("a",{attrs:{target:"_blank"},on:{click:function(n){return e.viewActivity(t)}}},[n("i",{staticClass:"font font-resource-view"})])])],1),e._v(" "),e.canViewCompleteness&&e.viewCompletenessWithoutMediaFragments(t)?n("div",{staticClass:"completeness-area",class:"full"===t.completeness?"bg-green":"bg-orange"},["full"===t.completeness?n("span",[e._v(e._s(e.$t("knowledgeGraph.finished")))]):"part"===t.completeness?n("span",[e._v(e._s(e.$t("knowledgeGraph.partFinished")))]):n("span",[e._v(e._s(e.$t("knowledgeGraph.notFinished")))])]):e._e()])])})),e._v(" "),0===e.knowledgeNode.knowledgeNodeDetail.activities.length?n("NoData",{staticClass:"no-data"},[e._v("\n      "+e._s(e.$t("knowledgeGraph.noReferenceActivity"))+"\n    ")]):e._e()],2),e._v(" "),n("ReferenceSubjectModal",{on:{"on-ok":e.updateNodeSubjectRef},model:{value:e.showReferenceSubjectModal,callback:function(t){e.showReferenceSubjectModal=t},expression:"showReferenceSubjectModal"}}),e._v(" "),n("ReferenceCaptureModal",{attrs:{"associated-ids":e.associatedCaptureIds},on:{"on-ok":e.updateNodeCaptureRef},model:{value:e.showCaptureModal,callback:function(t){e.showCaptureModal=t},expression:"showCaptureModal"}}),e._v(" "),n("Modal",{attrs:{width:"800",title:e.$t("knowledgeGraph.referenceActivity"),"class-name":"referenceActivityModal"},on:{"on-ok":e.confirmActivities,"on-cancel":e.cancelActivities},scopedSlots:e._u([{key:"footer",fn:function(){return[n("Button",{on:{click:function(){e.showModal=!1,e.cancelActivities()}}},[e._v("\n        "+e._s(e.$t("cancel"))+"\n      ")]),e._v(" "),n("Button",{staticClass:"ok",attrs:{type:"primary"},on:{click:function(){e.showModal=!1,e.confirmActivities()}}},[e._v("\n        "+e._s(e.$t("ok"))+"\n      ")]),e._v("\n      "+e._s(e.$t("knowledgeGraph.selectedActivityCount",{n:e.tmpSelectedActivities.length}))+"\n    ")]},proxy:!0}],null,!1,933133180),model:{value:e.showModal,callback:function(t){e.showModal=t},expression:"showModal"}},[n("ActivitySelect",{model:{value:e.tmpSelectedActivities,callback:function(t){e.tmpSelectedActivities=t},expression:"tmpSelectedActivities"}})],1)],1):e._e()}),[],!1,null,"11f66aff",null).exports,vt=n(959769),ht=n(804992),mt=n(156209),gt=null!==(r=null===(o=window.globalData)||void 0===o?void 0:o.course)&&void 0!==r?r:{id:0},yt=(0,i.aZ)({components:{NodeStatisticsCard:ht.Z,SvgIcon:S.Z},setup:function(e,t){var n=t.emit,o=["80~100","60~79","below60"],r=(0,i.f3)(k.iv),a=(0,vt.bG)(),l=a.tooltipSingleCompletionRate,c=a.isNormalMode,u=a.tooltipMasteryRate;return{completenessDistribution:(0,i.Fl)((function(){return o.map((function(e){var t;return{value:null===(t=r.value.knowledgeNodeDetail.completenessRateDistribution)||void 0===t?void 0:t[e],name:s.default.t("knowledgeGraph.statistics.".concat(e))}}))})),masteryDistribution:(0,i.Fl)((function(){return o.map((function(e){var t;return{value:null===(t=r.value.knowledgeNodeDetail.masteryRateDistribution)||void 0===t?void 0:t[e],name:s.default.t("knowledgeGraph.statistics.".concat(e))}}))})),statsUrl:(0,i.Fl)((function(){return"/course/".concat(gt.id,"/stat#/knowledge-graph/node/").concat(r.value.knowledgeNodeDetail.id)})),knowledgeNode:r,COMPLETENESS_LEGEND_COLORS:mt.wR,MASTERY_LEGEND_COLORS:mt.$e,tooltipSingleCompletionRate:l,isNormalMode:c,tooltipMasteryRate:u,handleDetailClick:function(){n("detail-click")}}}}),wt=(0,y.Z)(yt,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"node-statistics-wrapper"},[n("div",[n("a",{on:{click:e.handleDetailClick}},[e._v("\n      "+e._s(e.$t("knowledgeGraph.statistics.detail"))+"\n      "),n("Icon",{staticClass:"to-detail",attrs:{type:"ios-arrow-forward"}})],1)]),e._v(" "),n("NodeStatisticsCard",{attrs:{data:e.completenessDistribution,colors:e.COMPLETENESS_LEGEND_COLORS}},[n("span",[e._v(e._s(e.$t("knowledgeGraph.statistics.completenessRate")))]),e._v(" "),n("Tooltip",{attrs:{placement:"top","transfer-class-name":"knowledge-graph-tooltip",transfer:""}},[n("SvgIcon",{staticClass:"help-icon",attrs:{name:"help"}}),e._v(" "),n("template",{slot:"content"},[n("div",{staticClass:"tooltip-content"},[n("div",{staticClass:"item"},[n("span",{staticClass:"title"},[e._v(e._s(e.$t("knowledgeGraph.statistics.functionDescription")))]),e._v(" "),n("span",{staticClass:"content"},[e._v(e._s(e.tooltipSingleCompletionRate))])]),e._v(" "),e.isNormalMode?n("div",{staticClass:"item"},[n("span",{staticClass:"title"},[e._v(e._s(e.$t("knowledgeGraph.statistics.calculationRules")))]),e._v(" "),n("span",{staticClass:"content"},[e._v(e._s(e.$t("knowledgeGraph.statistics.singleNodeCompletenessRateTip")))])]):e._e()])])],2),e._v(" "),n("span",[e._v(": "+e._s(e.knowledgeNode.knowledgeNodeDetail.avgCompletenessRate))])],1),e._v(" "),n("NodeStatisticsCard",{attrs:{data:e.masteryDistribution,colors:e.MASTERY_LEGEND_COLORS}},[n("span",[e._v(e._s(e.$t("knowledgeGraph.statistics.masteryRate")))]),e._v(" "),n("Tooltip",{attrs:{placement:"top","transfer-class-name":"knowledge-graph-tooltip",transfer:""}},[n("SvgIcon",{staticClass:"help-icon",attrs:{name:"help"}}),e._v(" "),n("template",{slot:"content"},[n("div",{staticClass:"tooltip-content"},[n("div",{staticClass:"item"},[n("span",{staticClass:"title"},[e._v(e._s(e.$t("knowledgeGraph.statistics.functionDescription")))]),e._v(" "),n("span",{staticClass:"content"},[e._v(e._s(e.tooltipMasteryRate))])]),e._v(" "),e.isNormalMode?n("div",{staticClass:"item"},[n("span",{staticClass:"title"},[e._v(e._s(e.$t("knowledgeGraph.statistics.calculationRules")))]),e._v(" "),n("span",{staticClass:"content"},[e._v(e._s(e.$t("knowledgeGraph.statistics.singleNodeMasteryRateTip")))])]):e._e()])])],2),e._v(" "),n("span",[e._v(": "+e._s(e.knowledgeNode.knowledgeNodeDetail.avgMasteryRate))])],1)],1)}),[],!1,null,"6f88ece8",null).exports,bt=n(383228),_t=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},Ct=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},kt=function(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))},xt=(0,i.aZ)({components:{NoData:T.Z,SvgIcon:S.Z,TooltipExt:x.Z},props:{nodeId:{type:Number,required:!0}},setup:function(e,t){var n=this,o=t.emit,r=(0,i.iH)("referenceResource"),l=(0,i.iH)(null),c=(0,i.iH)(!1),u=(0,i.iH)([]),d=(0,i.iH)(0),p=(0,i.iH)(1),f=(0,i.f3)(k.iv),v=(0,i.Fl)((function(){return d.value>u.value.length})),h=(0,i.Fl)((function(){return f.value.knowledgeNodeDetail.captures.map((function(e){return e.id}))})),m=(0,i.Fl)((function(){return!C.yw&&!C.Uz.value&&C.wZ})),g=(0,i.Fl)((function(){return m.value&&f.value.edit})),y=function(){return _t(n,void 0,void 0,(function(){var t;return Ct(this,(function(n){switch(n.label){case 0:return c.value=!0,[4,(0,_.uq)(e.nodeId,p.value)];case 1:return t=n.sent(),d.value=t.total,o("loaded",d.value),u.value=kt(kt([],u.value,!0),t.items,!0),c.value=!1,[2]}}))}))};(0,a.MQn)(l,(function(){return _t(n,void 0,void 0,(function(){return Ct(this,(function(e){switch(e.label){case 0:return!v.value||c.value?[3,2]:(p.value++,[4,y()]);case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}),{distance:10});return(0,i.bv)((function(){return _t(n,void 0,void 0,(function(){return Ct(this,(function(e){switch(e.label){case 0:return[4,y()];case 1:return e.sent(),[2]}}))}))})),(0,i.YP)((function(){return e.nodeId}),(function(){return _t(n,void 0,void 0,(function(){return Ct(this,(function(e){switch(e.label){case 0:return p.value=1,u.value=[],[4,y()];case 1:return e.sent(),[2]}}))}))})),{scrollContainer:l,type:r,total:d,captures:u,disabledCaptureIds:h,addKnowledgeNodeCaptureReference:function(t){return _t(n,void 0,void 0,(function(){return Ct(this,(function(n){switch(n.label){case 0:return h.value.includes(t)?[2]:[4,(0,_.JS)(e.nodeId,[{referId:t,referType:"capture"}])];case 1:return n.sent(),[4,f.value.fetch()];case 2:return n.sent(),De.Toast.success(s.default.t("operationSuccess")),[2]}}))}))},canAddKnowledgeNodeCaptureReference:g,previewCapture:function(e){document.fullscreenElement&&document.exitFullscreen();var t=(0,he.useAngularScope)();u.value.forEach((function(e){e.type="capture"})),t.$broadcast("previewFiles",u.value,e),bt("#file-previewer").foundation("reveal","open")}}}}),St=(0,y.Z)(xt,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"list"},[e.captures.length>0?n("div",{ref:"scrollContainer",staticClass:"scroll-container"},e._l(e.captures,(function(t){return n("div",{key:t.id,staticClass:"capture-card"},[n("div",{staticClass:"left"},[n("SvgIcon",{staticClass:"left-icon",attrs:{name:"capture-video"}}),e._v(" "),n("TooltipExt",{attrs:{text:t.name,placement:"top"}})],1),e._v(" "),n("div",{staticClass:"right"},[n("Tooltip",{attrs:{content:e.$t("view"),placement:"top"}},[n("div",{staticClass:"btn",on:{click:function(n){return n.stopPropagation(),e.previewCapture(t)}}},[n("SvgIcon",{staticClass:"operate-icon",attrs:{name:"preview-open"}})],1)]),e._v(" "),e.canAddKnowledgeNodeCaptureReference?n("Tooltip",{attrs:{content:e.disabledCaptureIds.includes(t.id)?e.$t("knowledgeGraph.associationAdded"):e.$t("knowledgeGraph.addToRelatedRecordings"),placement:"top-end",offset:"12"}},[n("div",{staticClass:"btn",on:{click:function(n){return e.addKnowledgeNodeCaptureReference(t.id)}}},[n("SvgIcon",{staticClass:"operate-icon",class:{disabled:e.disabledCaptureIds.includes(t.id)},attrs:{name:"add-bookmark"}})],1)]):e._e()],1)])})),0):n("NoData",{staticClass:"no-data"},[e._v("\n    "+e._s(e.$t("knowledgeGraph.noRecommendedRecordings"))+"\n  ")])],1)}),[],!1,null,"4d0df832",null).exports,Tt=n(383228),Dt=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},It=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},Et=function(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))},Nt=(0,i.aZ)({components:{NoData:T.Z,SvgIcon:S.Z,TooltipExt:x.Z},props:{nodeId:{type:Number,required:!0}},setup:function(e,t){var n=this,o=t.emit,r=(0,i.iH)("referenceResource"),l=(0,i.iH)(null),c=(0,i.iH)(!1),u=(0,i.iH)([]),d=(0,i.iH)(0),p=(0,i.iH)(1),f=(0,i.f3)(k.iv),v=(0,i.Fl)((function(){return d.value>u.value.length})),h=(0,i.Fl)((function(){return f.value.knowledgeNodeDetail.uploads.map((function(e){return e.id}))})),m=(0,i.Fl)((function(){return u.value.map((function(e){return e.upload}))})),g=(0,i.Fl)((function(){return!C.yw&&!C.Uz.value&&C.wZ})),y=(0,i.Fl)((function(){return g.value&&f.value.edit})),w=function(){return Dt(n,void 0,void 0,(function(){var t;return It(this,(function(n){switch(n.label){case 0:return c.value=!0,[4,(0,_.uL)(e.nodeId,p.value)];case 1:return t=n.sent(),d.value=t.total,o("loaded",d.value),u.value=Et(Et([],u.value,!0),t.items,!0),c.value=!1,[2]}}))}))};return(0,a.MQn)(l,(function(){return Dt(n,void 0,void 0,(function(){return It(this,(function(e){switch(e.label){case 0:return!v.value||c.value?[3,2]:(p.value++,[4,w()]);case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}),{distance:10}),(0,i.bv)((function(){return Dt(n,void 0,void 0,(function(){return It(this,(function(e){switch(e.label){case 0:return[4,w()];case 1:return e.sent(),[2]}}))}))})),(0,i.YP)((function(){return e.nodeId}),(function(){return Dt(n,void 0,void 0,(function(){return It(this,(function(e){switch(e.label){case 0:return p.value=1,u.value=[],[4,w()];case 1:return e.sent(),[2]}}))}))})),{scrollContainer:l,type:r,total:d,resourceReferences:u,disabledUploadIds:h,addKnowledgeNodeResourceReference:function(t){return Dt(n,void 0,void 0,(function(){return It(this,(function(n){switch(n.label){case 0:return h.value.includes(t)?[2]:[4,(0,_.JS)(e.nodeId,[{referId:t,referType:"upload"}])];case 1:return n.sent(),[4,f.value.fetch()];case 2:return n.sent(),De.Toast.success(s.default.t("operationSuccess")),[2]}}))}))},getIcon:function(e){return"folder"!==e.type?"font-file-".concat((0,be.fileTypeByExtension)(e)):"font-cl-resource-folder"},preview:function(e){document.fullscreenElement&&document.exitFullscreen(),(0,he.useAngularScope)().$broadcast("previewFiles",m.value,e),Tt("#file-previewer").foundation("reveal","open")},canAddKnowledgeNodeResourceReference:y}}}),$t=(0,y.Z)(Nt,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"list"},[e.resourceReferences.length>0?n("div",{ref:"scrollContainer",staticClass:"scroll-container"},e._l(e.resourceReferences,(function(t){return n("div",{key:t.id,staticClass:"reference-card"},[n("div",{staticClass:"left"},[n("i",{staticClass:"font left-icon",class:e.getIcon(t.upload)}),e._v(" "),n("TooltipExt",{attrs:{text:t.name,placement:"top"}})],1),e._v(" "),n("div",{staticClass:"right"},[n("Tooltip",{attrs:{content:e.$t("view"),placement:"top"}},[n("div",{staticClass:"btn",on:{click:function(n){return n.stopPropagation(),e.preview(t.upload)}}},[n("SvgIcon",{staticClass:"operate-icon",attrs:{name:"preview-open"}})],1)]),e._v(" "),e.canAddKnowledgeNodeResourceReference?n("Tooltip",{attrs:{content:e.disabledUploadIds.includes(t.upload.id)?e.$t("knowledgeGraph.associationAdded"):e.$t("knowledgeGraph.addToRelatedResource"),placement:"top-end",offset:"12"}},[n("div",{staticClass:"btn",on:{click:function(n){return e.addKnowledgeNodeResourceReference(t.upload.id)}}},[n("SvgIcon",{staticClass:"operate-icon",class:{disabled:e.disabledUploadIds.includes(t.upload.id)},attrs:{name:"add-bookmark"}})],1)]):e._e()],1)])})),0):n("NoData",{staticClass:"no-data"},[e._v("\n    "+e._s(e.$t("knowledgeGraph.noRecommendedResources"))+"\n  ")])],1)}),[],!1,null,"9e472ec6",null).exports,Rt=(0,i.aZ)({components:{NodeRecommendedCapture:St,NodeRecommendedResourceReference:$t},props:{nodeId:{type:Number,required:!0}},setup:function(){var e=(0,i.iH)("referenceResource"),t=(0,i.iH)(0),n=(0,i.iH)(0);return{type:e,handleCaptureLoaded:function(e){t.value=e},captureTotal:t,handleResourceReferenceLoaded:function(e){n.value=e},resourceReferenceTotal:n,enableKnowledgeReferenceCapture:C.q}}}),jt=(0,y.Z)(Rt,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[n("div",{staticClass:"action"},[n("RadioGroup",{staticClass:"types",model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},[n("Radio",{attrs:{label:"referenceResource"}},[e._v("\n        "+e._s(e.$t("knowledgeGraph.recommendResources"))+"("+e._s(e.resourceReferenceTotal)+")\n      ")]),e._v(" "),e.enableKnowledgeReferenceCapture?n("Radio",{attrs:{label:"capture"}},[e._v("\n        "+e._s(e.$t("knowledgeGraph.recordings"))+"("+e._s(e.captureTotal)+")\n      ")]):e._e()],1)],1),e._v(" "),n("NodeRecommendedResourceReference",{directives:[{name:"show",rawName:"v-show",value:"referenceResource"===e.type,expression:"type === 'referenceResource'"}],attrs:{"node-id":e.nodeId},on:{loaded:e.handleResourceReferenceLoaded}}),e._v(" "),e.enableKnowledgeReferenceCapture?[n("NodeRecommendedCapture",{directives:[{name:"show",rawName:"v-show",value:"capture"===e.type,expression:"type === 'capture'"}],attrs:{"node-id":e.nodeId},on:{loaded:e.handleCaptureLoaded}})]:e._e()],2)}),[],!1,null,"2a4aed26",null).exports,Pt=n(651013),Mt=n(926630),Ot=(0,i.aZ)({props:{value:{type:Boolean,required:!0},node:{type:Object,required:!0}},components:{NodeStudentDetail:Pt.Z,NodeContentDetail:Mt.Z},setup:function(e,t){var n=t.emit,o=(0,a.NCN)(e,"value",n,{eventName:"input"}),r=(0,i.iH)("student"),l=(0,i.iH)("".concat(s.default.t("knowledgeGraph.statistics.userNo"),"/").concat(s.default.t("name"))),c=(0,i.iH)(""),u=(0,i.iH)("");return{show:o,tab:r,placeholder:l,keyword:c,inputValue:u,changeTab:function(e){r.value=e,c.value="",u.value="","student"===e&&(l.value="".concat(s.default.t("knowledgeGraph.statistics.userNo"),"/").concat(s.default.t("name")))},search:function(e){c.value=e},subTabChanged:function(e){"upload"===e&&(l.value=s.default.t("knowledgeGraph.statistics.resourceName")),"activity"===e&&(l.value=s.default.t("knowledgeGraph.statistics.activityName"))}}}}),Gt=(0,y.Z)(Ot,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Modal",{staticClass:"learning-path-statistic-detail-modal",attrs:{"footer-hide":"",width:"900",transfer:!1,"z-index":103},scopedSlots:e._u([{key:"header",fn:function(){return[n("span",{staticClass:"title"},[e._v(e._s(e.$t("knowledgeGraph.statistics.statisticDetail")))])]},proxy:!0}]),model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[e._v(" "),n("div",{staticClass:"learning-path-statistic-detail-wrapper"},[n("div",{staticClass:"tabs-wrapper"},[n("div",{staticClass:"tabs"},[n("div",{staticClass:"tab",class:{active:"student"===e.tab},on:{click:function(t){return e.changeTab("student")}}},[e._v("\n          "+e._s(e.$t("knowledgeGraph.statistics.byStudent"))+"\n        ")]),e._v(" "),n("div",{staticClass:"tab",class:{active:"content"===e.tab},on:{click:function(t){return e.changeTab("content")}}},[e._v("\n          "+e._s(e.$t("knowledgeGraph.statistics.byContent"))+"\n        ")])]),e._v(" "),n("div",{staticClass:"search"},[n("Input",{attrs:{search:"",placeholder:e.placeholder},on:{"on-search":e.search},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}})],1)]),e._v(" "),"student"===e.tab?n("NodeStudentDetail",{attrs:{keyword:e.keyword,"node-id":e.node.id,stripe:!1}}):e._e(),e._v(" "),"content"===e.tab?n("NodeContentDetail",{staticClass:"node-content-detail",attrs:{keyword:e.keyword,"node-id":e.node.id,uploadCount:e.node.uploads.length,activityCount:e.node.activities.length,stripe:!1},on:{"tab-changed":e.subTabChanged}}):e._e()],1)])}),[],!1,null,"45ab8499",null).exports,At=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},Zt=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},Ht=(0,i.aZ)({components:{NodeDetailBasic:ve,NodeDetailReference:ft,NodeDetailStatistics:wt,Facet:Q,TeachingCalendarKeywordIndex:b,NodeRelationRecommended:jt,StatisticDetailModal:Gt},props:{node:{type:Object,required:!0},edit:{type:Boolean,default:!0},statistics:{type:Boolean,default:!1},tab:{type:String,default:"basic"}},setup:function(e,t){var n=this,o=(t.emit,(0,i.iH)(null)),r=(0,i.iH)(!1),l=null,c=function(){return At(n,void 0,void 0,(function(){var t;return Zt(this,(function(n){switch(n.label){case 0:return l?[4,(0,_.CD)(l)]:[2];case 1:return(t=n.sent()).id!==l||(o.value=t,e.node instanceof k.kx&&Object.assign(e.node,o.value)),[2]}}))}))};(0,i.JJ)(k.iv,(0,i.iH)({knowledgeNodeDetail:o,edit:e.edit,fetch:c}));var u=(0,i.iH)(!1),d=(0,i.f3)("allowFacetsAndFragments",!1);(0,i.YP)((function(){var t;return null===(t=e.node)||void 0===t?void 0:t.id}),(function(){return At(n,void 0,void 0,(function(){var t;return Zt(this,(function(n){switch(n.label){case 0:return l=null===(t=e.node)||void 0===t?void 0:t.id,u.value=!0,[4,c()];case 1:return n.sent(),u.value=!1,[2]}}))}))}),{immediate:!0});var p=(0,i.Fl)((function(){var e;return"".concat(s.default.t("knowledgeGraph.reference"),"(").concat((null===(e=o.value)||void 0===e?void 0:e.referenceCount)||0,")")})),f=(0,i.Fl)((function(){return!C.yw&&(!!C.Uz.value||!C.wZ)})),v=(0,i.Fl)((function(){return!!C.yw||!C.Uz.value&&C.wZ})),h=(0,i.Fl)((function(){return"statistics"===e.tab&&v.value&&e.statistics?"statistics":"basic"})),m=(0,a.CVp)("basicInfoPanel"),g=(0,i.f3)("course",{id:0,type:0}),y=(0,i.Fl)((function(){return 8===g.type})),w=(0,i.iH)(!1);return{fetch:c,isProject:y,saveBasicInfo:function(){var e=m.value;e&&!0!==e.showModal&&e.handelSubmit(!0)},knowledgeNodeDetail:o,referenceLabel:p,loading:u,canViewNodeDetailInfo:f,canViewNodeStat:v,isSimulatingAsStudent:C.Uz,allowFacetsAndFragments:d,showTeachingCalendar:function(e){w.value=!0},showTeachingCalendarModal:w,teachingCalendarToggle:window.featureToggles.teaching_calendar,enableKnowledgeReferencePublicResource:C.g$,tabValue:h,showStatisticDetailModal:r}}}),Ft=(0,y.Z)(Ht,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.knowledgeNodeDetail?n("div",{staticClass:"container node-detail-panel"},[e.canViewNodeStat?n("StatisticDetailModal",{attrs:{node:e.node},model:{value:e.showStatisticDetailModal,callback:function(t){e.showStatisticDetailModal=t},expression:"showStatisticDetailModal"}}):e._e(),e._v(" "),n("Modal",{staticClass:"teaching-calendar-modal",attrs:{width:"1100","footer-hide":"",title:e.$t("teachingCalendar.title"),transfer:!1},model:{value:e.showTeachingCalendarModal,callback:function(t){e.showTeachingCalendarModal=t},expression:"showTeachingCalendarModal"}},[e.showTeachingCalendarModal?n("TeachingCalendarKeywordIndex",{attrs:{keyword:e.node.text||e.node.name}}):e._e()],1),e._v(" "),n("div",{staticClass:"node-header inset-x"},[n("h2",[e._v(e._s(e.node.text||e.node.name))]),e._v(" "),e.teachingCalendarToggle&&!e.isProject?n("Button",{staticClass:"teaching-calendar-btn",attrs:{size:"small"},on:{click:function(t){return e.showTeachingCalendar(e.node.text||e.node.name)}}},[n("i",{staticClass:"font font-calendar-event"}),e._v("\n      "+e._s(e.$t("teachingCalendar.title"))+"\n    ")]):e._e()],1),e._v(" "),n("div",{staticClass:"loading-content"},[e.loading?n("Spin",{attrs:{fix:""}}):e._e(),e._v(" "),e.canViewNodeDetailInfo?n("div",{staticClass:"info"},[e._v("\n      "+e._s(e.$t("knowledgeGraph.completeRateIs"))+"\n      "),n("b",[e._v(e._s(e.knowledgeNodeDetail.completenessRate))]),e._v(" "),n("span",[e._v("\n        （"+e._s(e.$t("knowledgeGraph.rake",{n:e.isSimulatingAsStudent?"--":e.knowledgeNodeDetail.completenessRank}))+"）\n      ")]),e._v("\n      ，"+e._s(e.$t("knowledgeGraph.masteryRateIs"))+"\n      "),n("b",[e._v(e._s(e.knowledgeNodeDetail.masteryRate))]),e._v(" "),n("span",[e._v("\n        （"+e._s(e.$t("knowledgeGraph.rake",{n:e.isSimulatingAsStudent?"--":e.knowledgeNodeDetail.masteryRank}))+"）\n      ")])]):e._e(),e._v(" "),e.knowledgeNodeDetail?n("Tabs",{staticClass:"tabs",attrs:{value:e.tabValue,name:"node-content-tabs"}},[n("TabPane",{directives:[{name:"click-outside-el",rawName:"v-click-outside-el",value:e.saveBasicInfo,expression:"saveBasicInfo"}],staticClass:"inset-x pane",attrs:{label:e.$t("knowledgeGraph.basicInfo"),name:"basic",tab:"node-content-tabs"}},[n("div",[n("NodeDetailBasic",{key:e.node.id,ref:"basicInfoPanel",attrs:{node:e.node,"node-detail":e.knowledgeNodeDetail}})],1)]),e._v(" "),e.allowFacetsAndFragments?n("TabPane",{staticClass:"inset-x pane",attrs:{label:e.$t("knowledgeGraph.facetNFragment"),name:"facets",tab:"node-content-tabs"}},[n("Facet",{attrs:{"node-id":e.node.id}})],1):e._e(),e._v(" "),n("TabPane",{staticClass:"inset-x flex overflow-y-auto",attrs:{label:e.$t("knowledgeGraph.material"),name:"textbook"}},[n("NodeDetailReference",{key:e.node.id,attrs:{node:e.node}})],1),e._v(" "),e.enableKnowledgeReferencePublicResource?n("TabPane",{attrs:{name:"relation-recommended",label:e.$t("knowledgeGraph.recommended")}},[n("NodeRelationRecommended",{attrs:{"node-id":e.node.id}})],1):e._e(),e._v(" "),e.canViewNodeStat&&e.statistics?n("TabPane",{staticClass:"inset-x pane",attrs:{label:e.$t("knowledgeGraph.statistics.title"),name:"statistics",tab:"node-content-tabs"}},[n("NodeDetailStatistics",{on:{"detail-click":function(t){e.showStatisticDetailModal=!0}}})],1):e._e()],1):e._e()],1)],1):e._e()}),[],!1,null,"d1c0838e",null).exports},494101:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});n(141817),n(66992),n(140561),n(788674),n(333948);var o=n(925706),r=n(117403),i=n(48496),a=n(558794),s=n(662061),l=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},c=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},u=(0,o.aZ)({props:{node:{type:Object,required:!0},relation:{type:Object,required:!0},canEditRelation:{type:Boolean,default:!1},showPrefix:{type:Boolean,default:!0},canDelete:{type:Boolean,default:!1}},components:{TooltipExt:a.Z},setup:function(e){var t=this,n=(0,o.f3)("course",{id:0}),a=(0,o.iH)(""),u=(0,o.iH)(!1),d=(0,o.iH)(!1),p=function(e){return"prev"===e?"post":"post"===e?"prev":"undirected"},f=function(t,n){var o=e.node,r=e.node.tree.find((function(e){return e.id===t.id}))[0],i={undirected:o.data.undirectedRelation,prev:o.data.prevRelation,post:o.data.postRelation},a={undirected:r.data.undirectedRelation,prev:r.data.prevRelation,post:r.data.postRelation},s=i[t.relationType].findIndex((function(e){return e.relationId===t.relationId})),l=i[t.relationType].splice(s,1)[0],c=a[p(t.relationType)].findIndex((function(e){return e.relationId===t.relationId})),u=a[p(t.relationType)].splice(c,1)[0];n&&(i[n].push(l),a[p(n)].push(u))};return{relationClass:function(e){return"undirected"===e.relationType?"undirected-relation":"prev"===e.relationType?"pre-relation":"post"===e.relationType?"post-relation":""},delRelation:function(e){return l(t,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:return[4,(0,s.LM)(n.id,[e.relationId])];case 1:return t.sent(),f(e),i.Toast.success(r.default.t("operationSuccess")),[2]}}))}))},editRelationType:a,onPopperShow:function(){a.value=e.relation.relationType},upadteRelation:function(o){return l(t,void 0,void 0,(function(){var t,a,l;return c(this,(function(c){switch(c.label){case 0:return t="",a=e.node.id,l=e.relation.id,"undirected"===o?t="undirected":"prev"===o?(t="directed",a=e.relation.id,l=e.node.id):t="directed",[4,(0,s.HH)(n.id,{id:e.relation.relationId,type:t,source:a,target:l})];case 1:return c.sent(),u.value=!1,f(e.relation,o),i.Toast.success(r.default.t("air.updateSuccess")),[2]}}))}))},visible:u,relationTooltipText:function(t){var n={prev:r.default.t("knowledgeGraph.addPrev"),post:r.default.t("knowledgeGraph.addPost"),undirected:r.default.t("knowledgeGraph.addRelation")};return e.showPrefix?"".concat(n[t.relationType],"：").concat(t.name):t.name},closePoptip:function(t){e.relation.relationType===t&&(u.value=!1)},hovering:d,handleMouseout:function(){d.value=!1},handleMouseover:function(){d.value=!0}}}}),d=(0,n(551900).Z)(u,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:e.relationClass(e.relation),on:{mouseover:e.handleMouseover,mouseout:e.handleMouseout,mousedown:function(e){e.stopPropagation()}}},[n("Poptip",{attrs:{placement:"bottom",padding:"12px 16px",disabled:!e.canEditRelation,transfer:"","transfer-class-name":"relation-item-poptip"},on:{"on-popper-show":e.onPopperShow},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[n("div",{staticClass:"rleation-area"},[n("div",{staticClass:"relation-name",style:{width:e.hovering&&e.canDelete?"calc(100% - 12px)":"100%"}},[n("TooltipExt",{attrs:{text:e.relationTooltipText(e.relation),"transfer-class-name":"knowledge-graph-outline-tooltip"}})],1),e._v(" "),e.canDelete?n("div",{staticClass:"delete-button"},[n("Tooltip",{attrs:{content:e.$t("remove"),placement:"top",transfer:"","transfer-class-name":"knowledge-graph-outline-tooltip"}},[n("i",{staticClass:"font font-cancel",on:{click:function(t){return t.stopPropagation(),e.delRelation(e.relation)}}})])],1):e._e()]),e._v(" "),n("div",{staticClass:"poptip-content",attrs:{slot:"content"},slot:"content"},[n("div",{staticClass:"poptip-header"},[n("span",{staticClass:"title"},[e._v(e._s(e.$t("knowledgeGraph.setNodeRelation")))]),e._v(" "),n("span",{staticClass:"remove",on:{click:function(t){return e.delRelation(e.relation)}}},[e._v(e._s(e.$t("remove")))])]),e._v(" "),n("RadioGroup",{attrs:{type:"button"},on:{"on-change":e.upadteRelation},model:{value:e.editRelationType,callback:function(t){e.editRelationType=t},expression:"editRelationType"}},[n("Radio",{attrs:{label:"undirected"},nativeOn:{click:function(t){return e.closePoptip("undirected")}}},[n("span",[e._v(e._s(e.$t("knowledgeGraph.addRelation")))])]),e._v(" "),n("Radio",{attrs:{label:"prev"},nativeOn:{click:function(t){return e.closePoptip("prev")}}},[n("span",[e._v(e._s(e.$t("knowledgeGraph.addPrev")))])]),e._v(" "),n("Radio",{attrs:{label:"post"},nativeOn:{click:function(t){return e.closePoptip("post")}}},[n("span",[e._v(e._s(e.$t("knowledgeGraph.addPost")))])])],1)],1)])],1)}),[],!1,null,"31ba78db",null).exports},336775:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return N}});var o=n(925706),r=n(860635),i=n(427372),a=n(311610),s=n(154803),l=n(864251),c=n(183825),u=(0,o.aZ)({components:{SvgIcon:a.Z,TeachingObjectiveSelect:l.Z,NodeDetailContent:c.Z,NoData:i.Z},setup:function(){var e=(0,o.iH)();return(0,o.YP)(s.Q7,(function(t){t&&(e.value=t.selected()[0],t.$on("node:selected",(function(t){e.value=t})),t.$on("node:saved",(function(t){e.value=t})),t.$on("node:removed",(function(t){e.value=null})))})),{currentNode:e}}}),d=n(551900),p=(0,d.Z)(u,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.currentNode?n("div",{staticClass:"container"},[n("NodeDetailContent",{attrs:{node:e.currentNode}})],1):n("NoData",[e._v(e._s(e.$t("knowledgeGraph.nodata")))])}),[],!1,null,"29d2e497",null).exports,f=n(553319),v=(n(788674),n(887757)),h=n.n(v),m=(n(535666),n(117403)),g=n(681423),y=n(462149),w=n(662061),b=n(202669),_=n(718630),C=n(119292),k=n(153384);function x(e,t,n,o,r,i,a){try{var s=e[i](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(o,r)}function S(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var i=e.apply(t,n);function a(e){x(i,o,r,a,s,"next",e)}function s(e){x(i,o,r,a,s,"throw",e)}a(void 0)}))}}var T=(0,o.aZ)({components:{HeaderWrapper:_.Z,CourseName:C.Z,SvgIcon:a.Z},setup(){var e=(0,o.f3)("course",{id:0,type:0}),t=(0,o.Fl)((()=>8===e.type)),n=(0,o.iH)(!1),r=(0,o.iH)("--"),i=(0,o.iH)("--"),a=(0,o.Fl)((()=>s.Vl.value===y.QO.PUBLISHED)),l=function(){var t=S(h().mark((function t(){var n,o;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=a.value?m.default.t("knowledgeGraph.cancelPublishTip"):m.default.t("knowledgeGraph.publishTip"),t.next=3,b.Z.open({title:m.default.t("tips"),type:"warning",divider:!1,width:416,content:n});case 3:if(t.sent){t.next=6;break}return t.abrupt("return");case 6:return o=a.value?y.QO.UNPUBLISHED:y.QO.PUBLISHED,t.next=9,(0,w.wy)(e.id,o).then((()=>{s.Vl.value=o;var e=a.value?m.default.t("knowledgeGraph.publishSuccess"):m.default.t("knowledgeGraph.cancelPublishSuccess");g.Z.success(e)})).catch((e=>{var t;null!==(t=e.response)&&void 0!==t&&t.data.message&&g.Z.error(e.response.data.message)}));case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();(0,o.bv)(S(h().mark((function t(){var n;return h().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!s.yw.value&&!s.wZ&&0!==s.Wq){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,(0,w.Rz)(e.id,s.Wq);case 4:n=t.sent,r.value=n.overallCompletenessRate,i.value=n.overallMasteryRate;case 7:case"end":return t.stop()}}),t)}))));var c=(0,o.Fl)((()=>!s.yw&&(s.Uz.value?a.value:a.value&&!s.wZ))),u=(0,o.Fl)((()=>!s.yw&&!s.Uz.value&&s.wZ)),d=(0,o.Fl)((()=>!!s.yw||(!(s.Uz.value||!s.wZ)||a.value)));return{isProject:t,isInstructor:s.wZ,isPublished:a,show:n,overallCompletenessRate:r,overallMasteryRate:i,toGraph:()=>{k.N.push("/relation")},closeModal:()=>{n.value=!1},publishOrCancelPublish:l,canViewOverallRate:c,canPublish:u,canViewGraph:d}}}),D=(0,d.Z)(T,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("HeaderWrapper",{scopedSlots:e._u([{key:"btn-group",fn:function(){return[e._t("default",[n("div",{staticClass:"right-content"},[e.canViewOverallRate?n("div",{staticClass:"flex"},[n("Tooltip",{attrs:{content:e.isProject?e.$t("project.refactor.completeRateTip"):e.$t("knowledgeGraph.completeRateTip"),placement:"top"}},[n("div",{staticClass:"rate"},[e._v("\n              "+e._s(e.$t("knowledgeGraph.allCompleteRate"))+": "+e._s(e.overallCompletenessRate)+"\n              "),n("span",{staticClass:"font font-question"})])]),e._v(" "),n("Tooltip",{attrs:{content:e.isProject?e.$t("project.refactor.masteryRateTip"):e.$t("knowledgeGraph.masteryRateTip"),placement:"top"}},[n("div",{staticClass:"rate"},[e._v("\n              "+e._s(e.$t("knowledgeGraph.allMasteryRate"))+": "+e._s(e.overallMasteryRate)+"\n              "),n("span",{staticClass:"font font-question"})])])],1):e._e(),e._v(" "),n("div",{staticClass:"btn-group"},[e.canPublish?n("span",[e.isPublished?n("Button",{staticClass:"publish-btn",on:{click:e.publishOrCancelPublish}},[n("SvgIcon",{attrs:{name:"unpublish"}}),e._v("\n              "+e._s(e.$t("knowledgeGraph.cancelPublish"))+"\n            ")],1):n("Button",{staticClass:"publish-btn",attrs:{type:"primary"},on:{click:e.publishOrCancelPublish}},[n("SvgIcon",{attrs:{name:"publish"}}),e._v("\n              "+e._s(e.$t("knowledgeGraph.publish"))+"\n            ")],1)],1):e._e(),e._v(" "),n("Button",{attrs:{disabled:!e.canViewGraph},on:{click:e.toGraph}},[e._v("\n            "+e._s(e.$t("knowledgeGraph.viewGraph"))+"\n          ")])],1)])])]},proxy:!0}],null,!0)},[n("CourseName")],1)}),[],!1,null,"0a19db4c",null).exports,I=n(64976),E=(0,o.aZ)({components:{Content:f.Z,Drawer:r.Z,NoData:i.Z,NodeDetail:p,Header:D},props:{keyword:{type:String},dimensions:{type:Array,default:function(){return[]}},showHeader:{type:Boolean,default:!0}},setup:function(){var e,t,n=(0,o.Fl)((function(){return s.Vl.value===y.QO.PUBLISHED})),r=8===(null===(t=null===(e=window.globalData)||void 0===e?void 0:e.course)||void 0===t?void 0:t.courseType),i=(0,o.iH)(!1),a=(0,o.Fl)((function(){return!!s.yw||(!(s.Uz.value||!s.wZ)||n.value)})),l=(0,o.Fl)((function(){return s.yw?480:s.Uz.value||!s.wZ?600:480}));return(0,o.bv)((function(){I.Z.$on("show-drawer",(function(){i.value=!0})),I.Z.$on("close-drawer",(function(){i.value=!1}))})),{isProject:r,isPublished:n,isInstructor:s.wZ,isSimulatingInstructor:s.yw,canViewContent:a,drawerWidth:l,showDrawer:i}}}),N=(0,d.Z)(E,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"knowledge-content"},[e.canViewContent?n("Content",{attrs:{keyword:e.keyword,dimensions:e.dimensions}}):n("NoData",[e._v(e._s(e.isProject?e.$t("project.refactor.notGraphTip"):e.$t("knowledgeGraph.NoContentTip")))]),e._v(" "),e.canViewContent?n("Drawer",{attrs:{width:e.drawerWidth},model:{value:e.showDrawer,callback:function(t){e.showDrawer=t},expression:"showDrawer"}},[n("NodeDetail")],1):e._e()],1)])}),[],!1,null,"b1940cda",null).exports},948150:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var o={props:{divider:{type:Boolean,default:!1}}},r=(0,n(551900).Z)(o,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{staticClass:"toolbar-wrapper",class:{"has-bottom-border":e.divider}},[e._t("default")],2)}),[],!1,null,"40968c46",null).exports},892932:function(e,t,n){"use strict";n.d(t,{Z:function(){return E}});n(141817),n(66992),n(788674),n(333948);var o=n(925706),r=n(966309),i=n(48496),a=n(959769),s=n(311610),l=n(119292),c=n(225590),u=n(662061),d=n(82720),p=n(220093),f=n(770181),v=(n(319601),n(117403)),h=n(486992),m=n(154803),g=function(){return(g=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},y=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},w=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},b=(0,o.aZ)({components:{CourseName:l.Z,Graph:c.Z,Legend:p.Z,Toolbar:f.Z},props:{viewMode:{type:String,required:!0},statsId:{type:Number,required:!0},setting:{type:Object,required:!0}},setup:function(e,t){var n,i=this,a=(0,o.iH)([]),s=(0,o.iH)([]),l=(0,o.iH)(((n={})[d.wO.COMPLETENESS]={},n[d.wO.MASTERY]={},n)),c=(0,o.f3)("course",{id:0});y(i,void 0,void 0,(function(){var t;return w(this,(function(n){switch(n.label){case 0:return[4,(0,u.ch)(c.id,e.statsId)];case 1:return t=n.sent(),a.value=t.tree,s.value=t.relations,l.value.completeness=t.completeness,l.value.mastery=t.mastery,[2]}}))}));var p=(0,o.Fl)((function(){return l.value[e.viewMode]})),f=function(t,n){var o,r=0;return r=null===(o=-1===n?l.value[e.viewMode][0]:l.value[e.viewMode][t.id])||m.Uz.value?3:o>=80?0:o>=60?1:2,d.LH[e.viewMode].nodes[r]},b=function(t){var n,o=(n={},n[d.wO.COMPLETENESS]=m.wZ?v.default.t("knowledgeGraph.statistics.averageCompleteness"):v.default.t("knowledgeGraph.statistics.completeness"),n[d.wO.MASTERY]=m.wZ?v.default.t("knowledgeGraph.statistics.averageMastery"):v.default.t("knowledgeGraph.statistics.mastery"),n)[e.viewMode];return"<div class='tooltip-title'>".concat(t.name,"</div><div> <span class='cycle' style='background: ").concat(t.color,"'></span> ").concat(o," ").concat(m.Uz.value?"--":(0,h.T3)(p.value[t.id])," </div>")},_=(0,r.CVp)("graph",null),C=(0,o.FN)();return(0,o.m0)((function(){var e,t,n,o;C.proxy.resetZoom=null===(e=_.value)||void 0===e?void 0:e.resetZoom,C.proxy.resetActive=null===(t=_.value)||void 0===t?void 0:t.resetActive,C.proxy.zoomIn=null===(n=_.value)||void 0===n?void 0:n.zoomIn,C.proxy.zoomOut=null===(o=_.value)||void 0===o?void 0:o.zoomOut})),function(){return(0,o.h)("Graph",{key:e.viewMode,ref:"graph",attrs:g({},t.attrs),props:g(g({},e),{nodes:a.value,links:s.value,nodeColor:f,tooltipHtml:b}),on:{"on-click-node":function(e){t.emit("on-click-node",e)},"on-click-outside":function(){t.emit("on-click-outside")}}})}}}),_=n(551900),C=(0,_.Z)(b,undefined,undefined,!1,null,"5992ba57",null).exports,k=n(427372),x=n(860635),S=n(183825),T=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},D=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},I=(0,o.aZ)({components:{CourseName:l.Z,Graph:c.Z,Legend:p.Z,Toolbar:f.Z,GraphContainer:C,NoData:k.Z,SvgIcon:s.Z,Drawer:x.Z,NodeDetailContent:S.Z},props:{value:Boolean},setup:function(e,t){var n=this,s=t.emit,l=(0,r.NCN)(e,"value",s,{eventName:"input"}),c=(0,o.f3)("course",{id:0}),p=(0,o.iH)(0),f=(0,o.iH)(),v=(0,o.iH)(!1),g=(0,o.iH)(),y=(0,o.iH)(d.wO.COMPLETENESS),w=function(){return i._.find(f.value,(function(e){return e.statsId===p.value}))},b=(0,o.iH)({course:!1,levelRelation:!0,directedRelation:!0,undirectedRelation:!0}),_=(0,o.iH)(),C=(0,r.PL)((function(){return(0,u.tm)(c.id)}),[],{immediate:!1}),k=(0,o.YP)(l,(function(){C.execute(),k()})),x=(0,a.bG)(),S=x.tooltipCompletionRate,I=x.tooltipMasteryRate,E=(0,o.Fl)((function(){return"".concat(S,";\n").concat(I)}));return(0,o.YP)((function(){return C.state.value.length}),(function(){setTimeout((function(){p.value=C.state.value[0].id}),1e3)})),{currentStatsId:p,show:l,graphSetting:b,viewMode:y,learningPathGraphViewMode:d.Sk,graphRef:f,graphWrapperRef:_,settingChange:function(e){b.value=e},restPosition:function(){var e=w();null==e||e.resetZoom(),null==e||e.resetActive()},fullscreen:function(){var e;document.fullscreenElement?document.exitFullscreen():null===(e=_.value)||void 0===e||e.requestFullscreen()},zoomIn:function(){var e=w();null==e||e.zoomIn()},zoomOut:function(){var e=w();null==e||e.zoomOut()},statsList:C,ViewMode:d.wO,viewModeDescription:E,formatPercent:h.T3,isSimulatingAsStudent:m.Uz,goBack:function(){l.value=!1},showDrawer:v,handleClickNode:function(e){return T(n,void 0,void 0,(function(){var t;return D(this,(function(n){switch(n.label){case 0:return e?[4,(0,u.CD)(e)]:[3,2];case 1:t=n.sent(),g.value=t,v.value=!0,n.label=2;case 2:return[2]}}))}))},handleClickOutside:function(){v.value=!1},currentNode:g}}}),E=(0,_.Z)(I,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Modal",{staticClass:"modal",attrs:{"footer-hide":"",fullscreen:"",closable:!1,transfer:!1,"z-index":102},scopedSlots:e._u([{key:"header",fn:function(){return[n("div",{staticClass:"path-header"},[n("div",{staticClass:"path-header-title"},[n("i",{staticClass:"font font-arrow-left-bold",on:{click:e.goBack}}),e._v("\n        "+e._s(e.$t("knowledgeGraph.learningPath"))+"\n      ")]),e._v(" "),n("div",{staticClass:"view-mode-selector"},[n("RadioGroup",{attrs:{type:"button","button-style":"solid"},model:{value:e.viewMode,callback:function(t){e.viewMode=t},expression:"viewMode"}},e._l(e.learningPathGraphViewMode,(function(t){return n("Radio",{key:t.key,attrs:{label:t.key}},[e._v(e._s(t.value))])})),1),e._v(" "),n("Poptip",{attrs:{placement:"bottom-end",width:"280",transfer:"",offset:"16",trigger:"hover","transfer-class-name":"learning-path-tooltip"},scopedSlots:e._u([{key:"title",fn:function(){return[n("span",[e._v(e._s(e.$t("knowledgeGraph.statistics.functionDescription")))])]},proxy:!0}])},[n("SvgIcon",{staticClass:"help-icon",attrs:{name:"header-help"}}),e._v(" "),e._v(" "),n("template",{slot:"content"},[n("div",{staticClass:"tooltip-content"},[n("div",{staticClass:"item"},[n("span",{staticClass:"content"},[e._v(e._s(e.viewModeDescription))])])])])],2)],1)])]},proxy:!0}]),model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[e._v(" "),n("div",{staticClass:"container"},[n("div",{staticClass:"timeline"},[n("Timeline",e._l(e.statsList.state.value,(function(t){return n("TimelineItem",{key:t.id,staticClass:"line-item",class:{active:e.currentStatsId===t.id}},[n("div",{staticClass:"item",on:{click:function(n){e.currentStatsId=t.id}}},[n("div",{staticClass:"title"},[e._v("\n              "+e._s(e.$t("knowledgeGraph.weekIndex",[t.week]))+"("+e._s(e.$t("knowledgeGraph.endAt",[t.statDateStr]))+")\n            ")]),e._v(" "),e.viewMode===e.ViewMode.MASTERY?n("div",{staticClass:"desc"},[e._v("\n              "+e._s(e.$t("knowledgeGraph.statistics.averageMasteryRate"))+":\n              "+e._s(e.isSimulatingAsStudent?"--":e.formatPercent(t.masteryRate))+"\n            ")]):e._e(),e._v(" "),e.viewMode===e.ViewMode.COMPLETENESS?n("div",{staticClass:"desc"},[e._v("\n              "+e._s(e.$t("knowledgeGraph.statistics.averageCompletenessRate"))+":\n              "+e._s(e.isSimulatingAsStudent?"--":e.formatPercent(t.completenessRate))+"\n            ")]):e._e()])])})),1),e._v(" "),0===e.statsList.state.value.length?n("NoData",{staticClass:"no-data"},[e._v(e._s(e.$t("knowledgeGraph.nodata")))]):e._e()],1),e._v(" "),n("div",{ref:"graphWrapperRef",staticClass:"graph-wrapper"},[e._l(e.statsList.state.value,(function(t){return n("GraphContainer",{key:t.id,ref:"graphRef",refInFor:!0,staticClass:"graph",class:{visible:t.id===e.currentStatsId},attrs:{"view-mode":e.viewMode,setting:e.graphSetting,"stats-id":t.id},on:{"on-click-node":e.handleClickNode,"on-click-outside":e.handleClickOutside}})})),e._v(" "),e.statsList.isLoading.value?n("Spin",{attrs:{size:"large",fix:""}}):e._e(),e._v(" "),n("Legend",{staticClass:"graph-legend",attrs:{"view-mode":e.viewMode}}),e._v(" "),e.statsList.state.value.length?n("Toolbar",{staticClass:"graph-toolbar",attrs:{"view-mode":e.viewMode},on:{"on-setting-change":e.settingChange,"on-fullscreen":e.fullscreen,"on-position":e.restPosition,"on-zoom-in":e.zoomIn,"on-zoom-out":e.zoomOut}}):e._e(),e._v(" "),n("Drawer",{attrs:{button:!1,"close-button":!0},model:{value:e.showDrawer,callback:function(t){e.showDrawer=t},expression:"showDrawer"}},[e.currentNode?n("NodeDetailContent",{attrs:{node:e.currentNode,statistics:!0,tab:"statistics"}}):e._e()],1)],2)])])}),[],!1,null,"d6b0824a",null).exports},444079:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var o=n(925706),r=(0,o.aZ)({props:{color:{type:String,required:!0},size:{type:Number,default:8}},setup:function(e){return{styles:(0,o.Fl)((function(){return{background:e.color,width:"".concat(e.size,"px"),height:"".concat(e.size,"px"),"border-radius":"".concat(e.size,"px")}}))}}}),i=(0,n(551900).Z)(r,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{staticClass:"legend-badge",style:e.styles})}),[],!1,null,null,null).exports},225590:function(e,t,n){"use strict";n.d(t,{Z:function(){return m}});n(141817),n(66992),n(185827),n(747042),n(788674),n(470189),n(132023),n(454747),n(333948);var o=n(925706),r=n(496486),i=n(156209),a=n(486992),s=n(82720),l=n(476342),c=n(159820),u=n(146176),d=n(154803),p=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},f=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},v=function(e,t,n){if(n||2===arguments.length)for(var o,r=0,i=t.length;r<i;r++)!o&&r in t||(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))},h=(0,o.aZ)({props:{nodes:{type:Array,required:!0},links:{type:Array},viewMode:{type:String},setting:{type:Object,required:!0},keyword:{type:String},nodeColor:{type:Function,default:function(e,t){return s.LH[s.wO.LEVEL].nodes[t]}},tooltipHtml:{type:Function},dimensions:{type:Array,default:function(){return[]}}},setup:function(e,t){var n,h=this,m=(0,o.iH)(),g=(0,o.iH)([]),y=(0,o.iH)([]),w=(0,o.f3)("course",{id:0,name:""}),b=function(e){t.emit("on-click-node",e)},_=function(){t.emit("on-click-outside")},C=(0,u.X)().depth,k=C<=5?20:2*C,x=new Set;(0,o.m0)((function(){var t=[],n=[];e.links&&n.push.apply(n,(0,r.cloneDeep)(e.links)),(0,a.T$)(e.nodes,(function(o,r){t.push({id:o.id,name:o.text,level:r,r:k,color:e.nodeColor(o,r),cognitiveDimension:o.cognitiveDimension,knowledgeTreeNode:o}),n.push.apply(n,o.prevRelation.map((function(e){return{id:e.relationId,source:e.id,target:o.id,isDirected:!0,color:i.OO}}))),n.push.apply(n,o.postRelation.map((function(e){return{id:e.relationId,source:o.id,target:e.id,isDirected:!0,color:i.OO}}))),n.push.apply(n,o.undirectedRelation.map((function(e){return{id:e.relationId,source:e.id,target:o.id,isDirected:!1,color:i.OO}})))})),n=n.reduce((function(e,t){return e.find((function(e){return e.id===t.id}))?e:v(v([],e,!0),[t],!1)}),[]);var o=0;if(e.setting.course){var l=e.nodeColor(null,-1);l||(l=s.LH[e.viewMode].course),t.unshift({id:0,name:w.name,level:-1,r:32,color:l,cognitiveDimension:null}),n.push.apply(n,e.nodes.map((function(t){return{id:o-=1,source:0,target:t.id,isDirected:!0,color:s.LH[e.viewMode].levelRelation}})))}e.setting.levelRelation&&(0,a.T$)(e.nodes,(function(t,r,i,a){a&&(o-=1,n.push({id:o,source:a.id,target:t.id,isDirected:!0,color:s.LH[e.viewMode].levelRelation}))})),e.setting.directedRelation||(n=n.filter((function(e){return!e.isDirected||e.id<0}))),e.setting.undirectedRelation||(n=n.filter((function(e){return e.isDirected})));var c;if(x.clear(),e.keyword){var u=t.filter((function(t){return t.name.includes(e.keyword)})).map((function(e){return e.knowledgeTreeNode})),d=[],p=new Set(u.map((function(e){return e.id})));(0,a.T$)(u,(function(e){p.has(e.id)||x.add(e.id),d.push(e.id)}));for(var f=u.map((function(e){return e.parentId})),h=function(){d.push.apply(d,f);var t=[];(0,a.T$)(e.nodes,(function(e){f.includes(e.id)&&e.parentId&&t.push(e.parentId)})),f=t};f.length;)h();(t=t.filter((function(e){return d.includes(e.id)||0===e.id}))).forEach((function(e){var t;(null===(t=e.knowledgeTreeNode)||void 0===t?void 0:t.children)&&(e.knowledgeTreeNode.children=e.knowledgeTreeNode.children.filter((function(e){return d.includes(e.id)})))}))}if(c=t.map((function(e){return e.id})),n=n.filter((function(e){var t="number"==typeof e.source?e.source:e.source.id,n="number"==typeof e.target?e.target:e.target.id;return c.includes(t)&&c.includes(n)})),e.dimensions.length>0){var m=(t=t.filter((function(t){return e.dimensions.includes(t.cognitiveDimension)||0===t.id}))).map((function(e){return e.id}));n=n.filter((function(e){var t="number"==typeof e.source?e.source:e.source.id,n="number"==typeof e.target?e.target:e.target.id;return m.includes(t)&&m.includes(n)}))}g.value=t,y.value=n})),(0,o.bv)((function(){return p(h,void 0,void 0,(function(){var t;return f(this,(function(o){return t=d._T.value?l.C:l.i,n=new t(m.value,{clickNode:b,clickOutside:_},e.tooltipHtml),[2]}))}))})),(0,c.ab)().then((function(t){(0,o.YP)([g,y,m,function(){return e.setting.showLevelNumber}],(function(){n.hiddenNodeIds=new Set(x),g.value.forEach((function(t){t.level>e.setting.showLevelNumber?n.hiddenNodeIds.add(t.id):x.has(t.id)||n.hiddenNodeIds.delete(t.id)})),n.update(g.value,y.value,e.keyword)}),{immediate:!0})})),window.addEventListener("resize",(function(){n.resize(),n.reRender()}));return{eleRef:m,zoomIn:function(){n.zoomIn()},zoomOut:function(){n.zoomOut()},resetZoom:function(){n.resetZoom()},resetActive:function(){n.resetStyle()}}}}),m=(0,n(551900).Z)(h,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"graph-wrapper"},[n("div",{staticClass:"graph-background"}),e._v(" "),n("div",{ref:"eleRef",staticClass:"graph-container"})])}),[],!1,null,"5850370c",null).exports},220093:function(e,t,n){"use strict";n.d(t,{Z:function(){return p}});n(923157);var o=n(925706),r=n(117403),i=n(82720),a=n(146176),s=n(156209),l=n(444079),c=["一","二","三","四","五","六","七","八","九","十"],u=function(){var e;return null===(e=document.documentElement.getAttribute("lang"))||void 0===e?void 0:e.toLocaleLowerCase().startsWith("zh")},d=(0,o.aZ)({components:{Badge:l.Z},props:{viewMode:{type:String,required:!0},value:{type:Number,default:100}},setup:function(e,t){var n=t.emit,l=(0,a.X)().depth,d={level:{name:r.default.t("knowledgeGraph.nodeLevel"),value:Array(l).fill(0).map((function(e,t){return{desc:r.default.t("knowledgeGraph.nodeByLevel",[u()?c[t]:t+1]),color:s.KV[t%s.KV.length]}}))},completeness:{name:r.default.t("knowledgeGraph.completeRate"),value:[{desc:"80%-100%",color:s.wR[0]},{desc:"60%-79%",color:s.wR[1]},{desc:r.default.t("knowledgeGraph.statistics.below60"),color:s.wR[2]},{desc:r.default.t("knowledgeGraph.nodata"),color:s.wR[3]}]},mastery:{name:r.default.t("knowledgeGraph.masteryRate"),value:[{desc:"80%-100%",color:s.$e[0]},{desc:"60%-79%",color:s.$e[1]},{desc:r.default.t("knowledgeGraph.statistics.below60"),color:s.$e[2]},{desc:r.default.t("knowledgeGraph.nodata"),color:s.$e[3]}]}},p=(0,o.Fl)((function(){switch(e.viewMode){case i.wO.LEVEL:return d.level;case i.wO.COMPLETENESS:return d.completeness;case i.wO.MASTERY:return d.mastery;default:return d.level}})),f=(0,o.Fl)((function(){return e.viewMode!==i.wO.LEVEL||p.value.value.length>1}));return{legend:p,show:f,toggle:function(t){e.value!==t&&n("input",t)}}}}),p=(0,n(551900).Z)(d,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.show?n("div",{staticClass:"legend"},[n("div",{staticClass:"name"},[e._v(e._s(e.legend.name))]),e._v(" "),n("div",{staticClass:"grid-wrapper"},e._l(e.legend.value,(function(t,o){return n("div",{key:o,staticClass:"legend-item",class:{disabled:o>e.value},on:{click:function(t){return e.toggle(o)}}},[n("Badge",{staticStyle:{"margin-right":"6px"},attrs:{color:t.color}}),e._v(" "),n("span",[e._v(e._s(t.desc))])],1)})),0)]):e._e()}),[],!1,null,"033f81ee",null).exports},770181:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var o=n(925706),r=n(117403),i=n(311610),a=n(82720),s=n(444079),l=n(156209),c=n(146176),u=(0,o.aZ)({components:{SvgIcon:i.Z,Badge:s.Z},props:{viewMode:{type:String,required:!0}},setup:function(e,t){var n=(0,o.iH)(),i=(0,o.iH)(!1),s=(0,o.f3)("course",{id:0,type:0}),u=(0,o.f3)("allowedRelationTypes",{prev:!0,post:!0,undirected:!0}),d=(0,c.X)().depth,p=(0,o.qj)({course:!0,directedRelation:!0,levelRelation:!0,undirectedRelation:!0,showLevelNumber:0}),f=(0,o.iH)(),v=(0,o.iH)(r.default.t("fullScreen")),h=function e(t){f.value.contains(t.target)||(i.value=!1,document.removeEventListener("click",e))},m=(0,o.Fl)((function(){if(!n.value)return"slide-left";var e=n.value.getBoundingClientRect(),t=e.width;return e.x+t>window.innerWidth/2?"slide-right":"slide-left"})),g=(0,o.Fl)((function(){return"slide-left"===m.value?{left:"60px"}:{right:"60px"}})),y=(0,o.Fl)((function(){return a.LH[e.viewMode]}));return(0,o.m0)((function(){t.emit("on-setting-change",p)})),{isShowSettingMenu:i,menuRef:f,menuPosition:g,colorByMode:y,setting:p,animateName:m,eleRef:n,course:s,RELATION_LINK_COLOR:l.OO,allowedRelationTypes:u,fullscreenText:v,depth:d,fullscreen:function(){t.emit("on-fullscreen")},position:function(){t.emit("on-position")},showSettingMenu:function(e){i.value?h(e):(i.value=!0,document.addEventListener("click",h))},zoomIn:function(){t.emit("on-zoom-in")},zoomOut:function(){t.emit("on-zoom-out")}}}}),d=(0,n(551900).Z)(u,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"eleRef",staticClass:"graph-toolbar"},[n("div",{staticClass:"graph-tool",staticStyle:{padding:"0",cursor:"pointer"}},[n("SvgIcon",{staticStyle:{width:"1.8em"},attrs:{name:"line"}})],1),e._v(" "),n("div",{staticClass:"graph-tool",on:{click:e.fullscreen}},[n("Button",{attrs:{type:"text"}},[n("SvgIcon",{attrs:{name:"fullscreen"}})],1),e._v(" "),n("span",{staticClass:"graph-tool-name"},[e._v(e._s(e.fullscreenText))])],1),e._v(" "),n("div",{staticClass:"graph-tool",on:{click:e.position}},[n("Button",{attrs:{type:"text"}},[n("SvgIcon",{attrs:{name:"position"}})],1),e._v(" "),n("span",{staticClass:"graph-tool-name"},[e._v(e._s(e.$t("knowledgeGraph.reset")))])],1),e._v(" "),n("div",{staticClass:"graph-tool",on:{click:e.zoomIn}},[n("Button",{attrs:{type:"text"}},[n("SvgIcon",{attrs:{name:"zoom-in"}})],1),e._v(" "),n("span",{staticClass:"graph-tool-name"},[e._v(e._s(e.$t("zoomIn")))])],1),e._v(" "),n("div",{staticClass:"graph-tool",on:{click:e.zoomOut}},[n("Button",{attrs:{type:"text"}},[n("SvgIcon",{attrs:{name:"zoom-out"}})],1),e._v(" "),n("span",{staticClass:"graph-tool-name"},[e._v(e._s(e.$t("zoomOut")))])],1),e._v(" "),"forest"!==e.viewMode?n("div",{staticClass:"graph-tool graph-setting",on:{click:function(t){return t.stopPropagation(),e.showSettingMenu(t)}}},[n("Button",{attrs:{type:"text"}},[n("SvgIcon",{attrs:{name:"setting"}})],1),e._v(" "),n("span",{staticClass:"graph-tool-name"},[e._v(e._s(e.$t("knowledgeGraph.settings")))]),e._v(" "),n("transition",{attrs:{name:e.animateName}},[e.isShowSettingMenu?n("div",{ref:"menuRef",staticClass:"graph-setting-menu",style:e.menuPosition},[n("div",[n("Checkbox",{model:{value:e.setting.course,callback:function(t){e.$set(e.setting,"course",t)},expression:"setting.course"}},[n("Badge",{attrs:{color:e.colorByMode.course,size:12}}),e._v("\n            "+e._s(8!==e.course.type?e.$t("knowledgeGraph.course"):e.$t("project.tag"))+"\n          ")],1)],1),e._v(" "),e.depth>1?n("div",[n("Checkbox",{model:{value:e.setting.levelRelation,callback:function(t){e.$set(e.setting,"levelRelation",t)},expression:"setting.levelRelation"}},[n("SvgIcon",{style:{color:e.colorByMode.levelRelation},attrs:{name:"link-legend1"}}),e._v("\n            "+e._s(e.$t("knowledgeGraph.level"))+"\n          ")],1)],1):e._e(),e._v(" "),e.allowedRelationTypes.prev||e.allowedRelationTypes.post?n("div",[n("Checkbox",{model:{value:e.setting.directedRelation,callback:function(t){e.$set(e.setting,"directedRelation",t)},expression:"setting.directedRelation"}},[n("SvgIcon",{style:{color:e.RELATION_LINK_COLOR},attrs:{name:"link-legend2"}}),e._v("\n            "+e._s(e.$t("knowledgeGraph.priorOrSubsequent"))+"\n          ")],1)],1):e._e(),e._v(" "),e.allowedRelationTypes.undirected?n("div",[n("Checkbox",{model:{value:e.setting.undirectedRelation,callback:function(t){e.$set(e.setting,"undirectedRelation",t)},expression:"setting.undirectedRelation"}},[n("SvgIcon",{style:{color:e.RELATION_LINK_COLOR},attrs:{name:"link-legend3"}}),e._v("\n            "+e._s(e.$t("knowledgeGraph.related"))+"\n          ")],1)],1):e._e()]):e._e()])],1):e._e()])}),[],!1,null,"bc4d32ca",null).exports},802972:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return L}});n(141817),n(66992),n(788674),n(115306),n(333948);var o=n(925706),r=n(117403),i=n(311610),a=n(462149),s=n(662061),l=n(681423),c=n(202669),u=n(959769),d=n(718630),p=n(119292),f=n(887757),v=n.n(f);n(535666);function h(e,t,n,o,r,i,a){try{var s=e[i](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(o,r)}var m={props:{course_id:Number},methods:{stopPreview(){var e,t=this;return(e=v().mark((function e(){return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,s.mu)(t.course_id);case 2:window.location.reload();case 3:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(o,r){var i=e.apply(t,n);function a(e){h(i,o,r,a,s,"next",e)}function s(e){h(i,o,r,a,s,"throw",e)}a(void 0)}))})()}}},g=n(551900),y=(0,g.Z)(m,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"course-preview-tips"},[n("div",{staticClass:"row"},[n("div",{staticClass:"large-26 left tips-title"},[n("span",{staticClass:"title"},[e._v(e._s(e.$t("coursePreviewTips.coursePreview")))]),e._v(" "),n("span",{staticClass:"effect-title"},[e._v("\n        ("+e._s(e.$t("coursePreviewTips.studentView"))+")\n        "),n("Tooltip",{attrs:{content:e.$t("coursePreviewTips.previewMessage"),placement:"bottom"}},[n("span",{staticClass:"font font-question"})])],1)]),e._v(" "),n("div",{staticClass:"large-6 right text-right"},[n("a",{staticClass:"button",on:{click:e.stopPreview}},[e._v(e._s(e.$t("coursePreviewTips.goBack")))])])])])}),[],!1,null,"442accef",null).exports,w=n(153384),b=n(225590),_=n(82720),C=n(220093),k=n(770181),x=n(892932),S=n(860635),T=(0,o.aZ)({props:{value:{type:Number},nodes:{type:Array}},setup:function(e,t){var n,r,i=t.emit,a=(0,o.iH)(!0),s=(0,o.iH)(e.value);(0,o.YP)(s,(function(e){i("input",e)}));var l=null===(r=null===(n=window.globalData)||void 0===n?void 0:n.course)||void 0===r?void 0:r.name;return{open:a,selectedNode:s,courseName:l,clickHandler:function(e){s.value===e?s.value=void 0:s.value=e}}}}),D=(0,g.Z)(T,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"drawer-wrapper",class:{open:e.open}},[n("div",{staticClass:"content"},[n("Collapse",{attrs:{simple:"",value:"0"}},[n("Panel",{attrs:{"hide-arrow":""}},[n("div",{staticClass:"collapse-header"},[n("i",{staticClass:"font font-triangle-collapsed"}),e._v(" "),n("span",[e._v(e._s(e.courseName))])]),e._v(" "),n("div",{attrs:{slot:"content"},slot:"content"},e._l(e.nodes,(function(t){return n("label",{key:t.text,on:{click:function(n){return n.preventDefault(),e.clickHandler(t.id)}}},[e._v("\n            "+e._s(t.text)+"\n\n            "),n("input",{directives:[{name:"model",rawName:"v-model",value:e.selectedNode,expression:"selectedNode"}],staticClass:"hidden",attrs:{type:"radio",name:"chapter"},domProps:{value:t.id,checked:e._q(e.selectedNode,t.id)},on:{change:function(n){e.selectedNode=t.id}}})])})),0)])],1)],1),e._v(" "),n("div",{staticClass:"handle-btn",class:{open:e.open},on:{click:function(t){e.open=!e.open}}},[n("Icon",{attrs:{type:"ios-arrow-forward"}})],1)])}),[],!1,null,"871b562e",null).exports,I=n(183825),E=n(154803),N=n(966309),$=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},R=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},j=(0,o.aZ)({setup:function(e,t){var n=this,r=(0,o.iH)(""),i=(0,o.iH)(),a=(0,o.iH)(!1),l=(0,o.iH)(!1),c=(0,o.iH)(),u=!1,d=function(e,t){var n,o;void 0===t&&(t="*"),null===(o=null===(n=i.value)||void 0===n?void 0:n.contentWindow)||void 0===o||o.postMessage(e,t)};(0,N.ORN)("message",(function(e){"loaded"===e.data.type?l.value=!0:"routeChange"===e.data.type?(e.data.data.intoSecondLayer&&(u=!0),d({type:"clusterData",data:c.value})):"clickNode"===e.data.type?t.emit("on-click-node",e.data.data.id):"documentClick"===e.data.type?t.emit("on-document-click"):"iframeClick"===e.data.type?t.emit("on-iframe-click"):"graphUpdate"===e.data.type&&u&&e.data.data.topicId&&(t.emit("on-click-node",Number(e.data.data.topicId)),u=!1)})),(0,o.YP)([a,l,c],(function(){[a.value,l.value].every((function(e){return e}))&&d({type:"clusterData",data:c.value})})),(0,o.bv)((function(){return $(n,void 0,void 0,(function(){var e,t,n;return R(this,(function(o){switch(o.label){case 0:return[4,Promise.all([(0,s.Rt)(E.N7.value.id),(0,s.Fx)(E.N7.value.id)])];case 1:return e=o.sent(),t=e[0],n=e[1],r.value=t,c.value=n,a.value=!0,[2]}}))}))}));return(0,o.dl)((function(){return $(n,void 0,void 0,(function(){var e;return R(this,(function(t){switch(t.label){case 0:return l.value=!1,a.value=!1,[4,(0,s.Fx)(E.N7.value.id)];case 1:return e=t.sent(),c.value=e,a.value=!0,[2]}}))}))})),{src:r,iframeRef:i,resetZoom:function(){d({type:"resetZoom",data:{}})},zoomIn:function(){d({type:"zoomIn",data:{}})},zoomOut:function(){d({type:"zoomOut",data:{}})}}}}),P=(0,g.Z)(j,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("iframe",{ref:"iframeRef",attrs:{src:e.src,frameborder:"0"}})}),[],!1,null,"76c40fb1",null).exports,M=n(336775),O=(0,o.aZ)({components:{KnowledgeTree:M.default},props:{value:Boolean},setup:function(e,t){var n=t.emit;return{show:(0,N.NCN)(e,"value",n,{eventName:"input"})}}}),G=(0,g.Z)(O,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Modal",{staticClass:"modal",attrs:{"footer-hide":"",fullscreen:""},scopedSlots:e._u([{key:"header",fn:function(){return[n("div",{staticClass:"path-header"},[e._v("\n      "+e._s(e.$t("knowledgeGraph.editGraph"))+"\n    ")])]},proxy:!0}]),model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[e._v(" "),n("div",{staticClass:"container"},[n("KnowledgeTree")],1)])}),[],!1,null,"7248be22",null).exports,A=n(427372),Z=n(37423),H=n(243407),F=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},B=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},z=(0,o.aZ)({components:{HeaderWrapper:d.Z,CoursePreviewTip:y,CourseName:p.Z,Graph:b.Z,Legend:C.Z,Toolbar:k.Z,Drawer:S.Z,NodeDetailContent:I.Z,LearningPath:x.Z,ClusterGraph:P,KnowledgeTreeModal:G,SvgIcon:i.Z,NoData:A.Z,KnowledgeTree:M.default,CognitiveDimensionSelect:Z.Z,LeftDrawer:D},beforeRouteEnter:function(e,t,n){"/knowledge-tree"===t.path?n((function(e){e.getNodes()})):n()},setup:function(){var e,t,n,i,d,p=this,f=(0,o.f3)("course",{id:0}),v=(0,o.f3)("allowFacetsAndFragments",!1),h=(null===(e=window.featureToggles)||void 0===e?void 0:e.isCognitiveDimensionOpen)||!1,m=(i=v,d=[{key:"level",value:r.default.t("knowledgeGraph.graphView")}],i&&d.unshift({key:"forest",value:r.default.t("knowledgeGraph.forestView")}),(E.dE||E.Uz.value)&&d.push({key:"knowledge-tree",value:r.default.t("knowledgeGraph.listView")}),d),g=(0,o.iH)(_.wO.LEVEL),y=(0,H.tv)().route;!function(){var e,t;(Number.isNaN(Number(null!==(e=y.value.query.node_id)&&void 0!==e?e:0))?0:Number(null!==(t=y.value.query.node_id)&&void 0!==t?t:0))?g.value=_.wO.KNOWLEDGE_TREE:v&&"/forest"===y.value.path&&(g.value=_.wO.FOREST)}();var b=8===(null===(n=null===(t=window.globalData)||void 0===t?void 0:t.course)||void 0===n?void 0:n.courseType),C=(0,o.iH)([]),k=(0,o.iH)("--"),x=(0,o.iH)("--"),S=(0,o.iH)({course:!0,levelRelation:!0,directedRelation:!0,undirectedRelation:!0,showLevelNumber:0}),T=(0,o.iH)([]),D=(0,o.iH)(void 0),I=(0,o.Fl)((function(){return D.value?[T.value.find((function(e){return e.id===D.value}))]:T.value})),N=(0,o.iH)(),$=(0,o.iH)(),R=(0,o.iH)(),j=(0,o.iH)(!1),P=(0,o.iH)(),M=(0,o.iH)(new a.kx),O=(0,o.iH)();(0,o.JJ)("facetDetailModalStatus",{opened:!1}),(0,o.JJ)("relationContext",{fragmentModalInject:R});var G=(0,o.Fl)((function(){return E.Vl.value===a.QO.PUBLISHED})),A=(0,o.Fl)((function(){return!E.yw&&!E.Uz.value&&E.wZ})),Z=(0,o.Fl)((function(){return!E.wZ&&!G.value})),z=(0,o.Fl)((function(){return!!E.yw||(!(E.Uz.value||!E.wZ)||G.value)})),L=(0,o.Fl)((function(){return E.yw?400:E.Uz.value||!E.wZ?600:400})),U=(0,o.Fl)((function(){return!!E.yw||!(E.Uz.value||!E.wZ)})),V=(0,o.Fl)((function(){return!E.yw&&(E.Uz.value?G.value:G.value&&!E.wZ)})),q=function(){return F(p,void 0,void 0,(function(){var e;return B(this,(function(t){switch(t.label){case 0:return e=T,[4,(0,s.$H)(f.id)];case 1:return e.value=t.sent(),[2]}}))}))},Y=(0,o.Fl)((function(){return E.Uz.value||!E.wZ?b?G.value?r.default.t("knowledgeGraph.noContent"):r.default.t("project.refactor.notGraphTip"):G.value?r.default.t("knowledgeGraph.noContent"):r.default.t("knowledgeGraph.NoContentTip"):r.default.t("knowledgeGraph.noContent")}));(0,o.YP)((function(){return y.value.path}),(function(e){"/forest"===e?g.value=_.wO.FOREST:"/graph"===e&&(g.value=_.wO.LEVEL)})),(0,o.bv)((function(){return F(p,void 0,void 0,(function(){var e;return B(this,(function(t){switch(t.label){case 0:return q(),V.value&&0!==E.Wq?[4,(0,s.Rz)(f.id,E.Wq)]:[3,2];case 1:e=t.sent(),k.value=e.overallCompletenessRate,x.value=e.overallMasteryRate,t.label=2;case 2:return[2]}}))}))}));var K=(0,u.bG)(),W=K.tooltipCompletionRate,J=K.tooltipMasteryRate,X=K.isNormalMode;return{overallCompletenessRate:k,overallMasteryRate:x,canViewOverallRate:V,showKnowledgeTree:function(){w.N.push("/knowledge-tree")},graphSetting:S,nodes:T,viewMode:g,graphViewMode:m,graphRef:N,graphWrapperRef:R,showDrawer:j,currentNode:M,drawerRef:O,clusterGraphRef:$,selectRef:P,settingChange:function(e){E._T.value?(S.value.directedRelation=e.directedRelation,S.value.levelRelation=e.levelRelation,S.value.undirectedRelation=e.undirectedRelation,S.value.course=!1,S.value.showLevelNumber=100):S.value=e},restPosition:function(){var e,t;null===(e=N.value)||void 0===e||e.resetZoom(),null===(t=$.value)||void 0===t||t.resetZoom()},fullscreen:function(){var e;document.fullscreenElement?document.exitFullscreen():null===(e=R.value)||void 0===e||e.requestFullscreen()},clickNode:function(e){return F(p,void 0,void 0,(function(){var t;return B(this,(function(n){return e?j.value&&M.value.id===e?(j.value=!1,[2]):(j.value=!0,M.value.id===e||((t=new a.kx).id=e,M.value=t),[2]):[2]}))}))},closeDrawer:function(){var e;null===(e=N.value)||void 0===e||e.resetActive()},clickDocument:function(){j.value=!1},clickIframe:function(){P.value&&P.value.visible&&(P.value.visible=!1)},zoomIn:function(){var e,t;null===(e=N.value)||void 0===e||e.zoomIn(),null===(t=$.value)||void 0===t||t.zoomIn()},zoomOut:function(){var e,t;null===(e=N.value)||void 0===e||e.zoomOut(),null===(t=$.value)||void 0===t||t.zoomOut()},canViewLearningPath:U,drawerWidth:L,haveUpdatePermission:A,publishOrCancelPublish:function(){return F(p,void 0,void 0,(function(){var e,t;return B(this,(function(n){switch(n.label){case 0:return e=G.value?r.default.t("knowledgeGraph.cancelPublishTip"):r.default.t("knowledgeGraph.publishTip"),[4,c.Z.open({title:r.default.t("tips"),type:"warning",divider:!1,width:416,content:e})];case 1:return n.sent()?(t=G.value?a.QO.UNPUBLISHED:a.QO.PUBLISHED,[4,(0,s.wy)(f.id,t).then((function(){E.Vl.value=t;var e=G.value?r.default.t("knowledgeGraph.publishSuccess"):r.default.t("knowledgeGraph.cancelPublishSuccess");l.Z.success(e)})).catch((function(e){var t;(null===(t=e.response)||void 0===t?void 0:t.data.message)&&l.Z.error(e.response.data.message)}))]):[2];case 2:return n.sent(),[2]}}))}))},isPublished:G,canViewContent:z,isProject:b,learningPathDisabled:Z,isCognitiveDimensionOpen:h,dimensions:C,onCognitiveDimensionSelected:function(e){C.value=e},onViewModeChange:function(){C.value=[],w.N.replace({})},getNodes:q,noDataTip:Y,course:f,isSimulatingAsStudent:E.Uz,tooltipCompletionRate:W,tooltipMasteryRate:J,isNormalMode:X,allowFacetsAndFragments:v,currentTopNode:D,currentNodes:I,isDark:E._T,clickOutside:function(){j.value=!1},keyword:E.$E}}}),L=(0,g.Z)(z,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"knowledge-relation"},[e.isSimulatingAsStudent?n("CoursePreviewTip",{attrs:{course_id:e.course.id}}):e._e(),e._v(" "),e.canViewContent?n("div",{staticClass:"outer-wrapper"},[e.isDark?n("LeftDrawer",{staticClass:"left-drawer",attrs:{nodes:e.nodes},model:{value:e.currentTopNode,callback:function(t){e.currentTopNode=t},expression:"currentTopNode"}}):e._e(),e._v(" "),n("div",{ref:"graphWrapperRef",staticClass:"graph-wrapper"},["level"===e.viewMode?n("Graph",{ref:"graphRef",staticClass:"graph",attrs:{nodes:e.currentNodes,"view-mode":e.viewMode,keyword:e.keyword,dimensions:e.dimensions,setting:e.graphSetting},on:{"on-click-node":e.clickNode,"on-click-outside":e.clickOutside}}):e._e(),e._v(" "),"level"===e.viewMode?n("Legend",{staticClass:"graph-legend",attrs:{"view-mode":e.viewMode},model:{value:e.graphSetting.showLevelNumber,callback:function(t){e.$set(e.graphSetting,"showLevelNumber",t)},expression:"graphSetting.showLevelNumber"}}):e._e(),e._v(" "),"knowledge-tree"===e.viewMode?n("KnowledgeTree",{attrs:{keyword:e.keyword,dimensions:e.dimensions,"show-header":!1}}):e._e(),e._v(" "),"knowledge-tree"!==e.viewMode?n("Toolbar",{staticClass:"graph-toolbar",attrs:{"view-mode":e.viewMode},on:{"on-setting-change":e.settingChange,"on-fullscreen":e.fullscreen,"on-position":e.restPosition,"on-zoom-in":e.zoomIn,"on-zoom-out":e.zoomOut}}):e._e(),e._v(" "),e.allowFacetsAndFragments&&"forest"===e.viewMode?n("ClusterGraph",{ref:"clusterGraphRef",on:{"on-click-node":e.clickNode,"on-document-click":e.clickDocument,"on-iframe-click":e.clickIframe}}):e._e(),e._v(" "),n("Drawer",{ref:"drawerRef",staticClass:"right-drawer",class:{wide:e.drawerWidth>450},attrs:{fixed:"",width:e.drawerWidth,button:!1,mask:!1},on:{"on-close":e.closeDrawer},model:{value:e.showDrawer,callback:function(t){e.showDrawer=t},expression:"showDrawer"}},[e.currentNode.id?n("NodeDetailContent",{attrs:{node:e.currentNode,statistics:!0}}):e._e()],1)],1)],1):n("NoData",[e._v(e._s(e.noDataTip))])],1)}),[],!1,null,"44b28ce4",null).exports},926630:function(e,t,n){"use strict";n.d(t,{Z:function(){return y}});n(141817),n(66992),n(747042),n(788674),n(323123),n(333948);var o=n(925706),r=n(356264),i=n(117403),a=n(922942),s=n(558794),l=n(48496),c=n(391737),u=n(661510),d=n(496486),p=n(444296),f=n(662061),v=n(383228),h=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{l(o.next(e))}catch(e){i(e)}}function s(e){try{l(o.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}l((o=o.apply(e,t||[])).next())}))},m=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(l){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},g=(0,o.aZ)({props:{keyword:{type:String,default:""},activityCount:{type:Number,default:0},uploadCount:{type:Number,default:0},nodeId:{type:Number},stripe:{type:Boolean,default:!0}},components:{TooltipExt:s.Z,Pagination:u.Z},setup:function(e,t){var n,s,u,g,y=this,w=[{title:i.default.t("knowledgeGraph.statistics.resourceName"),key:"name",width:e.nodeId?"183px":"280px",slot:"name"},{title:i.default.t("knowledgeGraph.statistics.completionStudents"),key:"completionStudent",width:e.nodeId?"212px":"178px",renderHeader:function(e,t){return e("span",{style:{display:"flex","flex-direction":"row","align-items":"center"}},[e("span",{style:{"margin-right":"4px"}},t.column.title),e("Tooltip",{props:{transfer:!0,placement:"top",effect:"light","white-space":"normal",content:i.default.t("knowledgeGraph.statistics.completionConditions")}},[e("i",{class:"font font-question"})])])}},{title:i.default.t("knowledgeGraph.statistics.completeness"),key:"completeness",width:e.nodeId?"183px":"280px",sortable:!0,sortMethod:p.k},{title:i.default.t("knowledgeGraph.statistics.visits"),key:"visits",width:e.nodeId?"183px":"178px",sortable:!0},{title:i.default.t("knowledgeGraph.operation"),width:e.nodeId?"88px":"80px",key:"operation",slot:"operation"}],b=[{title:i.default.t("knowledgeGraph.statistics.activityName"),key:"name",width:e.nodeId?"269px":"280px",slot:"name"},{title:i.default.t("knowledgeGraph.statistics.activityType"),width:e.nodeId?"120px":"134px",key:"type",render:function(e,t){return e("span",i.default.t("activityType.".concat(t.row.type)))}},{title:i.default.t("knowledgeGraph.statistics.completionStudents"),width:e.nodeId?"120px":"134px",key:"completionStudent"},{title:i.default.t("knowledgeGraph.statistics.completeness"),width:e.nodeId?"120px":"134px",key:"completeness",sortable:!0,sortMethod:p.k},{title:i.default.t("knowledgeGraph.statistics.mastery"),key:"masteryRate",width:e.nodeId?"120px":"134px",sortable:!0,sortMethod:function(e,t,n){return"--"===e?1:"--"===t?-1:(0,p.k)(e,t,n)}},{title:i.default.t("knowledgeGraph.operation"),width:e.nodeId?"100px":"80px",key:"operation",slot:"operation"}],_=(0,o.iH)(""),C=(0,o.iH)([]),k=null!==(n=e.nodeId)&&void 0!==n?n:Number(window.location.hash.split("/").slice(-1)[0]),x=null!==(g=null===(u=null===(s=window.globalData)||void 0===s?void 0:s.course)||void 0===u?void 0:u.id)&&void 0!==g?g:0,S=(0,o.Vh)(e,"keyword"),T=(0,o.iH)(),D=function(e,t){return h(y,void 0,void 0,(function(){var n;return m(this,(function(o){return n={keyword:S.value},[2,(0,f.FF)(k,e,t,n)]}))}))},I=function(e,t){return h(y,void 0,void 0,(function(){var n;return m(this,(function(o){return n={keyword:S.value},[2,(0,f.Fr)(k,e,t,n)]}))}))},E=function(){"upload"===_.value&&(T.value=(0,a.h0)(D)),"activity"===_.value&&(T.value=(0,a.h0)(I))},N=function(e){"upload"===e&&(_.value=e,C.value=w),"activity"===e&&(_.value=e,C.value=b),t.emit("tab-changed",e)};return(0,o.YP)((function(){return e.keyword}),(function(){var e;E(),null===(e=T.value)||void 0===e||e.fetch()})),(0,o.YP)((function(){return _.value}),(function(){var e;E(),null===(e=T.value)||void 0===e||e.fetch()})),(0,o.bv)((function(){N("upload")})),{tab:_,columns:C,pagination:T,fileTypeByExtension:l.fileTypeByExtension,openDetail:function(e){return"activity"===_.value?"exam"===e.type?window.open("/course/".concat(x,"/learning-activity/full-screen#/exam/").concat(e.id),"_blank"):window.open("/course/".concat(x,"/learning-activity/full-screen#/").concat(e.id),"_blank"):"upload"===_.value?function(e){document.fullscreenElement&&document.exitFullscreen();var t=(0,c.useAngularScope)(),n=(0,d.map)(T.value.data.items,(function(e){return(0,r.decamelizeKeys)(e)})),o=(0,r.decamelizeKeys)(e);t.$broadcast("previewFiles",n,o),v("#file-previewer").foundation("reveal","open")}(e):null},changeTab:N,formatActivityType:function(e){return e.split("_").join("-")}}}}),y=(0,n(551900).Z)(g,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"content"},[n("div",{staticClass:"tabs"},[n("div",{staticClass:"tab",class:{active:"upload"===e.tab},on:{click:function(t){return e.changeTab("upload")}}},[e._v("\n      "+e._s(e.$t("knowledgeGraph.referenceResource"))+" ("+e._s(e.uploadCount)+")\n    ")]),e._v(" "),n("div",{staticClass:"tab",class:{active:"activity"===e.tab},on:{click:function(t){return e.changeTab("activity")}}},[e._v("\n      "+e._s(e.$t("knowledgeGraph.referenceActivity"))+" ("+e._s(e.activityCount)+")\n    ")])]),e._v(" "),n("Table",{staticClass:"table-wrapper",attrs:{columns:e.columns,data:e.pagination&&e.pagination.data&&e.pagination.data.items||[],stripe:e.stripe},scopedSlots:e._u([{key:"name",fn:function(t){var o=t.row;return[n("div",{staticClass:"name-wrapper"},["upload"===e.tab?n("i",{class:"font font-file-"+e.fileTypeByExtension(o)}):e._e(),e._v(" "),"activity"===e.tab?n("i",{class:"font font-syllabus-"+e.formatActivityType(o.type)}):e._e(),e._v(" "),n("TooltipExt",{staticClass:"name",attrs:{text:o.name}})],1)]}},{key:"operation",fn:function(t){var o=t.row;return[n("div",{staticClass:"operation"},[n("Tooltip",{attrs:{content:e.$t("view"),placement:"top"}},[n("i",{staticClass:"font font-resource-view",on:{click:function(t){return t.stopPropagation(),e.openDetail(o)}}})])],1)]}}])}),e._v(" "),e.pagination&&e.pagination.data&&e.pagination.data.pages>0?n("div",{staticClass:"pagination"},[n("Pagination",{attrs:{total:e.pagination.data.total,"page-size":e.pagination.data.pageSize,current:e.pagination.data.page,"show-sizer":"","show-elevator":""},on:{"on-change":e.pagination.pageChanged,"on-page-size-change":e.pagination.pageSizeChanged}})],1):e._e()],1)}),[],!1,null,"6895fb75",null).exports},651013:function(e,t,n){"use strict";n.d(t,{Z:function(){return f}});n(747042),n(323123);var o,r,i=n(925706),a=n(661510),s=n(986228),l=n(117403),c=n(662061),u=n(547454),d=null!==(r=null===(o=window.globalData)||void 0===o?void 0:o.course)&&void 0!==r?r:{id:0},p=(0,i.aZ)({props:{keyword:{type:String,default:""},nodeId:{type:Number},stripe:{type:Boolean,default:!0}},components:{EllipsisText:s.Z,Pagination:a.Z},setup:function(e){var t,n=[{title:l.default.t("knowledgeGraph.statistics.userNo"),key:"userNo",slot:"userNo",width:e.nodeId?"183px":"247px"},{title:l.default.t("name"),key:"name",width:e.nodeId?"212px":"247px"},{title:l.default.t("knowledgeGraph.statistics.completeness"),key:"completenessRate",sortable:"custom",width:e.nodeId?"183px":"160px"},{title:l.default.t("knowledgeGraph.statistics.mastery"),key:"masteryRate",sortable:"custom",width:e.nodeId?"183px":"160px"},{title:l.default.t("operation"),slot:"action",width:e.nodeId?"88px":"80px",align:"center"}],o=null!==(t=e.nodeId)&&void 0!==t?t:Number(window.location.hash.split("/").slice(-1)[0]),r=(0,u._)(e,c.bi,o);return{columns:n,data:r.data,pagination:r.pagination,sortChange:r.sortChange,toStudentInfo:function(t){var n="/course/".concat(d.id,"/stat#/knowledge-graph/node/").concat(o,"/student/").concat(t.studentId);e.nodeId?window.open(n,"_blank"):window.location.href=n},loading:r.loading}}}),f=(0,n(551900).Z)(p,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"student-detail-content"},[n("Table",{staticClass:"table-wrapper",attrs:{columns:e.columns,data:e.pagination.data.items,loading:e.loading,stripe:e.stripe},on:{"on-sort-change":e.sortChange},scopedSlots:e._u([{key:"userNo",fn:function(e){var t=e.row;return[n("EllipsisText",{attrs:{line:1,text:t.userNo,"use-tipsy":!0}})]}},{key:"action",fn:function(t){var o=t.row;return[n("Tooltip",{staticClass:"operation",attrs:{placement:"top",content:e.$t("view")}},[n("i",{staticClass:"font font-resource-view",on:{click:function(t){return e.toStudentInfo(o)}}})])]}}])}),e._v(" "),e.pagination.data.pages>0?n("div",{staticClass:"pagination"},[n("Pagination",{attrs:{total:e.pagination.data.total,"page-size":e.pagination.data.pageSize,current:e.pagination.data.page,"show-sizer":"","show-elevator":""},on:{"on-change":e.pagination.pageChanged,"on-page-size-change":e.pagination.pageSizeChanged}})],1):e._e()],1)}),[],!1,null,"8c2ddb18",null).exports},603912:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var o={props:{active:{type:Boolean},max:{type:Number},min:{type:Number},currentValue:{type:Number}},data(){return{value:this.currentValue}},methods:{changeValue(){this.$emit("change-value",this.value)}}},r=(0,n(551900).Z)(o,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("InputNumber",{staticClass:"minimum-answer-input",attrs:{max:e.max,min:e.min,"controls-outside":"",size:"small",editable:!1,disabled:!e.active},on:{"on-change":function(t){return e.changeValue()}},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})}),[],!1,null,"77265c06",null).exports},192188:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});n(682772),n(747042),n(804723),n(323123),n(454747);var o={name:"thumbnail",props:{images:{type:Array,default:()=>[]}},data:()=>({thumbnails:[],ready:!1}),created(){this.images.forEach((e=>{var t=this;if(e.width&&e.height){var n={src:e.src,msrc:e.src,w:e.width,h:e.height};t.thumbnails.push(n)}else{var o=new Image;o.src=e.src,o.onload=function(){var n=o.width,r=o.height,i={src:e.src,msrc:e.src,w:n,h:r};t.thumbnails.push(i)}}})),this.ready=!0}},r=n(551900),i={name:"subject-info",components:{thumbnail:(0,r.Z)(o,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.ready?n("vue-preview",{class:{"many-columns":e.thumbnails.length>1,"one-column":1===e.thumbnails.length},attrs:{slides:e.thumbnails}}):e._e()],1)}),[],!1,null,"55e5f4e8",null).exports},props:{content:{type:String,default:""}},created(){var e=window.location.href;e.indexOf("?")<0&&(e+="?thumbnail=true",window.history.replaceState({path:e},"",e))},data(){return{images:this.getSubjectImages(),contents:this.getContentWithoutImages()}},methods:{getSubjectImages(){var e=[];if(!this.content)return e;var t=this.content.match(/<img.*?(?:>|\/>)/gi);if(t)for(var n=0;n<t.length;n++){var o=(new window.DOMParser).parseFromString(t[n],"text/html").querySelector("img"),r=o.src,i=o.width,a=o.height,s=i&&a?{src:r,width:i,height:a}:{src:r};e.push(s)}return e},getContentWithoutImages(){var e="",t="",n=this.content.indexOf("<img");n<0?e=this.content.slice(0):(e=this.content.slice(0,n),this.content.split(/<img.*?(?:>|\/>)/gi).forEach((n=>{n!==e&&(t+=n)})),"<br></p>"===t&&(t=""));return{beforeContent:e,afterContent:t}}}},a=(0,r.Z)(i,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"content-center"},[n("div",{domProps:{innerHTML:e._s(e.contents.beforeContent)}}),e._v(" "),n("thumbnail",{attrs:{images:e.images}}),e._v(" "),n("div",{domProps:{innerHTML:e._s(e.contents.afterContent)}})],1)}),[],!1,null,"7ad947ca",null).exports},769700:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var o={components:{SvgIcon:n(311610).Z}},r=(0,n(551900).Z)(o,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"nothing"},[n("SvgIcon",{staticClass:"img",attrs:{name:"empty-project"}}),e._v(" "),n("div",{staticClass:"desc"},[e._t("default")],2)],1)}),[],!1,null,"31be8915",null).exports}}]);