(self.webpackChunklms=self.webpackChunklms||[]).push([[30454],{978571:function(__unused_webpack_module,exports,__webpack_require__){var $=__webpack_require__(383228),_=__webpack_require__(496486),moment=__webpack_require__(730381),helper=__webpack_require__(293789),angular=__webpack_require__(261139),Decimal=__webpack_require__(993776);function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return n}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _createForOfIteratorHelper(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,l=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){l=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw o}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}__webpack_require__(141817),__webpack_require__(491038),__webpack_require__(682772),__webpack_require__(66992),__webpack_require__(365069),__webpack_require__(140561),__webpack_require__(556977),__webpack_require__(426833),__webpack_require__(788674),__webpack_require__(339714),__webpack_require__(132023),__webpack_require__(804723),__webpack_require__(115306),__webpack_require__(864765),__webpack_require__(323123),__webpack_require__(923157),__webpack_require__(573210),__webpack_require__(454747),__webpack_require__(333948),__webpack_require__(691285),__webpack_require__(678736);var renderMathInElement=__webpack_require__(92116),hljs=__webpack_require__(398128),iFrameResize=__webpack_require__(246955),I18n=__webpack_require__(117403).default,Vue=__webpack_require__(370538).default,sortable=__webpack_require__(751474),Sortable=sortable.default,utils=__webpack_require__(693604),uploadApi=__webpack_require__(201351),uploadService=__webpack_require__(606565),_require=__webpack_require__(859065),allowTypedToAnswerQuestion=_require.allowTypedToAnswerQuestion,generateHandle=_require.generateHandle,bool=e=>"string"==typeof e&&(""===e||"true"===e);exports.parseInteger=()=>({restrict:"A",require:"?ngModel",link(e,t,n,r){r.$parsers.push(utils.parseInteger),r.$formatters.push((function(e){return""+e}))}}),exports.ngCompileHtml=["$compile",e=>function(t,n,r){t.$watch(r.ngCompileHtml,(function(){var i,o=t.$eval(r.ngCompileHtml);if(o=o.replace(/]]/g,"]\x3c!----\x3e]"),n.html(o),0!==(i=document.getElementsByClassName("pre-wrap subject-description simditor-viewer")).length&&i.forEach((e=>{e.getElementsByClassName("simditor-attachment").forEach((e=>{var t,n;n="compiled",(t=e)&&(t.classList.contains(n)||t.classList.add(n))}))})),allowTypedToAnswerQuestion()){var a,l=generateHandle(n,null===(a=t.subject)||void 0===a?void 0:a.type);l&&l()}"mathjax"in r&&window.MathJax&&MathJax.typeset&&MathJax.typeset([n[0]]),e(n.contents())(t)}))}],exports.simditorAudio=()=>({restrict:"A",replace:!0,scope:{src:"@",id:"@",name:"@"},template:'\n            <span ng-show="finishRendering" class="simditor-audio-player compiled" ng-class="{\'playing\': status != \'ready\'}">\n                <span class="simditor-audio-container" ng-class="{\'disabled\': !allowPlay() && status == \'ready\' && !inEditSubjects, \'exam-mode\': inExam && resourceLoaded && !inSubmission, \'not-loaded\': !resourceLoaded}">\n                  <span class="play" ng-click="playButton($event)" ng-class="{\'disabled\': ((status == \'play\' && play_limit && inExam && !inSubmission) || !resourceLoaded) && !inEditSubjects}">\n                      <i ng-if="status==\'ready\'" class="font font-simditor-audio-play"></i>\n                      <i ng-if="status==\'play\'" class="font font-simditor-audio-pause"></i>\n                      <i ng-if="status==\'pause\'" class="font font-simditor-audio-continue"></i>\n                  </span>\n                  <span class="name truncate-text" tipsy-literal="{{ name }}" tipsy-ellipsis="yes" tipsy-ellipsis-check-method="width"\n                          tipsy-follow-element-width="true" ng-if="!inExam && resourceLoaded">{{ name }}</span>\n                  <span class="name load-failed" ng-if="!resourceLoaded && !isAudioLoading" ng-bind="notLoadedMessage[lang]"></span>\n                  <span class="simditor-audio-wrapper" ng-class="{\'with-name\': !inExam || !resourceLoaded}">\n                     <span class="duration">\n                          <span ng-bind="ui.currentTime | secondsToHms"></span><span>/</span><span ng-bind="ui.duration | secondsToHms"></span>\n                     </span>\n                     <span class="volume-bar" ng-class="{\'disabled\': (!allowPlay() && status == \'ready\') || !resourceLoaded}">\n                          <input class="volume-slider" type="range" min="0" max="100" ng-model="volume" ng-change="modifyVolume()">\n                          <i ng-show="volume" ng-click="mute()" class="font font-audio-volume2"></i>\n                          <i ng-hide="volume" ng-click="unmute()" class="font font-audio-volume-off2"></i>\n                     </span>\n                     <span class="progress-bar">\n                          <div class="progress"></div>\n                     </span>\n                  </span>\n                  <audio id="{{id}}" preload="none" class="audio">\n                     <source src="{{src}}">\n                  </audio>\n                </span>\n                <span class="warning-container mt-3" ng-if="(play_limit && inExam) && !inSubmission">\n                    <span class="warning" ng-bind="leftTimesWarningMessage[lang] | format:[left_times]"></span>\n                </span>\n            </span>',link(e,t,n,r){var i=t.find("audio")[0],o=$(i),a=t.find("audio source")[0],l=t.find(".progress")[0],s=$(l),d=!1,c={};if(e.play_limit_key=e.id,e.$parent.subject||e.$parent.currentSubject){e.play_record=e.$parent.play_record||{},e.subject=e.$parent.subject||e.$parent.currentSubject,e.subject.settings=e.subject.settings||{},e.play_limit_key="".concat(e.subject.id,"_").concat(e.id),e.play_times=e.play_record[e.play_limit_key]||0,e.play_limit=e.subject.play_limit||e.subject.settings.play_limit||!1,e.play_limit_times=e.subject.play_limit_times||e.subject.settings.play_limit_times||0;var u=e.play_limit_times-e.play_times;e.left_times=u>=0?u:0}e.lang=e.$parent.lang,e.ui={currentTime:0,duration:0},e.volume=100,e.expandVolume=!1,e.currentAudioScope={},e.inExam=e.$parent.inExam||!1,e.inEditSubjects=e.$parent.inEditSubjects||!1,e.inSubmission=e.$parent.inSubmission||!1,e.status="ready",e.isAudioLoading=!0,setTimeout((function(){e.finishRendering=!0,e.$apply()}),1500),e.leftTimesWarningMessage={"en-GB":"Playback Limits : {0}","en-US":"Playback Limits : {0}","zh-CN":"剩余播放次数: {0}","zh-MO":"剩餘播放次數: {0}","zh-TW":"剩餘播放次數: {0}","th-TH":"ขีดจำกัดการเล่น : {0}","id-ID":"Masih ada sisa waktu pemutaran","ms-MY":"Bilangan siaran yang tinggal","vi-VN":"Playback Limits : {0}"},e.notLoadedMessage={"en-GB":"Error: data loss or transcoding.","en-US":"Error: data loss or transcoding.","zh-CN":"无法播放，文件遗失或转码中","zh-MO":"無法播放，檔案遺失或轉碼中","zh-TW":"無法播放，檔案遺失或轉碼中","th-TH":"ข้อผิดพลาด: ข้อมูลสูญหายหรือแปลงรหัส","id-ID":"Tidak dapat memutar, file hilang atau dalam proses pengkodean","ms-MY":"Tidak dapat disiarkan, fail itu tiada atau sedang ditranskodkan","vi-VN":"Error: data loss or transcoding."},e.allowPlay=function(){return!!e.resourceLoaded&&(!e.inExam||(!e.subject||(!e.play_limit||(e.left_times>0||(!!e.inSubmission||!!e.inEditSubjects)))))},e.playButton=function(t){return t.preventDefault(),!!e.allowPlay()&&("play"==e.status?!(e.play_limit&&e.inExam&&!e.inSubmission&&!e.inEditSubjects)&&e.pause():void(e.currentAudioScope!=e&&"play"==e.currentAudioScope.status?e.inExam&&!e.inSubmission&&e.currentAudioScope.play_limit?($("#switch-audio-confirmation-popup").foundation("reveal","open"),e.$root.$broadcast("initSwitchAudioPopup",{currentAudioScope:e.currentAudioScope,nextAudioScope:e})):e.$root.$broadcast("switchAudio",{currentAudioScope:e.currentAudioScope,nextAudioScope:e}):e.play()))},e.pause=function(){return i.pause(),e.status="pause",e.$root.$broadcast("simditorAudioStatus",e),e.updateSliderColor(),e.status},e.play=function(){if(d)return $("#switch-video-confirmation-popup").foundation("reveal","open"),void e.$root.$broadcast("initSwitchVideoPopup",{currentVideo:{limitTimes:c.playLimitTimes,type:"switch",playLimit:c.playLimit},audioScope:e});e.subject&&(e.play_record[e.play_limit_key]=(e.play_record[e.play_limit_key]||0)+1,e.play_record.needSync=!0,e.$emit("playRecordUpdated"),e.inEditSubjects||(e.left_times-=1)),e.status="play",i.play(),e.$root.$broadcast("audioPlay",e),e.$root.$broadcast("simditorAudioStatus",e),e.updateSliderColor()},e.end=function(){i.pause(),i.currentTime=0,e.status="ready",e.updateSliderColor(),e.$apply(),e.$root.$broadcast("simditorAudioStatus",e)},e.mute=function(){e.tempVolume=e.volume,e.volume=0,e.modifyVolume()},e.unmute=function(){e.volume=e.tempVolume||100,e.modifyVolume()},e.audio=i,i.onended=function(){i.currentTime=0,e.status="ready",e.updateSliderColor(),e.$apply(),e.$root.$broadcast("audioPlay",e),e.$root.$broadcast("simditorAudioStatus",e)},i.onloadeddata=function(){e.resourceLoaded=!0,e.finishRendering=!0,e.isAudioLoading=!1,e.$apply(),"true"===n.autoplay&&e.play()},a.onerror=()=>{e.isAudioLoading=!1,e.$apply()},e.modifyVolume=function(){i.volume=e.volume/100,e.updateSliderColor()},e.updateSliderColor=function(){var t,n;t="ready"!=e.status?"#ffffff":"#6C6C6C",n="ready"!=e.status?"#0089B3":"#B5B5B5",$(".volume-slider").css("background","linear-gradient(to right, ".concat(t," 0%, ").concat(t," ").concat(e.volume,"%, ").concat(n,"  ").concat(e.volume,"%, ").concat(n," 100%)"))},o.on("durationchange",(function(){e.ui.duration=i.duration,e.$apply()})),o.on("timeupdate",(function(){e.ui.currentTime=i.currentTime,s.width("".concat(parseInt(100*i.currentTime/i.duration),"%")),e.$apply()})),e.$on("simditorAudioStatus",(function(t,n){e.currentAudioScope=n})),e.$on("switchAudio",(function(t,n){n.nextAudioScope==e?e.play():n.currentAudioScope==e&&(e.inExam?(i.pause(),i.currentTime=0,e.status="ready",e.updateSliderColor()):(i.pause(),e.status="pause",e.updateSliderColor()))})),e.$on("pauseAudio",((t,n)=>{i.pause(),i.currentTime=0,e.status="ready",e.updateSliderColor()})),e.$on("playAudio",((t,n)=>{d=!1,n==e&&e.play()})),e.$on("videoPlay",((e,t)=>{(c=t).inSubmission||(d=c.playing)})),e.$on("directVideoClose",(()=>{d=!1})),t.find(".volume-bar").mouseover((function(){e.expandVolume=!0})),e.updateSliderColor(),i.load()}}),exports.expandableContent=()=>({restrict:"A",link(e,t,n,r){var i=n.expandableContent;e.isExpanded=["module","bulletin","classification","topic"].includes(i);var o=function(){return e.isExpanded?$(".".concat(i,"-summary"),t).addClass("expanded"):$(".".concat(i,"-summary"),t).removeClass("expanded")};return o(),$(".".concat(i,"-summary"),t).on("click",(function(){return $(".".concat(i,"-content"),t).slideToggle(100),e.isExpanded=!e.isExpanded,o(),e.$apply()}))}}),exports.expandableContentRemember=["$timeout",e=>({restrict:"A",scope:{cookieKey:"@",toggleModel:"="},link(t,n,r){var i=r.expandableContentRemember,o=null,a=r.manualExpandedModuleId?parseInt(r.manualExpandedModuleId):"",l=null==r.toggleEmptyContent||"true"===r.toggleEmptyContent,s=null!=r.defaultExpanded?"true"===r.defaultExpanded:"module"===i||"classification"===i||"syllabus"===i;t.isExpanded=s;var d={},c=function(){var e,r,o=$(".".concat(i,"-summary .expand-collapse-button > .icon"),n),a=["icon-module-toggle-collapsed","icon-toggle-collapsed-lighter","font-toggle-collapsed","font-module-collapse","font-down","font-collapse-arrow"],l=["icon-module-toggle-expanded","icon-toggle-expanded-lighter","font-toggle-expanded","font-module-expand","font-up","font-expand-arrow"];return t.isExpanded?(e=l,r=a,$(".".concat(i,"-summary"),n).addClass("expanded"),$(n).addClass("expanded"),t.$emit("expandableContentExpanded",t.toggleModel)):(e=a,r=l,$(".".concat(i,"-summary"),n).removeClass("expanded"),$(n).removeClass("expanded"),t.$emit("expandableContentCollapsed",t.toggleModel)),_.each(r,(function(t,n){if(o.hasClass(t))return o.removeClass(t),o.addClass(e[n])}))},u=function(){return _.has($.cookie(),t.cookieKey)?JSON.parse($.cookie()[t.cookieKey]):{}},p=function(){return""!==a?t.toggleModel.id===a:_.has(d,t.toggleModel.id)?d[t.toggleModel.id]:s},f=function(){d=u();var e=p();return $(".".concat(i,"-content"),n).slideToggle(100),t.isExpanded=!e,o&&o.trigger("memberUpdated"),d[t.toggleModel.id]=t.isExpanded,$.cookie(t.cookieKey,JSON.stringify(d),{expires:365}),c(),t.$apply()};return t.change=function(e){if(e!==t.isExpanded)return f()},t.isToggleable=()=>l||(null!=t.toggleModel.syllabuses?t.toggleModel.syllabuses.length:void 0)||(null!=t.toggleModel.activities?t.toggleModel.activities.length:void 0),$(".".concat(i,"-summary"),n).on("click",(function(){if(t.isToggleable())return f()})),$(".not-toggle-content",n).on("click",(function(e){e.stopPropagation()})),n.on("$destroy",(function(){if(o)return o.trigger("memberRemoved",t)})),e((function(){return d=u(),t.isExpanded=p(),t.isExpanded||$(".".concat(i,"-content"),n).hide(),r.toggleGroup&&(o=$("#"+r.toggleGroup)).trigger("memberCreated",t),c()}))}})],exports.foldableContentRemember=["$timeout","$rootScope",(e,t)=>({restrict:"A",scope:{cookieKey:"@"},link(n,r){var i={};$("#course-menubar-fold",r).on("click",(function(){i=o();var e=l();return t.isFold=!e,a(),n.$apply()}));var o=function(){return _.has($.cookie(),n.cookieKey)?JSON.parse($.cookie()[n.cookieKey]):{}},a=function(){return i.isFold=t.isFold,$.cookie(n.cookieKey,JSON.stringify(i),{expires:365})},l=function(){return!_.has(i,"isFold")||i.isFold};return e((function(){return i=o(),t.isFold=l()}))}})],exports.expandableContentNew=["$timeout",e=>({restrict:"A",link:(t,n,r)=>e((function(){var e=r.expandableContentNew;if(t.isExpanded="true"===r.isExpanded,$(".".concat(e)).length)return t.isExpanded||$(".".concat(e)).css("display","none"),n.on("click",(function(){var r=t.isExpanded?n.data("collapsed"):n.data("expanded");if(r&&n.html(r),$(".".concat(e)).slideToggle(100),t.isExpanded=!t.isExpanded,!t.$$phase)return t.$apply()}))}),300)})],exports.expandableContentIsolate=["$timeout",e=>({restrict:"A",scope:!0,link:(t,n,r)=>e((function(){var e=r.expandableContentIsolate;if(t.isExpanded="true"===r.isExpanded,$(".".concat(e)).length)return t.isExpanded||$(".".concat(e)).css("display","none"),n.on("click",(function(){var r=t.isExpanded?n.data("collapsed"):n.data("expanded");return r&&n.html(r),$(".".concat(e)).slideToggle(100),t.isExpanded=!t.isExpanded,t.$apply()}))}))})],exports.toggleGroupManager=()=>({restrict:"A",link(e,t,n){t.attr("id",n.toggleGroupManager),e.isExpanded="true"===n.defaultExpanded,e.members={};var r=!0,i=function(){return r=!r,t.toggle()},o=function(){if(r!==function(){for(var t=0,n=Object.keys(e.members||{});t<n.length;t++)return n[t],!0;return!1}())return i()},a=function(){if(function(){for(var t=!1,n=0,r=Object.keys(e.members||{});n<r.length;n++){var i=r[n],o=e.members[i];if(o.isToggleable()&&(t=!0,!o.isExpanded))return!1}return t}()!==e.isExpanded)return e.isExpanded=!e.isExpanded};return t.on("click",(function(){return e.isExpanded=!e.isExpanded,t=e.isExpanded,(()=>{for(var n=[],r=0,i=Object.keys(e.members||{});r<i.length;r++){var o=i[r],a=e.members[o];a.isToggleable()?n.push(a.change(t)):n.push(void 0)}return n})();var t})),t.on("click-to-expand",(function(){return e.isExpanded=!0,t=e.isExpanded,(()=>{for(var n=[],r=0,i=Object.keys(e.members||{});r<i.length;r++){var o=i[r],a=e.members[o];a.isToggleable()&&a.isExpanded===!t?n.push(a.change(t)):n.push(void 0)}return n})();var t})),t.on("memberCreated",(function(t,n){return e.members[n.$id]=n,o(),a()})),t.on("memberUpdated",(()=>a())),t.on("memberRemoved",(function(t,n){return e.members[n.$id]&&delete e.members[n.$id],o()})),i()}}),exports.smsPin=["$http","$timeout","toastr","commonApi",(e,t,n,r)=>({restrict:"A",link(e,n,i){var o=n.text(),a=i.waitingText,l=i.errorField,s=i.waitingSeconds||60,d="false"!==i.validateExist,c=e=>function(){var r=Math.floor((new Date).getTime()/1e3);if(r<e){var i=e-r;return n.text(a.replace("{0}",i)),t(c(e),1e3)}return n.text(o),n.on("click",f)},u=function(){n.unbind("click");var e=Math.floor((new Date).getTime()/1e3)+s;return c(e)()},p=function(t){if(e.errors=t.errors,l)return e.errors[l]=t.errors.mobile_phone},f=()=>r.requestSMSPinCode(i.phoneNumber,u,p,d);return n.on("click",f)}})],exports.datepicker=["$timeout",e=>({restrict:"A",require:"ngModel",link:(t,n,r,i)=>(n.prop("autocomplete","off"),e((()=>n.datetimepicker({format:"YYYY-MM-DD",language:$("html").attr("lang"),pickTime:!1,useCurrent:!1}).on("dp.hide",(()=>i.$setViewValue($(n).val()))))))})],exports.timepicker=["$timeout",e=>({restrict:"A",require:"ngModel",link:(t,n,r,i)=>(n.prop("autocomplete","off"),e((()=>n.datetimepicker({format:"HH:mm",language:$("html").attr("lang"),pickDate:!1,useCurrent:!1}).on("dp.hide",(()=>i.$setViewValue($(n).val()))))))})],exports.datetimepicker=["$timeout",e=>({restrict:"A",require:"ngModel",link(t,n,r,i){var o,a;n.prop("autocomplete","off"),r.hasOwnProperty("noTime")?(a=!1,o="YYYY-MM-DD"):(a=!0,o="YYYY-MM-DD HH:mm");return i.$parsers.push((function(e){var t=moment(e,o,!0);return t.isValid()?t.utc().format("YYYY-MM-DDTHH:mm:ss")+"Z":e})),i.$formatters.push((function(e){var t=moment(e);return t.isValid()?t.format(o):e})),i.$formatters.push((function(e){var t=moment(e),r=n.data("DateTimePicker");return t.isValid()&&r&&r.setValue(t),e})),e((()=>n.datetimepicker({format:o,language:$("html").attr("lang"),pickTime:a,useCurrent:!0}).on("dp.hide",(()=>i.$setViewValue($(n).val()))).on("keypress",(function(e){if(13===e.keyCode)return i.$setViewValue($(n).val()),$(this).blur()}))))}})],exports.confirmDialog=()=>({priority:-1,restrict:"A",scope:{getConfirmMessage:"&"},link:(e,t,n)=>t.on("click",(function(t){var r=function(){var t=n.confirmDialog;return!t&&e.getConfirmMessage&&(t=e.getConfirmMessage()),t}();if(n.disabled||!window.confirm(r))return t.stopImmediatePropagation(),t.preventDefault()}))}),exports.hasSecondLevelMenu=()=>({restrict:"A",scope:{expandLeft:"="},link(e,t,n){$(t).find("li:has(ul.second-level)").mouseenter((function(){if(e.expandLeft){var t=$(this).find("ul").first().width();$(this).find("ul").first().css("left",-t-2+"px")}$(this).find("ul").first().show()})).mouseleave((function(){$(this).find("ul").first().hide()})),$(t).find("li:has(ul.second-level)").on("touchstart",(function(){$(this).parent().children("li").children("ul").hide();var t=$(this).find("ul").first().width();if($(this).find("ul").first().css("left",-t-2+"px"),$(this).find("ul").first().show(),e.ui)return e.ui.touchList=!0}))}}),exports.closeDropdown=()=>({restrict:"A",link:(e,t,n)=>t.on("click",(()=>$("#".concat(n.closeDropdown)).foundation("dropdown","close",$("#".concat(n.closeDropdown)))))}),exports.replyList=["$timeout","$routeParams",(e,t)=>({restrict:"A",link(n,r){if(t.scrollTo){n.topic.replies.length>5&&(n.topic.showAllReplies=!0);return e((function(){var e=r.find(".".concat(t.scrollTo));if(e.length>0)return e[0].scrollIntoView()}))}}})],exports.unreadReply=()=>({restrict:"A",link(e,t,n){if("true"===n.unreadReply)return e.unreadReplies.push(t)}}),exports.unvisiableReply=()=>({restrict:"A",link(e,t,n){if(parseInt(n.id))return e.unvisiableReplies.push(t)}}),exports.scrollToLastReply=["$location","$anchorScroll","$timeout",(e,t,n)=>({restrict:"A",link(r,i,o){var a="last_reply";if(r.$eval(o.scrollToLastReply))return i.attr("id",a),n((function(){return e.hash(a),t()}),0)}})],exports.focus=["$timeout",e=>({restrict:"A",link:(t,n,r)=>t.$watch(r.focus,(function(t){if(t)return e((()=>n[0].focus()))}))})],exports.formatScore=()=>({restrict:"A",require:"?ngModel",link:(e,t,n,r)=>r.$formatters.push(utils.formatScore)}),exports.number=()=>({restrict:"A",require:"?ngModel",link(e,t,n,r){var i=["-"],o=+n.min,a=+n.max;r.$parsers.push((e=>{var t=parseInt(e,10),n=t;return isNaN(t)?n=i.includes(e)?e:"":o&&t<o?n=o:a&&t>a&&(n=a),r.$setViewValue(n),r.$render(),n}))}}),exports.treeView=["$compile","$timeout",(e,t)=>({restrict:"A",require:"?ngModel",link(n,r,i){var o=i.treeId,a=i.treeModel,l=i.treeLevel||1,s=parseInt(l)+1,d=i.multiple||"false",c=i.needDefault,u=i.defaultName||"",p=i.defaultId,f=n.$eval(i.ngModel),m=i.usedFor||"departments",g=i.needFilter||"false",h=i.keywordPlaceholder||"",v=i.noResultsTip||"",b=i.conditionModel,y=i.alwaysResetClickEvent||"false",w=i.afterClickNode||"",k=i.initSelect||!1,x=i.initSelectModel||i.ngModel,S=i.stoppedDepartmentTip||"",T=i.needSwitchAll||"false",C=i.switchAllTip||"",E=i.updateErrorMessage||"false",A=i.triggerSearch||"true",M=i.name||"",I=i.dropDownMenu||"false",F=i.hideDropDown||"true";var P={study_course_classifications:"classification",departments:"departments",classifications:"children",subject_libs:"children",subject_libs_table:"children",bulletin_targets:"children",org:"children"},V=function(){if("true"===F)return r.hide()},q=e=>e[P[m||""]]||[],N=function(e){if("bulletin_targets"!==m||"gs".includes(e.id[0])){var t=e.id.toString(),n=f.indexOf(t);return e.selected&&-1===n&&f.push(e.id.toString()),e.selected||-1===n?void 0:f.splice(n,1)}},L=function(){var e=n.$eval(i.treeModel);return n.allChosen=!O(e)},j=function(e){if(e){var t=n[o].keyword;return"true"!==c||void 0!==t&&""!==t||n[o].defaultNode.selected?L():n.allChosen=!1}n.allChosen=!1},O=function e(t){return!(!t||!t.length)&&_.some(t,(t=>!t.selected||e(q(t))))},H=function e(t,n){t.selected=n,N(t);var r=P[m]||"";return t.hasOwnProperty(r)&&_.forEach(t[r]||[],(t=>e(t,n))),D()},R=e=>(()=>{var t,n=[],r=_createForOfIteratorHelper(q(e));try{for(r.s();!(t=r.n()).done;){var i=t.value;e.selected&&i.selected||(i.selected=e.selected,N(i)),q(i)?n.push(R(i)):n.push(void 0)}}catch(e){r.e(e)}finally{r.f()}return n})(),D=function(){var e,t,i=r.parent(".tree-view").find("span.title");f&&(e=_.filter(f,(e=>e&&e.toString().indexOf("root-")<0&&"a0"!=e)));var a=e?e.length:0;return t=0===a?r.parent(".tree-view").find("#default-text").text()||$("#selected-text-all").text():1===a?r.find("span[data-id="+e[0]+"]").data("name"):$("#selected-text").text().replace("#",a),i.text(t),n[o].title=t},z=function(e){return r.parent(".tree-view").find("span.select2-chosen").text(e.name)};n[o]=n[o]||{},n[o].defaultNode=n[o].defaultNode||{id:p,name:u,departments:[],selected:!!Array.isArray(f)&&f.includes(p)},n[o].toggleChildren=n[o].toggleChildren||function(e,t){return e.stopPropagation(),t.expanded=!t.expanded},"true"!==y&&null!=n[o].clickNode||(n[o].clickNode=function(e,t){(e.stopPropagation(),null!=t.id)&&(f=n.$eval(i.ngModel),"true"===d?function(e){if(e.selected=!e.selected,"true"===E&&n.errors&&n.errors[M]&&delete n.errors[M],N(e),["departments","study_course_classifications","classifications","bulletin_targets","org"].includes(m)&&helper.guard(q(e),(e=>e.length))&&R(e),D(),"true"===T&&j(e.selected),"function"==typeof n.search&&!["bulletin_targets"].includes(m)&&"true"===A)n.search()}(t):function(e){n.$eval("".concat(i.ngModel," = ").concat(e.id)),V(),z(e)}(t),w&&n.$eval(w)(t))}),1===l&&(n[o].switchAll=function(){var e=r.find("#switch_all").prop("checked");"true"===E&&n.errors&&n.errors[M]&&delete n.errors[M];var t=n.$eval(i.treeModel);f=n.$eval(i.ngModel);var a=n[o].keyword;if("true"!==c||void 0!==a&&""!==a||H(n[o].defaultNode,e),_.forEach(t,(t=>H(t,e))),"function"==typeof n.search&&!["bulletin_targets"].includes(m)&&"true"===A)return n.search()});var B='<li ng-click="'+o+".clickNode($event, "+o+'.defaultNode)"><div id="defaultTreeNode'+n.$id+'" class="item"><i class="blank"></i><span class="content" data-id="'+p+'" data-name="'+u+'"><input class="input" ng-if="'+d+' == true" type="checkbox" ng-checked="'+o+'.defaultNode.selected" /><span class="name truncate-text" ng-bind="'+o+'.defaultNode.name" tipsy="'+o+'.defaultNode.name" ng-attr-tipsy-follow-element-width="true" ng-attr-tipsy-ellipsis-check-method="width"></span><span class="status-label" ng-if="node.stopped">'+S+"</span></span></div></li>",W='<div class="search-header"  ng-click="$event.stopPropagation()"><div class="ui-multiselect-filter"><span class="search-content"><i class="icon icon-search-in-dropdown"></i><input class="keyword" type="text" ng-model="'+b+'.keyword" placeholder="'+h+'" ng-keyup="triggerSearchTreeView()" /></span></div></div>',U='<div class="search-header" ng-click="$event.stopPropagation()"><div class="ui-multiselect-filter"><div class="search-content"><i class="icon icon-search-in-dropdown"></i><input class="keyword" type="search" ng-model="'+b+'.keyword"placeholder="'+h+'" ng-change="triggerSearchTreeView()" /></div></div></div>',Y=1===l&&"true"===c?B:"",G="";1===l&&"true"===g&&(G=-1!==a.indexOf("departments")?U:W);var J="";1===l&&"true"===T&&(J='<div ng-click="$event.stopPropagation()"><div class="switch-all-nodes"><input class="input" id="switch_all" type="checkbox" ng-click="'+o+'.switchAll()" ng-model="allChosen"/>'+C+"</div></div>");var K="",Q="";k&&(K=' ng-init="node.selected = '+x+'.indexOf(node.id.toString()) != -1"',Q=' init-select-model="'+x+'" init-select="true"');var X="";l>1&&(X='style="overflow-y: hidden; max-height: 100%"');var Z=G+J+'<ul class="tree-level"'+X+">"+Y+'<li class="no-result" ng-if="'+a+".length == 0 && !"+c+'"><div class="item"><span class="content">'+v+'</span></div></li><li ng-repeat="node in '+a+'" ng-click="'+o+'.clickNode($event, node)"><div class="item tree-level-'+l+'" style="padding-left: '+10*l+'px"><i class="font font-tree-expanded" ng-if="node.departments.length && !node.expanded" ng-click="'+o+'.toggleChildren($event, node)"></i><i class="font font-tree-collapsed" ng-if="node.departments.length && node.expanded" ng-click="'+o+'.toggleChildren($event, node)"></i><i class="blank" ng-hide="node.departments.length"></i><span class="content" data-id="[[node.id]]" data-name="[[node.name]]"'+K+'><input class="input" ng-if="'+d+' == true" type="checkbox" ng-checked="node.selected" /><span class="name truncate-text" tipsy="node.name" ng-attr-tipsy-follow-element-width="true"  ng-attr-tipsy-ellipsis-check-method="width">[[node.name]]</span><span class="status-label" ng-if="node.stopped">'+S+'</span></span></div><div tree-view="true" ng-if="node.expanded" tree-id="'+o+'" multiple="'+d+'" tree-model="node.departments" tree-level="'+s+'"'+Q+'stopped-department-tip="'+S+'"></div></li></ul>',ee=G+'<ul class="tree-level">'+Y+'<li ng-if="'+a+".length == 0 && !"+c+'"><div class="item"><span class="content">'+v+'</span></div></li><li ng-repeat="node in '+a+'" ng-click="'+o+'.clickNode($event, node)"><div class="item-group" ng-if="!node.id"><span class="content" ng-bind="node.name"></span></div><div class="truncate-text item" style="padding-left: '+10*l+'px" ng-if="node.id"><i class="font font-tree-expanded" ng-if="node.children.length && !node.expanded" ng-click="'+o+'.toggleChildren($event, node)"></i><i class="font font-tree-collapsed" ng-if="node.children.length && node.expanded" ng-click="'+o+'.toggleChildren($event, node)"></i><i class="blank" ng-hide="node.children.length"></i><span class="content" data-id="[[node.id]]" data-name="[[node.name]]" title="[[node.display_name]]"><input class="input" ng-if="'+d+' == true" type="checkbox" ng-checked="node.selected" />[[node.display_name]]</span></div><div tree-view="true" ng-if="node.expanded" tree-id="'+o+'" multiple="[[node.childType === \'group\']]" used-for="'+m+'"tree-model="node.children" tree-level="'+s+'"></div></li></ul>',te='<ul class="tree-level"><li ng-repeat="node in '+a+'" ng-click="'+o+'.clickNode($event, node)"><div class="item" style="padding-left: '+10*l+'px"><i class="font font-tree-expanded" ng-if="node.classification.length && !node.expanded" ng-click="'+o+'.toggleChildren($event, node)"></i><i class="font font-tree-collapsed" ng-if="node.classification.length && node.expanded" ng-click="'+o+'.toggleChildren($event, node)"></i><i class="blank" ng-hide="node.classification.length"></i><span class="content" data-id="[[node.id]]" data-name="[[node.name]]"><input class="input" ng-if="'+d+' == true" type="checkbox" ng-checked="node.selected" />[[node.name]]</span></div><div tree-view="true" ng-if="node.expanded" tree-id="'+o+'" multiple="'+d+'"tree-model="node.classification" tree-level="'+s+'"></div></li></ul>',ne='<ul class="tree-level"><li ng-repeat="node in '+a+'" ng-click="'+o+'.clickNode($event, node)"><div class="item tree-level-'+l+'" style="padding-left: '+10*l+'px"><i class="font font-tree-expanded" ng-if="node.children.length && !node.expanded" ng-click="'+o+'.toggleChildren($event, node)"></i><i class="font font-tree-collapsed" ng-if="node.children.length && node.expanded" ng-click="'+o+'.toggleChildren($event, node)"></i><i class="blank" ng-hide="node.children.length"></i><span class="content" data-id="[[node.id]]" data-name="[[node.name]]"'+K+'><input class="input" ng-if="'+d+' == true" type="checkbox" ng-checked="node.selected" /><span class="name truncate-text" tipsy="node.name" ng-attr-tipsy-follow-element-width="true"  ng-attr-tipsy-ellipsis-check-method="width">[[node.name]]</span></div><div tree-view="true" ng-if="node.expanded" tree-id="'+o+'" multiple="'+d+'"used-for="'+m+'"tree-model="node.children" tree-level="'+s+'"'+Q+'"></div></li></ul>',re='<ul class="tree-level"><li ng-repeat="node in '+a+'" ng-click="'+o+'.clickNode($event, node)"><div class="item tree-level-'+l+'" style="padding-left: '+17*l+'px"><i class="font font-down collapsed" ng-if="node.children.length && !node.expanded" ng-click="'+o+'.toggleChildren($event, node)"></i><i class="font font-down" ng-if="node.children.length && node.expanded" ng-click="'+o+'.toggleChildren($event, node)"></i><i class="blank" ng-hide="node.children.length"></i><i class="font font-file-folder" ng-if="node.type == \'folder\' && !node.expanded"></i><i class="font font-file-folder-expanded" ng-if="node.type == \'folder\' && node.expanded"></i><i class="font font-resource-subject-lib" ng-if="node.type == \'exam\'"></i><span class="content" data-id="[[node.id]]" data-name="[[node.title]]"><span class="name truncate-text" ng-class="{active: node.id == currentClassfication.id, last: $last}" tipsy="node.title" ng-attr-tipsy-follow-element-width="true"  ng-attr-tipsy-ellipsis-check-method="width">[[node.title]]</span></div><div tree-view="true" ng-if="node.expanded" tree-id="'+o+'" multiple="'+d+'"used-for="'+m+'"tree-model="node.children" tree-level="'+s+'"></div></li></ul>',ie='<div class="lib-contents" ng-repeat="node in '+a+'" ng-click="'+o+'.clickNode($event, node)"><div class="lib-tr"><div class="lib-td lib-title tree-level-'+l+'"><div class="item tree-level-'+l+'" style="padding-left: '+13*l+'px"><div class="lib-border" ng-class="{\'indent\': node.children.length == 0 && node.type == \'folder\' }"><i class="font font-down collapsed" ng-if="node.children.length && !node.expanded" ng-click="'+o+'.toggleChildren($event, node)"></i><i class="font font-down" ng-if="node.children.length && node.expanded" ng-click="'+o+'.toggleChildren($event, node)"></i><i class="font font-file-folder" ng-if="node.type == \'folder\' && !node.expanded"></i><i class="font font-file-folder-expanded" ng-if="node.type == \'folder\' && node.expanded"></i><i class="font font-resource-subject-lib" ng-if="node.type != \'folder\'"></i><span class="content truncate-text" data-id="[[node.id]]" data-name="[[node.title]]"><span class="name" ng-class="{active: node.id == currentClassfication.id, last: $last}" tipsy="node.title" ng-attr-tipsy-follow-element-width="true"  ng-attr-tipsy-ellipsis-check-method="width">[[node.title]]</span></span></div></div></div><div class="lib-td lib-num"><span class="lib-vlaue" ng-bind="node.num_of_subjects || node.nums" ng-if="node.type != \'folder\'"></span></div><div class="lib-td lib-score"><div class="lib-input" ng-if="!selectRandomlyExam && node.type != \'folder\'">\x3c!--[if lte IE 9]><input type="text" ng-model="node.point" ng-change="calculate()" ng-class="{\'has-error\': node.hasPointFormatError || node.hasPointValueError}" float-precision="1"/><![endif]--\x3e\x3c!--[if gte IE 10]>\x3c!--\x3e<input type="number" ng-model="node.point" ng-change="calculate()"ng-class="{\'has-error\': node.hasPointFormatError}"float-precision="1"/><![endif]--\x3e<span class="has-error" ng-if="node.hasPointFormatError" ng-bind="i18nMessages[\'numFormat\']"></span></div></div><div class="lib-td lib-choose"><div class="lib-input" ng-if="node.type != \'folder\'">\x3c!--[if lte IE 9]><input type="text" ng-model="node.number" ng-change="calculate()" parse-integer ng-class="{\'has-error\': node.hasNumberFormatError || node.hasNumberValueError}" /><![endif]--\x3e\x3c!--[if gte IE 10]>\x3c!--\x3e<input type="number" ng-model="node.number" ng-change="calculate()"ng-class="{\'has-error\': node.hasNumberFormatError || node.hasNumberValueError}"/><![endif]--\x3e<span class="has-error" ng-if="node.hasNumberFormatError" ng-bind="i18nMessages[\'integerFormat\']"></span><span class="has-error" ng-if="node.hasNumberValueError && node.number <= 0">> 0</span><span class="has-error" ng-if="node.hasNumberValueError && node.number > node.nums" ng-bind="i18nMessages[\'subjectNum\']"></span></div></div></div><div class="lib-contents" tree-view="true" ng-if="node.expanded" tree-id="'+o+'" multiple="'+d+'"used-for="'+m+'"tree-model="node.children" tree-level="'+s+'"></div></div>',oe=G+'<ul class="tree-level">'+Y+'<li ng-if="'+a+".length == 0 && !"+c+'"><div class="item"><span class="content">'+v+'</span></div></li><li ng-repeat="node in '+a+'" ng-click="'+o+'.clickNode($event, node)"><div class="item tree-level-'+l+'" style="padding-left: '+10*l+'px"><i class="font font-tree-expanded" ng-if="node.children.length && !node.expanded" ng-click="'+o+'.toggleChildren($event, node)"></i><i class="font font-tree-collapsed" ng-if="node.children.length && node.expanded" ng-click="'+o+'.toggleChildren($event, node)"></i><i class="blank" ng-hide="node.children.length"></i><span class="content" data-id="[[node.id]]" data-name="[[node.name]]"'+K+'><input class="input" ng-if="'+d+' == true" type="checkbox" ng-checked="node.selected" /><span class="name truncate-text" tipsy="node.name" ng-attr-tipsy-follow-element-width="true"  ng-attr-tipsy-ellipsis-check-method="width">[[node.name]]</span></div><div tree-view="true" ng-if="node.expanded" tree-id="'+o+'" multiple="'+d+'"used-for="'+m+'"tree-model="node.children" tree-level="'+s+'"'+Q+'"></div></li></ul>';"bulletin_targets"===m?r.html("").append(e(ee)(n)):"study_course_classifications"===m?r.html("").append(e(te)(n)):"classifications"===m?r.html("").append(e(ne)(n)):"subject_libs"===m?r.html("").append(e(re)(n)):"subject_libs_table"===m?r.html("").append(e(ie)(n)):"org"===m?r.html("").append(e(oe)(n)):r.html("").append(e(Z)(n)),1===l&&"true"===d&&t((()=>D())),n.$on("refreshTreeViewModel",(function(e){return f=n.$eval(i.ngModel),n[o].defaultNode&&(n[o].defaultNode.selected=!!Array.isArray(f)&&f.includes(p)),t((()=>D()))})),n.triggerSearchTreeView=()=>{n.$emit("searchTreeView",o,n);var e=n.searchTreeView;"function"==typeof e&&e(o)};return n.$watch(i.treeModel,(function(){L(),function(){var e=n.$eval(i.treeModel);if(e)if(0===("bulletin_targets"===m?_.filter(e,(e=>(null!=e.children?e.children.length:void 0)>0)):"study_course_classifications"===m?_.filter(e,(e=>(null!=e.classification?e.classification.length:void 0)>0)):["classifications"].includes(m)?1:["subject_libs","subject_libs_table","org"].includes(m)?_.filter(e,(e=>(null!=e.children?e.children.length:void 0)>0)):_.filter(e,(e=>(null!=e.departments?e.departments.length:void 0)>0))).length&&l<2){if(r.find(".blank").hide(),"true"===T)r.find(".switch-all-nodes").css("padding-left","10px")}else if(r.find(".blank").show(),"true"===T)r.find(".switch-all-nodes").css("padding-left","32px")}()})),n.$watch(o+".keyword",(function(e){var t=$("#defaultTreeNode"+n.$id);return(null!=e?e.length:void 0)>0?t.hide():t.show()})),r.parent().on("click",(function(e){var t=helper.guard(r.parent().offset(),(e=>e.top))||0;return window.innerHeight-t-r.parent().outerHeight()<r.outerHeight()&&r.outerHeight()<t&&"false"===I?r.css({top:-r.outerHeight()}):r.css({top:""}),e.stopPropagation()})),r.parent(".tree-view").on("click",(()=>{n.disabled||r.toggle()})),$("body")[0].addEventListener("click",(function(e){if(!(r.find(e.target).length>0||r.parent(".tree-view").find(e.target).length>0))return r.hasClass("tree-container")?V():void 0}),!0)}})],exports.scrollable=()=>({link:(e,t,n)=>t.on("opened",(function(){var e=t.find(".".concat(n.scrollable)),r=e.width();if(e.find(">div").width()<r&&!e.attr("width-fixed"))return e.width(r+17),e.attr("width-fixed",!0)}))}),exports.enterPress=["$parse",e=>({restrict:"A",link(t,n,r){var i=e(r.enterPress);return n.bind("keypress",(function(e){return 13!==e.keyCode||(e.preventDefault(),t.$apply((()=>i(t,{$event:e}))))}))}})],exports.escPress=()=>({restrict:"A",require:"ngModel",link:(e,t,n)=>t.bind("keydown",(function(t){return 27!==t.keyCode||(t.preventDefault(),e.$apply((function(){var t=n.ngModel+"="+(""===e.$eval(n.escPress)?'""':e.$eval(n.escPress));return e.$eval(t)})))}))}),exports.scrollableTimeline=["$timeout",e=>({link:(t,n)=>e((function(){return n.offset().top>$(window).scrollTop()+.9*$(window).height()&&n.find(".cd-timeline-img, .cd-timeline-content").addClass("is-hidden"),$(window).on("scroll",(function(){if(n.offset().top<=$(window).scrollTop()+.9*$(window).height()&&n.find(".cd-timeline-img").hasClass("is-hidden"))return n.find(".cd-timeline-img, .cd-timeline-content").removeClass("is-hidden").addClass("bounce-in")}))}))})],exports.videoPlayer=["$timeout","$parse","$sanitize","$window","$translate",function(e,t,n,r,i){var o=null,a=0,l=(e,t)=>Math.max(e,t),s=function(e,t,n){return e?$(t).parent("div").append('<div class="video-offline-warning">'+n+"</div>"):$(t).parent("div").find(".video-offline-warning").remove()};return{restrict:"A",scope:{activity:"=",upload:"=",logVideoPlayed:"&",playerInitiated:"&",resource:"="},link(d,c,u){var p,f;d.playerLoadErrorMessage={"en-GB":"The video cannot be played directly. Please wait for transcoding to complete.","en-US":"The video cannot be played directly. Please wait for transcoding to complete.","zh-CN":"当前视频无法支持直接播放，请等待转码完成","zh-MO":"當前影片無法提供直接播放，請等待轉檔完成","zh-TW":"當前影片無法提供直接播放，請等待轉檔完成","th-TH":"ไม่สามารถเล่นวิดีโอได้โดยตรง โปรดรอให้การแปลงรหัสเสร็จสมบูรณ์","id-ID":"Video saat ini tidak dapat diputar langsung, harap tunggu hingga proses konversi selesai","ms-MY":"Video semasa tidak boleh disiarkan secara langsung, sila tunggu sehingga penukaran selesai.","vi-VN":"The video cannot be played directly. Please wait for transcoding to complete."};var m=!1,g=null==u.allowFowardSeeking||t(u.allowFowardSeeking)(d.$parent),h=null==u.allowRightClick||t(u.allowRightClick)(d.$parent),v=u.forwardSeekingWarning,b=t(u.playerSettings)(),y=function(e,n){return{plugins:{videoJsResolutionSwitcher:{default:t(n.resolution)(e.$parent),dynamicLabel:!0}}}}(d,u);return b&&(p=parseInt(b.lastPlayed),f=parseInt(b.lastThreshold),p>0&&!b.disableAutoPlay&&(y.autoplay=!0)),y.controlBar={volumeMenuButton:{inline:!1,vertical:!0}},y.playbackRates=[.75,1,1.25,1.5,2],e((function(){var e=function(e,t){var n=e.controlBar.playbackRateMenuButton,r=n.children()[0];r.children().forEach((e=>{e.rate===t?$(e.el()).addClass("active"):$(e.el()).removeClass("active")})),$(r.el()).addClass("vjs-menu-hidden"),$(n.el()).hover((()=>{$(r.el()).removeClass("vjs-menu-hidden")}))};return o&&clearInterval(o),Promise.all([__webpack_require__.e(83366),__webpack_require__.e(58425)]).then(__webpack_require__.bind(__webpack_require__,103151)).then((function(t){var w,_=t.default(c[0],y,(function(){}));_.on("error",(function(e){$(e.target).find(".vjs-modal-dialog-content").text(d.playerLoadErrorMessage[d.$root.lang])})),e(_,1),_.on("ratechange",(t=>{e(t.target.player,t.target.player.playbackRate())})),"False"==u.enablePlayRate&&(w=_.controlBar.playbackRateMenuButton,$(w.el()).remove()),_.on("resolutionchange",(e=>{var t=e.target.player.controlBar.playbackRateMenuButton.children()[0].children().find((e=>e.el().classList.contains("active"))),n=t?t.rate:1;e.target.player.playbackRate(n)})),_.ready((function(){return function(e,t){var r=e.data("desc"),o=e.parents(".video-player"),a=o.find(".vjs-control-bar .vjs-remaining-time");if(a.after(o.find(".vjs-control-bar .vjs-fullscreen-control")),t&&t.download&&e.data("allow-download")&&a.after("<div class='download'>\n    <a  href='".concat(t.download_link,"' ng-if='allow_download && !activity.uploads[0].deleted'>\n        <i class='font-audio-download font'></i>\n    </a>\n</div>")),a.after(o.find(".vjs-control-bar .vjs-volume-menu-button")),t&&t.desc&&r){a.after("<div class='desc'>\n    <i class='font-audio-desc'></i>\n</div>");var l=a.next(".desc");l.attr("title",n(r)).tipsy({gravity:"sw",trigger:"hover",className:"video-desc-white-bg",html:!0,opacity:1,afterShow:e=>e.appendTo(l).css({top:"auto",bottom:"45px",left:"-248px"})})}a.after(o.find(".vjs-control-bar .vjs-resolution-button")),a.after(o.find(".vjs-control-bar .vjs-playback-rate")),a.after(o.find(".vjs-control-bar .vjs-duration")),o.find(".vjs-control-bar .vjs-resolution-button .vjs-menu .vjs-menu-content").after("<div class='resolution-arrow'></div>"),o.find(".vjs-control-bar .vjs-volume-menu-button .vjs-menu .vjs-menu-content").after("<div class='volume-arrow'></div>"),o.find(".vjs-control-bar .vjs-playback-rate .vjs-menu .vjs-menu-content").after("<div class='playback-rate-arrow'></div>"),o.find(".vjs-control-bar .vjs-playback-rate .vjs-playback-rate-value").after("<div class='playback-rate-value'>".concat(i.instant("videoSpeed"),"</div>"))}(c,b),c.parents(".video-player").find(".vjs-control-bar .vjs-play-control.vjs-control.vjs-button").addClass("vjs-paused"),c.parents(".video-player").find(".vjs-control-bar .vjs-resolution-button .vjs-resolution-button-label").on("click",(()=>!1))})),c.on("touchstart",(function(){return _.paused()?_.play():_.pause()})),b&&c.on("durationchange",(function(){if(!m&&p>0&&parseInt(p)<parseInt(_.duration())){a=p,_.currentTime(p);var e=b.playedMsg.replace("{0}",utils.secondsToHms(p));return $(c).parent("div").append('<div class="prompt-message last-played">'+e+"</div>"),$(".prompt-message.last-played").delay(2500).hide(200),m=!0}}));var k=$(c[0]).parent("div").find(".vjs-poster");if(function(e,t){t.unbind("dblclick"),t.dblclick((function(){return e.isFullscreen()?e.exitFullscreen():e.requestFullscreen()}))}(_,k),g||function(e,t,n){if(t){var r=$(".vjs-mouse-display");r.append('<div class="warning-text">'+t+"<em></em></div>");var i=$(".warning-text");e.controlBar.progressControl.seekBar.mouseTimeDisplay.update=function(e,t){n=l(n,a),r.css("left",t+"px");var o=i.width()/2+12;return i.css("right",-1*o),i.find("em").css("right",o-5.5),e>n?r.addClass("has-warning"):(r.removeClass("has-warning"),r.attr("data-current-time",utils.secondsToHms(e)))}}e.on("seeking",(function(){if((n=l(n,a))<e.currentTime()&&e.currentTime(a),!e.paused()&&n>e.currentTime())return e.pause()})),e.on("seeked",(function(){if(e.isResolutionSwitch&&(e.isResolutionSwitch=!e.isResolutionSwitch,a=e.currentTime()),(n=l(n,a))<e.currentTime())return e.currentTime(a)})),o=setInterval((function(){!0!==e.isResolutionLoading&&(a=e.currentTime())}),500)}(_,v,f),h||(e=>{e.on("contextmenu",(e=>e.preventDefault()))})(_),!b.disableTrack&&b.offlineWarning&&function(e,t){s(!r.navigator.onLine,e,t),r.addEventListener("online",(()=>s(!1,e))),r.addEventListener("offline",(()=>s(!0,e,t)))}(c,b.offlineWarning),b.disableTrack&&!d.resource||utils.enableTrack(d,_,d.activity,"video",d.resource),d.playerInitiated)return _.theCurrentTime=_.currentTime,d.playerInitiated({player:_})}))}))}}}],exports.sortable=()=>({link(e,t,n){var r=".".concat(n.sortable),i=n.index,o=n.group||"shared",a="true"===n.sortableDisabled;return document.body.ondrop=function(e){e.preventDefault(),e.stopPropagation()},new Sortable(t[0],{draggable:r,disabled:a,group:{name:o,pull:!0,put:(e,t,r,i)=>n.type&&"template"===n.type?"course-syllabus"!==t.options.group.name||"module"!==e.options.group.name:("course-syllabus"!==t.options.group.name||"learning-activity"!==e.options.group.name)&&!t.options.group.name.startsWith("matching-dragable")},animation:150,handle:".drag-area",scroll:!0,forceAutoScrollFallback:!0,onUpdate(t){if("template"!==n.type){if("course-syllabus"===n.sortable){var r=JSON.parse(window.localStorage.getItem("course-list-sort")||"{}");return r.oldModule=angular.element(t.to).scope().module.id,e.resortSyllabus(t.oldIndex,t.newIndex,r)}return e.resort(t.oldIndex,t.newIndex,n.type,t,i)}if("module"===n.sortable)return e.resortModule(t.oldIndex,t.newIndex);if("course-syllabus"===n.sortable){var o={oldModule:angular.element(t.from).scope().module.id,newModule:angular.element(t.to).scope().module.id};return e.resortSyllabus(t.oldIndex,t.newIndex,o)}},onAdd:function(t){if(!t.item.id.startsWith("module-")){var r,o="template"===n.type?{oldModule:angular.element(t.from).scope().module.id}:JSON.parse(window.localStorage.getItem("course-list-sort")||"{}");if(t.item.id.startsWith("syllabus-"))return o.newModule=angular.element(t.to).scope().module.id,e.resortSyllabus(t.oldIndex,t.newIndex,o);null!==(r=t.item).parentElement&&r.parentElement.removeChild(r),["module","course-syllabus","learning-activity"].includes(n.sortable)&&e.resortForModuleOrSyllabus(t.oldIndex,t.newIndex,o,n.type,t,i)}},onRemove:function(t){if("module"!==n.sortable&&"course-syllabus"!==n.sortable)return e.resortWhenRemove(t.oldIndex)},onEnd:function(t){if("module"===n.sortable&&e.expandAll(),"course-syllabus"===n.sortable){if("template"===n.type)return;e.expandActivities()}"learning-activity"===n.sortable&&e.afterSort()},onStart(t){var r,i;if("learning-activity"!==n.sortable&&(document.body.scrollTop=document.documentElement.scrollTop=0),"template"===n.type)return"module"===n.sortable?e.collapseAll():e.expandAll();if("module"!==n.sortable){"course-syllabus"===n.sortable&&(e.expandModulesAndContents(),i=angular.element(t.item).scope().syllabus.id,e.collapseActivities());var o=e.syllabus?e.syllabus.activities:e.module.directActivities;window.localStorage.setItem("course-list-sort",JSON.stringify({oldModule:null===(r=e.module)||void 0===r?void 0:r.id,oldSyllabus:e.syllabus?e.syllabus.id:i,fromActivities:o}))}else e.collapseAll()}})}}),exports.dragCloneable=()=>({restrict:"A",scope:{dragOptions:"=",dragType:"@",dragCallback:"&"},link(e,t,n){var r=e.dragOptions.id,i="".concat(n.dragCloneable,"-")+r,o={draggable:".clone-area",handle:".drag-area",sourceId:"cloneable-source",hoverClass:"drag-hover",trashId:"drag-trash-"+r,boxHeight:41};e.dragOptions.dragConfig=o;var a="from"!==e.dragType||"clone";return"trash"===e.dragType&&(a=!1),new Sortable(t[0],{group:{name:i,put:"from"!==e.dragType&&[i],pull:a},animation:300,draggable:o.draggable,handle:o.handle,sort:!1,scroll:!1,onAdd:function(t){if(e.dragOptions.dragging){var n=e.dragOptions.dragging,r=e.dragOptions.dragConfig;if(n.toTrash)t.item.parentNode.removeChild(t.item),e.dragOptions.elements=t.from.parentNode.parentNode;else{if(t.to.children.length>1)if(t.to.children[0].dataset.dragNodeId==t.to.children[1].dataset.dragNodeId)t.to.removeChild(t.item);else{var i=t.to.children[0].dataset.dragNodeId===t.item.dataset.dragNodeId?1:0;r.sourceId===t.from.id?t.to.removeChild(t.to.children[i]):t.from.appendChild(t.to.children[i])}e.dragOptions.elements=t.to.parentNode.parentNode,e.dragOptions.dragging.lastEle=null,t.to.classList.remove(r.hoverClass)}}else t.preventDefault()},onMove:function(t){if(e.dragOptions.dragging){var n=e.dragOptions.dragging,r=e.dragOptions.dragConfig;n.toPool=t.to&&r.sourceId===t.to.id,n.toTrash=t.to&&r.trashId===t.to.parentNode.id,n.lastEle&&n.lastEle.classList.remove(r.hoverClass),n.toPool||(n.lastEle=t.to,n.lastEle.classList.add(r.hoverClass)),0===t.to.children.length||n.toPool?n.toHeight=r.boxHeight:n.toHeight=t.to.offsetHeight,n.fromPool||(n.fromHeight=t.from.offsetHeight),e.dragOptions.dragging=n}else t.preventDefault()},onStart:function(t){var n=e.dragOptions.dragConfig,r={fillCount:0,fromHeight:t.item.offsetHeight,toHeight:n.boxHeight,toPool:!1,toTrash:!1,fromPool:n.sourceId===t.from.id};r.fromPool||(t.from.classList.add(n.hoverClass),document.getElementById(n.trashId).style.display="unset"),e.dragOptions.dragging=r},onEnd:function(t){if(e.dragOptions.dragging){var n=e.dragOptions.dragConfig,r=e.dragOptions.dragging;r.fromPool||(r.toTrash?t.from.style.height=n.boxHeight+"px":t.from.style.height=r.toHeight+"px",t.from.classList.remove(n.hoverClass),document.getElementById(n.trashId).style.display="none"),t.item&&t.item.parentNode&&(n.sourceId!==t.item.parentNode.id&&(t.item.parentNode.style.height=r.fromHeight+"px"),t.item.parentNode.classList.remove(n.hoverClass)),e.dragOptions.dragging=null,e.dragCallback()}else t.preventDefault()}})}});var hideTipsyWhenElemInvisible=(e,t)=>t.closest("a[href],[ng-click]").on("click",(()=>$(".tipsy:visible").hide()));exports.tipsy=["$timeout",e=>({restrict:"A",link(t,n,r){var i=function(){var e,i=t.$eval(r.tipsy),o="string"==typeof(e="no"!==r.tipsyEscape?_.escape(i):i)?e.replace(/\n/g,"<br />"):e;return n.attr("title",o),n.tipsy({ellipsis:"no"!==r.tipsyEllipsis,gravity:$.fn.tipsy.autoBounds(37,r.tipsyGravity||"sw"),opacity:.95,followElementWidth:"true"===r.tipsyFollowElementWidth,ellipsisCheckMethod:r.tipsyEllipsisCheckMethod,html:!0})};return i(),t.$watch(r.tipsy,i),hideTipsyWhenElemInvisible(e,n)}})],exports.tipsyLiteral=["$timeout",e=>({restrict:"A",link:(t,n,r)=>(t.$watch((()=>r.tipsyLiteral),(function(){var e="yes"===r.tipsyHtml,t=e?r.tipsyLiteral:_.escape(r.tipsyLiteral);return n.attr("title",t),n.tipsy({ellipsis:"yes"===r.tipsyEllipsis,gravity:$.fn.tipsy.autoBounds(37,r.tipsyGravity||"sw"),opacity:.95,className:r.tipsyClass||"",followElementWidth:"true"===r.tipsyFollowElementWidth,ellipsisCheckMethod:r.tipsyEllipsisCheckMethod,html:e,fade:!0})})),hideTipsyWhenElemInvisible(e,n))})],exports.tipsyAuto=["$timeout",e=>({restrict:"A",link:(t,n,r)=>(t.$watch((()=>n.text()),(function(){var e=n.text().replace(/\s+/g," ").trim();return n.attr("title",e),n.tipsy({ellipsis:"yes"===r.tipsyEllipsis,gravity:$.fn.tipsy.autoBounds(37,r.tipsyGravity||"sw"),opacity:.95,html:!0})})),hideTipsyWhenElemInvisible(e,n))})],exports.cornerButtonGroup=["$rootScope",e=>({controller(){e.showCornerButton=!0}})],exports.fixableNav=["$timeout","$rootScope",(e,t)=>({link(n,r,i){var o=parseFloat(i.offsetTop||0),a=0,l=window;if(null!=i.scrollEleCssSelector){var s=$(i.scrollEleCssSelector).first();"auto"===s.css("overflow")&&(l=s,a=s.offset().top,r.css("top",a+"px"))}var d=r.offset().top-o-a;return e((()=>d=r.offset().top-o-a)),$(l).scroll((function(){if($(this).scrollTop()>d&&!r.hasClass("fixed")&&(r.addClass("fixed"),e((()=>t.showBackToTopButton=!0))),$(this).scrollTop()<=d&&r.hasClass("fixed"))return r.removeClass("fixed"),e((()=>t.showBackToTopButton=!1))}))}})],exports.fixableButtons=["$location","$window",(e,t)=>({link:(n,r,i)=>(e.path().indexOf("classroom")>0?r.css("backgroundColor","white"):r.css("backgroundColor","#F4F4F4"),$(window).scroll((function(){if($(".subjects-edit-board").length){var e=$(this).scrollTop()+t.innerHeight<=$(".subjects-edit-board").height()+$(".subjects-edit-board").offset().top;if(e&&r.attr("class").indexOf("fixed-buttons")<0&&r.addClass("fixed-buttons"),!e&&r.attr("class").indexOf("fixed-buttons")>=0)return r.removeClass("fixed-buttons")}})))})],exports.fixableListHeader=()=>({link:(e,t,n)=>$(window).scroll((function(){var e=$(this).scrollTop()>n.startFixedPosition;if(e&&t.attr("class").indexOf("fixed-list-header")<0&&t.addClass("fixed-list-header"),!e&&t.attr("class").indexOf("fixed-list-header")>=0)return t.removeClass("fixed-list-header")}))}),exports.scrollToTop=["$document",e=>({link:(t,n)=>n.on("click",(()=>e.scrollTopAnimated(0,500)))})],exports.indeterminateCheckbox=()=>({link:(e,t)=>e.$watch("indeterminate",(()=>t.prop("indeterminate",e.indeterminate)))}),exports.uiSelect2=["$timeout",e=>({priority:0,restrict:"A",require:"?ngModel",link:(t,n,r,i)=>(n.on("click",(e=>$(".tipsy:visible").hide())),"true"===r.uiSelect2HideTipsyWhenOpening&&n.on("select2-opening",(()=>$(".tipsy:visible").hide())),"true"===r.uiSelect2ApplyWhenLoaded&&n.on("select2-loaded",(()=>t.$apply())),i&&n.on("change",(()=>i.$setValidity("server",!0))),e((()=>$(n).css("visibility","visible"))))})],exports.fixIeMinWidth=["$timeout",e=>({restrict:"A",link(e,t,n){if(-1!==navigator.userAgent.indexOf("MSIE 9")){var r=function(t){var n=$(t);return e.$watch((()=>n.children().length),(()=>i(t)))},i=function e(t){var n=$(t);if(n.children()){var i,o=_createForOfIteratorHelper(n.children());try{for(o.s();!(i=o.n()).done;){var a=i.value;r(a),e(a)}}catch(e){o.e(e)}finally{o.f()}}var l=parseInt(($(t).css("min-width")||"0").replace("px","")),s=n.parent().width(),d=n[0].getBoundingClientRect().width+1;if(l>0&&s>d&&null==n.parent().data("ie-width-fixed"))return n.parent().css({width:Math.ceil(d)}).data("ie-width-fixed",!0)};return r(t)}}})],exports.uiSelect2KeyPress=["$timeout",e=>({restrict:"A",link:(t,n,r)=>e((function(){var e=n.next("div.select2-container");return e.bind("keypress",(function(t){return 9===t.keyCode||(t.stopPropagation(),t.preventDefault(),e.next("select.rubric-score-box").select2("open")),!0}))}),100)})],exports.addSlideSelect2=["$window",e=>({restrict:"A",link:(t,n,r)=>n.on("select2-selecting",(function(t){if("-1"===t.val)return t.preventDefault(),n.select2("close"),$("#slide-refresh-popup").foundation("reveal","open"),e.open("".concat(e.location.protocol,"//").concat(e.location.host,"/user/resources/slides#/?comeFrom=activity"),"_blank")}))})],exports.simEditor=["simditor","$timeout","$sanitize","$compile",(e,t,n,r)=>({require:"?ngModel",restrict:"A",scope:{submitCallback:"&",rollbackCallback:"&"},link(i,o,a,l){var s;if(l){i.patronCtrl={patronValue:null},i.enableAutoSubmit=helper.guard(i.$eval(a.simEditor),(e=>e.enableAutoSubmit));var d,c,u,p,f,m=function(){return l.$setViewValue(i.patronCtrl.patronValue),l.$render()},g=function(){return i.submitCallback().then((()=>i.patronCtrl.patronValue=l.$modelValue),(()=>m()))},h=function(){var e=l.$modelValue,t=i.patronCtrl.patronValue;return String(e)===String(t)},v={allowedAttributes:{img:["src","alt","width","height","data-non-image","data-latex","class","data-mathml","role","align","style","data-id"],span:["contenteditable","class","data-id"],a:["href","target","data-id","class","tipsy-literal","title"],video:["src","controls"],svg:["class","width","height"],use:["href"]}};if(a.simToolbar)v.toolbar=a.simToolbar.split(",");else if(a.simToolbarExtendDefault){v.toolbar=["title","bold","italic","underline","strikethrough","fontScale","color","ol","ul","blockquote","code","table","link","lmsimage","hr","indent","outdent","superscript","subscript"].concat(a.simToolbarExtendDefault.split(","))}if(null!==(s=window.orgSettings.simditorMarkdown)&&void 0!==s&&s.enable&&v.toolbar&&v.toolbar.length)v.toolbar.splice(0,0,"markdown"),null!==(d=window.orgSettings.simditorMarkdown)&&void 0!==d&&d.defaultActive&&(v.markdown=!0);if(v.toolbar)i.$root.isFormulaEditorEnable&&"True"===i.$root.isFormulaEditorEnable||(v.toolbar=_.filter(v.toolbar,(e=>"lmsformula"!==e))),i.$root.isSimditorMediaEnable&&"true"===i.$root.isSimditorMediaEnable||(v.toolbar=_.filter(v.toolbar,(e=>"lmsaudio"!==e))),null!==(c=window.featureToggles)&&void 0!==c&&c.vocabulary||(v.toolbar=v.toolbar.filter((e=>"entry"!==e))),null!==(u=window.featureToggles)&&void 0!==u&&u.editorActivityRefer||(v.toolbar=v.toolbar.filter((e=>"activity"!==e))),null!==(p=window.featureToggles)&&void 0!==p&&p.simditor_embed_video||(v.toolbar=v.toolbar.filter((e=>"lmsembed"!==e))),null!==(f=window.featureToggles)&&void 0!==f&&f.simditor_attachment||(v.toolbar=v.toolbar.filter((e=>"lmsattachment"!==e)));var b=["a","abbr","acronym","address","area","article","aside","audio","b","big","blockquote","br","button","canvas","caption","center","cite","code","col","colgroup","command","datagrid","datalist","dd","del","details","dfn","dialog","dir","div","dl","dt","em","event-source","fieldset","figcaption","figure","footer","font","form","header","h1","h2","h3","h4","h5","h6","hr","i","img","input","ins","keygen","kbd","label","legend","li","m","map","menu","meter","multicol","nav","nextid","ol","output","optgroup","option","p","pre","progress","q","s","samp","section","select","small","sound","source","spacer","span","strike","strong","sub","sup","table","tbody","td","textarea","time","tfoot","th","thead","tr","tt","u","ul","var","video","style","svg","use"],y=["azimuth","background","background-color","border-bottom-color","border-collapse","border-color","border-left-color","border-right-color","border-top-color","clear","color","cursor","direction","display","elevation","float","font","font-family","font-size","font-style","font-variant","font-weight","height","line-height","overflow","pause","pause-after","pause-before","pitch","pitch-range","richness","speak","speak-header","speak-numeral","speak-punctuation","speech-rate","stress","text-align","text-decoration","unicode-bidi","vertical-align","voice-family","volume","white-space","width"];v.allowedTags=b,v.allowedStyles={};for(var w=0,k=b;w<k.length;w++){var x=k[w];void 0===v.allowedAttributes[x]?v.allowedAttributes[x]=["class","style"]:v.allowedAttributes[x].concat(["class","style"]),v.allowedStyles[x]=y}v.$compile=r,a.courseId&&(v.courseId=a.courseId),a.traceId&&(v.traceId=a.traceId);return v.upload={pasteImageUpload:function(e,t){var n={name:e.name,size:e.size,parent_id:0,is_scorm:!1,is_wmpkg:!1};uploadApi.preUpload(n).then((n=>{var r=n.body;uploadApi.uploadResource(r,e.obj,(function(n){n.lengthComputable&&t.trigger("uploadprogress",[e,n.loaded,n.total])}),(function(n){uploadService.isUploadCallback(r)&&uploadApi.uploadCallback(r.id).then((()=>{}));var o={success:!0,filePath:"".concat(i.simditor.url_prefix,"api/uploads/").concat(r.id,"/in-rich-content")+"?created_at=".concat(r.created_at),uploadId:r.id};t.trigger("uploadprogress",[e,e.size,e.size]),t.trigger("uploadsuccess",[e,o]),t.trigger("uploadcomplete")}),(function(n,r){t.trigger("uploaderror",[e,n,r]),t.trigger("uploadcomplete")}))}))}},e.create(o,v).then((function(e){i.simditor=e;var r=e=>e.stopPropagation();i.simditor.body.on("focus",(function(){return i.enableAutoSubmit&&(i.patronCtrl.patronValue=l.$modelValue),i.simditor.body.on("wheel",r)})),i.simditor.body.on("blur",(function(){if(i.simditor.body.off("wheel",r),i.enableAutoSubmit)return h()?(m(),i.rollbackCallback()):g()})),l.$render=()=>i.simditor.setValue(n(l.$viewValue||"")),i.simditor.on("insertUpload",(function(e,t){i.$emit("simditorInsertUpload",t.uploads)})),void 0!==a.cleanFontSizePaste&&(i.simditor.opts.cleanFontSizePaste=!0),void 0!==a.disabledPaste&&i.simditor.on("pasting",((e,t)=>!1)),i.simditor.on("removeUpload",(function(e,t){i.$emit("simditorRemoveUpload",t.uploads)}));var o=()=>{var e=i.simditor.getValue(),n=!1;try{n=!$(e).text().trim()&&!e.includes("img")}catch(e){}return n&&(e=""),document.querySelectorAll("div.simditor-body pre").forEach((e=>{e.className=e.dataset.lang,e.contentEditable=!1,hljs.highlightElement(e)})),t((()=>l.$setViewValue(e)))};return i.simditor.on("markdownchanged",(()=>{o()})),i.simditor.on("valuechanged",(function(){o()}))}))}}})],exports.modelPatron=()=>({require:["modelPatron","ngModel"],restrict:"A",scope:{ngModel:"=",submitCallback:"&",rollbackCallback:"&"},controller:()=>({}),link(e,t,n,r){var i,o={required:!0,enterToSubmit:!0,bindConvertValue:!0};angular.extend(o,e.$eval(n.modelPatron));var a=_slicedToArray(Array.from(r),2),l=a[0],s=a[1];t.bind("focus",(function(){var e,t=s.$modelValue;return l.patronValue=null===(e=d(t))||void 0===e?void 0:e.toString()})),t.bind("keydown",(function(e){if(27===e.keyCode)return e.preventDefault(),u()})),t.bind("blur",(()=>c())),t.bind("keypress",(function(e){if(13===e.keyCode&&o.enterToSubmit)return e.preventDefault(),t.blur()}));var d=function(e){return!o.bindConvertValue||isNaN(e)||""===e||null===e?e:parseFloat(e)},c=function(){return i()?(u(),e.rollbackCallback()):p()},u=function(){return s.$setViewValue(l.patronValue||""),s.$render()},p=function(){return e.submitCallback().then((()=>l.patronValue=s.$modelValue),(()=>u()))};return i=function(){var e=d(s.$modelValue).toString(),t=l.patronValue;return o.required?s.$isEmpty(e)||String(e)===String(t):e===t}}}),exports.modelTimeScorePatron=()=>({require:["modelTimeScorePatron","ngModel"],restrict:"A",scope:{ngModel:"=",submitCallback:"&",editingStatusCallback:"&",showFloatingMessage:"&",removeFloatingMessage:"&"},controller:()=>({}),link(e,t,n,r){var i,o={required:!0,type:"number"};angular.extend(o,e.$eval(n.modelTimeScorePatron));var a=_slicedToArray(Array.from(r),2),l=a[0],s=a[1];t.bind("focus",(function(){var e=s.$modelValue;if(isNaN(e)||""===e||null===e?l.patronValue=e:l.patronValue=parseFloat(e),!l.status)return l.correctPatronValue=l.patronValue})),t.bind("keydown",(function(e){if(27===e.keyCode)return e.preventDefault(),p()})),t.bind("keyup",(function(e){if("number"===o.type)return c()}));var d=function(t){return l.status=t,e.editingStatusCallback({status:t})},c=function(){var t=0,r=100,i=!0,o=!1;void 0!==n.minimum&&""!==n.minimum&&(t=n.minimum),void 0!==n.maximum&&""!==n.maximum&&(r=n.maximum),void 0!==n.validate&&""!==n.validate&&"false"===n.validate&&(i=!1),void 0!==n.nullable&&""!==n.nullable&&"true"===n.nullable&&(o=!0);var a=s.$modelValue;if(!(!1===i||0===a.length&&o)){if(""!==a&&void 0!==a){var c=parseFloat(a);c<t||c>r?d("process-error"):c>=t||c<=r?d("editing"):String(parseFloat(a))===String(l.correctPatronValue)?d(null):d("processing")}else l.correctPatronValue?d("process-error"):d(null);return e.removeFloatingMessage()}};t.bind("blur",(()=>u())),t.bind("keypress",(function(e){if(13===e.keyCode)return e.preventDefault(),t.blur()}));var u=function(){return i()?d(null):f()},p=function(){return s.$setViewValue(l.correctPatronValue),s.$render()},f=function(){d("processing"),e.showFloatingMessage({status:"processing",disappear:!1});return e.submitCallback({oldValue:l.correctPatronValue}).success((function(t){return e.showFloatingMessage({status:"process-success"}),l.patronValue=s.$modelValue,d(null)})).error((function(t,n){return 400===n?e.showFloatingMessage({status:"process-valid-error",msg:t.errors[o.field][0],disappear:!1}):e.showFloatingMessage({status:"process-failed",msg:"",disappear:!1}),d("process-error")}))};return i=function(){var e=s.$modelValue,t=l.patronValue;return"number"===o.type?s.$isEmpty(e)&&s.$isEmpty(l.correctPatronValue)||String(parseFloat(e))===String(l.correctPatronValue):String(e)===String(t)}}}),exports.modelScorePatron=()=>({require:["modelScorePatron","ngModel"],restrict:"A",scope:{ngModel:"=",submitCallback:"&",editingStatusCallback:"&",showFloatingMessage:"&",removeFloatingMessage:"&"},controller:()=>({}),link(e,t,n,r){var i,o={required:!0,type:"number"};angular.extend(o,e.$eval(n.modelScorePatron));var a=_slicedToArray(Array.from(r),2),l=a[0],s=a[1];t.bind("focus",(function(){var e=s.$modelValue;if(isNaN(e)||""===e||null===e?l.patronValue=e:l.patronValue=parseFloat(e),!l.status)return l.correctPatronValue=l.patronValue})),t.bind("keydown",(function(e){if(27===e.keyCode)return e.preventDefault(),p()})),t.bind("keyup",(function(e){if("number"===o.type)return c()}));var d=function(t){return l.status=t,e.editingStatusCallback({status:t})},c=function(){var t=s.$modelValue;if(""!==t&&void 0!==t){var n=parseFloat(t);n<0||n>100?d("process-error"):String(parseFloat(t))===String(l.correctPatronValue)?d(null):d("processing")}else l.correctPatronValue?d("process-error"):d(null);return e.removeFloatingMessage()};t.bind("blur",(()=>u())),t.bind("keypress",(function(e){if(13===e.keyCode)return e.preventDefault(),t.blur()}));var u=function(){if(!i())return f()},p=function(){return s.$setViewValue(l.correctPatronValue),s.$render()},f=function(){d("processing"),e.showFloatingMessage({status:"processing",disappear:!1});return e.submitCallback({oldValue:l.correctPatronValue}).success((function(t){return e.showFloatingMessage({status:"process-success"}),l.patronValue=s.$modelValue,d(null)})).error((function(t,n){return 400===n?e.showFloatingMessage({status:"process-valid-error",msg:t.errors[o.field][0],disappear:!1}):e.showFloatingMessage({status:"process-failed",msg:"",disappear:!1}),d("process-error")}))};return i=function(){var e=s.$modelValue,t=l.patronValue;return"number"===o.type?s.$isEmpty(e)&&s.$isEmpty(l.correctPatronValue)||String(parseFloat(e))===String(l.correctPatronValue):String(e)===String(t)}}}),exports.stopPropagation=()=>({restrict:"A",link:(e,t,n)=>t.bind("click",(e=>e.stopPropagation()))}),exports.contentLengthLimit=["$parse",e=>({restrict:"A",link(t,n,r,i){var o=e(r.contentLengthLimit),a=t.$eval(r.contentLengthMax);if(a)return n.bind("input keydown",(function(e){return n.val().length>=a&&function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.which||e.keyCode||e.charCode;if(t&&9===n)return!1;var r={8:"Backspace",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",46:"Delete"},i={metaKey:{88:"X",65:"A"},ctrlKey:{88:"X",65:"A"},shiftKey:{},altKey:{}};for(var o in i)if(e[o]&&i[o][n])return!1;return!r[n]}(e)?(e.preventDefault(),e.stopPropagation(),t.$apply((()=>o(t,{$exceeded:!0})))):t.$apply((()=>o(t,{$exceeded:!1}))),setTimeout((()=>t.$digest()))})),n.bind("keyup",(function(e){if(n.val().length>a)return n.val(n.val().substr(0,a)),t.$apply((()=>o(t,{$exceeded:!0}))),setTimeout((()=>t.$digest()))}))}})],exports.contentLengthLeft=["$parse",e=>({restrict:"A",scope:{bindModel:"="},link(e,t,n,r){var i=e.$parent.$eval(n.contentLengthMax);if(i)return t.bind("keyup",(()=>e.bindModel.leftCharacterCount=i-t.val().length)),e.bindModel.leftCharacterCount=i}})],exports.toggleDropdownList=["$timeout","$rootScope","$window",(e,t,n)=>({restrict:"A",link(n,r,i){r.hide();var o=!0;return e((function(){$("#".concat(i.toggleDropdownList)).on("touchstart click",(function(e){if(o){if(o=!1,!t.displayedDropdown)return r.show(),t.displayedDropdown=r,setTimeout((()=>o=!0),300),e.stopPropagation();$(r).is(t.displayedDropdown)?(r.hide(),t.displayedDropdown=null):(t.displayedDropdown.hide(),r.show(),t.displayedDropdown=r)}return setTimeout((()=>o=!0),300),e.stopPropagation()})),$("body").on("click",(function(){return o&&t.displayedDropdown?(t.displayedDropdown.hide(),t.displayedDropdown=null):setTimeout((()=>o=!0),300)}))}))}})],exports.expandHeight=["$timeout",e=>({restrict:"A",link(t,n,r){n.css("overflow-y","hidden");var i=function e(){var t=$("#"+r.container),i=t.is(":visible");i||t.show();var o=n.find("textarea");o.css("height","auto"),o.off("change keyup keydown paste",e).on("change keyup keydown paste",e);var a,l=0,s=_createForOfIteratorHelper(o);try{for(s.s();!(a=s.n()).done;){var d=a.value;$(d).css("height","auto"),d.scrollHeight>l&&(l=d.scrollHeight)}}catch(e){s.e(e)}finally{s.f()}o.css("height",l+10);var c,u=0,p=_createForOfIteratorHelper(n.find(">.column"));try{for(p.s();!(c=p.n()).done;){var f=c.value;$(f).css("height","auto"),f.scrollHeight>u&&(u=f.scrollHeight),$(f).css("height","")}}catch(e){p.e(e)}finally{p.f()}if(n.css("height",u),!i)return t.hide()};return t.$on("refreshHeight",(()=>e((()=>i())))),t.$watch(r.expandHeight,(()=>e((()=>i()))),!0)}})];var _formatDatetime=e=>t=>utils.formatDatetime(t,e);exports.formatDatetime=()=>({restrict:"A",require:"?ngModel",link:(e,t,n,r)=>r.$formatters.push(_formatDatetime(n.formatDatetime))}),exports.parseBoolean=()=>({restrict:"A",require:"?ngModel",link:(e,t,n,r)=>(r.$parsers.push(utils.parseBoolean),r.$formatters.push(utils.formatBoolean))}),exports.goBack=["$window",e=>({restrict:"A",link:(t,n)=>n.bind("click",(function(){e.history.length>2&&e.history.back();var t=$("#courseId").val();return t?e.location.href="/course/".concat(t,"/content"):e.history.back()}))})],exports.autoSelect=()=>({restrict:"A",link:(e,t,n)=>t.bind("click",(()=>t.select()))}),exports.onFileSelected=["$rootScope","$parse",(e,t)=>({restrict:"A",priority:-1,link:(n,r,i)=>(n.fileSelectorClicked=!1,r.bind("click",(function(){if(n.$emit("fileSelectOpen"),e.$apply(),!n.fileSelectorClicked){n.fileSelectorClicked=!0;var r=i.fileSelectScopeId?"filesSelected"+i.fileSelectScopeId:"filesSelected";return n.$on(r,((e,r)=>t(i.onFileSelected)(n)(angular.copy(r))))}})))})],exports.floatPrecision=()=>({restrict:"A",require:"?ngModel",link(e,t,n,r){var i=parseInt(n.floatPrecision,10);return r.$parsers.push((function(e){if(![0,0].includes(e)&&!e)return"";var t=(e+="").replace(/[^0-9 .]+/g,"");if(t!==e)return r.$setViewValue(t),r.$render(),t;var o=e.indexOf(".");if(-1!==o){t.match("^\\.")&&(t="0"+t,r.$setViewValue(t),r.$render());var a=e.indexOf(".",o+1);a>-1?(t=e.substring(0,a),r.$setViewValue(t),r.$render()):0===i&&-1!==o?(t=e.replace(".",""),r.$setViewValue(t),r.$render()):e.length-(o+1)>i&&(t=e.substr(0,o+i+1),r.$setViewValue(t),r.$render())}return void 0!==n.parseFloat&&(t=utils.formatFloat(t)),void 0!==n.min&&utils.formatFloat(n.min)>t&&(t=n.min,r.$setViewValue(t),r.$render()),void 0!==n.max&&utils.formatFloat(n.max)<t&&(t=n.max,r.$setViewValue(t),r.$render()),t}))}}),exports.alert=()=>({restrict:"A",link:(e,t,n)=>t.on("click",(()=>window.alert(n.alert)))}),exports.previewer=["$rootScope",e=>({restrict:"A",link:(t,n,r)=>n.click((function(){e.fromPage=r.fromPage;var n=t.$eval(r.previewer);if(n){var i,o,a,l;if("LARK"===(null==n||null===(i=n.currentFile)||void 0===i?void 0:i.source))return window.open(n.currentFile.url);if("WEDRIVE"===(null==n||null===(o=n.currentFile)||void 0===o?void 0:o.source))return e.$broadcast("previewFile",n.currentFile,t.activity);if("page"===(null===(a=n.activity)||void 0===a?void 0:a.type))return e.$broadcast("previewPageContent",n.activity);if("lesson"===(null===(l=n.activity)||void 0===l?void 0:l.type))return e.$broadcast("previewLesson",n.activity);if("video-quiz"===(null==n?void 0:n.currentFile.type)){var s=((null==n?void 0:n.currentFile.uploads)||n.uploads||[])[0];if(s&&!s.deleted)return e.$broadcast("previewFile",s,n.activity)}if(!n.currentFile.deleted){var d=n.uploads;d&&Array.isArray(d)&&(d=d.filter((e=>e.id>0)));var c=n.isAttachment||!1,u=n.aliyunOfficeEdit||!1;return d&&0!==d.length?e.$broadcast("previewFiles",d,n.currentFile,n.activity,n.canAddNote,n.canGuestPreview,n.forceShowDownloadButton,c,u):e.$broadcast("previewFile",t.upload,t.activity,u)}}else if("video-quiz"===t.upload.type){var p,f=(null!==(p=t.upload.uploads)&&void 0!==p?p:[])[0];if(f&&!f.deleted)return e.$broadcast("previewFile",f)}else if(!t.upload.deleted)return e.$broadcast("previewFile",t.upload,t.activity)}))})],exports.resourceReferencePreviewer=["$rootScope",e=>({restrict:"A",link(t,n,r){var i=t.ccLicenseMapping[t.resource.cc_license_name];return i&&t.resource.upload&&(t.resource.upload.cc_license_description=i.description,t.resource.upload.cc_license_code=i.code,t.resource.upload.cc_license_name=i.name,t.resource.upload.cc_license_link=i.link,t.resource&&t.resource.share_to_id&&(t.resource.upload.referType="shared_resource",t.resource.upload.referId=t.resource.id)),n.click((()=>e.$broadcast("previewResourceReference",t.resource)))}})],exports.lessonResourcePreviewer=["$rootScope",e=>({restrict:"A",link(t,n,r){var i=t.resource,o=i.name,a=i.referrer_id;if("lesson_resource"===i.referrer_type)return n.click((()=>e.$broadcast("previewFile",{id:a,name:o,type:"lesson-resource"})))}})],exports.hypothesisStat=["$rootScope",e=>({restrict:"A",link:(t,n,r)=>n.click((function(){if(!t.upload.deleted)return e.$broadcast("openHypothesisStat",t.upload,t.activity)}))})],exports.integerLimit=()=>({restrict:"A",require:"?ngModel",link(e,t,n,r){r.$parsers.push(_.debounce((function(e){if(null==e)return"";var t=e.toString().replace(/[^0-9]/g,""),i=parseInt(n.max)?n.max:"1000000",o=parseInt(n.min)?n.min:"0";return parseInt(t)>parseInt(i)&&(t=i),parseInt(t)<parseInt(o)&&(t=o),"number"==typeof(t=parseInt(t)||t)&&(r.$setViewValue(t),r.$render()),t}),500)),t.on("blur",(function(e){var t=e.target.value;r.$setViewValue(t),r.$render()}))}}),exports.uuidFormatter=()=>({restrict:"A",require:"?ngModel",link:(e,t,n,r)=>r.$formatters.push((function(e){return e&&0===e.indexOf("_uuid_")?"":e}))}),exports.refreshOn=["$parse",e=>({restrict:"A",link(t,n,r){if(r.ngInit)return t.$watch(r.refreshOn,(()=>e(r.ngInit)(t)))}})],exports.backgroundImage=()=>({restrict:"A",link:(e,t,n)=>n.$observe("backgroundImage",(function(e){if(e)return t.css({"background-image":"url("+n.backgroundImage+")"})}))}),exports.beforeController=()=>({restrict:"A",priority:550,scope:!0,controller:["$scope","$attrs",(e,t)=>e.$eval(t.beforeController)]}),exports.activityCheckpointLock=["$timeout",e=>({restrict:"E",replace:!0,template:'<div class="activity-lock"> <i class="font font-thin-lock"></i> </div>'})],exports.rootScopeVariable=["$rootScope",e=>({restrict:"E",link(t,n,r){if(!_.isEmpty(r.name))return e[r.name]=r.value}})],exports.fixNgModelName=()=>({restrict:"A",require:["ngModel","^?form"],link(e,t,n,r){var i=_slicedToArray(Array.from(r),2),o=i[0],a=i[1];if(a)return n.$observe("name",(function(e){if(e!==o.$name)return a.$removeControl(o),o.$name=e,a.$addControl(o)}))}});var treeViewTemplate='<script type="text/ng-template" id="treeSelector">\n    <div class="form-element-wrapper">\n        <div class="select2-container tree-selector">\n            <a href="javascript:void(0)" class="select2-choice" ng-click="showTreeContainer=!showTreeContainer">\n                <span class="select2-chosen">\n                    <div class="select2-line-content"></div>\n                </span>\n                <span class="select2-arrow"></span>\n            </a>\n            <div class="tree-container" ng-include="\'treeNode\'" ng-show="showTreeContainer">\n            </div>\n        </div>\n    </div>\n<\/script>',treeNodeTemplate='<script type="text/ng-template" id="treeNode">\n    <div ng-repeat="node in nodes track by node.id" class="tree-node" ng-click="selectTreeNode(node)" stop-propagation>\n        <span style="visibility: [[node.children.length > 0?\'visible\':\'hidden\']]" stop-propagation>\n            <i class="font font-tree-expanded" ng-click="node.expanded = !node.expanded" ng-if="!node.expanded"></i>\n            <i class="font font-tree-collapsed" ng-click="node.expanded = !node.expanded" ng-if="node.expanded"></i>\n        </span>\n        <span id="[[ node.id ]]" ng-bind="node.name"></span>\n        <div class="children" ng-if="(nodes=node.children) && nodes && nodes.length > 0 && node.expanded" ng-include="\'treeNode\'"></div>\n    </div>\n<\/script>';$("body").append(treeNodeTemplate),$("body").append(treeViewTemplate),exports.treeSelector=()=>({restrict:"EA",require:"?treeModel",scope:{treeModel:"=",nodes:"="},link(e,t,n){var r=void 0,i=function(e){t.find(".select2-chosen .select2-line-content").text(e.name)},o="false"!==n.allowSelectParent,a=e.$parent.$eval(n.nodes),l=function e(t,n){var i,o=_createForOfIteratorHelper(n);try{for(o.s();!(i=o.n()).done;){var a=i.value;if(r)return r;if(a.id===t)return r=a;a.children&&e(t,a.children)}}catch(e){o.e(e)}finally{o.f()}}(e.treeModel,a);return l&&i(l),e.selectTreeNode=function(t){if(o||!t.children.length)return e.treeModel=t.id,e.showTreeContainer=!1,i(t);t.expanded=!t.expanded},$("body")[0].addEventListener("click",(function(n){if(!(t.find(n.target).length>0))return e.showTreeContainer=!1,e.$apply()}),!0)},templateUrl:"treeSelector"}),exports.autoScrollToLastPosition=["$document","$timeout","$location",(e,t,n)=>({restrict:"A",link:(r,i,o)=>(r.okSaveScroll=!0,r.scrollPos={},r.previousLocationPath="",e.bind("scroll",(function(){if(r.okSaveScroll)return r.scrollPos[n.path()]=$(window).scrollTop()})),r.scrollClear=e=>r.scrollPos[e]=0,r.$on("$locationChangeSuccess",(function(){window.scrollTo(0,0);var e=0;return r.scrollPos[n.path()]&&(e=r.scrollPos[n.path()]),n.path()!==r.previousLocationPath&&t((function(){return $("html, body").stop().animate({scrollTop:e},400,"swing"),r.okSaveScroll=!0}),0),r.previousLocationPath=n.path()})),r.$on("$locationChangeStart",(e=>r.okSaveScroll=!1)))})],exports.circleBar=function(){return{restrict:"E",replace:!0,require:"^ngModel",scope:{ngModel:"="},link:(e,t,n)=>e.$watch("ngModel",(()=>function(e,t){var n=null!=t.ngModel?t.ngModel:0;e.find(".mask :first-child").text(n+"%");var r=e.css("background-color");return n<=50?e.find(".circle-bar-right").css("transform","rotate("+3.6*n+"deg)"):(e.find(".circle-bar-right").css({transform:"rotate(0deg)","background-color":r}),e.find(".circle-bar-left").css("transform","rotate("+3.6*(n-50)+"deg)"))}(t,e)),!0),template:'<div id="circle-bar" class="circle-bar"> <div class="circle-bar-left"></div> <div class="circle-bar-right"></div> <div class="mask"> <span class="percent">{{ ngModel }}%</span> </div> </div>'}},exports.lazyload=()=>({restrict:"A",link:(e,t,n)=>t.lazyload()}),exports.draggable=function(){return{restrict:"A",link(e,t){if(!_.isEmpty(t))return function(e){var t;e=e[0];var n=0,r=0,i=0,o=0,a=function(t){return(t=t||window.event).preventDefault(),n=i-t.clientX,r=o-t.clientY,i=t.clientX,o=t.clientY,e.style.top=e.offsetTop-r+"px",e.style.left=e.offsetLeft-n+"px"};return e.onmousedown=function(e){return(e=e||window.event).preventDefault(),i=e.clientX,o=e.clientY,document.onmouseup=t,document.onmousemove=a},t=function(){return document.onmouseup=null,document.onmousemove=null}}(t)}}},exports.onRepeatFinished=["$timeout",e=>({restrict:"A",link(t,n,r){if(t.$last)return e((()=>t.$eval(r.onRepeatFinished)))}})],exports.uiBreadcrumbs=["$route","$translate",function(e,t){return{restrict:"E",template:'    <div id=\'breadcrumb\' class="row">\n      <span ng-repeat="crumb in breadcrumbs" class="crumb" ng-class="{ \'current-crumb\': $last }">\n          <a ng-href="#{{ crumb.originalPath }}" ng-if="!$last">{{ crumb.displayName }}</a>\n          <span ng-show="$last">{{ crumb.displayName }}</span>\n          <span class="crumb-delimiter" ng-if="!$last"> > </span>\n      </span>\n    </div>    ',link:function(n){n.breadcrumbs=[];var r=e.routes?Object.values(e.routes):[];function i(e,n){var r=[],o=e.find((e=>e.code===n));return o?(o.displayName=t.instant(o.code),r.push(o),o.parent&&r.push(...i(e,o.parent)),r):r}n.$on("$routeChangeSuccess",(function(e,t){var o=i(r,t.$$route.code);o.reverse(),n.breadcrumbs=o}))}}}],exports.vueWrapper=function(){return{restrict:"A",link:function(e,t){Promise.all([__webpack_require__.e(62831),__webpack_require__.e(67728),__webpack_require__.e(75551),__webpack_require__.e(58348),__webpack_require__.e(61580),__webpack_require__.e(91307),__webpack_require__.e(78196),__webpack_require__.e(31185),__webpack_require__.e(34922),__webpack_require__.e(702),__webpack_require__.e(40678),__webpack_require__.e(98659),__webpack_require__.e(4301),__webpack_require__.e(49998),__webpack_require__.e(74932),__webpack_require__.e(4849),__webpack_require__.e(76970),__webpack_require__.e(9101),__webpack_require__.e(11486),__webpack_require__.e(94874),__webpack_require__.e(40433),__webpack_require__.e(15974),__webpack_require__.e(29433),__webpack_require__.e(56212),__webpack_require__.e(19279),__webpack_require__.e(77768),__webpack_require__.e(66309),__webpack_require__.e(2079),__webpack_require__.e(91131),__webpack_require__.e(17455),__webpack_require__.e(11610),__webpack_require__.e(10405),__webpack_require__.e(31342),__webpack_require__.e(85787),__webpack_require__.e(15868),__webpack_require__.e(9449),__webpack_require__.e(51845),__webpack_require__.e(94493),__webpack_require__.e(14787),__webpack_require__.e(98046),__webpack_require__.e(42311),__webpack_require__.e(10552),__webpack_require__.e(14402),__webpack_require__.e(6671)]).then(__webpack_require__.bind(__webpack_require__,548908)).then((()=>{if(!t._vue){var n=new Vue({el:t[0],i18n:I18n,provide:e.vueParam,data:()=>e.vueParam||{},methods:e.vueMethods||{}});e.vue=n,t._vue=n}}))}}},exports.vueSlider=["$timeout",function($timeout){return{restrict:"E",scope:{},template:'\n          <div style="width: 100%" vue-wrapper>\n            <wg-slider :value="value" :stop="stop" :max="max" :show-tips="showTips" :published="published" @input="sliderInput"></wg-slider>\n          </div>',controller:["$scope",function(e){e.stop=0,e.max=100,e.vueLoaded=!1,e.httpLoaded=!1,e.showTips=!1,e.published=!1,e.value=0,e.vueParam={stop:e.stop,max:e.max,showTips:e.showTips,published:e.published,value:e.value},e.vueMethods={sliderInput(t){e.$emit("inputChange",t)}},e.$watch("vue",(()=>{e.vue&&(e.vueLoaded=!0,e.httpLoaded&&e.$emit("resetVueParam"))})),e.$on("resetVueParam",(()=>{e.vueLoaded&&e.httpLoaded?void 0!==e.vue.stop&&(e.vue.stop=e.stop,e.vue.max=e.max,e.vue.showTips=e.showTips,e.vue.published=e.published,e.vue.value=e.value):e.$apply()}))}],link($scope,_,$attrs){var leftPercentField=$attrs.leftPercent,percentField=$attrs.percent,publishedField=$attrs.published,isScoredField=$attrs.isScored,useMax=void 0!==$attrs.max||"true"===$attrs.max,showTips=void 0!==$attrs.showTips||"true"===$attrs.showTips;$scope.$watch("$parent.".concat(leftPercentField),(newValue=>{if($scope.$parent[leftPercentField]&&$scope.$parent[leftPercentField].minus){if(useMax){var max=Number(new Decimal(100).minus($scope.$parent[leftPercentField]).toFixed());$scope.max=max}showTips&&($scope.showTips=!0),$scope.published=eval("$scope.$parent.".concat(publishedField)),$scope.value=Number(eval("$scope.$parent.".concat(percentField))),$scope.stop=Number(newValue.toFixed()),$scope.httpLoaded=!0,$scope.vueLoaded&&$scope.$emit("resetVueParam")}})),isScoredField&&$scope.$watch("$parent.".concat(isScoredField),(()=>{$timeout((()=>{$scope.$emit("resetVueParam")}),50)})),$scope.$on("inputChange",((_,data)=>{$timeout(eval("$scope.$parent.".concat(percentField," = ").concat(data)))}))}}}],exports.elementReady=function(){return{priority:-1e3,restrict:"A",link:function(e,t,n){e.$eval(n.elementReady)}}};var ace=__webpack_require__(722085);ace.config.set("basePath","/static/js/ace"),exports.code=function(){return{priority:-100,restrict:"E",transclude:!0,replace:!0,scope:!0,template:'<pre style="min-width:600px;background:white;" id="{{uuid}}"><ng-transclude></ng-transclude></pre>',link:function(e,t,n){e.lang=_.find((n.class||"").split(/\s+/),(e=>e.includes("lang")))||"lang-javascript",e.uuid=[(new Date).getTime(),Math.floor(1e4*Math.random())].join("_"),setTimeout((function(){$("#".concat(e.uuid)).length<=0||(e.editor=ace.edit(e.uuid,{maxLines:25,wrap:!0,highlightActiveLine:!1,mode:"ace/mode/".concat(e.lang.replace("lang-","")),useWorker:!1}),e.editor.setReadOnly(!0))}),500)}}},exports.previewContentInIframe=["$timeout",e=>({restrict:"A",link(e,t,n){$(t).html('<iframe id="previewContentInIframe" src="'.concat(n.iframeSrc,'" style="width:100%;height:').concat(n.iframeHeight,'px;border:none"></iframe>')),"true"==n.resize&&iFrameResize({log:!1,checkOrigin:!1},"#previewContentInIframe")}})],exports.groupSelector=()=>({restrict:"E",template:'<div class="group-selector" ng-style="{\'width\': boxWidth}" ng-class="{\'group-selector-forbidden\': readonly == \'true\'}">\n            <div class="group-selector-btn btn-size-[[btnSize]]" ng-class="{\'border-hide\': hideBorder == \'true\', \'border-show\': hideBorder != \'true\'}" ng-click="openSelector()">\n              <label class="selected-name" ng-if="selectedName !=\'\'" ng-bind="selectedName" tipsy="selectedName" tipsy-ellipsis="no"></label>\n              <label class="dropdown-icon"><i class="icon icon-arrow-down"></i></label>\n            </div>\n            <ul class="group-selector-box hidden-selector" ng-style="{\'width\': boxWidth, \'max-height\': boxHeight}">\n              <li ng-repeat="item in selectList"\n                ng-class="{\'selected-option\': item.value==selected && item.highlight, \'highlight-option\': item.highlight, \'secondary-option\': item.level > 1}"\n                ng-click="selectItem(item)"\n                tipsy="item.key" tipsy-ellipsis="no">{{item.key}}</li>\n            </ul>\n          </div>',scope:{groups:"=",selected:"=",disabled:"=",hideBorder:"@",width:"@",height:"@",readonly:"@",btnSize:"@"},link(e,t,n){e.selectList=[],e.selectedName="",e.boxWidth=e.width&&""!=e.width?e.width:"320px",e.boxHeight=e.height&&""!=e.height?e.height:"300px",e.btnSize=e.btnSize&&""!=e.btnSize?e.btnSize:"small",e.showDropDown=!1,e.groupLength=0;var r=()=>{var e=$(t).offset().left;$(t).find(".group-selector-box").offset({left:e})};$(t).parents(".sync-scroll-x").scroll(r),e.$watch("groups+selected",(function(){e.groups&&e.groupLength!=e.groups.length&&(e.groupLength=e.groups.length,e.selectList=[],e.selected=e.selected&&""!=e.selected&&-1!=e.selected&&0!=e.selected?e.selected:e.groups[0].value,e.selectedName="",e.oldGroupLen=e.groups.length,e.groups.forEach((t=>{var n=!t.items||0==t.items.length;e.selectList.push({key:t.name,value:n?t.value:9999,highlight:n,level:1}),e.selected&&e.selected==t.value&&(e.selectedName=t.name),n||t.items.forEach((t=>{e.selectList.push({key:t.name,value:t.value,highlight:!0,level:2}),e.selected&&e.selected==t.value&&(e.selectedName=t.name)}))})),""==e.selectedName&&(e.selectedName=e.groups[0].name,e.selected=e.groups[0].value),document.addEventListener("mouseup",(e=>{e=e||window.event;var n=$(".group-selector-btn");n.is(e.target)||0!==n.has(e.target).length||(t[0].children[0].children[1].classList.add("hidden-selector"),t[0].children[0].children[0].classList.remove("highlight-btn"))}))),e.selectList.length>0&&e.selectList.forEach((t=>{e.selected==t.value&&(e.selectedName=t.key)}))})),e.$watch("disabled",(function(){e.selectList.forEach((t=>{t.highlight=t.value!=e.disabled&&9999!=t.value})),e.selected&&e.selected==e.disabled&&(e.selected=e.groups[0].value,e.selectedName=e.groups[0].name)})),e.openSelector=function(n){"true"!=e.readonly&&(t[0].children[0].children[0].classList.add("highlight-btn"),t[0].children[0].children[1].classList.remove("hidden-selector")),r()},e.selectItem=function(n){n.highlight&&(e.selected=n.value,e.selectedName=n.key,t[0].children[0].children[1].classList.add("hidden-selector"),t[0].children[0].children[0].classList.remove("highlight-btn"))}}}),exports.injectContext=["$compile",e=>({restrict:"A",link(){window.$compile||(window.$compile=e)}})],exports.checkUploadStatus=()=>({restrict:"A",link(e,t,n){e.uploads&&e.uploads.length&&_.find(e.uploads,(e=>e.audit_status))?e.hasAuditStatus=!0:e.hasAuditStatus=!1}}),exports.doubleClickDisabled=()=>({restrict:"A",link(e,t,n){$(t).on("click",(()=>{$(t).attr("disabled","disabled"),setTimeout((()=>{$(t).removeAttr("disabled")}),800)}))}}),exports.syncScrollContent=()=>({restrict:"A",link(e,t,n){$(t).find(".sync-scroll-x").scroll((e=>{var n=$(e.target).scrollLeft();$(t).find(".sync-scroll-x").scrollLeft(n)})),$(t).find(".sync-scroll-y").scroll((e=>{var n=$(e.target).scrollTop();$(t).find(".sync-scroll-x").scrollTop(n)}))}}),exports.iframeonload=()=>({restrict:"A",link:(e,t,n)=>{t.bind("load",(()=>{e.$apply((()=>e.$eval(n.iframeonload)))}))}}),exports.autoHeightTextarea=["$timeout",function(e){return{restrict:"A",link:function(t,n){t.initialHeight=t.initialHeight||n[0].style.height;var r=function(){n[0].style.height=t.initialHeight,n[0].style.height=Math.floor(n[0].scrollHeight+5)+"px"};n.on("input change",r),e(r,0)}}}],exports.scrollBy=()=>({restrict:"A",link(e,t,n){var r=n.scrollBy;$(r).on("scroll",(e=>{$(t).scrollLeft($(e.target).scrollLeft())}))}}),exports.autoHeightTable=["$timeout",function(e){return{restrict:"A",link(t,n,r){var i,o=n.index(),a=null!==(i=r.autoHeightTable)&&void 0!==i?i:"",l=r.useIndex,s=a.split(",");e((()=>{var e=n.outerHeight();s.forEach((t=>{var n=$(".".concat(t))[l?o:o-1];n&&$(n).outerHeight(e)})),n.outerHeight(e)}))}}}],exports.verticalSelf=["$timeout",function(e){return{restrict:"A",link(t,n){var r=n.parent();e((()=>{var e=n.height(),t=r.height()/2-e/2;n.css({marginTop:t})}))}}}],exports.autoHeightForState=["$timeout",function(e){return{restrict:"A",link(t,n){var r=$(n).index(),i=$(".activity-body .module-content-wrapper"),o=$(".module-overall, .module-block, .syllabus-overall, .activity-block",i);e((()=>{var e=n.height();o.each(((t,n)=>{$($(n).children().get(r)).css({height:e+"px","line-height":e+"px"})}));var t=$(".basic-info-header + div").height();$(".activity-body .module-header-wrapper .module-header").height(t),$(".activity-body .module-header-wrapper").parent().height(t).parent().height(t)}))}}}],exports.waterMark=[()=>({restrict:"A",link(e,t,n){var r=n.waterMark;if(!r){var i,o,a=null===(i=window.globalData)||void 0===i?void 0:i.user.userNo,l=null===(o=window.globalData)||void 0===o?void 0:o.user.name;r="".concat(l," ").concat(a)}var s=n.color,d=n.font,c=utils.createWaterMakerImage(r,{fillStyle:s,font:d}),u=$("<div class='water-mark'>").css({position:"fixed",top:0,left:0,pointerEvents:"none",width:"100vw",height:"100vh",background:"url(".concat(c,") repeat")});$(t).find(".water-mark").length||$(t).append(u)}})],exports.errSrc=()=>({restrict:"A",link:function(e,t,n){t.bind("error",(function(){n.src!=n.errSrc&&n.$set("src",n.errSrc)}))}}),exports.widthFor=()=>({restrict:"A",link(e,t,n){if(n.widthFor&&$(n.widthFor).length){var r=$(n.widthFor).width();r&&t.width(r)}}}),exports.ellipsisText=()=>({restrict:"A",link(e,t,n){e.$watch("attr.ngBind",(()=>{var e,r=null!==(e=n.lines)&&void 0!==e?e:2,i=Number(t.css("line-height").replace("px",""));if(!(Number.isNaN(i)||i<=0)){var o=r*i,a=t.height();if(!(a<=o)){var l=t.text(),s=l.split(""),d=s.splice(-6);for(bool(n.useTipsy)&&t.tipsy({ellipsis:!1,gravity:$.fn.tipsy.autoBounds(37,n.tipsyGravity||"sw"),opacity:.95,followElementWidth:"true"===n.tipsyFollowElementWidth,ellipsisCheckMethod:n.tipsyEllipsisCheckMethod,html:!0,title:()=>l});a>o&&s.length;)s.pop(),t.text("".concat(s.join(""),"...").concat(d.join(""))),a=t.height()}}}))}}),exports.vueActivityTime=()=>({restrict:"E",scope:{start:"=?",end:"=?",neverExpire:"=?",endTimeError:"=?",startTimeError:"=?",showNeverExpire:"=?",showTips:"=?",requiredStart:"=?",requiredEnd:"=?",startTips:"@",endTips:"@"},template:'<activity-time\n        ng-prop-start="start"\n        ng-prop-end="end"\n        ng-prop-never_expire="neverExpire"\n        ng-prop-show_tips="showTips"\n        ng-prop-start_tips="startTips"\n        ng-prop-end_tips="endTips"\n        ng-prop-required_start="requiredStart"\n        ng-prop-required_end="requiredEnd"\n        ng-prop-end_time_error="endTimeError"\n        ng-prop-start_time_error="startTimeError"\n        ng-prop-show_never_expire="showNeverExpire"\n      ></activity-time>',controller:["$scope",e=>{var t,n,r,i,o,a;e.showTips=null===(t=e.showTips)||void 0===t||t,e.startTips=null!==(n=e.startTips)&&void 0!==n?n:"",e.endTips=null!==(r=e.endTips)&&void 0!==r?r:"",e.requiredStart=null!==(i=e.requiredStart)&&void 0!==i&&i,e.requiredEnd=null!==(o=e.requiredEnd)&&void 0!==o&&o,e.showNeverExpire=null===(a=e.showNeverExpire)||void 0===a||a}],link(e,t){var n=$("activity-time",t);n.on("start-date-change",(t=>{var n,r=t.detail;e.start=null!==(n=r[0])&&void 0!==n?n:"",e.startTimeError="",e.$apply()})),n.on("end-date-change",(t=>{var n,r=t.detail;e.end=null!==(n=r[0])&&void 0!==n?n:"",e.endTimeError="",e.$apply()})),n.on("expire-change",(t=>{var n=t.detail;e.neverExpire=n[0],e.$apply()})),e.$on("$destroy",(()=>{n.off("start-time-change"),n.off("end-time-change"),n.off("expire-change")}))}}),exports.vueDatepicker=()=>({restrict:"E",scope:{time:"=",err:"=",placeholder:"@",disabled:"=?"},template:'<wg-datepicker ng-prop-time="time" ng-prop-err="err" ng-prop-placeholder="placeholder" ng-prop-disabled="disabled"></wg-datepicker>',controller:["$scope",e=>{var t,n;e.placeholder=null!==(t=e.placeholder)&&void 0!==t?t:"",e.disabled=null!==(n=e.disabled)&&void 0!==n&&n}],link(e,t){$("wg-datepicker",t).on("date-change",(t=>{var n,r=t.detail;e.time=null!==(n=r[0])&&void 0!==n?n:"",e.err="",e.$apply()}))}}),exports.activityScoreTypeWeight=()=>({restrict:"E",scope:{courseId:"=",left:"=",value:"="},replace:!0,template:'\n    <div style="display: inline-block; width: 75%;">\n      <div><input type="text" disabled ng-value="valueText" style="text-align: center; background-color: #F7F7F7;" /> % <span style="color: #737373;">(<span ng-bind="leftText"></span>)</span></div>\n      <div style="padding: 12px 16px; background-color: #E9E9E9; margin-top: 16px; position: relative; border-radius: 3px;">\n        <div style="position: absolute; width: 8px; height: 8px; transform: rotate(45deg); left: 18px; top: -4px; background: inherit; border-radius: 3px;"></div>\n        <span ng-bind-html="tipText"></span>\n      </div>\n    </div>\n  ',controller:["$scope",e=>{e.leftText=e.$root.$t("scorePercentageSetting.leftPercentage",[0]),e.valueText=new Decimal(e.value||0).toFixed(1),e.tipText=e.$root.$t("scorePercentageSetting.scoreByWeightTip",['<a href="/course/'.concat(e.courseId,'/score" target="_blank">').concat(e.$root.$t("scorePercentageSetting.score"),"</a>")]),e.$watch("left",(t=>{if(t){var n=new Decimal(t).minus(new Decimal(e.value||0)).toFixed(1);e.leftText=e.$root.$t("scorePercentageSetting.leftPercentage",[new Decimal(n)])}}))}]}),exports.uiSortList=()=>({restrict:"A",transclude:!0,scope:{emit:"&onSort",groupElementSelector:"@",key:"@"},template:'\n      <ng-transclude></ng-transclude>\n      <span class="sort-component-wrapper" style="display:inline-flex;\n        flex-direction:column;\n        line-height: normal;\n        vertical-align: middle;\n        font-size: 10px;"\n      >\n        <i class="font font-up" ng-click="sortBy($event, \'asc\')" style="cursor: pointer;"></i>\n        <i class="font font-down" ng-click="sortBy($event, \'desc\')" style="margin-top: -3px; cursor: pointer;"></i>\n      </span>\n      ',link:e=>{e.sortBy=(t,n)=>{var r=t.currentTarget||t.target,i=$(r).hasClass("active");(t=>{if($(".font",$(t).parent()).removeClass("active").css("color",""),e.groupElementSelector){var n=$(e.groupElementSelector);$(".font",n).css("color","").removeClass("active")}})(r),function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]?($(e).css("color",""),$(e).removeClass("active")):($(e).css("color","#333333"),$(e).addClass("active"))}(r,i);var o={key:e.key,order:n};e.emit({params:i?null:o})}}}),exports.wheelStopPropagation=()=>({restrict:"A",link:function(e,t){t.on("wheel",(function(e){var n=t.scrollTop(),r=t[0].scrollHeight,i=t[0].offsetHeight,o=e.originalEvent.deltaY;(0===n&&o<0||n+i>=r&&o>0)&&(e.stopPropagation(),e.preventDefault())}))}}),exports.spinner=()=>({restrict:"A",scope:{loading:"=",size:"=",spinnerStyle:"=",fullscreen:"=",maskBackgroundColor:"@"},link:(e,t)=>{var n=document.createElement("style");n.id="__spinner",n.textContent="\n    @keyframes __spin {\n      0% { transform: rotate(0deg); }\n      100% { transform: rotate(360deg); }\n    }\n    .__spinner {\n      width: 100%;\n      height: 100%;\n      border: 3px solid rgb(from var(--primary-brand-color) r g b / 0.1);\n      border-top-color: var(--primary-brand-color);\n      border-radius: 50%;\n      animation: __spin 1s linear infinite;\n    }\n\n    .__spinner-container {\n        position: fixed;\n        top: 0;\n        left: 0;\n        right: 0;\n        bottom: 0;\n        z-index: 100000;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n    }\n  ";var r=$('<div\n            ng-show="loading"\n            style="width: '.concat(e.size,"px; height: ").concat(e.size,'px; display: inline-block; vertical-align: text-top;">\n          <div class="__spinner"></div>\n          </div>'));e.spinnerStyle&&r.css(e.spinnerStyle);var i=r;if(e.fullscreen){var o=$("<div class='__spinner-container'>");o.append(r),e.maskBackgroundColor&&o.css("backgroundColor",e.maskBackgroundColor),i=o}document.getElementById("__spinner")||document.head.appendChild(n),e.$watch("loading",(e=>{e?(t.after(i),t.hide()):(i.remove(),t.show())}))}})},859065:function(e,t,n){var r=n(383228),i=n(261139);n(788674),n(324603),n(339714),n(115306),n(323123);var o=n(887757);function a(e,t,n,r,i,o,a){try{var l=e[o](a),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(r,i)}n(535666);var l=n(117403).default,s="fill_in_blank",d="cloze",c=(e,t,n)=>{r(e,t).each(function(){var e,t=(e=o.mark((function e(t,i){var a;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("async function"!=typeof n){e.next=6;break}return e.next=3,n(t);case 3:e.t0=e.sent,e.next=7;break;case 6:e.t0="function"==typeof n?n(t):n;case 7:(a=e.t0)&&r(i).replaceWith(r(a));case 9:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function l(e){a(o,r,i,l,s,"next",e)}function s(e){a(o,r,i,l,s,"throw",e)}l(void 0)}))});return function(e,n){return t.apply(this,arguments)}}())};e.exports={allowTypedToAnswerQuestion:()=>{var e=window.location.pathname,t=(e,t)=>t.some((t=>t instanceof RegExp?t.test(e):t===e));return t(window.location.hash.replace(/^#\//,"").split("?").shift(),["preview","take"])||t(e,[/\/subject-lib\/\d+\/preview/,/\/course\/\d+\/correction-books/])},generateHandle:(e,t)=>{switch(t){case s:return;case d:return()=>(e=>{c(".__blank__",e,(t=>{var n,o=i.element(e).scope(),a=o.subject;e.addClass("___answer-cloze-subject");var s=null!==(n=a.sub_subjects[t])&&void 0!==n?n:[],d='<select\n        class="___select-answer"\n        id="'.concat(s.id,"_").concat(t,'"\n        multi-select\n        no-filter="true"\n        disableSearch="true"\n        ng-change="onChangeSubmission(subject.sub_subjects[').concat(t,'])"\n        ng-model="subject.sub_subjects[').concat(t,'].answeredOption"\n      >\n        <option value="" disabled selected hidden>').concat(l.t("courseListFilter.choose"),"</option>\n      ").concat(s.options.map((e=>'<option value="'.concat(e.id,'">').concat(e.content,"</option>"))).join(" "),"\n      </select>"),c=r(d);return o.$watch((()=>o.subject.sub_subjects[t].answeredOption),(e=>{e?r("+ button",c).removeClass("gray"):r("+ button",c).addClass("gray")})),c}))})(e)}}}},201351:function(e,t,n){var r=n(370538).default;n(323123),e.exports={preUpload:e=>r.http.post("/api/uploads",e),uploadBlob(e,t,n,r){var i=new FormData,o=t.type.split("/")[1];return i.append("file",t,"file.".concat(o)),"QINIU"===e.storage_type?this.upload2Qiniu(e,i,n,r):this.upload2Local(e,i,n,r)},uploadResource(e,t,n,r,i){var o=new FormData;return o.append("file",t),"QINIU"===e.storage_type?this.upload2Qiniu(e,o,n,r,i):this.upload2Local(e,o,n,r,i)},updateToken:e=>r.http.get("/api/uptoken?id=".concat(e.id)),upload2Qiniu(e,t,n,i,o){return this.updateToken(e).then((function(a){var l="UpToken ".concat(a.body.uptoken),s="".concat(e.upload_url,"/mkblk/").concat(t.get("file").size),d="".concat(e.upload_url,"/mkfile/").concat(t.get("file").size),c={Authorization:l,"Content-Type":"application/octet-stream"},u={Authorization:l,"Content-Type":"text/plain;charset=UTF-8"};return r.http.post(s,t.get("file"),{headers:c}).then((e=>r.http.post(d,e.data.ctx,{headers:u,progress:n}).then(i,o)),o)}),(()=>o()))},upload2Local(e,t,n,i,o){if("S3"===e.storage_type&&"WRPC"===e.transcoder){var a=t.get("file"),l={headers:{"Content-Type":a.type},progress:n};return r.http.put(e.upload_url,a,l).then(i,o)}return r.http.put(e.upload_url,t,{progress:n}).then(i,o)},uploadCallback:e=>r.http.post("/internal-api/upload/callback/".concat(e),{file_key:e}),previewUploadsInfo:(e,t,n)=>r.http.get("/api/uploads/".concat(e,"?preview=true")).then(t,n),getDownloadUrlForAi:(e,t,n)=>r.http.get("/api/uploads/".concat(e,"/download-url-for-ai")).then(t,n),createParseWord:(e,t,n,i,o,a,l)=>r.http.post("/api/data-import/from-word",{upload_id:e,html:i,belong:t,belong_id:n,template:o}).then(a,l)}},606565:function(e){e.exports={isUploadCallback:e=>"S3"===e.storage_type&&"WRPC"===e.transcoder}},917086:function(e,t){"use strict";t.Z={i:{page:{item:"項",items:"項",page:"項/頁"}}}},246955:function(e,t,n){var r,i,o,a=n(383228);!function(n){var l,s,d,c,u,p,f,m,g,h,v,b,y;function w(){return window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver}function _(e,t,n){e.addEventListener(t,n,!1)}function k(e,t,n){e.removeEventListener(t,n,!1)}function $(e){return h[e]?h[e].log:s}function x(e,t){C("log",e,t,$(e))}function S(e,t){C("info",e,t,$(e))}function T(e,t){C("warn",e,t,!0)}function C(e,t,n,r){!0===r&&"object"==typeof window.console&&console[e](function(e){return u+"["+(t="Host page: "+(e=e),(t=window.top!==window.self?window.parentIFrame&&window.parentIFrame.getId?window.parentIFrame.getId()+": "+e:"Nested host page: "+e:t)+"]");var t}(t),n)}function E(e){function t(){n("Height"),n("Width"),L((function(){N(w),P($),m("onResized",w)}),w,"init")}function n(e){var t=Number(h[$]["max"+e]),n=Number(h[$]["min"+e]),r=(e=e.toLowerCase(),Number(w[e]));x($,"Checking "+e+" is in range "+n+"-"+t),r<n&&(r=n,x($,"Set "+e+" to min value")),t<r&&(r=t,x($,"Set "+e+" to max value")),w[e]=""+r}function r(e){return b.slice(b.indexOf(":")+c+e)}function i(e,t){var n,r;n=function(){var n,r;j("Send Page Info","pageInfo:"+(n=document.body.getBoundingClientRect(),r=w.iframe.getBoundingClientRect(),JSON.stringify({iframeHeight:r.height,iframeWidth:r.width,clientHeight:Math.max(document.documentElement.clientHeight,window.innerHeight||0),clientWidth:Math.max(document.documentElement.clientWidth,window.innerWidth||0),offsetTop:parseInt(r.top-n.top,10),offsetLeft:parseInt(r.left-n.left,10),scrollTop:window.pageYOffset,scrollLeft:window.pageXOffset,documentHeight:document.documentElement.clientHeight,documentWidth:document.documentElement.clientWidth,windowHeight:window.innerHeight,windowWidth:window.innerWidth})),e,t)},y[r=t]||(y[r]=setTimeout((function(){y[r]=null,n()}),32))}function o(e){return e=e.getBoundingClientRect(),F($),{x:Math.floor(Number(e.left)+Number(f.x)),y:Math.floor(Number(e.top)+Number(f.y))}}function a(e){var t=e?o(w.iframe):{x:0,y:0},n={x:Number(w.width)+t.x,y:Number(w.height)+t.y};x($,"Reposition requested from iFrame (offset x:"+t.x+" y:"+t.y+")"),window.top===window.self?(f=n,l(),x($,"--")):window.parentIFrame?window.parentIFrame["scrollTo"+(e?"Offset":"")](n.x,n.y):T($,"Unable to scroll to requested position, window.parentIFrame not found")}function l(){!1===m("onScroll",f)?V():P($)}function s(e){e=e.split("#")[1]||"";var t=decodeURIComponent(e);(t=document.getElementById(t)||document.getElementsByName(t)[0])?(t=o(t),x($,"Moving to in page link (#"+e+") at x: "+t.x+" y: "+t.y),f={x:t.x,y:t.y},l(),x($,"--")):window.top===window.self?x($,"In page link #"+e+" not found"):window.parentIFrame?window.parentIFrame.moveToAnchor(e):x($,"In page link #"+e+" not found and window.parentIFrame not found")}function d(e){var t,n;n=0===Number(w.width)&&0===Number(w.height)?{x:(t=r(9).split(":"))[1],y:t[0]}:{x:w.width,y:w.height},m(e,{iframe:w.iframe,screenX:Number(n.x),screenY:Number(n.y),type:w.type})}function m(e,t){return A($,e,t)}var g,v,b=e.data,w={},$=null;if("[iFrameResizerChild]Ready"===b)for(var C in h)j("iFrame requested init",O(C),h[C].iframe,C);else u===(""+b).slice(0,p)&&b.slice(p).split(":")[0]in h?(w=function(){var e=b.slice(p).split(":"),t=e[1]?parseInt(e[1],10):0,n=h[e[0]]&&h[e[0]].iframe,r=getComputedStyle(n);return{iframe:n,id:e[0],height:t+function(e){return"border-box"!==e.boxSizing?0:(e.paddingTop?parseInt(e.paddingTop,10):0)+(e=e.paddingBottom?parseInt(e.paddingBottom,10):0)}(r)+function(e){return"border-box"!==e.boxSizing?0:(e.borderTopWidth?parseInt(e.borderTopWidth,10):0)+(e=e.borderBottomWidth?parseInt(e.borderBottomWidth,10):0)}(r),width:e[2],type:e[3]}}(),$=w.id,h[$]&&(h[$].loaded=!0),(v=w.type in{true:1,false:1,undefined:1})&&x($,"Ignoring init message from meta parent page"),!v&&(v=!0,h[g=$]||(v=!1,T(w.type+" No settings for "+g+". Message was: "+b)),v)&&(x($,"Received: "+b),g=!0,null===w.iframe&&(T($,"IFrame ("+w.id+") not found"),g=!1),g&&function(){var t=e.origin,n=h[$]&&h[$].checkOrigin;if(n&&""+t!="null"&&!function(){if(n.constructor!==Array)return e=h[$]&&h[$].remoteHost,x($,"Checking connection is from: "+e),t===e;var e,r=0,i=!1;for(x($,"Checking connection is from allowed list of origins: "+n);r<n.length;r++)if(n[r]===t){i=!0;break}return i}())throw new Error("Unexpected message received from: "+t+" for "+w.iframe.id+". Message was: "+e.data+". This error can be disabled by setting the checkOrigin: false option or by providing of array of trusted domains.");return 1}()&&function(){switch(h[$]&&h[$].firstRun&&h[$]&&(h[$].firstRun=!1),w.type){case"close":I(w.iframe);break;case"message":l=r(6),x($,"onMessage passed: {iframe: "+w.iframe.id+", message: "+l+"}"),m("onMessage",{iframe:w.iframe,message:JSON.parse(l)}),x($,"--");break;case"mouseenter":d("onMouseEnter");break;case"mouseleave":d("onMouseLeave");break;case"autoResize":h[$].autoResize=JSON.parse(r(9));break;case"scrollTo":a(!1);break;case"scrollToOffset":a(!0);break;case"pageInfo":i(h[$]&&h[$].iframe,$),o=$,e("Add ",_),h[o]&&(h[o].stopPageInfo=n);break;case"pageInfoStop":h[$]&&h[$].stopPageInfo&&(h[$].stopPageInfo(),delete h[$].stopPageInfo);break;case"inPageLink":s(r(9));break;case"reset":q(w);break;case"init":t(),m("onInit",w.iframe);break;default:0===Number(w.width)&&0===Number(w.height)?T("Unsupported message received ("+w.type+"), this is likely due to the iframe containing a later version of iframe-resizer than the parent page"):t()}function e(e,t){function r(){h[o]?i(h[o].iframe,o):n()}["scroll","resize"].forEach((function(n){x(o,e+n+" listener for sendPageInfo"),t(window,n,r)}))}function n(){e("Remove ",k)}var o,l}())):S($,"Ignored: "+b)}function A(e,t,n){var r=null,i=null;if(h[e]){if("function"!=typeof(r=h[e][t]))throw new TypeError(t+" on iFrame["+e+"] is not a function");i=r(n)}return i}function M(e){e=e.id,delete h[e]}function I(e){var t=e.id;if(!1===A(t,"onClose",t))x(t,"Close iframe cancelled by onClose event");else{x(t,"Removing iFrame: "+t);try{e.parentNode&&e.parentNode.removeChild(e)}catch(e){T(e)}A(t,"onClosed",t),x(t,"--"),M(e)}}function F(e){null===f&&x(e,"Get page position: "+(f={x:window.pageXOffset===n?document.documentElement.scrollLeft:window.pageXOffset,y:window.pageYOffset===n?document.documentElement.scrollTop:window.pageYOffset}).x+","+f.y)}function P(e){null!==f&&(window.scrollTo(f.x,f.y),x(e,"Set page position: "+f.x+","+f.y),V())}function V(){f=null}function q(e){x(e.id,"Size reset requested by "+("init"===e.type?"host page":"iFrame")),F(e.id),L((function(){N(e),j("reset","reset",e.iframe,e.id)}),e,"reset")}function N(e){function t(t){var r;r=t,e.id?(e.iframe.style[r]=e[r]+"px",x(e.id,"IFrame ("+n+") "+r+" set to "+e[r]+"px")):x("undefined","messageData id not set"),function(t){var r;function i(){Object.keys(h).forEach((function(e){function t(e){return"0px"===(h[n]&&h[n].iframe.style[e])}var n;h[n=e]&&null!==h[n].iframe.offsetParent&&(t("height")||t("width"))&&j("Visibility change","resize",h[n].iframe,n)}))}!d&&"0"===e[t]&&(d=!0,x(n,"Hidden iFrame detected, creating visibility listener"),t=w())&&(r=document.querySelector("body"),new t((function(e){x("window","Mutation observed: "+e[0].target+" "+e[0].type),R(i,16)})).observe(r,{attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0}))}(t)}var n=e.iframe.id;h[n]&&(h[n].sizeHeight&&t("height"),h[n].sizeWidth)&&t("width")}function L(e,t,n){n!==t.type&&m&&!window.jasmine?(x(t.id,"Requesting animation frame"),m(e)):e()}function j(e,t,n,r,i){var o=!1;r=r||n.id,h[r]&&(function(){var i;n&&"contentWindow"in n&&null!==n.contentWindow?(i=h[r]&&h[r].targetOrigin,x(r,"["+e+"] Sending msg to iframe["+r+"] ("+t+") targetOrigin: "+i),n.contentWindow.postMessage(u+t,i)):T(r,"["+e+"] IFrame("+r+") not found")}(),i&&h[r]&&h[r].warningTimeout&&(h[r].msgTimeout=setTimeout((function(){!h[r]||h[r].loaded||o||(o=!0,T(r,"IFrame has not responded within "+h[r].warningTimeout/1e3+" seconds. Check iFrameResizer.contentWindow.js has been loaded in iFrame. This message can be ignored if everything is working, or you can set the warningTimeout option to a higher value or zero to suppress this warning."))}),h[r].warningTimeout)))}function O(e){return e+":"+h[e].bodyMarginV1+":"+h[e].sizeWidth+":"+h[e].log+":"+h[e].interval+":"+h[e].enablePublicMethods+":"+h[e].autoResize+":"+h[e].bodyMargin+":"+h[e].heightCalculationMethod+":"+h[e].bodyBackground+":"+h[e].bodyPadding+":"+h[e].tolerance+":"+h[e].inPageLinks+":"+h[e].resizeFrom+":"+h[e].widthCalculationMethod+":"+h[e].mouseEvents}function H(e,t){function r(e){var t=e.split("Callback");2===t.length&&(this[t="on"+t[0].charAt(0).toUpperCase()+t[0].slice(1)]=this[e],delete this[e],T(i,"Deprecated: '"+e+"' has been renamed '"+t+"'. The old method will be removed in the next major version."))}var i=function(n){if("string"!=typeof n)throw new TypeError("Invaild id for iFrame. Expected String");var r;return""===n&&(e.id=(r=t&&t.id||b.id+l++,null!==document.getElementById(r)&&(r+=l++),n=r),s=(t||{}).log,x(n,"Added missing iframe ID: "+n+" ("+e.src+")")),n}(e.id);if(i in h&&"iFrameResizer"in e)T(i,"Ignored iFrame, already setup.");else{switch(function(t){if(t=t||{},h[i]=Object.create(null),h[i].iframe=e,h[i].firstRun=!0,h[i].remoteHost=e.src&&e.src.split("/").slice(0,3).join("/"),"object"!=typeof t)throw new TypeError("Options is not an object");Object.keys(t).forEach(r,t);var n,o=t;for(n in b)Object.prototype.hasOwnProperty.call(b,n)&&(h[i][n]=(Object.prototype.hasOwnProperty.call(o,n)?o:b)[n]);h[i]&&(h[i].targetOrigin=!0!==h[i].checkOrigin||""===(t=h[i].remoteHost)||null!==t.match(/^(about:blank|javascript:|file:\/\/)/)?"*":t)}(t),x(i,"IFrame scrolling "+(h[i]&&h[i].scrolling?"enabled":"disabled")+" for "+i),e.style.overflow=!1===(h[i]&&h[i].scrolling)?"hidden":"auto",h[i]&&h[i].scrolling){case"omit":break;case!0:e.scrolling="yes";break;case!1:e.scrolling="no";break;default:e.scrolling=h[i]?h[i].scrolling:"no"}a("Height"),a("Width"),o("maxHeight"),o("minHeight"),o("maxWidth"),o("minWidth"),"number"!=typeof(h[i]&&h[i].bodyMargin)&&"0"!==(h[i]&&h[i].bodyMargin)||(h[i].bodyMarginV1=h[i].bodyMargin,h[i].bodyMargin=h[i].bodyMargin+"px"),function(t){var r=w();r&&(r=r,e.parentNode)&&new r((function(t){t.forEach((function(t){Array.prototype.slice.call(t.removedNodes).forEach((function(t){t===e&&I(e)}))}))})).observe(e.parentNode,{childList:!0}),_(e,"load",(function(){var r,o;j("iFrame.onload",t,e,n,!0),r=h[i]&&h[i].firstRun,o=h[i]&&h[i].heightCalculationMethod in g,!r&&o&&q({iframe:e,height:0,width:0,type:"init"})})),j("init",t,e,n,!0)}(O(i)),h[i]&&(h[i].iframe.iFrameResizer={close:I.bind(null,h[i].iframe),removeListeners:M.bind(null,h[i].iframe),resize:j.bind(null,"Window resize","resize",h[i].iframe),moveToAnchor:function(e){j("Move to anchor","moveToAnchor:"+e,h[i].iframe,i)},sendMessage:function(e){j("Send Message","message:"+(e=JSON.stringify(e)),h[i].iframe,i)}})}function o(t){var n=h[i][t];1/0!==n&&0!==n&&(e.style[t]="number"==typeof n?n+"px":n,x(i,"Set "+t+" = "+e.style[t]))}function a(e){if(h[i]["min"+e]>h[i]["max"+e])throw new Error("Value for min"+e+" can not be greater than max"+e)}}function R(e,t){null===v&&(v=setTimeout((function(){v=null,e()}),t))}function D(){"hidden"!==document.visibilityState&&(x("document","Trigger event: Visibility change"),R((function(){z("Tab Visible","resize")}),16))}function z(e,t){Object.keys(h).forEach((function(n){var r;h[r=n]&&"parent"===h[r].resizeFrom&&h[r].autoResize&&!h[r].firstRun&&j(e,t,h[n].iframe,n)}))}function B(){_(window,"message",E),_(window,"resize",(function(){x("window","Trigger event: "+"resize"),R((function(){z("Window resize","resize")}),16)})),_(document,"visibilitychange",D),_(document,"-webkit-visibilitychange",D)}function W(){function e(e,n){if(n){if(!n.tagName)throw new TypeError("Object is not a valid DOM element");if("IFRAME"!==n.tagName.toUpperCase())throw new TypeError("Expected <IFRAME> tag, found <"+n.tagName+">");H(n,e),t.push(n)}}for(var t,r=["moz","webkit","o","ms"],i=0;i<r.length&&!m;i+=1)m=window[r[i]+"RequestAnimationFrame"];return m?m=m.bind(window):x("setup","RequestAnimationFrame not supported"),B(),function(r,i){var o;switch(t=[],(o=r)&&o.enablePublicMethods&&T("enablePublicMethods option has been removed, public methods are now always available in the iFrame"),typeof i){case"undefined":case"string":Array.prototype.forEach.call(document.querySelectorAll(i||"iframe"),e.bind(n,r));break;case"object":e(r,i);break;default:throw new TypeError("Unexpected data type ("+typeof i+")")}return t}}"undefined"!=typeof window&&(l=0,d=s=!1,c="message".length,p=(u="[iFrameSizer]").length,f=null,m=window.requestAnimationFrame,g=Object.freeze({max:1,scroll:1,bodyScroll:1,documentElementScroll:1}),h={},v=null,b=Object.freeze({autoResize:!0,bodyBackground:null,bodyMargin:null,bodyMarginV1:8,bodyPadding:null,checkOrigin:!0,inPageLinks:!1,enablePublicMethods:!0,heightCalculationMethod:"bodyOffset",id:"iFrameResizer",interval:32,log:!1,maxHeight:1/0,maxWidth:1/0,minHeight:0,minWidth:0,mouseEvents:!0,resizeFrom:"parent",scrolling:!1,sizeHeight:!0,sizeWidth:!1,warningTimeout:5e3,tolerance:0,widthCalculationMethod:"scroll",onClose:function(){return!0},onClosed:function(){},onInit:function(){},onMessage:function(){T("onMessage function not defined")},onMouseEnter:function(){},onMouseLeave:function(){},onResized:function(){},onScroll:function(){return!0}}),y={},a!==n&&function(e){e.fn?e.fn.iFrameResize||(e.fn.iFrameResize=function(e){return this.filter("iframe").each((function(t,n){H(n,e)})).end()}):S("","Unable to bind to jQuery, it is not fully loaded.")}(a),i=[],void 0!==(o="function"==typeof(r=W)?r.apply(t,i):r)&&(e.exports=o),window.iFrameResize=window.iFrameResize||W())}()}}]);