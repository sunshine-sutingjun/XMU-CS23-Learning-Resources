(self.webpackChunklms=self.webpackChunklms||[]).push([[31646],{821525:function(e,t,n){"use strict";function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function o(e,t,n){return t=u(t),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,d()?Reflect.construct(t,n||[],u(e).constructor):t.apply(e,n))}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,m(i.key),i)}}function a(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e,t,n){return(t=m(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var i=v(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}}).apply(null,arguments)}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t)}function d(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(d=function(){return!!e})()}function p(e,t){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,o,r,s,a=[],l=!0,c=!1;try{if(r=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=r.call(n)).done)&&(a.push(i.value),a.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw o}}return a}}(e,t)||b(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}function y(e,t,n,i){var o=c(u(1&i?e.prototype:e),t,n);return 2&i&&"function"==typeof o?function(e){return o.apply(n,e)}:o}function g(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||b(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}function _(e){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t){if(e){if("string"==typeof e)return i(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}function k(e,t,n){return"*"===e||(e.length>0?-1!==e.indexOf(t):!n)}function x(e,t,n){var i,o=e=e||{},r=t=t||{};if(n)for(i=0;i<n.length;i++)o[n[i]]=r[n[i]];else for(i in r)o[i]=r[i];return e}function C(e){return"[object Number]"===Object.prototype.toString.call(e)}function S(e){return"string"==typeof e}function w(e){return"boolean"==typeof e}function E(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function P(e){return"[object Function]"===Object.prototype.toString.call(e)}function A(e){if(S(e))return""+e;if(w(e))return!!e;if(r=e,"[object Date]"===Object.prototype.toString.call(r))return new Date(e.getTime());if(P(e))return e;if(Array.isArray(e)){for(var t=[],n=0;n<e.length;n++)t.push(A(e[n]));return t}if(E(e)){var i={};for(var o in e)i[o]=A(e[o]);return i}return e;var r}function D(e,t,n,i){var o,r,s={},a={};for(n=n||[],i=i||[],r=0;r<n.length;r++)s[n[r]]=!0;for(r=0;r<i.length;r++)a[i[r]]=!0;var l=A(e);for(r in t)if(null==l[r]||a[r])l[r]=t[r];else if(s[r])(o=[]).push.apply(o,Array.isArray(l[r])?l[r]:[l[r]]),o.push(t[r]),l[r]=o;else if(S(t[r])||w(t[r])||P(t[r])||C(t[r]))l[r]=t[r];else if(Array.isArray(t[r]))o=[],Array.isArray(l[r])&&o.push.apply(o,l[r]),o.push.apply(o,t[r]),l[r]=o;else if(E(t[r]))for(var c in E(l[r])||(l[r]={}),t[r])l[r][c]=t[r][c];return l}function M(e,t,n){for(var i=0;i<n.length;i++){var o=n[i][0][n[i][1]].apply(n[i][0],n[i][2]);if(o===t)return o}return e}function T(e,t,n,i){var o=function(e){if(null!=e){if(S(e))return function(e){var n=e.match(/(\${.*?})/g);if(null!=n)for(var i=0;i<n.length;i++){var o=t[n[i].substring(2,n[i].length-1)]||"";null!=o&&(e=e.replace(n[i],o))}if(null!=(n=e.match(/({{.*?}})/g)))for(var r=0;r<n.length;r++){var s=t[n[r].substring(2,n[r].length-2)]||"";null!=s&&(e=e.replace(n[r],s))}return e}(e);if(!P(e)||i||null!=n&&0!==(e.name||"").indexOf(n)){if(Array.isArray(e)){for(var r=[],s=0;s<e.length;s++)r.push(o(e[s]));return r}if(E(e)){var a={};for(var l in e)a[l]=o(e[l]);return a}return e}return e(t)}};return o(e)}function j(e,t){if(!e)return null;for(var n=0;n<e.length;n++)t(e[n])}function O(e,t){if(e)for(var n=0;n<e.length;n++)if(t(e[n]))return n;return-1}function I(e,t){var n=O(e,t);return-1===n?null:e[n]}function L(e,t){var n=null;return e.forEach((function(e){t(e)&&(n=e)})),n}function N(e,t){var n=O(e,t);return n>-1&&e.splice(n,1),-1!==n}function F(e){if(null!=Array.fromArray)return Array.from(e);var t=[];return Array.prototype.push.apply(t,e),t}function G(e,t){var n=e.indexOf(t);return n>-1&&e.splice(n,1),-1!==n}function R(e,t,n,i){var o=e[t];return null==o&&(o=[],e[t]=o),o[i?"unshift":"push"](n),o}function B(e,t,n){return-1===e.indexOf(t)&&(n?e.unshift(t):e.push(t),!0)}n.d(t,{B8j:function(){return Ut},Kn2:function(){return E},TVq:function(){return ut},WLU:function(){return Os},p5v:function(){return Cs},rCC:function(){return on},wS:function(){return Qo}});for(var H=[],U=0;U<256;U++)H[U]=(U<16?"0":"")+U.toString(16);function X(){var e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return H[255&e]+H[e>>8&255]+H[e>>16&255]+H[e>>24&255]+"-"+H[255&t]+H[t>>8&255]+"-"+H[t>>16&15|64]+H[t>>24&255]+"-"+H[63&n|128]+H[n>>8&255]+"-"+H[n>>16&255]+H[n>>24&255]+H[255&i]+H[i>>8&255]+H[i>>16&255]+H[i>>24&255]}function Y(e,t,n){var i=e.x-t.x,o=e.y-t.y,r=Math.cos(n/360*Math.PI*2),s=Math.sin(n/360*Math.PI*2);return{x:i*r-o*s+t.x,y:o*r+i*s+t.y,cr:r,sr:s}}function K(e){if(null==e)return null;for(var t=e.replace(/^\s\s*/,""),n=/\s/,i=t.length;n.test(t.charAt(--i)););return t.slice(0,i+1)}function V(e,t){for(var n=[],i=0;i<e.length;i++)n.push(t(e[i]));return n}function z(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if("undefined"!=typeof console)try{var i=arguments[arguments.length-1];console.log(i)}catch(e){}}function W(e){return e<0?-1:e>0?1:0}function $(e,t,n){return function(){var i=null;try{null!=t&&(i=t.apply(this,arguments))}catch(e){z("jsPlumb function failed : "+e)}if(null!=e&&(null==n||i!==n))try{i=e.apply(this,arguments)}catch(e){z("wrapped function failed : "+e)}return i}}function q(e,t,n){return e.has(t)||e.set(t,n()),e.get(t)}function Z(e,t){for(var n=e.__proto__;null!=n;){if(n instanceof t)return!0;n=n.__proto__}return!1}function J(e,t,n){for(var i=(n=n||e.parentNode).querySelectorAll(t),o=0;o<i.length;o++)if(i[o]===e)return!0;return!1}function Q(e,t){e.stopPropagation?e.stopPropagation():e.returnValue=!1,!t&&e.preventDefault&&e.preventDefault()}function ee(e,t,n,i){if(i&&J(e,t,n))return e;for(e=e.parentNode;null!=e&&e!==n;){if(J(e,t))return e;e=e.parentNode}}function te(e){return e.srcElement||e.target}function ne(e){return null!=e.className?void 0===e.className.baseVal?e.className:e.className.baseVal:""}function ie(e,t,n){var i=null==t?[]:Array.isArray(t)?t:t.split(/\s+/),o=null==n?[]:Array.isArray(n)?n:n.split(/\s+/),r=ne(e).split(/\s+/),s=function(e,t){for(var n=0;n<t.length;n++)if(e)-1===r.indexOf(t[n])&&r.push(t[n]);else{var i=r.indexOf(t[n]);-1!==i&&r.splice(i,1)}};s(!0,i),s(!1,o),function(e,t,n){t=K(t),void 0!==e.className.baseVal?e.className.baseVal=t:e.className=t;try{var i=e.classList;if(null!=i){for(;i.length>0;)i.remove(i.item(0));for(var o=0;o<n.length;o++)n[o]&&i.add(n[o])}}catch(e){z("WARN: cannot set class list",e)}}(e,r.join(" "),r)}function oe(e){return!S(e)&&!Array.isArray(e)&&null!=e.length&&null==e.documentElement&&null==e.nodeType}function re(e,t){var n=function(e,t){null!=e&&null!=t&&t.length>0&&(e.classList?j(K(t).split(/\s+/),(function(t){e.classList.add(t)})):ie(e,t))};oe(e)?j(e,(function(e){return n(e,t)})):n(e,t)}function se(e,t){var n=function(e,t){null!=e&&null!=t&&t.length>0&&(e.classList?K(t).split(/\s+/).forEach((function(t){e.classList.remove(t)})):ie(e,null,t))};oe(e)?j(e,(function(e){return n(e,t)})):n(e,t)}function ae(e,t,n,i){return le(null,e,t,n,i)}function le(e,t,n,i,o){var r,s=null==e?document.createElement(t):document.createElementNS(e,t);for(r in n=n||{})s.style[r]=n[r];for(r in i&&(s.className=i),o=o||{})s.setAttribute(r,""+o[r]);return s}function ce(e){var t=e.getBoundingClientRect(),n=document.body,i=document.documentElement,o=window.pageYOffset||i.scrollTop||n.scrollTop,r=window.pageXOffset||i.scrollLeft||n.scrollLeft,s=i.clientTop||n.clientTop||0,a=i.clientLeft||n.clientLeft||0,l=t.top+o-s,c=t.left+r-a;return{x:Math.round(c),y:Math.round(l)}}function ue(e,t){var n=t.getContainer().getBoundingClientRect(),i=e.getBoundingClientRect(),o=t.currentZoom;return{x:(i.left-n.left)/o,y:(i.top-n.top)/o}}function he(e,t){var n=e.getBoundingClientRect(),i=t.currentZoom;return{w:n.width/i,h:n.height/i}}var de=function(e){return e.SVG="SVG",e.HTML="HTML",e}({});function pe(e){return e instanceof SVGElement?de.SVG:de.HTML}function fe(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.map((function(e){return"."+e})).join(",")}function ve(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.map((function(e){return"["+e+"]"})).join(",")}var ye="source",ge="target",me="block",_e="none",be="absolute",ke="fixed",xe="data-jtk-group",Ce="data-jtk-managed",Se="data-jtk-not-draggable",we="tabindex",Ee="data-jtk-scope-",Pe="checkCondition",Ae="jtk-connector",De="jtk-endpoint",Me="jtk-floating-endpoint",Te="jtk-group-collapsed",je="jtk-group-expanded",Oe="jtk-overlay",Ie="connection",Le="internal.connection",Ne="connection:move",Fe="internal.endpoint:unregistered",Ge="internal.connection:detached",Re="element:manage",Be="group:member:added",He="maxConnections",Ue="element:unmanage",Xe="zoom",Ye="isDetachAllowed",Ke="beforeDrop",Ve="beforeDetach",ze=ve(Ce),We={"stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},$e="stroke-dasharray",qe="svg",Ze="path",Je={svg:"http://www.w3.org/2000/svg"};function Qe(e,t){for(var n in t)e.setAttribute(n,""+t[n])}function et(e,t){return(t=t||{}).version="1.1",t.xmlns=Je.svg,le(Je.svg,e,null,null,t)}function tt(e){return"position:absolute;left:"+e[0]+"px;top:"+e[1]+"px"}function nt(e,t,n){if(t.setAttribute("fill",n.fill?n.fill:_e),t.setAttribute("stroke",n.stroke?n.stroke:_e),n.strokeWidth&&t.setAttribute("stroke-width",n.strokeWidth),n.dashstyle&&n.strokeWidth&&!n[$e]){var i=-1===n.dashstyle.indexOf(",")?" ":",",o=n.dashstyle.split(i),r="";j(o,(function(e){r+=Math.floor(e*n.strokeWidth)+i})),t.setAttribute($e,r)}else n[$e]&&t.setAttribute($e,n[$e]);for(var s in We)n[s]&&t.setAttribute(We[s],n[s])}function it(e,t,n){e.childNodes.length>n?e.insertBefore(t,e.childNodes[n]):e.appendChild(t)}function ot(e,t,n){var i=[e,t];return n&&i.push(n),i.join(":")}var rt="data-jtk-container",st="data-jtk-enabled",at="data-jtk-scope",lt="endpoint",ct="element",ut="connection",ht="click",dt="contextmenu",pt="dblclick",ft="dbltap",vt="mousedown",yt="mouseenter",gt="mouseexit",mt="mousemove",_t="mouseup",bt="mouseout",kt="mouseover",xt="tap",Ct="revert",St="connection:drag",wt=ot(ct,ht),Et=ot(ct,pt),Pt=ot(ct,ft),At=ot(ct,bt),Dt=ot(ct,kt),Mt=ot(ct,mt),Tt=ot(ct,_t),jt=ot(ct,vt),Ot=ot(ct,dt),It=ot(ct,xt),Lt=ot(lt,ht),Nt=ot(lt,pt),Ft=(ot(lt,ft),ot(lt,bt)),Gt=ot(lt,kt),Rt=ot(lt,_t),Bt=ot(lt,vt),Ht=(ot(lt,xt),ot(ut,ht)),Ut=ot(ut,pt),Xt=ot(ut,ft),Yt=ot(ut,bt),Kt=ot(ut,kt),Vt=ot(ut,_t),zt=ot(ut,vt),Wt=ot(ut,dt),$t=ot(ut,xt),qt="position",Zt=fe(Ae),Jt=fe(De),Qt=ve(xe),en=ve("data-jtk-group-content"),tn=fe(Oe),nn=function(e){return e.Circle="Circle",e.Ellipse="Ellipse",e.Triangle="Triangle",e.Diamond="Diamond",e.Rectangle="Rectangle",e.Square="Square",e}({}),on=function(e){return e.Assign="Assign",e.AutoDefault="AutoDefault",e.Bottom="Bottom",e.BottomLeft="BottomLeft",e.BottomRight="BottomRight",e.Center="Center",e.Continuous="Continuous",e.ContinuousBottom="ContinuousBottom",e.ContinuousLeft="ContinuousLeft",e.ContinuousRight="ContinuousRight",e.ContinuousTop="ContinuousTop",e.ContinuousLeftRight="ContinuousLeftRight",e.ContinuousTopBottom="ContinuousTopBottom",e.Left="Left",e.Perimeter="Perimeter",e.Right="Right",e.Top="Top",e.TopLeft="TopLeft",e.TopRight="TopRight",e}({});var rn=a((function e(t){r(this,e),this.params=t,l(this,"x1",void 0),l(this,"x2",void 0),l(this,"y1",void 0),l(this,"y2",void 0),l(this,"extents",{xmin:1/0,xmax:-1/0,ymin:1/0,ymax:-1/0}),l(this,"type",void 0),this.x1=t.x1,this.y1=t.y1,this.x2=t.x2,this.y2=t.y2}),[{key:"findClosestPointOnPath",value:function(e,t){return{d:1/0,x:null,y:null,l:null,x1:null,y1:null,x2:null,y2:null}}},{key:"lineIntersection",value:function(e,t,n,i){return[]}},{key:"boxIntersection",value:function(e,t,n,i){var o=[];return o.push.apply(o,this.lineIntersection(e,t,e+n,t)),o.push.apply(o,this.lineIntersection(e+n,t,e+n,t+i)),o.push.apply(o,this.lineIntersection(e+n,t+i,e,t+i)),o.push.apply(o,this.lineIntersection(e,t+i,e,t)),o}},{key:"boundingBoxIntersection",value:function(e){return this.boxIntersection(e.x,e.y,e.w,e.h)}}]),sn="undefined",an="default",ln="true",cn="false",un="*";function hn(e,t,n,i,o,r,s){return function(){var e=[];return e.push.apply(e,arguments),e.item=function(e){return this[e]},e}(function(e,t,n,i,o,r,s){return new Touch({target:e,identifier:X(),pageX:t,pageY:n,screenX:i,screenY:o,clientX:r||i,clientY:s||o})}(e,t,n,i,o,r,s))}function dn(e,t,n){for(var i=(n=n||e.parentNode).querySelectorAll(t),o=0;o<i.length;o++)if(i[o]===e)return!0;return!1}function pn(e){return e.srcElement||e.target}function fn(e,t,n,i){if(i){var o=e.composedPath?e.composedPath():e.path;if(void 0!==o&&o.indexOf)return{path:o,end:o.indexOf(n)};var r={path:[],end:-1},s=function(e){r.path.push(e),e===n?r.end=r.path.length-1:null!=e.parentNode&&s(e.parentNode)};return s(t),r}return{path:[t],end:1}}var vn=1,yn=!1,gn=!1;function mn(){return yn||"ontouchstart"in document.documentElement||null!=navigator.maxTouchPoints&&navigator.maxTouchPoints>0}function _n(){return gn||"onmousedown"in document.documentElement}var bn=l(l(l({},vt,"touchstart"),_t,"touchend"),mt,"touchmove");function kn(e,t){if(null==e)return{x:0,y:0};var n=Sn(wn(e),0);return{x:n[t+"X"],y:n[t+"Y"]}}function xn(e){return kn(e,"page")}function Cn(e){return kn(e,"client")}function Sn(e,t){return e.item?e.item(t):e[t]}function wn(e){return e.touches&&e.touches.length>0?e.touches:e.changedTouches&&e.changedTouches.length>0?e.changedTouches:e.targetTouches&&e.targetTouches.length>0?e.targetTouches:[e]}function En(e,t,n,i,o){if(Dn(e,t,n),i.__tauid=n.__tauid,e.addEventListener)e.addEventListener(t,n,!1,o);else if(e.attachEvent){var r=t+n.__tauid;e["e"+r]=n,e[r]=function(){e["e"+r]&&e["e"+r](window.event)},e.attachEvent("on"+t,e[r])}}function Pn(e,t,n){var i=this;null!=n&&An(e,(function(o){if(function(e,t,n){if(e.__ta&&e.__ta[t]&&delete e.__ta[t][n.__tauid],n.__taExtra){for(var i=0;i<n.__taExtra.length;i++)Pn(e,n.__taExtra[i][0],n.__taExtra[i][1]);n.__taExtra.length=0}n.__taUnstore&&n.__taUnstore()}(o,t,n),null!=n.__tauid)if(o.removeEventListener)o.removeEventListener(t,n,!1),mn()&&bn[t]&&o.removeEventListener(bn[t],n,!1);else if(i.detachEvent){var r=t+n.__tauid;o[r]&&o.detachEvent("on"+t,o[r]),o[r]=null,o["e"+r]=null}n.__taTouchProxy&&Pn(e,n.__taTouchProxy[1],n.__taTouchProxy[0])}))}function An(e,t){if(null!=e)for(var n="string"==typeof e?document.querySelectorAll(e):null!=e.length?e:[e],i=0;i<n.length;i++)t(n[i])}function Dn(e,t,n){var i=vn++;return e.__ta=e.__ta||{},e.__ta[t]=e.__ta[t]||{},e.__ta[t][i]=n,n.__tauid=i,i}var Mn=/:not\(([^)]+)\)/;function Tn(e,t,n,i){if(null==e)return n;var o=e.split(","),r=[],s=[];j(o,(function(e){var t=e.match(Mn);null!=t?s.push(t[1]):r.push(e)})),s.length>0&&0===r.length&&r.push(un);var a=function(i){a.__tauid=n.__tauid;var o=pn(i),l=!1,c=o,u=fn(i,o,t,null!=e);if(-1!=u.end)for(var h=0;!l&&h<u.end;h++){c=u.path[h];for(var d=0;d<s.length;d++)if(dn(c,s[d],t))return;for(var p=0;!l&&p<r.length;p++)if(dn(c,r[p],t)){n.apply(c,[i,c]),l=!0;break}}};return function(e,t,n){e.__taExtra=e.__taExtra||[],e.__taExtra.push([t,n])}(n,i,a),a}var jn=function(e,t,n,i,o){if(mn()&&bn[t]){var r=Tn(i,e,n,bn[t]);En(e,bn[t],r,n,o)}"focus"===t&&null==e.getAttribute(we)&&e.setAttribute(we,"1"),En(e,t,Tn(i,e,n,t),n,o)},On=l(l(l({},xt,{touches:1,taps:1}),ft,{touches:1,taps:2}),dt,{touches:2,taps:1});function In(e,t,n,i){for(var o in n.__tamee[e])n.__tamee[e].hasOwnProperty(o)&&n.__tamee[e][o].apply(i,[t])}var Ln=a((function e(){r(this,e)}),null,[{key:"generate",value:function(e,t){return function(n,i,o,r){if(i==dt&&_n())jn(n,i,o,r);else{if(null==n.__taTapHandler){var s=n.__taTapHandler={tap:[],dbltap:[],down:!1,taps:0,downSelectors:[]},a=function(i){for(var o=pn(i),a=fn(i,o,n,null!=r),l=!1,h=0;h<a.end;h++){if(l)return;o=a.path[h];for(var d=0;d<s.downSelectors.length;d++)if(null==s.downSelectors[d]||dn(o,s.downSelectors[d],n)){s.down=!0,setTimeout(c,e),setTimeout(u,t),l=!0;break}}},l=function(e){if(s.down){var t,i,o=pn(e);s.taps++;var r=function(e){return wn(e).length}(e);for(var a in On)if(On.hasOwnProperty(a)){var l=On[a];if(l.touches===r&&(1===l.taps||l.taps===s.taps))for(var c=0;c<s[a].length;c++){i=fn(e,o,n,null!=s[a][c][1]);for(var u=0;u<i.end;u++)if(t=i.path[u],null==s[a][c][1]||dn(t,s[a][c][1],n)){s[a][c][0].apply(t,[e,t]);break}}}}},c=function(){s.down=!1},u=function(){s.taps=0};n.__taTapHandler.downHandler=a,n.__taTapHandler.upHandler=l,jn(n,vt,a),jn(n,_t,l)}n.__taTapHandler.downSelectors.push(r),n.__taTapHandler[i].push([o,r]),o.__taUnstore=function(){null!=n.__taTapHandler&&(N(n.__taTapHandler.downSelectors,(function(e){return e===r})),function(e,t){var n,i=0;for(i=0,n=e.length;i<n&&e[i][0]!==t;i++);i<e.length&&e.splice(i,1)}(n.__taTapHandler[i],o),0===n.__taTapHandler.downSelectors.length&&(Pn(n,vt,n.__taTapHandler.downHandler),Pn(n,_t,n.__taTapHandler.upHandler),delete n.__taTapHandler))}}}}}]),Nn=a((function e(){r(this,e)}),null,[{key:"generate",value:function(){var e=[];return function(t,n,i,o){if(!t.__tamee){t.__tamee={over:!1,mouseenter:[],mouseexit:[]};var r=function(n){var i=pn(n);(null==o&&i==t&&!t.__tamee.over||dn(i,o,t)&&(null==i.__tamee||!i.__tamee.over))&&(In(yt,n,t,i),i.__tamee=i.__tamee||{},i.__tamee.over=!0,e.push(i))},s=function(n){for(var i=pn(n),o=0;o<e.length;o++)i!=e[o]||dn(n.relatedTarget||n.toElement,"*",i)||(i.__tamee.over=!1,e.splice(o,1),In(gt,n,t,i))};En(t,kt,Tn(o,t,r,kt),r),En(t,bt,Tn(o,t,s,bt),s)}i.__taUnstore=function(){delete t.__tamee[n][i.__tauid]},Dn(t,n,i),t.__tamee[n][i.__tauid]=i}}}]),Fn=a((function e(t){r(this,e),l(this,"clickThreshold",void 0),l(this,"dblClickThreshold",void 0),l(this,"tapHandler",void 0),l(this,"mouseEnterExitHandler",void 0),t=t||{},this.clickThreshold=t.clickThreshold||250,this.dblClickThreshold=t.dblClickThreshold||450,this.mouseEnterExitHandler=Nn.generate(),this.tapHandler=Ln.generate(this.clickThreshold,this.dblClickThreshold)}),[{key:"_doBind",value:function(e,t,n,i,o){if(null!=n){var r=e;t===xt||t===ft||t===dt?this.tapHandler(r,t,n,i,o):t===yt||t==gt?this.mouseEnterExitHandler(r,t,n,i,o):jn(r,t,n,i,o)}}},{key:"on",value:function(e,t,n,i,o){var r=null==i?null:n,s=null==i?n:i;return this._doBind(e,t,s,r,o),this}},{key:"off",value:function(e,t,n){return Pn(e,t,n),this}},{key:"trigger",value:function(e,t,n,i,o){var r=_n()&&("undefined"==typeof MouseEvent||null==n||n.constructor===MouseEvent),s=mn()&&!_n()&&bn[t]?bn[t]:t,a=!(mn()&&!_n()&&bn[t]),l=xn(n),c=kn(n,"screen"),u=Cn(n);return An(e,(function(e){var h;n=n||{screenX:c.x,screenY:c.y,clientX:u.x,clientY:u.y};var d,p={TouchEvent:function(t){var n=hn(e,l.x,l.y,c.x,c.y,u.x,u.y);(t.initTouchEvent||t.initEvent)(s,!0,!0,window,null,c.x,c.y,u.x,u.y,!1,!1,!1,!1,n,n,n,1,0)},MouseEvents:function(t){t.initMouseEvent(s,!0,!0,window,null==o?1:o,c.x,c.y,u.x,u.y,!1,!1,!1,!1,1,e)}},f=!a&&!r&&mn()&&bn[t]?"TouchEvent":"MouseEvents";h=document.createEvent(f),p[f](h),d=h,i&&(d.payload=i),e.dispatchEvent(h)})),this}}]);var Gn=[null,[1,-1],[1,1],[-1,1],[-1,-1]],Rn=[null,[-1,-1],[-1,1],[1,1],[1,-1]],Bn=2*Math.PI;function Hn(e,t){return t.x===e.x?t.y>e.y?1/0:-1/0:t.y===e.y?t.x>e.x?0:-0:(t.y-e.y)/(t.x-e.x)}function Un(e,t){return Math.sqrt(Math.pow(t.y-e.y,2)+Math.pow(t.x-e.x,2))}function Xn(e,t){return t.x>e.x||t.x==e.x?t.y>e.y?2:1:t.y>e.y?3:4}function Yn(e,t){var n=e.x,i=e.x+e.w,o=e.y,r=e.y+e.h,s=t.x,a=t.x+t.w,l=t.y,c=t.y+t.h;return n<=s&&s<=i&&o<=l&&l<=r||n<=a&&a<=i&&o<=l&&l<=r||n<=s&&s<=i&&o<=c&&c<=r||n<=a&&s<=i&&o<=c&&c<=r||s<=n&&n<=a&&l<=o&&o<=c||s<=i&&i<=a&&l<=o&&o<=c||s<=n&&n<=a&&l<=r&&r<=c||s<=i&&n<=a&&l<=r&&r<=c}function Kn(e,t,n){var i=Hn(e,t),o=Xn(e,t),r=n>0?Gn[o]:Rn[o],s=Math.atan(i),a=Math.abs(n*Math.sin(s))*r[1],l=Math.abs(n*Math.cos(s))*r[0];return{x:e.x+l,y:e.y+a}}function Vn(e,t,n){if(J(t,n,e))return t;for(var i=t.parentNode;null!=i&&i!==e;){if(J(i,n,e))return i;i=i.parentNode}}function zn(e,t,n){var i=t.parentNode,o=e.getSize(i),r=e.getSize(t),s=n.x,a=s+r.w,l=n.y,c=l+r.h;return a>0&&s<o.w&&c>0&&l<o.h}var Wn="start",$n="beforeStart",qn="drag",Zn="stop",Jn="katavorio-draggable",Qn=function(){return!0},ei=function(){return!1},ti="katavorio-delegated-draggable",ni="katavorio-drag-no-select",ii="katavorio-ghost-proxy",oi="katavorio-clone-drag",ri=function(e){return e.absolutePosition="absolutePosition",e.transform="transform",e.xyAttributes="xyAttributes",e}({}),si=new Map;si.set(ri.absolutePosition,(function(e,t){e.style.left="".concat(t.x,"px"),e.style.top="".concat(t.y,"px")})),si.set(ri.xyAttributes,(function(e,t){e.setAttribute("x","".concat(t.x)),e.setAttribute("y","".concat(t.y))}));var ai=new Map;ai.set(ri.absolutePosition,(function(e){return{x:e.offsetLeft,y:e.offsetTop}})),ai.set(ri.xyAttributes,(function(e){return{x:parseFloat(e.getAttribute("x")),y:parseFloat(e.getAttribute("y"))}}));var li=new Map;li.set(ri.absolutePosition,(function(e,t){e.style.width="".concat(t.w,"px"),e.style.height="".concat(t.h,"px")})),li.set(ri.xyAttributes,(function(e,t){e.setAttribute("width","".concat(t.w)),e.setAttribute("height","".concat(t.h))}));var ci=new Map;ci.set(ri.absolutePosition,(function(e){return{w:e.offsetWidth,h:e.offsetHeight}})),ci.set(ri.xyAttributes,(function(e){return{w:parseFloat(e.getAttribute("width")),h:parseFloat(e.getAttribute("height"))}}));var ui=[Zn,Wn,qn,"drop","over","out",$n],hi=function(){},di=function(e,t){if(null!=e){e=S(e)||null!=e.tagName||null==e.length?[e]:e;for(var n=0;n<e.length;n++)t.apply(e[n],[e[n]])}},pi=a((function e(t,n){r(this,e),this.el=t,this.manager=n,l(this,"_class",void 0),l(this,"uuid",X()),l(this,"enabled",!0),l(this,"scopes",[]),l(this,"eventManager",void 0),this.eventManager=n.eventManager}),[{key:"setEnabled",value:function(e){this.enabled=e}},{key:"isEnabled",value:function(){return this.enabled}},{key:"toggleEnabled",value:function(){this.enabled=!this.enabled}},{key:"addScope",value:function(e){var t={};for(var n in di(this.scopes,(function(e){t[e]=!0})),di(e?e.split(/\s+/):[],(function(e){t[e]=!0})),this.scopes.length=0,t)this.scopes.push(n)}},{key:"removeScope",value:function(e){var t={};for(var n in di(this.scopes,(function(e){t[e]=!0})),di(e?e.split(/\s+/):[],(function(e){delete t[e]})),this.scopes.length=0,t)this.scopes.push(n)}},{key:"toggleScope",value:function(e){var t={};for(var n in di(this.scopes,(function(e){t[e]=!0})),di(e?e.split(/\s+/):[],(function(e){t[e]?delete t[e]:t[e]=!0})),this.scopes.length=0,t)this.scopes.push(n)}}]);var fi=function(e){return e.notNegative="notNegative",e.parent="parent",e.parentEnclosed="parentEnclosed",e}({}),vi=function(e){function t(e,n,i){var s;(r(this,t),l(s=o(this,t,[e,i]),"_class",void 0),l(s,"rightButtonCanDrag",void 0),l(s,"consumeStartEvent",void 0),l(s,"clone",void 0),l(s,"scroll",void 0),l(s,"trackScroll",void 0),l(s,"trackScrollContainer",void 0),l(s,"_downAt",void 0),l(s,"_posAtDown",void 0),l(s,"_pagePosAtDown",void 0),l(s,"_pageDelta",{x:0,y:0}),l(s,"_moving",void 0),l(s,"_lastPosition",void 0),l(s,"_lastScrollValues",{x:0,y:0}),l(s,"_initialScroll",{x:0,y:0}),l(s,"_size",void 0),l(s,"_currentParentPosition",void 0),l(s,"_ghostParentPosition",void 0),l(s,"_dragEl",void 0),l(s,"_multipleDrop",void 0),l(s,"_ghostProxyOffsets",void 0),l(s,"_ghostDx",void 0),l(s,"_ghostDy",void 0),l(s,"_isConstrained",!1),l(s,"_ghostProxyParent",void 0),l(s,"_useGhostProxy",void 0),l(s,"_ghostProxyFunction",void 0),l(s,"_activeSelectorParams",void 0),l(s,"_availableSelectors",[]),l(s,"_canDrag",void 0),l(s,"_consumeFilteredEvents",void 0),l(s,"_parent",void 0),l(s,"_ignoreZoom",void 0),l(s,"_filters",{}),l(s,"_constrainRect",void 0),l(s,"_elementToDrag",void 0),l(s,"downListener",void 0),l(s,"moveListener",void 0),l(s,"upListener",void 0),l(s,"scrollTracker",void 0),l(s,"listeners",{start:[],drag:[],stop:[],over:[],out:[],beforeStart:[],revert:[]}),l(s,"_timer",null),s._class=s.manager.css.draggable,re(s.el,s._class),s.downListener=s._downListener.bind(s),s.upListener=s._upListener.bind(s),s.moveListener=s._moveListener.bind(s),s.rightButtonCanDrag=!0===n.rightButtonCanDrag,s.consumeStartEvent=!1!==n.consumeStartEvent,s._dragEl=s.el,s.clone=!0===n.clone,s.scroll=!0===n.scroll,s.trackScroll=!1!==n.trackScroll,s.trackScrollContainer=n.trackScrollContainer||document.documentElement,s._multipleDrop=!1!==n.multipleDrop,s._canDrag=n.canDrag||Qn,s._consumeFilteredEvents=n.consumeFilteredEvents,s._parent=n.parent,s._ignoreZoom=!0===n.ignoreZoom,s._ghostProxyParent=n.ghostProxyParent,s.trackScroll)&&(s.scrollTracker=s._trackScroll.bind(s),(s.trackScrollContainer===document.documentElement?document:s.trackScrollContainer).addEventListener("scroll",s.scrollTracker));if(!0===n.ghostProxy?s._useGhostProxy=Qn:n.ghostProxy&&"function"==typeof n.ghostProxy?s._useGhostProxy=n.ghostProxy:s._useGhostProxy=function(e,t){return!(!s._activeSelectorParams||!s._activeSelectorParams.useGhostProxy)&&s._activeSelectorParams.useGhostProxy(e,t)},n.makeGhostProxy?s._ghostProxyFunction=n.makeGhostProxy:s._ghostProxyFunction=function(e){return s._activeSelectorParams&&s._activeSelectorParams.makeGhostProxy?s._activeSelectorParams.makeGhostProxy(e):e.cloneNode(!0)},n.selector){var a=s.el.getAttribute(Jn);null==a&&(a=""+(new Date).getTime(),s.el.setAttribute("katavorio-draggable",a)),s._availableSelectors.push(n)}return s.eventManager.on(s.el,vt,s.downListener),s}return h(t,e),a(t,[{key:"_trackScroll",value:function(e){if(this._moving){var t=this._lastPosition.x-this._downAt.x+this.trackScrollContainer.scrollLeft-this._initialScroll.x,n=this._lastPosition.y-this._downAt.y+this.trackScrollContainer.scrollTop-this._initialScroll.y;this.moveBy(t,n,e)}}},{key:"on",value:function(e,t){this.listeners[e]&&this.listeners[e].push(t)}},{key:"off",value:function(e,t){if(this.listeners[e]){for(var n=[],i=0;i<this.listeners[e].length;i++)this.listeners[e][i]!==t&&n.push(this.listeners[e][i]);this.listeners[e]=n}}},{key:"_upListener",value:function(e){this._downAt&&(this._downAt=null,this.eventManager.off(document,mt,this.moveListener),this.eventManager.off(document,_t,this.upListener),se(document.body,ni),this.unmark(e),this.stop(e),this._moving=!1,this.clone?(this._dragEl&&this._dragEl.parentNode&&this._dragEl.parentNode.removeChild(this._dragEl),this._dragEl=null):this._activeSelectorParams&&this._activeSelectorParams.revertFunction&&!0===this._activeSelectorParams.revertFunction(this._dragEl,this.manager.getPosition(this._dragEl))&&(this.manager.setPosition(this._dragEl,this._posAtDown),this._dispatch(Ct,this._dragEl)),this._clearAutoScroll())}},{key:"_downListener",value:function(e){if(!e.defaultPrevented&&((this.rightButtonCanDrag||3!==e.which&&2!==e.button)&&this.isEnabled()&&this._canDrag()))if(this._testFilter(e)&&function(e,t,n){return!J(e.srcElement||e.target,n.getInputFilterSelector(),t)}(e,this.el,this.manager)){this._activeSelectorParams=null,this._elementToDrag=null,0===this._availableSelectors.length&&console.log("JSPLUMB: no available drag selectors");var t=e.target||e.srcElement,n=function(e,t,n){for(var i=null,o=t.getAttribute("katavorio-draggable"),r=null!=o?"[katavorio-draggable='"+o+"'] ":"",s=0;s<e.length;s++)if(null!=(i=Vn(t,n,r+e[s].selector))){if(e[s].filter){var a=J(n,e[s].filter,i);if(!0===e[s].filterExclude&&!a||a)return null}return[e[s],i]}return null}(this._availableSelectors,this.el,t);if(null!=n&&(this._activeSelectorParams=n[0],this._elementToDrag=n[1]),null==this._activeSelectorParams||null==this._elementToDrag)return;var i=this._activeSelectorParams.dragInit?this._activeSelectorParams.dragInit(this._elementToDrag,e):null;if(null!=i&&(this._elementToDrag=i),this.clone)if(this._dragEl=this._elementToDrag.cloneNode(!0),re(this._dragEl,oi),this._dragEl.setAttribute("id",null),this._dragEl.style.position="absolute",null!=this._parent){var o=this.manager.getPosition(this.el);this._dragEl.style.left=o.x+"px",this._dragEl.style.top=o.y+"px",this._parent.appendChild(this._dragEl)}else{var r=ce(this._elementToDrag);this._dragEl.style.left=r.x+"px",this._dragEl.style.top=r.y+"px",document.body.appendChild(this._dragEl)}else this._dragEl=this._elementToDrag;this.consumeStartEvent&&Q(e),this._downAt=Cn(e),this._dragEl&&this._dragEl.parentNode&&(this._initialScroll={x:this.trackScrollContainer.scrollLeft,y:this.trackScrollContainer.scrollTop}),this._posAtDown=this.manager.getPosition(this._dragEl),this._pagePosAtDown=ce(this._dragEl),this._pageDelta={x:this._pagePosAtDown.x-this._posAtDown.x,y:this._pagePosAtDown.y-this._posAtDown.y},this._size=this.manager.getSize(this._dragEl),this.eventManager.on(document,mt,this.moveListener),this.eventManager.on(document,_t,this.upListener),re(document.body,ni),this._dispatch($n,{el:this.el,pos:this._posAtDown,e:e,drag:this,size:this._size})}else this._consumeFilteredEvents&&Q(e)}},{key:"_clearAutoScroll",value:function(){this._timer&&(clearInterval(this._timer),this._timer=null)}},{key:"_autoScroll",value:function(e){var t=this.trackScrollContainer,n=Cn(e),i=t.getBoundingClientRect(),o=n.x,r=n.y,s=i.top,a=i.bottom,l=i.left,c=i.right,u=i.width,h=i.height,d=t.scrollWidth,p=t.scrollHeight,f=t.scrollLeft,v=t.scrollTop,y=u<d,g=h<p,m=y&&Math.abs(c-o)<=30&&f+u<d,_=y&&Math.abs(l-o)<=30&&!!f,b=g&&Math.abs(a-r)<=30&&v+h<p,k=g&&Math.abs(s-r)<=30&&!!v,x=m?1:_?-1:0,C=b?1:k?-1:0;this._clearAutoScroll(),0==x&&0==C||(this._timer=window.setInterval((function(){var e=x?10*x:0,n=C?10*C:0;t.scrollLeft+=e,t.scrollTop+=n}),24))}},{key:"_moveListener",value:function(e){if(this._downAt){if(!this._moving){var t=this._dispatch(Wn,{el:this.el,pos:this._posAtDown,e:e,drag:this,size:this._size});if(!1!==t){if(!this._downAt)return;this.mark(t),this._moving=!0}else this.abort()}if(this._downAt){var n=Cn(e),i=n.x-this._downAt.x,o=n.y-this._downAt.y,r=this._ignoreZoom?1:this.manager.getZoom();this._lastPosition=n,i+=this.trackScrollContainer.scrollLeft-this._initialScroll.x,o+=this.trackScrollContainer.scrollTop-this._initialScroll.y,i/=r,o/=r,this._autoScroll(e),this.moveBy(i,o,e)}}}},{key:"getDragDelta",value:function(){return null!=this._posAtDown&&null!=this._downAt?{x:this._downAt.x-this._posAtDown.x,y:this._downAt.y-this._posAtDown.y}:{x:0,y:0}}},{key:"mark",value:function(e){var t;this._posAtDown=this.manager.getPosition(this._dragEl),this._pagePosAtDown=ce(this._dragEl),this._pageDelta={x:this._pagePosAtDown.x-this._posAtDown.x,y:this._pagePosAtDown.y-this._posAtDown.y},this._size=this.manager.getSize(this._dragEl),re(this._dragEl,this.manager.css.drag),this._constrainRect={w:(t=this._dragEl).parentNode.offsetWidth+t.parentNode.scrollLeft,h:t.parentNode.offsetHeight+t.parentNode.scrollTop},this._ghostDx=0,this._ghostDy=0}},{key:"unmark",value:function(e){this._isConstrained&&this._useGhostProxy(this._elementToDrag,this._dragEl)?(this._ghostProxyOffsets={x:this._dragEl.offsetLeft-this._ghostDx,y:this._dragEl.offsetTop-this._ghostDy},this._dragEl.parentNode.removeChild(this._dragEl),this._dragEl=this._elementToDrag):this._ghostProxyOffsets=null,se(this._dragEl,this.manager.css.drag),this._isConstrained=!1}},{key:"moveBy",value:function(e,t,n){var i=this.toGrid({x:this._posAtDown.x+e,y:this._posAtDown.y+t}),o=this._doConstrain(i,this._dragEl,this._constrainRect,this._size,n);if(null!=o){if(this._useGhostProxy(this.el,this._dragEl))if(i.x!==o.x||i.y!==o.y){if(!this._isConstrained){var r=this._ghostProxyFunction(this._elementToDrag);re(r,ii),this._ghostProxyParent?(this._ghostProxyParent.appendChild(r),this._currentParentPosition=ce(this._elementToDrag.parentNode),this._ghostParentPosition=ce(this._ghostProxyParent),this._ghostDx=this._currentParentPosition.x-this._ghostParentPosition.x,this._ghostDy=this._currentParentPosition.y-this._ghostParentPosition.y):this._elementToDrag.parentNode.appendChild(r),this._dragEl=r,this._isConstrained=!0}o=i}else this._isConstrained&&(this._dragEl.parentNode.removeChild(this._dragEl),this._dragEl=this._elementToDrag,this._isConstrained=!1,this._currentParentPosition=null,this._ghostParentPosition=null,this._ghostDx=0,this._ghostDy=0);this.manager.setPosition(this._dragEl,{x:o.x+this._ghostDx,y:o.y+this._ghostDy}),this._dispatch(qn,{el:this.el,pos:o,e:n,drag:this,size:this._size,originalPos:this._posAtDown})}}},{key:"abort",value:function(){null!=this._downAt&&this._upListener()}},{key:"getDragElement",value:function(e){return e?this._elementToDrag||this.el:this._dragEl||this.el}},{key:"stop",value:function(e,t){if(t||this._moving){var n=[],i=this.manager.getPosition(this._dragEl);n.push([this._dragEl,i,this,this._size]),this._dispatch(Zn,{el:this._dragEl,pos:this._ghostProxyOffsets||i,finalPos:i,e:e,drag:this,selection:n,size:this._size,originalPos:{x:this._posAtDown.x,y:this._posAtDown.y}})}else this._moving||this._activeSelectorParams.dragAbort&&this._activeSelectorParams.dragAbort(this._elementToDrag)}},{key:"_dispatch",value:function(e,t){var n=null;if(this._activeSelectorParams&&this._activeSelectorParams[e])n=this._activeSelectorParams[e](t);else if(this.listeners[e])for(var i=0;i<this.listeners[e].length;i++)try{var o=this.listeners[e][i](t);null!=o&&(n=o)}catch(e){}return n}},{key:"resolveGrid",value:function(){var e={grid:null,thresholdX:5,thresholdY:5};return null!=this._activeSelectorParams&&null!=this._activeSelectorParams.grid&&(e.grid=this._activeSelectorParams.grid,null!=this._activeSelectorParams.snapThreshold&&(e.thresholdX=this._activeSelectorParams.snapThreshold,e.thresholdY=this._activeSelectorParams.snapThreshold)),e}},{key:"toGrid",value:function(e){var t=this.resolveGrid(),n=t.grid,i=t.thresholdX,o=t.thresholdY;return null==n?e:function(e,t,n,i){n=null==n?null==t.thresholdX?t.w/2:t.thresholdX:n,i=null==i?null==t.thresholdY?t.h/2:t.thresholdY:i;var o=Math.floor(e.x/t.w),r=t.w*o,s=r+t.w,a=Math.abs(e.x-r)<=n?r:Math.abs(s-e.x)<=n?s:e.x,l=Math.floor(e.y/t.h),c=t.h*l,u=c+t.h;return{x:a,y:Math.abs(e.y-c)<=i?c:Math.abs(u-e.y)<=i?u:e.y}}(e,n,n?n.w/2:i,n?n.h/2:o)}},{key:"setUseGhostProxy",value:function(e){this._useGhostProxy=e?Qn:ei}},{key:"_doConstrain",value:function(e,t,n,i,o){return null!=this._activeSelectorParams&&this._activeSelectorParams.constrainFunction&&"function"==typeof this._activeSelectorParams.constrainFunction?this._activeSelectorParams.constrainFunction(e,t,n,i,o):e}},{key:"_testFilter",value:function(e){for(var t in this._filters){var n=this._filters[t],i=n[0](e);if(n[1]&&(i=!i),!i)return!1}return!0}},{key:"addFilter",value:function(e,t){var n,i=this;if(e){var o="function"==typeof(n=e)?(n._katavorioId=X(),n._katavorioId):n;this._filters[o]=[function(t){var n,o=t.srcElement||t.target;return S(e)?n=J(o,e,i.el):"function"==typeof e&&(n=e(t,i.el)),n},!1!==t]}}},{key:"removeFilter",value:function(e){var t="function"==typeof e?e._katavorioId:e;delete this._filters[t]}},{key:"clearAllFilters",value:function(){this._filters={}}},{key:"addSelector",value:function(e,t){e.selector&&(t?this._availableSelectors.unshift(e):this._availableSelectors.push(e))}},{key:"destroy",value:function(){(this.eventManager.off(this.el,vt,this.downListener),this.eventManager.off(document,mt,this.moveListener),this.eventManager.off(document,_t,this.upListener),this.downListener=null,this.upListener=null,this.moveListener=null,null!=this.scrollTracker)&&(this.trackScrollContainer===document.documentElement?document:this.trackScrollContainer).removeEventListener("scroll",this.scrollTracker)}}])}(pi),yi=["input","textarea","select","button","option"].join(","),gi=a((function e(t){r(this,e),l(this,"eventManager",void 0),l(this,"zoom",1),l(this,"css",{}),l(this,"inputFilterSelector",void 0),l(this,"positioningStrategy",void 0),l(this,"_positionSetter",void 0),l(this,"_positionGetter",void 0),l(this,"_sizeSetter",void 0),l(this,"_sizeGetter",void 0),t=t||{},this.inputFilterSelector=t.inputFilterSelector||yi,this.eventManager=new Fn,this.zoom=t.zoom||1,this.positioningStrategy=t.positioningStrategy||ri.absolutePosition,this._positionGetter=ai.get(this.positioningStrategy),this._positionSetter=si.get(this.positioningStrategy),this._sizeGetter=ci.get(this.positioningStrategy),this._sizeSetter=li.get(this.positioningStrategy);var n=t.css||{};x(this.css,n)}),[{key:"getPosition",value:function(e){return this._positionGetter(e)}},{key:"setPosition",value:function(e,t){this._positionSetter(e,t)}},{key:"getSize",value:function(e){return this._sizeGetter(e)}},{key:"getZoom",value:function(){return this.zoom}},{key:"setZoom",value:function(e){this.zoom=e}},{key:"_prepareParams",value:function(e){e=e||{};var t,n={events:{}};for(t in e)n[t]=e[t];for(t=0;t<ui.length;t++)n.events[ui[t]]=e[ui[t]]||hi;return n}},{key:"getInputFilterSelector",value:function(){return this.inputFilterSelector}},{key:"setInputFilterSelector",value:function(e){return this.inputFilterSelector=e,this}},{key:"draggable",value:function(e,t){if(null==e._katavorioDrag){var n=this._prepareParams(t),i=new vi(e,n,this);return re(e,ti),e._katavorioDrag=i,i}return e._katavorioDrag}},{key:"destroyDraggable",value:function(e){e._katavorioDrag&&(e._katavorioDrag.destroy(),delete e._katavorioDrag)}}]),mi="jtk-drag-selected",_i=a((function e(t){r(this,e),this.instance=t,l(this,"_dragSelection",[]),l(this,"_dragSizes",new Map),l(this,"_dragElements",new Map),l(this,"_dragElementStartPositions",new Map),l(this,"_dragElementPositions",new Map),l(this,"__activeSet",void 0)}),[{key:"_activeSet",get:function(){return null==this.__activeSet?this._dragSelection:this.__activeSet}},{key:"length",get:function(){return this._dragSelection.length}},{key:"filterActiveSet",value:function(e){var t=this;this.__activeSet=[],j(this._dragSelection,(function(n){e(n)&&t.__activeSet.push(n)}))}},{key:"clear",value:function(){var e=this;this.reset(),j(this._dragSelection,(function(t){return e.instance.removeClass(t.jel,mi)})),this._dragSelection.length=0}},{key:"reset",value:function(){this._dragElementStartPositions.clear(),this._dragElementPositions.clear(),this._dragSizes.clear(),this._dragElements.clear(),this.__activeSet=null}},{key:"initialisePositions",value:function(){var e=this;j(this._activeSet,(function(t){var n=e.instance.viewport.getPosition(t.id),i={x:parseInt(""+t.jel.offsetLeft,10),y:parseInt(""+t.jel.offsetTop,10)};e._dragElementStartPositions.set(t.id,i),e._dragElementPositions.set(t.id,i),e._dragSizes.set(t.id,{w:n.w,h:n.h})}))}},{key:"updatePositions",value:function(e,t,n){var i=this,o=e.x-t.x,r=e.y-t.y;j(this._activeSet,(function(e){var t=i._dragElementStartPositions.get(e.id);if(t){var s=t.x+o,a=t.y+r,l=i._dragSizes.get(e.id),c={x:s,y:a,w:l.w,h:l.h};if(e.jel._jsPlumbParentGroup&&e.jel._jsPlumbParentGroup.constrain){var u={w:e.jel.parentNode.offsetWidth+e.jel.parentNode.scrollLeft,h:e.jel.parentNode.offsetHeight+e.jel.parentNode.scrollTop};c.x=Math.max(c.x,0),c.y=Math.max(c.y,0),c.x=Math.min(c.x,u.w-l.w),c.y=Math.min(c.y,u.h-l.h)}i._dragElementPositions.set(e.id,{x:s,y:a}),e.jel.style.left=c.x+"px",e.jel.style.top=c.y+"px",n(e.jel,e.id,l,c)}}))}},{key:"each",value:function(e){var t=this;j(this._activeSet,(function(n){var i=t._dragSizes.get(n.id),o=t._dragElementPositions.get(n.id),r=t._dragElementStartPositions.get(n.id);e(n.jel,n.id,o,i,r)}))}},{key:"add",value:function(e,t){var n=e;t=t||this.instance.getId(n),-1===O(this._dragSelection,(function(e){return e.id===t}))&&(this.instance.addClass(e,mi),this._dragSelection.push({id:t,jel:n}))}},{key:"remove",value:function(e){var t=this,n=e;this._dragSelection=this._dragSelection.filter((function(e){var i=e.jel!==n;return i||t.instance.removeClass(e.jel,mi),i}))}},{key:"toggle",value:function(e){var t=e;-1!==O(this._dragSelection,(function(e){return e.jel===t}))?this.remove(t):this.add(e)}}]),bi="jtk-drag-active",ki="jtk-drag-hover",xi=a((function e(t,n,i){var o=this;r(this,e),this.instance=t,this.dragSelection=n,l(this,"collicat",void 0),l(this,"drag",void 0),l(this,"_draggables",{}),l(this,"_dlist",[]),l(this,"_elementsWithEndpoints",{}),l(this,"_draggablesForElements",{}),l(this,"handlers",[]),l(this,"_trackScroll",void 0),l(this,"_trackScrollContainer",void 0),l(this,"_filtersToAdd",[]),this.collicat=new gi({zoom:this.instance.currentZoom,css:{noSelect:this.instance.dragSelectClass,delegatedDraggable:"jtk-delegated-draggable",draggable:"jtk-draggable",drag:"jtk-drag",selected:mi,active:bi,hover:ki,ghostProxy:"jtk-ghost-proxy"}}),this.instance.bind(Xe,(function(e){o.collicat.setZoom(e)})),i=i||{},this._trackScroll=!1!==i.trackScroll,this._trackScrollContainer=i.trackScrollContainer||document.documentElement}),[{key:"addHandler",value:function(e,t){var n=this,i=x({selector:e.selector},t||{});i.start=$(i.start,(function(t){return e.onStart(t)}),!1),i.drag=$(i.drag,(function(t){return e.onDrag(t)})),i.stop=$(i.stop,(function(t){return e.onStop(t)}));var o=(e.onBeforeStart||function(e){}).bind(e);if(i.beforeStart=$(i.beforeStart,(function(e){return o(e)})),i.dragInit=function(t,n){return e.onDragInit(t,n)},i.dragAbort=function(t){return e.onDragAbort(t)},e.useGhostProxy&&(i.useGhostProxy=e.useGhostProxy,i.makeGhostProxy=e.makeGhostProxy),null==i.constrainFunction&&null!=i.containment)switch(i.containment){case fi.notNegative:i.constrainFunction=function(e,t,n,i){return{x:Math.max(0,Math.min(e.x)),y:Math.max(0,Math.min(e.y))}};break;case fi.parent:var r=i.containmentPadding||5;i.constrainFunction=function(e,t,n,i){return{x:e.x<0?0:e.x>n.w-r?n.w-r:e.x,y:e.y<0?0:e.y>n.h-r?n.h-r:e.y}};break;case fi.parentEnclosed:i.constrainFunction=function(e,t,n,i){return{x:e.x<0?0:e.x+i.w>n.w?n.w-i.w:e.x,y:e.y<0?0:e.y+i.h>n.h?n.h-i.h:e.y}}}null==this.drag?(i.trackScroll=this._trackScroll,i.trackScrollContainer=this._trackScrollContainer,this.drag=this.collicat.draggable(this.instance.getContainer(),i),j(this._filtersToAdd,(function(e){return n.drag.addFilter(e[0],e[1])})),this.drag.on(Ct,(function(e){n.instance.revalidate(e)}))):this.drag.addSelector(i),this.handlers.push({handler:e,options:i}),e.init(this.drag)}},{key:"addSelector",value:function(e,t){this.drag&&this.drag.addSelector(e,t)}},{key:"addFilter",value:function(e,t){null==this.drag?this._filtersToAdd.push([e,!0===t]):this.drag.addFilter(e,t)}},{key:"removeFilter",value:function(e){null!=this.drag&&this.drag.removeFilter(e)}},{key:"setFilters",value:function(e){var t=this;j(e,(function(e){t.drag.addFilter(e[0],e[1])}))}},{key:"reset",value:function(){var e=[];if(j(this.handlers,(function(e){e.handler.reset()})),this.handlers.length=0,null!=this.drag){var t=this.drag._filters;for(var n in t)e.push([n,t[n][1]]);this.collicat.destroyDraggable(this.instance.getContainer())}return delete this.drag,e}},{key:"setOption",value:function(e,t){var n=I(this.handlers,(function(t){return t.handler===e}));null!=n&&x(n.options,t||{})}}]);function Ci(e,t){return S(t)?{id:t,active:!0}:{id:t.id,active:t.active}}var Si=a((function e(t,n){r(this,e),this.instance=t,this._dragSelection=n,l(this,"selector","> "+ze+":not("+fe(Oe)+")"),l(this,"_dragOffset",null),l(this,"_groupLocations",[]),l(this,"_intersectingGroups",[]),l(this,"_currentDragParentGroup",null),l(this,"_dragGroupByElementIdMap",{}),l(this,"_dragGroupMap",{}),l(this,"_currentDragGroup",null),l(this,"_currentDragGroupOffsets",new Map),l(this,"_currentDragGroupSizes",new Map),l(this,"_currentDragGroupOriginalPositions",new Map),l(this,"_dragPayload",null),l(this,"drag",void 0),l(this,"originalPosition",void 0)}),[{key:"onDragInit",value:function(e){return null}},{key:"onDragAbort",value:function(e){return null}},{key:"getDropGroup",value:function(){var e=null;if(this._intersectingGroups.length>0){var t=this._intersectingGroups[0].groupLoc.group,n=this._intersectingGroups[0].intersectingElement,i=n._jsPlumbParentGroup;i!==t&&(null!=i&&i.overrideDrop(n,t)||(e=this._intersectingGroups[0]))}return e}},{key:"onStop",value:function(e){var t,n=this,i=e.drag.getDragElement(),o=this.getDropGroup(),r=[];function s(e,t,n,i,s){var a=n.x,l=n.y;if(e._jsPlumbParentGroup&&e._jsPlumbParentGroup.constrain){var c={w:e.parentNode.offsetWidth+e.parentNode.scrollLeft,h:e.parentNode.offsetHeight+e.parentNode.scrollTop};a=Math.max(a,0),l=Math.max(l,0),a=Math.min(a,c.w-i.w),l=Math.min(l,c.h-i.h),n.x=a,n.y=l}r.push({el:e,id:t,pos:n,originalPos:s,originalGroup:e._jsPlumbParentGroup,redrawResult:null,reverted:!1,dropGroup:null==o?void 0:o.groupLoc.group})}if(r.push({el:i,id:this.instance.getId(i),pos:e.finalPos,originalGroup:i._jsPlumbParentGroup,redrawResult:null,originalPos:e.originalPos,reverted:!1,dropGroup:null!=o?o.groupLoc.group:null}),this._dragSelection.each((function(t,n,i,o,r){t!==e.el&&s(t,n,{x:i.x,y:i.y},o,r)})),null===(t=this._currentDragGroup)||void 0===t||t.members.forEach((function(t){if(t.el!==e.el){var i=n._currentDragGroupOffsets.get(t.elId),o=n._currentDragGroupSizes.get(t.elId),r={x:e.finalPos.x+i[0].x,y:e.finalPos.y+i[0].y};s(t.el,t.elId,r,o,n._currentDragGroupOriginalPositions.get(t.elId))}})),j(r,(function(e){var t=null!=e.originalGroup,i=t&&zn(n.instance,e.el,e.pos),r={x:0,y:0};if(t&&!i){if(null==o){var s=n._pruneOrOrphan(e,!0,!0);null!=s.pos?e.pos=s.pos.pos:!s.pruned&&e.originalGroup.revert&&(e.pos=e.originalPos,e.reverted=!0)}}else t&&i&&(r=n._computeOffsetByParentGroup(e.originalGroup));null==o||i?e.dropGroup=null:n.instance.groupManager.addToGroup(o.groupLoc.group,!1,e.el),e.reverted&&n.instance.setPosition(e.el,e.pos),e.redrawResult=n.instance.setElementPosition(e.el,e.pos.x+r.x,e.pos.y+r.y),n.instance.removeClass(e.el,"jtk-dragged"),n.instance.select({source:e.el}).removeClass(n.instance.elementDraggingClass+" "+n.instance.sourceElementDraggingClass,!0),n.instance.select({target:e.el}).removeClass(n.instance.elementDraggingClass+" "+n.instance.targetElementDraggingClass,!0)})),null!=r[0].originalGroup){var a=i._jsPlumbParentGroup;if(a!==r[0].originalGroup){var l=e.drag.getDragElement(!0);if(r[0].originalGroup.ghost){var c=this.instance.getPosition(this.instance.getGroupContentArea(a)),u=this.instance.getPosition(this.instance.getGroupContentArea(r[0].originalGroup)),h={x:u.x+e.pos.x-c.x,y:u.y+e.pos.y-c.y};l.style.left=h.x+"px",l.style.top=h.y+"px",this.instance.revalidate(l)}}}this.instance.fire("drag:stop",{elements:r,e:e.e,el:i,payload:this._dragPayload}),this._cleanup()}},{key:"_cleanup",value:function(){var e=this;j(this._groupLocations,(function(t){e.instance.removeClass(t.el,bi),e.instance.removeClass(t.el,ki)})),this._currentDragParentGroup=null,this._groupLocations.length=0,this.instance.hoverSuspended=!1,this._dragOffset=null,this._dragSelection.reset(),this._dragPayload=null,this._currentDragGroupOffsets.clear(),this._currentDragGroupSizes.clear(),this._currentDragGroupOriginalPositions.clear(),this._currentDragGroup=null}},{key:"reset",value:function(){}},{key:"init",value:function(e){this.drag=e}},{key:"onDrag",value:function(e){var t=this,n=e.drag.getDragElement(),i=this.instance.getId(n),o=e.pos,r=this.instance.viewport.getPosition(i),s={x:o.x,y:o.y};this._intersectingGroups.length=0,null!=this._dragOffset&&(s.x+=this._dragOffset.x,s.y+=this._dragOffset.y);var a=function(n,i,o){if(o){var r=new Set;j(t._groupLocations,(function(n){!r.has(n.group.id)&&Yn(i,n.r)?(n.group!==t._currentDragParentGroup&&t.instance.addClass(n.el,ki),t._intersectingGroups.push({groupLoc:n,intersectingElement:e.drag.getDragElement(!0),d:0}),j(t.instance.groupManager.getAncestors(n.group),(function(e){return r.add(e.id)}))):t.instance.removeClass(n.el,ki)}))}t.instance.setElementPosition(n,i.x,i.y),t.instance.fire("drag:move",{el:n,e:e.e,pos:{x:i.x,y:i.y},originalPosition:t.originalPosition,payload:t._dragPayload})},l={x:s.x,y:s.y,w:r.w,h:r.h};a(n,l,!0),this._dragSelection.updatePositions(o,this.originalPosition,(function(e,t,n,i){a(e,i,!1)})),this._currentDragGroupOffsets.forEach((function(e,n){var i=t._currentDragGroupSizes.get(n),o={x:l.x+e[0].x,y:l.y+e[0].y,w:i.w,h:i.h};e[1].style.left=o.x+"px",e[1].style.top=o.y+"px",a(e[1],o,!1)}))}},{key:"_computeOffsetByParentGroup",value:function(e){var t=this.instance.getPosition(e.el),n=e.contentArea;if(n!==e.el){var i=this.instance.getPosition(n);t.x+=i.x,t.y+=i.y}if(e.el._jsPlumbParentGroup){var o=this._computeOffsetByParentGroup(e.el._jsPlumbParentGroup);t.x+=o.x,t.y+=o.y}return t}},{key:"onStart",value:function(e){var t=this,n=e.drag.getDragElement(),i=this.instance.getPosition(n);this.originalPosition={x:e.pos.x,y:e.pos.y},n._jsPlumbParentGroup&&(this._dragOffset=this._computeOffsetByParentGroup(n._jsPlumbParentGroup),this._currentDragParentGroup=n._jsPlumbParentGroup);var o=!0,r=n.getAttribute(Se);if((!1===this.instance.elementsDraggable||null!=r&&r!==cn)&&(o=!1),o){this._groupLocations.length=0,this._intersectingGroups.length=0,this.instance.hoverSuspended=!0;var s=e.drag.getDragElement(!0),a=s.querySelectorAll(ze),l=function(e){for(var t=[],n=e._jsPlumbParentGroup;null!=n;)t.push(n.el),n=n.group;return t}(s),c=[];Array.prototype.push.apply(c,a),Array.prototype.push.apply(c,l),this._dragSelection.filterActiveSet((function(e){return-1===c.indexOf(e.jel)})),this._dragSelection.initialisePositions();var u=function(n,i,o){if(!n._isJsPlumbGroup||t.instance.allowNestedGroups){var r=!n._jsPlumbParentGroup,s=r||!0!==n._jsPlumbParentGroup.dropOverride,a=!r&&(n._jsPlumbParentGroup.ghost||!0!==n._jsPlumbParentGroup.constrain);(r||s&&a)&&(j(t.instance.groupManager.getGroups(),(function(e){var i=n._jsPlumbGroup;if(!1!==e.droppable&&!1!==e.enabled&&n._jsPlumbGroup!==e&&!t.instance.groupManager.isDescendant(e,i)){var o=e.el,r=t.instance.getId(o),s=t.instance.viewport.getPosition(r),a={el:o,r:{x:s.x,y:s.y,w:s.w,h:s.h},group:e};t._groupLocations.push(a),e!==t._currentDragParentGroup&&t.instance.addClass(o,bi)}})),t._groupLocations.sort((function(e,n){return t.instance.groupManager.isDescendant(e.group,n.group)?-1:t.instance.groupManager.isAncestor(n.group,e.group)?1:0})))}return t.instance.select({source:n}).addClass(t.instance.elementDraggingClass+" "+t.instance.sourceElementDraggingClass,!0),t.instance.select({target:n}).addClass(t.instance.elementDraggingClass+" "+t.instance.targetElementDraggingClass,!0),t.instance.fire("drag:start",{el:n,e:e.e,originalPosition:t.originalPosition,pos:t.originalPosition,dragGroup:i,dragGroupMemberSpec:o})},h=this.instance.getId(n);this._currentDragGroup=this._dragGroupByElementIdMap[h],this._currentDragGroup&&!function(e,t){var n=L(e.members,(function(e){return e.el===t}));return null!==n&&!0===n.active}(this._currentDragGroup,n)&&(this._currentDragGroup=null);var d=u(n);if(!1===d)return this._cleanup(),!1;this._dragPayload=d,null!=this._currentDragGroup&&(this._currentDragGroupOffsets.clear(),this._currentDragGroupSizes.clear(),this._currentDragGroup.members.forEach((function(e){var n=t.instance.viewport.getPosition(e.elId);t._currentDragGroupOffsets.set(e.elId,[{x:n.x-i.x,y:n.y-i.y},e.el]),t._currentDragGroupSizes.set(e.elId,n),t._currentDragGroupOriginalPositions.set(e.elId,{x:n.x,y:n.y}),u(e.el,t._currentDragGroup,e)})))}return o}},{key:"addToDragGroup",value:function(e){var t=this,n=Ci(this.instance,e),i=this._dragGroupMap[n.id];null==i&&(i={id:n.id,members:new Set},this._dragGroupMap[n.id]=i);for(var o=arguments.length,r=new Array(o>1?o-1:0),s=1;s<o;s++)r[s-1]=arguments[s];this.removeFromDragGroup.apply(this,r),j(r,(function(e){var o=t.instance.getId(e);i.members.add({elId:o,el:e,active:n.active}),t._dragGroupByElementIdMap[o]=i}))}},{key:"removeFromDragGroup",value:function(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];j(n,(function(t){var n=e.instance.getId(t),i=e._dragGroupByElementIdMap[n];if(null!=i){var o=new Set;i.members.forEach((function(e){e.el!==t&&o.add(e)})),i.members=o,delete e._dragGroupByElementIdMap[n]}}))}},{key:"setDragGroupState",value:function(e){for(var t=this,n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];var r=i.map((function(e){return t.instance.getId(e)}));j(r,(function(n){var i=t._dragGroupByElementIdMap[n];if(null!=i){var o=L(i.members,(function(e){return e.elId===n}));null!=o&&(o.active=e)}}))}},{key:"clearDragGroup",value:function(e){var t=this,n=this._dragGroupMap[e];null!=n&&(n.members.forEach((function(e){delete t._dragGroupByElementIdMap[e.elId]})),n.members.clear())}},{key:"_pruneOrOrphan",value:function(e,t,n){var i=e.el,o={pruned:!1,pos:null};if(n||!zn(this.instance,i,e.pos)){var r=i._jsPlumbParentGroup;r.prune?(i._isJsPlumbGroup?this.instance.removeGroup(i._jsPlumbGroup):r.remove(e.el,!0),o.pruned=!0):r.orphan&&(o.pos=this.instance.groupManager.orphan(e.el,t),i._isJsPlumbGroup?r.removeGroup(i._jsPlumbGroup):r.remove(e.el))}return o}}]),wi={},Ei={},Pi={},Ai={get:function(e,t,n){var i=wi[t];if(i)return new i(e,n);throw{message:"jsPlumb: unknown endpoint type '"+t+"'"}},clone:function(e){var t=Pi[e.type];return Ai.get(e.endpoint,e.type,t.getParams(e))},compute:function(e,t,n,i){var o=Ei[e.type];if(null!=o)return o(e,t,n,i);z("jsPlumb: cannot find endpoint calculator for endpoint of type ",e.type)},registerHandler:function(e){Pi[e.type]=e,wi[e.type]=e.cls,Ei[e.type]=e.compute}},Di=a((function e(t,n){r(this,e),this.endpoint=t,l(this,"typeId",void 0),l(this,"x",void 0),l(this,"y",void 0),l(this,"w",void 0),l(this,"h",void 0),l(this,"computedValue",void 0),l(this,"bounds",{xmin:1/0,xmax:-1/0,ymin:1/0,ymax:-1/0}),l(this,"classes",[]),l(this,"instance",void 0),l(this,"type",void 0),n=n||{},this.instance=t.instance,t.cssClass&&this.classes.push(t.cssClass),n.cssClass&&this.classes.push(n.cssClass)}),[{key:"addClass",value:function(e){this.classes.push(e),this.instance.addEndpointClass(this.endpoint,e)}},{key:"removeClass",value:function(e){this.classes=this.classes.filter((function(t){return t!==e})),this.instance.removeEndpointClass(this.endpoint,e)}},{key:"compute",value:function(e,t,n){this.computedValue=Ai.compute(this,e,t,n),this.bounds.xmin=this.x,this.bounds.ymin=this.y,this.bounds.xmax=this.x+this.w,this.bounds.ymax=this.y+this.h}},{key:"setVisible",value:function(e){this.instance.setEndpointVisible(this.endpoint,e)}}]),Mi=function(e){return e.top="top",e.left="left",e.right="right",e.bottom="bottom",e}(Mi||{}),Ti=Mi.top,ji=Mi.left,Oi=Mi.right,Ii=Mi.bottom,Li=[ji,Oi],Ni=[Ti,Ii],Fi=a((function e(t,n,i){r(this,e),this.instance=t,this.element=n,l(this,"isFloating",!0),l(this,"isContinuous",void 0),l(this,"isDynamic",void 0),l(this,"locations",[]),l(this,"currentLocation",0),l(this,"locked",!1),l(this,"cssClass",""),l(this,"timestamp",null),l(this,"type","Floating"),l(this,"id",X()),l(this,"orientation",[0,0]),l(this,"size",void 0),this.size=t.viewport.getPosition(i),this.locations.push({x:.5,y:.5,ox:this.orientation[0],oy:this.orientation[1],offx:0,offy:0,iox:this.orientation[0],ioy:this.orientation[1],cls:""})}),[{key:"_updateOrientationInRouter",value:function(){this.instance.router.setAnchorOrientation(this,[this.locations[0].ox,this.locations[0].oy])}},{key:"over",value:function(e){this.orientation=this.instance.router.getEndpointOrientation(e),this.locations[0].ox=this.orientation[0],this.locations[0].oy=this.orientation[1],this._updateOrientationInRouter()}},{key:"out",value:function(){this.orientation=null,this.locations[0].ox=this.locations[0].iox,this.locations[0].oy=this.locations[0].ioy,this._updateOrientationInRouter()}}]),Gi=l(l(l(l({},Ti,Ii),Oi,ji),ji,Oi),Ii,Ti),Ri=l(l(l(l({},Ti,Oi),Oi,Ii),ji,Ti),Ii,ji),Bi=l(l(l(l({},Ti,ji),Oi,Ti),ji,Ii),Ii,Oi);function Hi(e){return 0===e.faces.length?Ti:e.faces[0]}function Ui(e,t){return-1!==e.faces.indexOf(t)}function Xi(e,t){return null==e.lockedAxis?null==e.lockedFace?!0===Ui(e,t):e.lockedFace===t:-1!==e.lockedAxis.indexOf(t)}function Yi(e,t){if(Ui(e,t))return t;if(Ui(e,Gi[t]))return Gi[t];var n=function(e,t){return(e.clockwise?Ri:Bi)[t]}(e,t);if(Ui(e,n))return n;var i=function(e,t){return(e.clockwise?Bi:Ri)[t]}(e,t);return Ui(e,i)?i:t}var Ki={x:.5,y:0,ox:0,oy:-1,offx:0,offy:0},Vi={x:.5,y:1,ox:0,oy:1,offx:0,offy:0},zi={x:0,y:.5,ox:-1,oy:0,offx:0,offy:0},Wi={x:1,y:.5,ox:1,oy:0,offx:0,offy:0},$i={Top:[Ki],Bottom:[Vi],Left:[zi],Right:[Wi],TopLeft:[{x:0,y:0,ox:0,oy:-1,offx:0,offy:0}],TopRight:[{x:1,y:0,ox:1,oy:-1,offx:0,offy:0}],BottomLeft:[{x:0,y:1,ox:0,oy:1,offx:0,offy:0}],BottomRight:[{x:1,y:1,ox:0,oy:1,offx:0,offy:0}],Center:[{x:.5,y:.5,ox:0,oy:0,offx:0,offy:0}],AutoDefault:[Ki,zi,Vi,Wi]},qi={Continuous:{faces:[Ti,ji,Ii,Oi]},ContinuousTop:{faces:[Ti]},ContinuousRight:{faces:[Oi]},ContinuousBottom:{faces:[Ii]},ContinuousLeft:{faces:[ji]},ContinuousLeftRight:{faces:[ji,Oi]},ContinuousTopBottom:{faces:[Ti,Ii]}};function Zi(e,t){if(t=t||{},e===on.Perimeter)return function(e){var t=(e=e||{}).anchorCount||60,n=e.shape;if(!n)throw new Error("no shape supplied to Perimeter Anchor type");if(!ro.has(n))throw new Error("Shape ["+n+"] is unknown by Perimeter Anchor type");var i=ro.get(n)(t);e.rotation&&(i=function(e,t){for(var n=[],i=t/180*Math.PI,o=0;o<e.length;o++){var r=e[o].x-.5,s=e[o].y-.5;n.push({x:r*Math.cos(i)-s*Math.sin(i)+.5,y:r*Math.sin(i)+s*Math.cos(i)+.5,ox:e[o].ox,oy:e[o].oy,offx:0,offy:0,iox:0,ioy:0,cls:""})}return n}(i,e.rotation));return x(Ji(on.Perimeter,i,e),{shape:n})}(t);var n=$i[e];if(null!=n)return Ji(e,V(n,(function(e){return x({iox:e.ox,ioy:e.oy},e)})),t);if(null!=(n=qi[e]))return function(e,t,n){var i={type:e,locations:[],currentLocation:0,locked:!1,id:X(),cssClass:n.cssClass||"",isFloating:!1,isContinuous:!0,timestamp:null,faces:n.faces||t,lockedFace:null,lockedAxis:null,clockwise:!(!1===n.clockwise),__currentFace:null};return Object.defineProperty(i,Qi,{get:function(){return this.__currentFace},set:function(e){this.__currentFace=Yi(this,e)}}),i}(e,n.faces,t);throw{message:"jsPlumb: unknown anchor type '"+e+"'"}}function Ji(e,t,n){return{type:e,locations:t,currentLocation:0,locked:!1,id:X(),isFloating:!1,isContinuous:!1,isDynamic:t.length>1,timestamp:null,cssClass:n.cssClass||""}}var Qi="currentFace";function eo(e){return e.length<7&&e.every(C)||7===e.length&&e.slice(0,5).every(C)&&S(e[6])}function to(e){if(S(e))return Zi(e,null);if(Array.isArray(e)){if(eo(e)){var t=e;return Ji(null,[{x:t[0],y:t[1],ox:t[2],oy:t[3],offx:null==t[4]?0:t[4],offy:null==t[5]?0:t[5],iox:t[2],ioy:t[3],cls:t[6]||""}],{cssClass:t[6]||""})}return Ji("Dynamic",V(e,(function(e){if(S(e)){var t=$i[e];return null!=t?x({iox:t[0].ox,ioy:t[0].oy,cls:""},t[0]):null}if(eo(e))return{x:e[0],y:e[1],ox:e[2],oy:e[3],offx:null==e[4]?0:e[4],offy:null==e[5]?0:e[5],iox:e[2],ioy:e[3],cls:e[6]||""}})).filter((function(e){return null!=e})),{})}var n=e;return Zi(n.type,n.options)}function no(e){for(var t=.5,n=2*Math.PI/e,i=[],o=0,r=0;r<e;r++){var s=t+t*Math.sin(o),a=t+t*Math.cos(o);i.push({x:s,y:a,ox:0,oy:0,offx:0,offy:0,iox:0,ioy:0,cls:""}),o+=n}return i}function io(e,t){for(var n=[],i=0;i<e.length;i++)n.push([e[i][0],e[i][1],e[i][2],e[i][3],1/e.length,e[i][4],e[i][5]]);return function(e,t){for(var n=t/e.length,i=[],o=function(e,o,r,s,a,l,c){for(var u=(r-e)/(n=t*a),h=(s-o)/n,d=0;d<n;d++)i.push({x:e+u*d,y:o+h*d,ox:null==l?0:l,oy:null==c?0:c,offx:0,offy:0,iox:0,ioy:0,cls:""})},r=0;r<e.length;r++)o.apply(null,e[r]);return i}(n,t)}function oo(e){return io([[0,0,1,0,0,-1],[1,0,1,1,1,0],[1,1,0,1,0,1],[0,1,0,0,-1,0]],e)}var ro=new Map;ro.set(nn.Circle,no),ro.set(nn.Ellipse,no),ro.set(nn.Rectangle,oo),ro.set(nn.Square,oo),ro.set(nn.Diamond,(function(e){return io([[.5,0,1,.5],[1,.5,.5,1],[.5,1,0,.5],[0,.5,.5,0]],e)})),ro.set(nn.Triangle,(function(e){return io([[.5,0,1,1],[1,1,0,1],[0,1,.5,0]],e)}));var so=a((function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r(this,e),this.selector=t,this.def=n,this.exclude=i,l(this,"id",void 0),l(this,"redrop",void 0),this.id=X(),this.redrop=n.def.redrop||ao}),[{key:"setEnabled",value:function(e){this.def.enabled=e}},{key:"isEnabled",value:function(){return!1!==this.def.enabled}}]),ao="strict";function lo(e,t,n,i,o,r){var s=function(e,t,n){return new Fi(e,t,n)}(r,i,o),a={paintStyle:e.getPaintStyle(),preparedAnchor:s,element:i,scope:e.scope,cssClass:[Me,e.cssClass].join(" ")};null!=t&&(Z(t,Di)?a.existingEndpoint=t:a.endpoint=t);var l=r._internal_newEndpoint(a);return r._paintEndpoint(l,{}),l}function co(e,t,n,i,o){for(var r=e.target||e.srcElement,s=!1,a=i.getSelector(t,n),l=0;l<a.length;l++)if(a[l]===r){s=!0;break}return o?!s:s}var uo=fe(bi,ki),ho="sourceSelectorEndpoint",po=a((function e(t){r(this,e),this.instance=t,l(this,"jpc",void 0),l(this,"existingJpc",void 0),l(this,"_originalAnchorSpec",void 0),l(this,"ep",void 0),l(this,"endpointRepresentation",void 0),l(this,"canvasElement",void 0),l(this,"_activeDefinition",void 0),l(this,"placeholderInfo",{id:null,element:null}),l(this,"floatingIndex",void 0),l(this,"floatingId",void 0),l(this,"floatingElement",void 0),l(this,"floatingEndpoint",void 0),l(this,"floatingAnchor",void 0),l(this,"_stopped",void 0),l(this,"inPlaceCopy",void 0),l(this,"endpointDropTargets",[]),l(this,"currentDropTarget",null),l(this,"payload",void 0),l(this,"floatingConnections",{}),l(this,"_forceReattach",void 0),l(this,"_forceDetach",void 0),l(this,"mousedownHandler",void 0),l(this,"mouseupHandler",void 0),l(this,"selector",fe(De));var n=t.getContainer();this.mousedownHandler=this._mousedownHandler.bind(this),this.mouseupHandler=this._mouseupHandler.bind(this),t.on(n,vt,ze,this.mousedownHandler),t.on(n,_t,[ze,fe(De)].join(","),this.mouseupHandler)}),[{key:"_resolveDragParent",value:function(e,t){var n=this.instance.getContainer(),i=ee(t,ze,n,!0);if(null!=e.parentSelector){var o=ee(t,e.parentSelector,n,!0);return null!=o&&(i=ee(o.parentNode,ze,n,!1)),o||i}return i}},{key:"_mousedownHandler",value:function(e){var t,n;if(3!==e.which&&2!==e.button){var i=e.target||e.srcElement;if((null==(n=this._getSourceDefinition(e))||null!=(t=this._resolveDragParent(n.def.def,i))&&t.getAttribute(st)!==cn)&&n){var o,r=e.currentTarget;if(i.getAttribute(st)!==cn){if(Q(e),this._activeDefinition=n,null!=(o=n.def.def).canAcceptNewConnection&&!o.canAcceptNewConnection(t,e))return!1;var s=Or(e,t,this.instance.currentZoom),a={element:t};if(x(a,o),a.isTemporarySource=!0,o.scope)a.scope=o.scope;else{var l=i.getAttribute(at);null!=l&&(a.scope=l)}if(null!=(a=D(a,o.parameterExtractor?o.parameterExtractor(t,i,e):{})).maxConnections&&a.maxConnections>=0&&this.instance.select({source:t}).length>=a.maxConnections)return Q(e),o.onMaxConnections&&o.onMaxConnections({element:t,maxConnections:a.maxConnections},e),e.stopImmediatePropagation&&e.stopImmediatePropagation(),!1;if(o.anchorPositionFinder){var c=o.anchorPositionFinder(t,s,o,e);null!=c&&(a.anchor=c)}this._originalAnchorSpec=a.anchor||(this.instance.areDefaultAnchorsSet()?this.instance.defaults.anchors[0]:this.instance.defaults.anchor);var u=this.instance.router.prepareAnchor(this._originalAnchorSpec),h=[s.x,s.y,0,0];if(u.locations.length>0)h[2]=u.locations[0].ox,h[3]=u.locations[0].oy;else if(u.isContinuous){var d=s.x<.5?s.x:1-s.x,p=s.y<.5?s.y:1-s.y;h[2]=d<p?s.x<.5?-1:1:0,h[3]=p<d?s.y<.5?-1:1:0}a.anchor=h,a.deleteOnEmpty=!0,this.ep=this.instance._internal_newEndpoint(a);var f={};if(o.extract){for(var v in o.extract){var y=i.getAttribute(v);y&&(f[o.extract[v]]=y)}this.ep.mergeParameters(f)}if(a.uniqueEndpoint){var g=this.ep.elementId,m=this.instance.getManagedData(g,ho,n.id);null==m?(this.instance.setManagedData(g,ho,n.id,this.ep),this.ep.deleteOnEmpty=!1):this.ep.finalEndpoint=m}r._jsPlumbOrphanedEndpoints=r._jsPlumbOrphanedEndpoints||[],r._jsPlumbOrphanedEndpoints.push(this.ep),this.instance.trigger(this.ep.endpoint.canvas,vt,e,f)}}}}},{key:"_mouseupHandler",value:function(e){var t=e.currentTarget||e.srcElement;t._jsPlumbOrphanedEndpoints&&(function(e,t){e=null==e.length||"string"==typeof e?[e]:e;for(var n=0;n<e.length;n++)t(e[n])}(t._jsPlumbOrphanedEndpoints,this.instance._maybePruneEndpoint.bind(this.instance)),t._jsPlumbOrphanedEndpoints.length=0),this._activeDefinition=null}},{key:"onDragInit",value:function(e){var t=ue(e,this.instance),n=he(e,this.instance);return this._makeDraggablePlaceholder(t,n),this.placeholderInfo.element.jtk=e.jtk,this.placeholderInfo.element}},{key:"onDragAbort",value:function(e){this._cleanupDraggablePlaceholder()}},{key:"_makeDraggablePlaceholder",value:function(e,t){this.placeholderInfo=this.placeholderInfo||{};var n=ae("div",{position:"absolute"});this.instance._appendElementToContainer(n);var i=this.instance.getId(n);return this.instance.setPosition(n,e),n.style.width=t.w+"px",n.style.height=t.h+"px",this.instance.manage(n),this.placeholderInfo.id=i,this.placeholderInfo.element=n,n}},{key:"_cleanupDraggablePlaceholder",value:function(){this.placeholderInfo.element&&(this.instance.unmanage(this.placeholderInfo.element,!0),delete this.placeholderInfo.element,delete this.placeholderInfo.id)}},{key:"reset",value:function(){var e=this.instance.getContainer();this.instance.off(e,_t,this.mouseupHandler),this.instance.off(e,vt,this.mousedownHandler)}},{key:"init",value:function(e){}},{key:"startNewConnectionDrag",value:function(e,t){this.jpc=this.instance._newConnection({sourceEndpoint:this.ep,targetEndpoint:this.floatingEndpoint,source:this.ep.element,target:this.placeholderInfo.element,paintStyle:this.ep.connectorStyle,hoverPaintStyle:this.ep.connectorHoverStyle,connector:this.ep.connector,overlays:this.ep.connectorOverlays,type:this.ep.edgeType,cssClass:this.ep.connectorClass,hoverClass:this.ep.connectorHoverClass,scope:e,data:t}),this.jpc.pending=!0,this.jpc.addClass(this.instance.draggingClass),this.ep.addClass(this.instance.draggingClass),this.instance.fire(St,this.jpc)}},{key:"startExistingConnectionDrag",value:function(){this.existingJpc=!0,this.instance.setHover(this.jpc,!1);var e=this.jpc.endpoints[0].id===this.ep.id?0:1;this.ep.detachFromConnection(this.jpc,null,!0),this.floatingEndpoint.addConnection(this.jpc),this.instance.fire(St,this.jpc),this.instance.sourceOrTargetChanged(this.jpc.endpoints[e].elementId,this.placeholderInfo.id,this.jpc,this.placeholderInfo.element,e),this.jpc.suspendedEndpoint=this.jpc.endpoints[e],this.jpc.suspendedElement=this.jpc.endpoints[e].element,this.jpc.suspendedElementId=this.jpc.endpoints[e].elementId,this.jpc.suspendedElementType=0===e?ye:ge,this.instance.setHover(this.jpc.suspendedEndpoint,!1),this.floatingEndpoint.referenceEndpoint=this.jpc.suspendedEndpoint,this.floatingEndpoint.mergeParameters(this.jpc.suspendedEndpoint.parameters),this.jpc.endpoints[e]=this.floatingEndpoint,this.jpc.addClass(this.instance.draggingClass),this.floatingId=this.placeholderInfo.id,this.floatingIndex=e,this.instance._refreshEndpoint(this.ep)}},{key:"_shouldStartDrag",value:function(){var e=!0;this.ep.enabled||(e=!1),null!=this.jpc||this.ep.isSource||this.ep.isTemporarySource||(e=!1),!this.ep.isSource||!this.ep.isFull()||null!=this.jpc&&this.ep.dragAllowedWhenFull||(e=!1),null==this.jpc||this.jpc.isDetachable(this.ep)||(this.ep.isFull()?e=!1:this.jpc=null);var t={},n=this.instance.checkCondition(null==this.jpc?"beforeDrag":"beforeStartDetach",{endpoint:this.ep,source:this.ep.element,sourceId:this.ep.elementId,connection:this.jpc});return!1===n?e=!1:"object"===_(n)?x(t=n,this.payload||{}):t=this.payload||{},[e,t]}},{key:"_createFloatingEndpoint",value:function(e){var t=this.ep.endpoint;null!=this.ep.edgeType&&(t=this.instance._deriveEndpointAndAnchorSpec(this.ep.edgeType).endpoints[1]),this.floatingEndpoint=lo(this.ep,t,0,this.placeholderInfo.element,this.placeholderInfo.id,this.instance),this.floatingAnchor=this.floatingEndpoint._anchor,this.floatingEndpoint.deleteOnEmpty=!0,this.floatingElement=this.floatingEndpoint.endpoint.canvas,this.floatingId=this.instance.getId(this.floatingElement)}},{key:"_populateTargets",value:function(e,t){var n,i,o=this,r=this.jpc&&this.jpc.endpoints[0]===this.ep;if(j(this.instance.getContainer().querySelectorAll([".",De,"[",Ee,this.ep.scope,"]:not(.",Me,")"].join("")),(function(t){if(!(null==o.jpc&&t===e||t===o.floatingElement||null==o.jpc&&t.jtk.endpoint.isFull())&&(r&&t.jtk.endpoint.isSource||!r&&t.jtk.endpoint.isTarget)){var i=ue(t,o.instance),s=he(t,o.instance);n={x:i.x,y:i.y,w:s.w,h:s.h},o.endpointDropTargets.push({el:t,targetEl:t,r:n,endpoint:t.jtk.endpoint,def:null}),o.instance.addClass(t,bi)}})),r){var s=I(this.instance.sourceSelectors,(function(e){return e.isEnabled()&&(null==e.def.def.scope||e.def.def.scope===o.ep.scope)}));null!=s&&j(this._findTargetZones(s),(function(e){if(e.getAttribute(st)!==cn){var t=e.getAttribute(at);if(null!=t&&t!==o.ep.scope)return;var n={r:null,el:e};n.targetEl=ee(e,ze,o.instance.getContainer(),!0);var i=ue(n.el,o.instance),r=he(n.el,o.instance);n.r={x:i.x,y:i.y,w:r.w,h:r.h},null!=s.def.def.rank&&(n.rank=s.def.def.rank),n.def=s.def,o.endpointDropTargets.push(n),o.instance.addClass(n.targetEl,bi)}}))}else(function(e,t){var n=[];if(e)for(var i=0;i<e.length;i++)t(e[i])&&n.push(i);return n})(i=this.instance.targetSelectors,(function(e){return e.isEnabled()})).map((function(e){return i[e]})).forEach((function(e){j(o._findTargetZones(e),(function(n){if(n.getAttribute(st)!==cn){var i=n.getAttribute(at);if(null!=i&&i!==o.ep.scope)return;var r={r:null,el:n};if(null!=e.def.def.parentSelector&&(r.targetEl=ee(n,e.def.def.parentSelector,o.instance.getContainer(),!0)),null==r.targetEl&&(r.targetEl=ee(n,ze,o.instance.getContainer(),!0)),(!1===e.def.def.allowLoopback||o._activeDefinition&&!1===o._activeDefinition.def.def.allowLoopback)&&r.targetEl===o.ep.element)return;if(null!=e.def.def.canAcceptNewConnection&&!e.def.def.canAcceptNewConnection(r.targetEl,t))return;var s=e.def.def.maxConnections;if(null!=s&&-1!==s&&o.instance.select({target:r.targetEl}).length>=s)return;var a=ue(n,o.instance),l=he(n,o.instance);r.r={x:a.x,y:a.y,w:l.w,h:l.h},r.def=e.def,null!=e.def.def.rank&&(r.rank=e.def.def.rank),o.endpointDropTargets.push(r),o.instance.addClass(r.targetEl,bi)}}))}));this.endpointDropTargets.sort((function(e,t){if(e.targetEl._isJsPlumbGroup&&!t.targetEl._isJsPlumbGroup)return 1;if(!e.targetEl._isJsPlumbGroup&&t.targetEl._isJsPlumbGroup)return-1;if(e.targetEl._isJsPlumbGroup&&t.targetEl._isJsPlumbGroup){if(o.instance.groupManager.isAncestor(e.targetEl._jsPlumbGroup,t.targetEl._jsPlumbGroup))return-1;if(o.instance.groupManager.isAncestor(t.targetEl._jsPlumbGroup,e.targetEl._jsPlumbGroup))return 1}else{if(null==e.rank||null==t.rank)return 0;if(e.rank>t.rank)return-1;if(e.rank<t.rank)return 1}}))}},{key:"_findTargetZones",value:function(e){var t;if("any"===e.redrop){var n=this.instance.targetSelectors.map((function(e){return e.selector}));n.push.apply(n,g(this.instance.sourceSelectors.map((function(e){return e.selector})))),n.push(ze),t=n.join(",")}else if(e.redrop===ao)t=e.selector;else if("anySource"===e.redrop)t=this.instance.sourceSelectors.map((function(e){return e.selector})).join(",");else if("anyTarget"===e.redrop)t=this.instance.targetSelectors.map((function(e){return e.selector})).join(",");else if("anySourceOrTarget"===e.redrop){var i=this.instance.targetSelectors.map((function(e){return e.selector}));i.push.apply(i,g(this.instance.sourceSelectors.map((function(e){return e.selector})))),t=i.join(",")}return this.instance.getContainer().querySelectorAll(t)}},{key:"onStart",value:function(e){this.endpointDropTargets.length=0,this.currentDropTarget=null,this._stopped=!1;var t=e.drag.getDragElement();if(this.ep=t.jtk.endpoint,!this.ep)return!1;this.endpointRepresentation=this.ep.endpoint,this.canvasElement=this.endpointRepresentation.canvas,this.jpc=this.ep.connectorSelector();var n=f(this._shouldStartDrag(),2),i=n[0],o=n[1];if(!1===i)return this._stopped=!0,!1;this.instance.setHover(this.ep,!1),this.instance.isConnectionBeingDragged=!0,this.jpc&&!this.ep.isFull()&&this.ep.isSource&&(this.jpc=null),this._createFloatingEndpoint(this.canvasElement),this._populateTargets(this.canvasElement,e.e),null==this.jpc?this.startNewConnectionDrag(this.ep.scope,o):this.startExistingConnectionDrag(),this._registerFloatingConnection(this.placeholderInfo,this.jpc),this.instance.currentlyDragging=!0}},{key:"onBeforeStart",value:function(e){this.payload=e.e.payload||{}}},{key:"onDrag",value:function(e){if(this._stopped)return!0;if(this.placeholderInfo.element){var t=he(this.floatingElement,this.instance);this.instance.setElementPosition(this.placeholderInfo.element,e.pos.x,e.pos.y);for(var n,i,o={x:e.pos.x,y:e.pos.y,w:t.w,h:t.h},r=0;r<this.endpointDropTargets.length;r++)if(Yn(o,this.endpointDropTargets[r].r)){n=this.endpointDropTargets[r];break}n!==this.currentDropTarget&&null!=this.currentDropTarget&&(i=this._getFloatingAnchorIndex(),this.instance.removeClass(this.currentDropTarget.el,ki),this.currentDropTarget.endpoint&&(this.currentDropTarget.endpoint.endpoint.removeClass(this.instance.endpointDropAllowedClass),this.currentDropTarget.endpoint.endpoint.removeClass(this.instance.endpointDropForbiddenClass)),this.floatingAnchor.out()),null!=n&&(this.instance.addClass(n.el,ki),i=this._getFloatingAnchorIndex(),null!=n.endpoint&&(n.endpoint.isSource&&0===i||n.endpoint.isTarget&&0!==i||this.jpc.suspendedEndpoint&&n.endpoint.referenceEndpoint&&n.endpoint.referenceEndpoint.id===this.jpc.suspendedEndpoint.id?(this.instance.checkCondition("checkDropAllowed",{sourceEndpoint:this.jpc.endpoints[i],targetEndpoint:n.endpoint.endpoint,connection:this.jpc})?(n.endpoint.endpoint.addClass(this.instance.endpointDropAllowedClass),n.endpoint.endpoint.removeClass(this.instance.endpointDropForbiddenClass)):(n.endpoint.endpoint.removeClass(this.instance.endpointDropAllowedClass),n.endpoint.endpoint.addClass(this.instance.endpointDropForbiddenClass)),this.floatingAnchor.over(n.endpoint),this.instance._paintConnection(this.jpc)):n=null)),this.currentDropTarget=n}}},{key:"_maybeCleanup",value:function(e){e._mtNew&&0===e.connections.length?this.instance.deleteEndpoint(e):delete e._mtNew}},{key:"_reattachOrDiscard",value:function(e){var t=null!=this.jpc.suspendedEndpoint,n=this._getFloatingAnchorIndex();return t&&this._shouldReattach()?(0===n?(this.jpc.source=this.jpc.suspendedElement,this.jpc.sourceId=this.jpc.suspendedElementId):(this.jpc.target=this.jpc.suspendedElement,this.jpc.targetId=this.jpc.suspendedElementId),this._doForceReattach(n),!0):(this._discard(n,e),!1)}},{key:"onStop",value:function(e){var t=this,n=e.e;this.instance.isConnectionBeingDragged=!1,this.instance.currentlyDragging=!1;var i=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.join(" ")}(ki,bi);if(j(this.instance.getContainer().querySelectorAll(uo),(function(e){t.instance.removeClass(e,i)})),this.jpc&&null!=this.jpc.endpoints){var o,r=null!=this.jpc.suspendedEndpoint,s=this._getFloatingAnchorIndex(),a=this.jpc.suspendedEndpoint;if(null!=this.currentDropTarget)if(null==(o=this._getDropEndpoint(e,this.jpc)))this._reattachOrDiscard(e.e);else if(a&&a.id===o.id)this._doForceReattach(s);else if(o.enabled)if(o.isFull())o.fire(He,{endpoint:this,connection:this.jpc,maxConnections:this.instance.defaults.maxConnections},n),this._reattachOrDiscard(e.e);else{0===s?(this.jpc.source=o.element,this.jpc.sourceId=o.elementId):(this.jpc.target=o.element,this.jpc.targetId=o.elementId);var l=!0;r&&this.jpc.suspendedEndpoint.id!==o.id&&(this.jpc.isDetachAllowed(this.jpc)&&this.jpc.endpoints[s].isDetachAllowed(this.jpc)&&this.jpc.suspendedEndpoint.isDetachAllowed(this.jpc)&&this.instance.checkCondition("beforeDetach",this.jpc)||(l=!1)),(l=l&&o.isDropAllowed(this.jpc.sourceId,this.jpc.targetId,this.jpc.scope,this.jpc,o))?this._drop(o,s,n,l):this._reattachOrDiscard(e.e)}else this._reattachOrDiscard(e.e);else this._reattachOrDiscard(e.e);this.instance._refreshEndpoint(this.ep),this.ep.removeClass(this.instance.draggingClass),this._cleanupDraggablePlaceholder(),this.jpc.removeClass(this.instance.draggingClass),delete this.jpc.suspendedEndpoint,delete this.jpc.suspendedElement,delete this.jpc.suspendedElementType,delete this.jpc.suspendedElementId,delete this.jpc.suspendedIndex,delete this.floatingId,delete this.floatingIndex,delete this.floatingElement,delete this.floatingEndpoint,delete this.floatingAnchor,delete this.jpc.pending,null!=o&&this._maybeCleanup(o)}}},{key:"_getSourceDefinition",value:function(e){for(var t,n=this.instance.getContainer(),i=0;i<this.instance.sourceSelectors.length;i++)if((t=this.instance.sourceSelectors[i]).isEnabled()&&!1!==co(e,n,t.selector,this.instance,t.exclude))return t}},{key:"_getDropEndpoint",value:function(e,t){var n;if(null==this.currentDropTarget.endpoint){var i=this.currentDropTarget.def,o=e.e.target||e.e.srcElement;if(null==i)return null;var r=this.currentDropTarget.targetEl,s=Or(e.e,r,this.instance.currentZoom),a=this.instance._deriveEndpointAndAnchorSpec(t.getType().join(" "),!0),l=a.endpoints?x(e,{endpoint:i.def.endpoint||a.endpoints[1],cssClass:i.def.cssClass||"",source:!0===i.def.source,target:!0===i.def.target}):e,c=this.instance.validAnchorsSpec(a.anchors)?a.anchors:this.instance.areDefaultAnchorsSet()?this.instance.defaults.anchors:null,u=i.def.anchor,h=i.def.anchorPositionFinder?i.def.anchorPositionFinder(r,s,i.def,e.e):null,d=null!=h?h:null!=u?u:null!=c&&null!=c[1]?c[1]:null;if(null!=d&&(l=x(l,{anchor:d})),null!=i.def.portId&&(l.portId=i.def.portId),(l=D(l,i.def.parameterExtractor?i.def.parameterExtractor(this.currentDropTarget.el,o,e.e):{})).element=r,(n=this.instance._internal_newEndpoint(l))._mtNew=!0,n.deleteOnEmpty=!0,i.def.parameters&&n.mergeParameters(i.def.parameters),i.def.extract){var p={};for(var f in i.def.extract){var v=this.currentDropTarget.el.getAttribute(f);v&&(p[i.def.extract[f]]=v)}n.mergeParameters(p)}}else n=this.currentDropTarget.endpoint;return n&&(n.removeClass(this.instance.endpointDropAllowedClass),n.removeClass(this.instance.endpointDropForbiddenClass)),n}},{key:"_doForceReattach",value:function(e){this.floatingEndpoint.detachFromConnection(this.jpc,null,!0),this.jpc.endpoints[e]=this.jpc.suspendedEndpoint,this.instance.setHover(this.jpc,!1),this.jpc._forceDetach=!0,this.jpc.suspendedEndpoint.addConnection(this.jpc),this.instance.sourceOrTargetChanged(this.floatingId,this.jpc.suspendedEndpoint.elementId,this.jpc,this.jpc.suspendedEndpoint.element,e),this.instance.deleteEndpoint(this.floatingEndpoint),this.instance.repaint(this.jpc.source),delete this.jpc._forceDetach}},{key:"_shouldReattach",value:function(){if(this.jpc.isReattach()||this.jpc._forceReattach)return!0;var e=this.jpc.suspendedEndpoint,t=this.jpc.suspendedElementType==ye?1:0,n=this.jpc.endpoints[t];return!M(!0,!1,[[e,Ye,[this.jpc]],[n,Ye,[this.jpc]],[this.jpc,Ye,[this.jpc]],[this.instance,Pe,[Ve,this.jpc]]])}},{key:"_discard",value:function(e,t){this.jpc.pending?this.instance.fire("connection:abort",this.jpc,t):(0===e?(this.jpc.source=this.jpc.suspendedEndpoint.element,this.jpc.sourceId=this.jpc.suspendedEndpoint.elementId):(this.jpc.target=this.jpc.suspendedEndpoint.element,this.jpc.targetId=this.jpc.suspendedEndpoint.elementId),this.jpc.endpoints[e]=this.jpc.suspendedEndpoint),this.floatingEndpoint&&this.floatingEndpoint.detachFromConnection(this.jpc),this.instance.deleteConnection(this.jpc,{originalEvent:t,force:!0})}},{key:"_drop",value:function(e,t,n,i){if(this.jpc.endpoints[t].detachFromConnection(this.jpc),this.jpc.suspendedEndpoint&&this.jpc.suspendedEndpoint.detachFromConnection(this.jpc),this.jpc.endpoints[t]=e,e.addConnection(this.jpc),this.jpc.suspendedEndpoint){var o=this.jpc.suspendedEndpoint.elementId;this.instance.fireMoveEvent({index:t,originalSourceId:0===t?o:this.jpc.sourceId,newSourceId:0===t?e.elementId:this.jpc.sourceId,originalTargetId:1===t?o:this.jpc.targetId,newTargetId:1===t?e.elementId:this.jpc.targetId,originalEndpoint:this.jpc.suspendedEndpoint,connection:this.jpc,newEndpoint:e},n)}1===t?this.instance.sourceOrTargetChanged(this.floatingId,this.jpc.targetId,this.jpc,this.jpc.target,1):this.instance.sourceOrTargetChanged(this.floatingId,this.jpc.sourceId,this.jpc,this.jpc.source,0),this.jpc.endpoints[0].finalEndpoint&&(this.jpc.endpoints[0].detachFromConnection(this.jpc),this.jpc.endpoints[0]=this.jpc.endpoints[0].finalEndpoint,this.jpc.endpoints[0].addConnection(this.jpc)),E(i)&&this.jpc.mergeData(i),this._originalAnchorSpec&&(this.jpc.endpoints[0].setAnchor(this._originalAnchorSpec),this._originalAnchorSpec=null),this.instance._finaliseConnection(this.jpc,null,n),this.instance.setHover(this.jpc,!1),this.instance.revalidate(this.jpc.endpoints[0].element)}},{key:"_registerFloatingConnection",value:function(e,t){this.floatingConnections[e.id]=t}},{key:"_getFloatingAnchorIndex",value:function(){return null==this.floatingIndex?1:this.floatingIndex}}]),fo=function(e){function t(e,n){var i;return r(this,t),(i=o(this,t,[e,n])).instance=e,i.dragSelection=n,l(i,"selector",[">",Qt,ze].join(" ")),l(i,"doRevalidate",void 0),i.doRevalidate=i._revalidate.bind(i),i}return h(t,e),a(t,[{key:"reset",value:function(){this.drag.off(Ct,this.doRevalidate)}},{key:"_revalidate",value:function(e){this.instance.revalidate(e)}},{key:"init",value:function(e){this.drag=e,e.on(Ct,this.doRevalidate)}},{key:"useGhostProxy",value:function(e,t){var n=t._jsPlumbParentGroup;return null!=n&&!0===n.ghost}},{key:"makeGhostProxy",value:function(e){var t=e,n=t.cloneNode(!0);return n._jsPlumbParentGroup=t._jsPlumbParentGroup,n}}])}(Si),vo=a((function e(t,n){r(this,e),this.instance=t,this.overlay=n,l(this,"htmlElementOverlay",void 0),this.htmlElementOverlay=n}),null,[{key:"getElement",value:function(e,t,n){if(null==e.canvas){if(n&&t){e.canvas=n(t);var i=e.instance.overlayClass+" "+(e.cssClass?e.cssClass:"");e.instance.addClass(e.canvas,i)}else e.canvas=ae("div",{},e.instance.overlayClass+" "+(e.cssClass?e.cssClass:""));for(var o in e.instance.setAttribute(e.canvas,"jtk-overlay-id",e.id),e.attributes)e.instance.setAttribute(e.canvas,o,e.attributes[o]);e.canvas.style.position=be,e.instance._appendElement(e.canvas,e.instance.getContainer()),e.instance.getId(e.canvas);var r="translate(-50%, -50%)";e.canvas.style.webkitTransform=r,e.canvas.style.mozTransform=r,e.canvas.style.msTransform=r,e.canvas.style.oTransform=r,e.canvas.style.transform=r,e.isVisible()||(e.canvas.style.display=_e),e.canvas.jtk={overlay:e}}return e.canvas}},{key:"destroy",value:function(e){e.canvas&&e.canvas.parentNode&&e.canvas.parentNode.removeChild(e.canvas),delete e.canvas,delete e.cachedDimensions}},{key:"_getDimensions",value:function(e,t){return(null==e.cachedDimensions||t)&&(e.cachedDimensions={w:1,h:1}),e.cachedDimensions}}]),yo=a((function e(){r(this,e),l(this,"_listeners",{}),l(this,"eventsSuspended",!1),l(this,"tick",!1),l(this,"eventsToDieOn",{ready:!0}),l(this,"queue",[])}),[{key:"fire",value:function(e,t,n){var i=null;if(this.tick)this.queue.unshift(arguments);else{if(this.tick=!0,!this.eventsSuspended&&this._listeners[e]){var o=this._listeners[e].length,r=0,s=!1;if(!this.shouldFireEvent||this.shouldFireEvent(e,t,n))for(;!s&&r<o&&!1!==i;){if(this.eventsToDieOn[e])this._listeners[e][r](t,n);else try{i=this._listeners[e][r](t,n)}catch(t){z("jsPlumb: fire failed for event "+e+" : "+(t.message||t))}r++,null!=this._listeners&&null!=this._listeners[e]||(s=!0)}}this.tick=!1,this._drain()}return i}},{key:"_drain",value:function(){var e=this.queue.pop();e&&this.fire.apply(this,e)}},{key:"unbind",value:function(e,t){if(0===arguments.length)this._listeners={};else if(1===arguments.length){if("string"==typeof e)delete this._listeners[e];else if(e.__jsPlumb){var n;for(var i in e.__jsPlumb)n=e.__jsPlumb[i],G(this._listeners[n]||[],e)}}else 2===arguments.length&&G(this._listeners[e]||[],t);return this}},{key:"getListener",value:function(e){return this._listeners[e]||[]}},{key:"isSuspendEvents",value:function(){return this.eventsSuspended}},{key:"setSuspendEvents",value:function(e){this.eventsSuspended=e}},{key:"bind",value:function(e,t,n){var i=this,o=function(e){R(i._listeners,e,t,n),t.__jsPlumb=t.__jsPlumb||{},t.__jsPlumb[X()]=e};if("string"==typeof e)o(e);else if(null!=e.length)for(var r=0;r<e.length;r++)o(e[r]);return this}},{key:"silently",value:function(e){this.setSuspendEvents(!0);try{e()}catch(e){z("Cannot execute silent function "+e)}this.setSuspendEvents(!1)}}]);!function(e){function t(){return r(this,t),o(this,t,arguments)}h(t,e),a(t,[{key:"shouldFireEvent",value:function(e,t,n){return!0}}])}(yo);function go(e){var t=null;return(t=S(e)?{type:e,options:{}}:e).options.id=t.options.id||X(),t}var mo=function(e){function t(e,n,i){var s;for(var a in r(this,t),(s=o(this,t)).instance=e,s.component=n,l(s,"id",void 0),l(s,"type",void 0),l(s,"cssClass",void 0),l(s,"visible",!0),l(s,"location",void 0),l(s,"events",void 0),l(s,"attributes",void 0),i=i||{},s.id=i.id||X(),s.cssClass=i.cssClass||"",s.setLocation(i.location),s.events=i.events||{},s.attributes=i.attributes||{},s.events)s.bind(a,s.events[a]);return s}return h(t,e),a(t,[{key:"setLocation",value:function(e){var t=null==this.location?.5:this.location;if(null!=e)try{var n="string"==typeof e?parseFloat(e):e;isNaN(n)||(t=n)}catch(e){}this.location=t}},{key:"shouldFireEvent",value:function(e,t,n){return!0}},{key:"setVisible",value:function(e){this.visible=e,this.instance.setOverlayVisible(this,e)}},{key:"isVisible",value:function(){return this.visible}}])}(yo),_o={},bo=function(e,t,n,i){var o=_o[t];if(o)return new o(e,n,i);throw{message:"jsPlumb: unknown overlay type '"+t+"'"}},ko=function(e,t){_o[e]=t},xo=function(e){function t(e,n,i){var s;return r(this,t),(s=o(this,t,[e,n,i])).instance=e,s.component=n,l(s,"label",void 0),l(s,"labelText",void 0),l(s,"type",t.type),l(s,"cachedDimensions",void 0),i=i||{label:""},s.setLabel(i.label),s}return h(t,e),a(t,[{key:"getLabel",value:function(){return P(this.label)?this.label(this):this.labelText}},{key:"setLabel",value:function(e){this.label=e,this.labelText=null,this.instance.updateLabel(this)}},{key:"getDimensions",value:function(){return{w:1,h:1}}},{key:"updateFrom",value:function(e){null!=e.label&&this.setLabel(e.label),null!=e.location&&(this.setLocation(e.location),this.instance.updateLabel(this))}}])}(mo);function Co(e){return e.type===xo.type}function So(e){return null==e?null:e.split(" ").filter((function(e){return null!=e&&e.length>0}))}function wo(e,t,n){for(var i in t)e[i]=n}l(xo,"type","Label"),ko(xo.type,xo);var Eo="__default",Po="__label",Ao="overlay",Do="remove";function Mo(e,t){if(e.getDefaultType){var n=e.getTypeDescriptor(),i={},o=e.getDefaultType(),r=x({},o);wo(i,o,Eo),e._types.forEach((function(t){if(t!==Eo){var o=e.instance.getType(t,n);if(null!=o){var s=new Set(["connector","anchor","anchors"]);if("override"===o.mergeStrategy)for(var a in o)s.add(a);r=D(r,o,["cssClass"],(l=[],s.forEach((function(e){l.push(e)})),l)),wo(i,o,t)}}var l})),t&&(r=T(r,t,"_")),e.applyType(r,i)}}function To(e,t){var n=e.instance.getType(t,e.getTypeDescriptor());null!=n&&n.cssClass&&e.removeClass(n.cssClass)}function jo(e){if(e.paintStyle&&e.hoverPaintStyle){var t={};x(t,e.paintStyle),x(t,e.hoverPaintStyle),e.hoverPaintStyle=t}}var Oo=function(e){function t(e,n){var i;if(r(this,t),(i=o(this,t)).instance=e,l(i,"defaultLabelLocation",.5),l(i,"overlays",{}),l(i,"overlayPositions",{}),l(i,"overlayPlacements",{}),l(i,"clone",void 0),l(i,"deleted",void 0),l(i,"segment",void 0),l(i,"x",void 0),l(i,"y",void 0),l(i,"w",void 0),l(i,"h",void 0),l(i,"id",void 0),l(i,"visible",!0),l(i,"typeId",void 0),l(i,"params",{}),l(i,"paintStyle",void 0),l(i,"hoverPaintStyle",void 0),l(i,"paintStyleInUse",void 0),l(i,"_hover",!1),l(i,"lastPaintedAt",void 0),l(i,"data",void 0),l(i,"_defaultType",void 0),l(i,"events",void 0),l(i,"parameters",void 0),l(i,"_types",void 0),l(i,"_typeCache",void 0),l(i,"cssClass",void 0),l(i,"hoverClass",void 0),l(i,"beforeDetach",void 0),l(i,"beforeDrop",void 0),n=n||{},i.cssClass=n.cssClass||"",i.hoverClass=n.hoverClass||e.defaults.hoverClass,i.beforeDetach=n.beforeDetach,i.beforeDrop=n.beforeDrop,i._types=new Set,i._typeCache={},i.parameters=A(n.parameters||{}),i.id=n.id||i.getIdPrefix()+(new Date).getTime(),i._defaultType={parameters:i.parameters,scope:n.scope||i.instance.defaultScope,overlays:{}},n.events)for(var s in n.events)i.bind(s,n.events[s]);i.clone=function(){var t=Object.create(i.constructor.prototype);return i.constructor.apply(t,[e,n]),t},i.overlays={},i.overlayPositions={};var a=n.overlays||[],c={},u=i.getDefaultOverlayKey();if(u){var h=i.instance.defaults[u];h&&a.push.apply(a,g(h));for(var d=0;d<a.length;d++){var p=go(a[d]);c[p.options.id]=p}}return i._defaultType.overlays=c,n.label&&(i.getDefaultType().overlays.__label={type:xo.type,options:{label:n.label,location:n.labelLocation||i.defaultLabelLocation,id:Po,cssClass:"jtk-default-label"}}),i}return h(t,e),a(t,[{key:"isDetachAllowed",value:function(e){var t=!0;if(this.beforeDetach)try{t=this.beforeDetach(e)}catch(e){z("jsPlumb: beforeDetach callback failed",e)}return t}},{key:"isDropAllowed",value:function(e,t,n,i,o){var r,s={sourceId:e,targetId:t,scope:n,connection:i,dropEndpoint:o};if(this.beforeDrop)try{r=this.beforeDrop(s)}catch(e){z("jsPlumb: beforeDrop callback failed",e)}else r=this.instance.checkCondition(Ke,s);return r}},{key:"getDefaultType",value:function(){return this._defaultType}},{key:"appendToDefaultType",value:function(e){for(var t in e)this._defaultType[t]=e[t]}},{key:"getId",value:function(){return this.id}},{key:"cacheTypeItem",value:function(e,t,n){this._typeCache[n]=this._typeCache[n]||{},this._typeCache[n][e]=t}},{key:"getCachedTypeItem",value:function(e,t){return this._typeCache[t]?this._typeCache[t][e]:null}},{key:"setType",value:function(e,t){this.clearTypes(),(So(e)||[]).forEach(this._types.add,this._types),Mo(this,t)}},{key:"getType",value:function(){return Array.from(this._types.keys())}},{key:"reapplyTypes",value:function(e){Mo(this,e)}},{key:"hasType",value:function(e){return this._types.has(e)}},{key:"addType",value:function(e,t){var n=So(e),i=!1;if(null!=n){for(var o=0,r=n.length;o<r;o++)this._types.has(n[o])||(this._types.add(n[o]),i=!0);i&&Mo(this,t)}}},{key:"removeType",value:function(e,t){var n,i=this,o=So(e),r=!1;if(null!=o){for(var s=0,a=o.length;s<a;s++)n=o[s],r=!!i._types.has(n)&&(To(i,n),i._types.delete(n),!0)||r;r&&Mo(this,t)}}},{key:"clearTypes",value:function(e){var t=this;this._types.forEach((function(e){To(t,e)})),this._types.clear(),Mo(this,e)}},{key:"toggleType",value:function(e,t){var n=So(e);if(null!=n){for(var i=0,o=n.length;i<o;i++)this._types.has(n[i])?(To(this,n[i]),this._types.delete(n[i])):this._types.add(n[i]);Mo(this,t)}}},{key:"applyType",value:function(e,t){if(this.setPaintStyle(e.paintStyle),this.setHoverPaintStyle(e.hoverPaintStyle),this.mergeParameters(e.parameters),this.paintStyleInUse=this.getPaintStyle(),e.overlays){var n,i={};for(n in e.overlays){var o=this.overlays[e.overlays[n].options.id];if(o)o.updateFrom(e.overlays[n].options),i[e.overlays[n].options.id]=!0,this.instance.reattachOverlay(o,this);else{var r=this.getCachedTypeItem(Ao,e.overlays[n].options.id);null!=r?(this.instance.reattachOverlay(r,this),r.setVisible(!0),r.updateFrom(e.overlays[n].options),this.overlays[r.id]=r):r=this.addOverlay(e.overlays[n]),i[r.id]=!0}}for(n in this.overlays)null==i[this.overlays[n].id]&&this.removeOverlay(this.overlays[n].id,!0)}}},{key:"setPaintStyle",value:function(e){this.paintStyle=e,this.paintStyleInUse=this.paintStyle,jo(this)}},{key:"getPaintStyle",value:function(){return this.paintStyle}},{key:"setHoverPaintStyle",value:function(e){this.hoverPaintStyle=e,jo(this)}},{key:"getHoverPaintStyle",value:function(){return this.hoverPaintStyle}},{key:"destroy",value:function(){for(var e in this.overlays)this.instance.destroyOverlay(this.overlays[e]);this.overlays={},this.overlayPositions={},this.unbind(),this.clone=null}},{key:"isHover",value:function(){return this._hover}},{key:"mergeParameters",value:function(e){null!=e&&x(this.parameters,e)}},{key:"setVisible",value:function(e){this.visible=e,e?this.showOverlays():this.hideOverlays()}},{key:"isVisible",value:function(){return this.visible}},{key:"setAbsoluteOverlayPosition",value:function(e,t){this.overlayPositions[e.id]=t}},{key:"getAbsoluteOverlayPosition",value:function(e){return this.overlayPositions?this.overlayPositions[e.id]:null}},{key:"_clazzManip",value:function(e,t){for(var n in this.overlays)"add"===e?this.instance.addOverlayClass(this.overlays[n],t):e===Do&&this.instance.removeOverlayClass(this.overlays[n],t)}},{key:"addClass",value:function(e,t){var n=(this.cssClass||"").split(" ");n.push(e),this.cssClass=n.join(" "),this._clazzManip("add",e)}},{key:"removeClass",value:function(e,t){var n=(this.cssClass||"").split(" ");this.cssClass=n.filter((function(t){return t!==e})).join(" "),this._clazzManip(Do,e)}},{key:"getClass",value:function(){return this.cssClass}},{key:"shouldFireEvent",value:function(e,t,n){return!0}},{key:"getData",value:function(){return this.data}},{key:"setData",value:function(e){this.data=e||{}}},{key:"mergeData",value:function(e){this.data=x(this.data,e)}},{key:"addOverlay",value:function(e){var t=function(e,t){var n=null;if(S(t))n=bo(e.instance,t,e,{});else if(null!=t.type&&null!=t.options){var i=t,o=x({},i.options);n=bo(e.instance,i.type,e,o)}else n=t;return n.id=n.id||X(),e.cacheTypeItem(Ao,n,n.id),e.overlays[n.id]=n,n}(this,e);if(this.getData&&t.type===xo.type&&!S(e)){var n=this.getData(),i=e.options;if(n){var o=n[i.labelLocationAttribute||"labelLocation"];o&&(t.location=o)}}return t}},{key:"getOverlay",value:function(e){return this.overlays[e]}},{key:"getOverlays",value:function(){return this.overlays}},{key:"hideOverlay",value:function(e){var t=this.getOverlay(e);t&&t.setVisible(!1)}},{key:"hideOverlays",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var i in t=t||[],this.overlays)0!==t.length&&-1===t.indexOf(i)||this.overlays[i].setVisible(!1)}},{key:"showOverlay",value:function(e){var t=this.getOverlay(e);t&&t.setVisible(!0)}},{key:"showOverlays",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var i in t=t||[],this.overlays)0!==t.length&&-1===t.indexOf(i)||this.overlays[i].setVisible(!0)}},{key:"removeAllOverlays",value:function(){for(var e in this.overlays)this.instance.destroyOverlay(this.overlays[e]);this.overlays={},this.overlayPositions=null,this.overlayPlacements={}}},{key:"removeOverlay",value:function(e,t){var n=this.overlays[e];n&&(n.setVisible(!1),t||this.instance.destroyOverlay(n),delete this.overlays[e],this.overlayPositions&&delete this.overlayPositions[e],this.overlayPlacements&&delete this.overlayPlacements[e])}},{key:"removeOverlays",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var i=0,o=t.length;i<o;i++)this.removeOverlay(arguments[i])}},{key:"getLabel",value:function(){var e=this.getLabelOverlay();return null!=e?e.getLabel():null}},{key:"getLabelOverlay",value:function(){return this.getOverlay(Po)}},{key:"setLabel",value:function(e){var t,n,i,o=this.getLabelOverlay();if(o)if(S(e)||P(e))o.setLabel(e);else{var r=e;r.label&&o.setLabel(r.label),r.location&&(o.location=r.location)}else{var s=S(e)||P(e)?{label:e}:e;t=this,i=x({cssClass:(n=s).cssClass,id:Po,component:t},n),o=new xo(t.instance,t,i),this.overlays.__label=o}}}])}(yo),Io=["connectorStyle","connectorHoverStyle","connectorOverlays","connector","connectionType","connectorClass","connectorHoverClass"],Lo=function(e){function t(e,n){var i;r(this,t),(i=o(this,t,[e,n])).instance=e,l(i,"connections",[]),l(i,"endpoint",void 0),l(i,"element",void 0),l(i,"elementId",void 0),l(i,"dragAllowedWhenFull",!0),l(i,"timestamp",void 0),l(i,"portId",void 0),l(i,"maxConnections",void 0),l(i,"proxiedBy",void 0),l(i,"connectorClass",void 0),l(i,"connectorHoverClass",void 0),l(i,"finalEndpoint",void 0),l(i,"enabled",!0),l(i,"isSource",void 0),l(i,"isTarget",void 0),l(i,"isTemporarySource",void 0),l(i,"connectionCost",1),l(i,"connectionsDirected",void 0),l(i,"connectionsDetachable",void 0),l(i,"reattachConnections",void 0),l(i,"currentAnchorClass",void 0),l(i,"referenceEndpoint",void 0),l(i,"edgeType",void 0),l(i,"connector",void 0),l(i,"connectorOverlays",void 0),l(i,"connectorStyle",void 0),l(i,"connectorHoverStyle",void 0),l(i,"deleteOnEmpty",void 0),l(i,"uuid",void 0),l(i,"scope",void 0),l(i,"_anchor",void 0),l(i,"defaultLabelLocation",[.5,.5]),i.appendToDefaultType({edgeType:n.edgeType,maxConnections:null==n.maxConnections?i.instance.defaults.maxConnections:n.maxConnections,paintStyle:n.paintStyle||i.instance.defaults.endpointStyle,hoverPaintStyle:n.hoverPaintStyle||i.instance.defaults.endpointHoverStyle,connectorStyle:n.connectorStyle,connectorHoverStyle:n.connectorHoverStyle,connectorClass:n.connectorClass,connectorHoverClass:n.connectorHoverClass,connectorOverlays:n.connectorOverlays,connector:n.connector}),i.enabled=!(!1===n.enabled),i.visible=!0,i.element=n.element,i.uuid=n.uuid,i.portId=n.portId,i.elementId=n.elementId,i.connectionCost=null==n.connectionCost?1:n.connectionCost,i.connectionsDirected=n.connectionsDirected,i.currentAnchorClass="",i.events={},i.connectorOverlays=n.connectorOverlays,i.connectorStyle=n.connectorStyle,i.connectorHoverStyle=n.connectorHoverStyle,i.connector=n.connector,i.edgeType=n.edgeType,i.connectorClass=n.connectorClass,i.connectorHoverClass=n.connectorHoverClass,i.deleteOnEmpty=!0===n.deleteOnEmpty,i.isSource=n.source||!1,i.isTemporarySource=n.isTemporarySource||!1,i.isTarget=n.target||!1,i.connections=n.connections||[],i.scope=n.scope||e.defaultScope,i.timestamp=null,i.reattachConnections=n.reattachConnections||e.defaults.reattachConnections,i.connectionsDetachable=e.defaults.connectionsDetachable,!1===n.connectionsDetachable&&(i.connectionsDetachable=!1),i.dragAllowedWhenFull=!1!==n.dragAllowedWhenFull,n.onMaxConnections&&i.bind(He,n.onMaxConnections);var s=n.endpoint||n.existingEndpoint||e.defaults.endpoint;if(i.setEndpoint(s),null!=n.preparedAnchor)i.setPreparedAnchor(n.preparedAnchor);else{var a=n.anchor?n.anchor:n.anchors?n.anchors:e.defaults.anchor||on.Top;i.setAnchor(a)}var c=[an,n.type||""].join(" ");return i.addType(c,n.data),i}return h(t,e),a(t,[{key:"getIdPrefix",value:function(){return"_jsplumb_e"}},{key:"getTypeDescriptor",value:function(){return"endpoint"}},{key:"getXY",value:function(){return{x:this.endpoint.x,y:this.endpoint.y}}},{key:"getDefaultOverlayKey",value:function(){return"endpointOverlays"}},{key:"_updateAnchorClass",value:function(){var e=this._anchor&&this._anchor.cssClass;if(null!=e&&e.length>0){var t=this.instance.endpointAnchorClassPrefix+"-"+this.currentAnchorClass;this.currentAnchorClass=e;var n=this.instance.endpointAnchorClassPrefix+(this.currentAnchorClass?"-"+this.currentAnchorClass:"");t!==n&&(this.removeClass(t),this.addClass(n),this.instance.removeClass(this.element,t),this.instance.addClass(this.element,n))}}},{key:"setPreparedAnchor",value:function(e){return this.instance.router.setAnchor(this,e),this._updateAnchorClass(),this}},{key:"_anchorLocationChanged",value:function(e){this.fire("anchor:changed",{endpoint:this,anchor:e}),this._updateAnchorClass()}},{key:"setAnchor",value:function(e){var t=this.instance.router.prepareAnchor(e);return this.setPreparedAnchor(t),this}},{key:"addConnection",value:function(e){this.connections.push(e),this.instance._refreshEndpoint(this)}},{key:"detachFromConnection",value:function(e,t,n){(t=null==t?this.connections.indexOf(e):t)>=0&&(this.connections.splice(t,1),this.instance._refreshEndpoint(this)),!n&&this.deleteOnEmpty&&0===this.connections.length&&this.instance.deleteEndpoint(this)}},{key:"deleteEveryConnection",value:function(e){for(var t=this.connections.length,n=0;n<t;n++)this.instance.deleteConnection(this.connections[0],e)}},{key:"detachFrom",value:function(e){for(var t=[],n=0;n<this.connections.length;n++)this.connections[n].endpoints[1]!==e&&this.connections[n].endpoints[0]!==e||t.push(this.connections[n]);for(var i=0,o=t.length;i<o;i++)this.instance.deleteConnection(t[0]);return this}},{key:"setVisible",value:function(e,n,i){if(y(t,"setVisible",this,3)([e]),this.endpoint.setVisible(e),e?this.showOverlays():this.hideOverlays(),!n)for(var o=0;o<this.connections.length;o++)if(this.connections[o].setVisible(e),!i){var r=this===this.connections[o].endpoints[0]?1:0;1===this.connections[o].endpoints[r].connections.length&&this.connections[o].endpoints[r].setVisible(e,!0,!0)}}},{key:"applyType",value:function(e,n){y(t,"applyType",this,3)([e,n]),this.setPaintStyle(e.endpointStyle||e.paintStyle),this.setHoverPaintStyle(e.endpointHoverStyle||e.hoverPaintStyle),this.connectorStyle=e.connectorStyle,this.connectorHoverStyle=e.connectorHoverStyle,this.connector=e.connector,this.connectorOverlays=e.connectorOverlays,this.edgeType=e.edgeType,null!=e.maxConnections&&(this.maxConnections=e.maxConnections),e.scope&&(this.scope=e.scope),x(e,Io),this.instance.applyEndpointType(this,e)}},{key:"destroy",value:function(){y(t,"destroy",this,3)([]),this.deleted=!0,null!=this.endpoint&&this.instance.destroyEndpoint(this)}},{key:"isFull",value:function(){return 0===this.maxConnections||!(this.isFloating()||this.maxConnections<0||this.connections.length<this.maxConnections)}},{key:"isFloating",value:function(){return this.instance.router.isFloating(this)}},{key:"isConnectedTo",value:function(e){var t=!1;if(e)for(var n=0;n<this.connections.length;n++)if(this.connections[n].endpoints[1]===e||this.connections[n].endpoints[0]===e){t=!0;break}return t}},{key:"setDragAllowedWhenFull",value:function(e){this.dragAllowedWhenFull=e}},{key:"getUuid",value:function(){return this.uuid}},{key:"connectorSelector",value:function(){return this.connections[0]}},{key:"prepareEndpoint",value:function(e,t){var n,i={cssClass:this.cssClass,endpoint:this};if(Z(e,Di)){var o=e;(n=Ai.clone(o)).classes=i.cssClass.split(" ")}else if(S(e))n=Ai.get(this,e,i);else{var r=e;x(i,r.options||{}),n=Ai.get(this,r.type,i)}return n.typeId=t,n}},{key:"setEndpoint",value:function(e){var t=this.prepareEndpoint(e);this.setPreparedEndpoint(t)}},{key:"setPreparedEndpoint",value:function(e){null!=this.endpoint&&this.instance.destroyEndpoint(this),this.endpoint=e}},{key:"addClass",value:function(e,n){y(t,"addClass",this,3)([e,n]),null!=this.endpoint&&this.endpoint.addClass(e)}},{key:"removeClass",value:function(e,n){y(t,"removeClass",this,3)([e,n]),null!=this.endpoint&&this.endpoint.removeClass(e)}}])}(Oo),No="anchors",Fo="connector";function Go(e,t,n,i,o,r,s){var a;if(t)e.endpoints[n]=t,t.addConnection(e);else{var l=s||e.endpointSpec||e.endpointsSpec[n]||e.instance.defaults.endpoints[n]||e.instance.defaults.endpoint,c=e.endpointStyles[n]||e.endpointStyle||e.instance.defaults.endpointStyles[n]||e.instance.defaults.endpointStyle;null==c.fill&&null!=e.paintStyle&&(c.fill=e.paintStyle.stroke),null==c.outlineStroke&&null!=e.paintStyle&&(c.outlineStroke=e.paintStyle.outlineStroke),null==c.outlineWidth&&null!=e.paintStyle&&(c.outlineWidth=e.paintStyle.outlineWidth);var u=e.endpointHoverStyles[n]||e.endpointHoverStyle||e.endpointHoverStyle||e.instance.defaults.endpointHoverStyles[n]||e.instance.defaults.endpointHoverStyle;null!=e.hoverPaintStyle&&(null==u&&(u={}),null==u.fill&&(u.fill=e.hoverPaintStyle.stroke));var h=e.uuids?e.uuids[n]:null;i=null!=i?i:null!=e.instance.defaults.anchors?e.instance.defaults.anchors[n]:e.instance.defaults.anchor,a=e.instance._internal_newEndpoint({paintStyle:c,hoverPaintStyle:u,endpoint:l,connections:[e],uuid:h,element:o,scope:e.scope,anchor:i,reattachConnections:e.reattach||e.instance.defaults.reattachConnections,connectionsDetachable:e.detachable||e.instance.defaults.connectionsDetachable}),e.instance._refreshEndpoint(a),null==t&&(a.deleteOnEmpty=!0),e.endpoints[n]=a}return a}var Ro=function(e){function t(e,n){var i;r(this,t),(i=o(this,t,[e,n])).instance=e,l(i,"connector",void 0),l(i,"defaultLabelLocation",.5),l(i,"scope",void 0),l(i,"typeId","_jsplumb_connection"),l(i,"previousConnection",void 0),l(i,"sourceId",void 0),l(i,"targetId",void 0),l(i,"source",void 0),l(i,"target",void 0),l(i,"detachable",!0),l(i,"reattach",!1),l(i,"uuids",void 0),l(i,"cost",1),l(i,"directed",void 0),l(i,"endpoints",[null,null]),l(i,"endpointStyles",void 0),l(i,"endpointSpec",void 0),l(i,"endpointsSpec",void 0),l(i,"endpointStyle",{}),l(i,"endpointHoverStyle",{}),l(i,"endpointHoverStyles",void 0),l(i,"suspendedEndpoint",void 0),l(i,"suspendedIndex",void 0),l(i,"suspendedElement",void 0),l(i,"suspendedElementId",void 0),l(i,"suspendedElementType",void 0),l(i,"_forceReattach",void 0),l(i,"_forceDetach",void 0),l(i,"proxies",[]),l(i,"pending",!1),i.id=n.id,i.previousConnection=n.previousConnection,i.source=n.source,i.target=n.target,n.sourceEndpoint?(i.source=n.sourceEndpoint.element,i.sourceId=n.sourceEndpoint.elementId):i.sourceId=e.getId(i.source),n.targetEndpoint?(i.target=n.targetEndpoint.element,i.targetId=n.targetEndpoint.elementId):i.targetId=e.getId(i.target),i.scope=n.scope;var s=n.anchors?n.anchors[0]:n.anchor,a=n.anchors?n.anchors[1]:n.anchor;e.manage(i.source),e.manage(i.target),i.visible=!0,i.params={cssClass:n.cssClass,hoverClass:n.hoverClass,"pointer-events":n["pointer-events"],overlays:n.overlays},i.lastPaintedAt=null,n.type&&(n.endpoints=n.endpoints||i.instance._deriveEndpointAndAnchorSpec(n.type).endpoints),i.endpointSpec=n.endpoint,i.endpointsSpec=n.endpoints||[null,null],i.endpointStyle=n.endpointStyle,i.endpointHoverStyle=n.endpointHoverStyle,i.endpointStyles=n.endpointStyles||[null,null],i.endpointHoverStyles=n.endpointHoverStyles||[null,null],i.paintStyle=n.paintStyle,i.hoverPaintStyle=n.hoverPaintStyle,i.uuids=n.uuids,i.makeEndpoint(!0,i.source,i.sourceId,s,n.sourceEndpoint),i.makeEndpoint(!1,i.target,i.targetId,a,n.targetEndpoint),i.scope||(i.scope=i.endpoints[0].scope),null!=n.deleteEndpointsOnEmpty&&(i.endpoints[0].deleteOnEmpty=n.deleteEndpointsOnEmpty,i.endpoints[1].deleteOnEmpty=n.deleteEndpointsOnEmpty);var c=i.instance.defaults.connectionsDetachable;!1===n.detachable&&(c=!1),!1===i.endpoints[0].connectionsDetachable&&(c=!1),!1===i.endpoints[1].connectionsDetachable&&(c=!1),i.endpointsSpec=n.endpoints||[null,null],i.endpointSpec=n.endpoint||null;var u=n.reattach||i.endpoints[0].reattachConnections||i.endpoints[1].reattachConnections||i.instance.defaults.reattachConnections,h=x({},i.endpoints[0].connectorStyle||i.endpoints[1].connectorStyle||n.paintStyle||i.instance.defaults.paintStyle);if(i.appendToDefaultType({detachable:c,reattach:u,paintStyle:h,hoverPaintStyle:x({},i.endpoints[0].connectorHoverStyle||i.endpoints[1].connectorHoverStyle||n.hoverPaintStyle||i.instance.defaults.hoverPaintStyle)}),n.outlineWidth&&(h.outlineWidth=n.outlineWidth),n.outlineColor&&(h.outlineStroke=n.outlineColor),n.lineWidth&&(h.strokeWidth=n.lineWidth),n.color&&(h.stroke=n.color),!i.instance._suspendDrawing){var d=i.instance._suspendedAt||X();i.instance._paintEndpoint(i.endpoints[0],{timestamp:d}),i.instance._paintEndpoint(i.endpoints[1],{timestamp:d})}i.cost=n.cost||i.endpoints[0].connectionCost,i.directed=n.directed,null==n.directed&&(i.directed=i.endpoints[0].connectionsDirected);var p=x({},i.endpoints[1].parameters);x(p,i.endpoints[0].parameters),x(p,i.parameters),i.parameters=p,i.paintStyleInUse=i.getPaintStyle()||{},i._setConnector(i.endpoints[0].connector||i.endpoints[1].connector||n.connector||i.instance.defaults.connector,!0);var f=null!=n.data&&E(n.data)?n.data:{};i.setData(f);var v=[an,i.endpoints[0].edgeType,i.endpoints[1].edgeType,n.type].join(" ");return/[^\s]/.test(v)&&i.addType(v,n.data),i}return h(t,e),a(t,[{key:"getIdPrefix",value:function(){return"_jsPlumb_c"}},{key:"getDefaultOverlayKey",value:function(){return"connectionOverlays"}},{key:"getXY",value:function(){return{x:this.connector.x,y:this.connector.y}}},{key:"makeEndpoint",value:function(e,t,n,i,o){return n=n||this.instance.getId(t),Go(this,o,e?0:1,i,t)}},{key:"getTypeDescriptor",value:function(){return t.type}},{key:"isDetachable",value:function(e){return!1!==this.detachable&&(null!=e?!0===e.connectionsDetachable:!0===this.detachable)}},{key:"setDetachable",value:function(e){this.detachable=!0===e}},{key:"isReattach",value:function(){return!0===this.reattach||!0===this.endpoints[0].reattachConnections||!0===this.endpoints[1].reattachConnections}},{key:"setReattach",value:function(e){this.reattach=!0===e}},{key:"applyType",value:function(e,n){var i=null;null!=e.connector&&(null==(i=this.getCachedTypeItem(Fo,n.connector))&&(i=this.prepareConnector(e.connector,n.connector),this.cacheTypeItem(Fo,i,n.connector)),this.setPreparedConnector(i)),y(t,"applyType",this,3)([e,n]),null!=e.detachable&&this.setDetachable(e.detachable),null!=e.reattach&&this.setReattach(e.reattach),e.scope&&(this.scope=e.scope);var o=null;e.anchor?null==(o=this.getCachedTypeItem(No,n.anchor))&&(o=[to(e.anchor),to(e.anchor)],this.cacheTypeItem(No,o,n.anchor)):e.anchors&&null==(o=this.getCachedTypeItem(No,n.anchors))&&(o=[to(e.anchors[0]),to(e.anchors[1])],this.cacheTypeItem(No,o,n.anchors)),null!=o&&(this.instance.router.setConnectionAnchors(this,o),this.instance.router.isDynamicAnchor(this.endpoints[1])&&this.instance.repaint(this.endpoints[1].element)),this.instance.applyConnectorType(this.connector,e)}},{key:"addClass",value:function(e,n){y(t,"addClass",this,3)([e]),n&&(this.endpoints[0].addClass(e),this.endpoints[1].addClass(e),this.suspendedEndpoint&&this.suspendedEndpoint.addClass(e)),this.connector&&this.instance.addConnectorClass(this.connector,e)}},{key:"removeClass",value:function(e,n){y(t,"removeClass",this,3)([e]),n&&(this.endpoints[0].removeClass(e),this.endpoints[1].removeClass(e),this.suspendedEndpoint&&this.suspendedEndpoint.removeClass(e)),this.connector&&this.instance.removeConnectorClass(this.connector,e)}},{key:"setVisible",value:function(e){y(t,"setVisible",this,3)([e]),this.connector&&this.instance.setConnectorVisible(this.connector,e),this.instance._paintConnection(this)}},{key:"destroy",value:function(){y(t,"destroy",this,3)([]),this.endpoints=null,this.endpointStyles=null,this.source=null,this.target=null,this.instance.destroyConnector(this),this.connector=null,this.deleted=!0}},{key:"getUuids",value:function(){return[this.endpoints[0].getUuid(),this.endpoints[1].getUuid()]}},{key:"prepareConnector",value:function(e,t){var n,i={cssClass:this.params.cssClass,hoverClass:this.params.hoverClass,"pointer-events":this.params["pointer-events"]};if(S(e))n=this.instance._makeConnector(this,e,i);else{var o=e;n=this.instance._makeConnector(this,o.type,D(o.options||{},i))}return null!=t&&(n.typeId=t),n}},{key:"setPreparedConnector",value:function(e,t,n,i){if(this.connector!==e){var o,r="";if(null!=this.connector&&(o=this.connector,r=this.instance.getConnectorClass(this.connector),this.instance.destroyConnector(this)),this.connector=e,i&&this.cacheTypeItem(Fo,e,i),this.addClass(r),null!=o){var s=this.getOverlays();for(var a in s)this.instance.reattachOverlay(s[a],this)}t||this.instance._paintConnection(this)}}},{key:"_setConnector",value:function(e,t,n,i){var o=this.prepareConnector(e,i);this.setPreparedConnector(o,t,n,i)}},{key:"replaceEndpoint",value:function(e,t){var n=this.endpoints[e],i=(n.elementId,this.instance.getEndpoints(n.element)),o=i.indexOf(n),r=Go(this,null,e,null,n.element,0,t);this.endpoints[e]=r,i.splice(o,1,r),n.detachFromConnection(this),this.instance.deleteEndpoint(n),this.instance.fire("endpoint:replaced",{previous:n,current:r})}}])}(Oo);function Bo(e){if(null==e.path){var t=x({"jtk-overlay-id":e.id},e.attributes);e.path=et(Ze,t);var n=e.instance.overlayClass+" "+(e.cssClass?e.cssClass:"");e.instance.addClass(e.path,n),e.path.jtk={overlay:e}}var i=e.path.parentNode;if(null==i){if(e.component instanceof Ro){var o=e.component.connector;i=null!=o?o.canvas:null}else if(e.component instanceof Lo){var r=e.component.endpoint;i=null!=r?r.canvas:r}null!=i&&it(i,e.path,1)}return e.path}l(Ro,"type","connection"),function(e){function t(){var e;r(this,t);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return l(e=o(this,t,[].concat(i)),"path",void 0),e}h(t,e),a(t)}(mo);var Ho=a((function e(){r(this,e)}),null,[{key:"paint",value:function(e,t,n,i){if(null!=n){var o=[e.x,e.y],r=[e.w,e.h];if(null!=i&&(i.xmin<0&&(o[0]+=i.xmin),i.ymin<0&&(o[1]+=i.ymin),r[0]=i.xmax+(i.xmin<0?-i.xmin:0),r[1]=i.ymax+(i.ymin<0?-i.ymin:0)),isFinite(r[0])&&isFinite(r[1])){var s={width:""+(r[0]||0),height:""+(r[1]||0)};t.containerType===de.HTML?Qe(e.canvas,x(s,{style:tt([o[0],o[1]])})):Qe(e.canvas,x(s,{x:o[0],y:o[1]}))}}}}]);function Uo(e,t,n,i){!function(e,t){if(null!=t.canvas)return t.canvas;var n=et(qe,{style:"",width:"0",height:"0","pointer-events":_e,position:be});t.canvas=n,e._appendElement(t.canvas,e.getContainer()),null!=t.cssClass&&e.addClass(n,t.cssClass),e.addClass(n,e.connectorClass),n.jtk=n.jtk||{},n.jtk.connector=t}(e,t),Ho.paint(t,e,n,i);var o=[0,0];if(i.xmin<0&&(o[0]=-i.xmin),i.ymin<0&&(o[1]=-i.ymin),t.segments.length>0){var r={d:e.getPathData(t),transform:"translate("+o[0]+","+o[1]+")","pointer-events":"visibleStroke"},s=null;if(n.outlineStroke){var a=n.outlineWidth||1,l=n.strokeWidth+2*a;(s=x({},n)).stroke=n.outlineStroke,s.strokeWidth=l,null==t.bgPath?(t.bgPath=et(Ze,r),e.addClass(t.bgPath,e.connectorOutlineClass),it(t.canvas,t.bgPath,0)):Qe(t.bgPath,r),nt(t.canvas,t.bgPath,s)}var c=t;null==c.path?(c.path=et(Ze,r),it(c.canvas,c.path,n.outlineStroke?1:0)):(c.path.parentNode!==c.canvas&&it(c.canvas,c.path,n.outlineStroke?1:0),Qe(t.path,r)),nt(t.canvas,t.path,n)}}var Xo=a((function e(){r(this,e)}),null,[{key:"getEndpointElement",value:function(e){if(null!=e.canvas)return e.canvas;var t=et(qe,{style:"",width:"0",height:"0","pointer-events":"all",position:be});e.canvas=t;var n=e.classes.join(" ");e.instance.addClass(t,n);for(var i=e.endpoint.scope.split(/\s/),o=0;o<i.length;o++)e.instance.setAttribute(t,Ee+i[o],ln);return e.instance._appendElementToContainer(t),null!=e.cssClass&&e.instance.addClass(t,e.cssClass),e.instance.addClass(t,e.instance.endpointClass),t.jtk=t.jtk||{},t.jtk.endpoint=e.endpoint,t.style.display=!1!==e.endpoint.visible?me:_e,t}},{key:"paint",value:function(e,t,n){if(!0!==e.endpoint.deleted){this.getEndpointElement(e),Ho.paint(e,e.instance,n);var i=x({},n);i.outlineStroke&&(i.stroke=i.outlineStroke),null==e.node?(e.node=t.makeNode(e,i),e.canvas.appendChild(e.node)):null!=t.updateNode&&t.updateNode(e,e.node),nt(e.canvas,e.node,i)}}}]),Yo=a((function e(t,n){r(this,e),this.connection=t,l(this,"type",void 0),l(this,"edited",!1),l(this,"stub",void 0),l(this,"sourceStub",void 0),l(this,"targetStub",void 0),l(this,"maxStub",void 0),l(this,"typeId",void 0),l(this,"gap",void 0),l(this,"sourceGap",void 0),l(this,"targetGap",void 0),l(this,"segments",[]),l(this,"totalLength",0),l(this,"segmentProportions",[]),l(this,"segmentProportionalLengths",[]),l(this,"paintInfo",null),l(this,"strokeWidth",void 0),l(this,"x",void 0),l(this,"y",void 0),l(this,"w",void 0),l(this,"h",void 0),l(this,"segment",void 0),l(this,"bounds",{xmin:1/0,xmax:-1/0,ymin:1/0,ymax:-1/0}),l(this,"cssClass",void 0),l(this,"hoverClass",void 0),l(this,"geometry",void 0),this.stub=n.stub||this.getDefaultStubs(),this.sourceStub=Array.isArray(this.stub)?this.stub[0]:this.stub,this.targetStub=Array.isArray(this.stub)?this.stub[1]:this.stub,this.gap=n.gap||0,this.sourceGap=Array.isArray(this.gap)?this.gap[0]:this.gap,this.targetGap=Array.isArray(this.gap)?this.gap[1]:this.gap,this.maxStub=Math.max(this.sourceStub,this.targetStub),this.cssClass=n.cssClass||"",this.hoverClass=n.hoverClass||""}),[{key:"getTypeDescriptor",value:function(){return"connector"}},{key:"getIdPrefix",value:function(){return"_jsplumb_connector"}},{key:"setGeometry",value:function(e,t){this.geometry=e,this.edited=null!=e&&!t}},{key:"exportGeometry",value:function(){return this.geometry}},{key:"importGeometry",value:function(e){return this.geometry=e,!0}},{key:"resetGeometry",value:function(){this.geometry=null,this.edited=!1}},{key:"transformAnchorPlacement",value:function(e,t,n){return{x:e.x,y:e.y,ox:e.ox,oy:e.oy,curX:e.curX+t,curY:e.curY+n}}},{key:"resetBounds",value:function(){this.bounds={xmin:1/0,xmax:-1/0,ymin:1/0,ymax:-1/0}}},{key:"findSegmentForPoint",value:function(e,t){for(var n={d:1/0,s:null,x:null,y:null,l:null,x1:null,y1:null,x2:null,y2:null,index:null,connectorLocation:null},i=0;i<this.segments.length;i++){var o=this.segments[i].findClosestPointOnPath(e,t);o.d<n.d&&(n.d=o.d,n.l=o.l,n.x=o.x,n.y=o.y,n.s=this.segments[i],n.x1=o.x1,n.x2=o.x2,n.y1=o.y1,n.y2=o.y2,n.index=i,n.connectorLocation=this.segmentProportions[i][0]+o.l*(this.segmentProportions[i][1]-this.segmentProportions[i][0]))}return n}},{key:"lineIntersection",value:function(e,t,n,i){for(var o=[],r=0;r<this.segments.length;r++)o.push.apply(o,this.segments[r].lineIntersection(e,t,n,i));return o}},{key:"boxIntersection",value:function(e,t,n,i){for(var o=[],r=0;r<this.segments.length;r++)o.push.apply(o,this.segments[r].boxIntersection(e,t,n,i));return o}},{key:"boundingBoxIntersection",value:function(e){for(var t=[],n=0;n<this.segments.length;n++)t.push.apply(t,this.segments[n].boundingBoxIntersection(e));return t}},{key:"_updateSegmentProportions",value:function(){for(var e=0,t=0;t<this.segments.length;t++){var n=this.segments[t].getLength();this.segmentProportionalLengths[t]=n/this.totalLength,this.segmentProportions[t]=[e,e+=n/this.totalLength]}}},{key:"_findSegmentForLocation",value:function(e,t){var n,i,o;if(t&&(e=e>0?e/this.totalLength:(this.totalLength+e)/this.totalLength),1===e)n=this.segments.length-1,o=1;else if(0===e)o=0,n=0;else if(e>=.5){for(n=0,o=0,i=this.segmentProportions.length-1;i>-1;i--)if(this.segmentProportions[i][1]>=e&&this.segmentProportions[i][0]<=e){n=i,o=(e-this.segmentProportions[i][0])/this.segmentProportionalLengths[i];break}}else for(n=this.segmentProportions.length-1,o=1,i=0;i<this.segmentProportions.length;i++)if(this.segmentProportions[i][1]>=e){n=i,o=(e-this.segmentProportions[i][0])/this.segmentProportionalLengths[i];break}return{segment:this.segments[n],proportion:o,index:n}}},{key:"_addSegment",value:function(e,t){if(t.x1!==t.x2||t.y1!==t.y2){var n=new e(t);this.segments.push(n),this.totalLength+=n.getLength(),this.updateBounds(n)}}},{key:"_clearSegments",value:function(){this.totalLength=0,this.segments.length=0,this.segmentProportions.length=0,this.segmentProportionalLengths.length=0}},{key:"getLength",value:function(){return this.totalLength}},{key:"_prepareCompute",value:function(e){this.strokeWidth=e.strokeWidth;var t=e.sourcePos.curX,n=e.targetPos.curX,i=e.sourcePos.curY,o=e.targetPos.curY,r=Xn({x:t,y:i},{x:n,y:o}),s=n<t,a=o<i,l=[e.sourcePos.ox,e.sourcePos.oy],c=[e.targetPos.ox,e.targetPos.oy],u=s?n:t,h=a?o:i,d=Math.abs(n-t),p=Math.abs(o-i),f=0===l[0]&&0===l[1],v=0===c[0]&&0===c[1];if(f||v){var y=d>p?0:1,g=[1,0][y],m=0===y?t:i,_=0===y?n:o;f&&(l[y]=m>_?-1:1,l[g]=0),v&&(c[y]=m>_?1:-1,c[g]=0)}var b=s?d+this.sourceGap*l[0]:this.sourceGap*l[0],k=a?p+this.sourceGap*l[1]:this.sourceGap*l[1],x=s?this.targetGap*c[0]:d+this.targetGap*c[0],C=a?this.targetGap*c[1]:p+this.targetGap*c[1],S=l[0]*c[0]+l[1]*c[1],w={sx:b,sy:k,tx:x,ty:C,xSpan:Math.abs(x-b),ySpan:Math.abs(C-k),mx:(b+x)/2,my:(k+C)/2,so:l,to:c,x:u,y:h,w:d,h:p,segment:r,startStubX:b+l[0]*this.sourceStub,startStubY:k+l[1]*this.sourceStub,endStubX:x+c[0]*this.targetStub,endStubY:C+c[1]*this.targetStub,isXGreaterThanStubTimes2:Math.abs(b-x)>this.sourceStub+this.targetStub,isYGreaterThanStubTimes2:Math.abs(k-C)>this.sourceStub+this.targetStub,opposite:-1===S,perpendicular:0===S,orthogonal:1===S,sourceAxis:0===l[0]?"y":"x",points:[u,h,d,p,b,k,x,C],stubs:[this.sourceStub,this.targetStub]};return w.anchorOrientation=w.opposite?"opposite":w.orthogonal?"orthogonal":"perpendicular",w}},{key:"updateBounds",value:function(e){var t=e.extents;this.bounds.xmin=Math.min(this.bounds.xmin,t.xmin),this.bounds.xmax=Math.max(this.bounds.xmax,t.xmax),this.bounds.ymin=Math.min(this.bounds.ymin,t.ymin),this.bounds.ymax=Math.max(this.bounds.ymax,t.ymax)}},{key:"dumpSegmentsToConsole",value:function(){z("SEGMENTS:");for(var e=0;e<this.segments.length;e++)z(this.segments[e].type,""+this.segments[e].getLength(),""+this.segmentProportions[e])}},{key:"pointOnPath",value:function(e,t){var n=this._findSegmentForLocation(e,t);return n.segment&&n.segment.pointOnPath(n.proportion,!1)||{x:0,y:0}}},{key:"gradientAtPoint",value:function(e,t){var n=this._findSegmentForLocation(e,t);return n.segment&&n.segment.gradientAtPoint(n.proportion,!1)||0}},{key:"pointAlongPathFrom",value:function(e,t,n){var i=this._findSegmentForLocation(e,n);return i.segment&&i.segment.pointAlongPathFrom(i.proportion,t,!1)||{x:0,y:0}}},{key:"compute",value:function(e){this.paintInfo=this._prepareCompute(e),this._clearSegments(),this._compute(this.paintInfo,e),this.x=this.paintInfo.points[0],this.y=this.paintInfo.points[1],this.w=this.paintInfo.points[2],this.h=this.paintInfo.points[3],this.segment=this.paintInfo.segment,this._updateSegmentProportions()}},{key:"setAnchorOrientation",value:function(e,t){}}]),Ko=function(e){function t(e,n,i){var s;return r(this,t),(s=o(this,t,[e,n,i])).instance=e,s.component=n,l(s,"width",void 0),l(s,"length",void 0),l(s,"foldback",void 0),l(s,"direction",void 0),l(s,"location",.5),l(s,"paintStyle",void 0),l(s,"type",t.type),l(s,"cachedDimensions",void 0),i=i||{},s.width=i.width||20,s.length=i.length||20,s.direction=(i.direction||1)<0?-1:1,s.foldback=i.foldback||.623,s.paintStyle=i.paintStyle||{strokeWidth:1},s.location=null==i.location?s.location:Array.isArray(i.location)?i.location[0]:i.location,s}return h(t,e),a(t,[{key:"draw",value:function(e,t,n){if(e instanceof Yo){var i,o,r,s=e;if(this.location>1||this.location<0){var a=this.location<0?1:0;o=Kn(i=s.pointAlongPathFrom(a,this.location,!1),s.pointAlongPathFrom(a,this.location-this.direction*this.length/2,!1),this.length)}else if(1===this.location){if(o=Kn(i=s.pointOnPath(this.location),s.pointAlongPathFrom(this.location,-this.length),this.length),-1===this.direction){var l=o;o=i,i=l}}else if(0===this.location){if(i=Kn(o=s.pointOnPath(this.location),s.pointAlongPathFrom(this.location,this.length),this.length),-1===this.direction){var c=o;o=i,i=c}}else o=Kn(i=s.pointAlongPathFrom(this.location,this.direction*this.length/2),s.pointOnPath(this.location),this.length);var u={hxy:i,tail:r=function(e,t,n){var i=Hn(e,t),o=Math.atan(-1/i),r=n/2*Math.sin(o),s=n/2*Math.cos(o);return[{x:t.x+s,y:t.y+r},{x:t.x-s,y:t.y-r}]}(i,o,this.width),cxy:Kn(i,o,this.foldback*this.length)},h=this.paintStyle.stroke||t.stroke,d=this.paintStyle.fill||t.stroke;return{component:e,d:u,"stroke-width":this.paintStyle.strokeWidth||t.strokeWidth,stroke:h,fill:d,xmin:Math.min(i.x,r[0].x,r[1].x),xmax:Math.max(i.x,r[0].x,r[1].x),ymin:Math.min(i.y,r[0].y,r[1].y),ymax:Math.max(i.y,r[0].y,r[1].y)}}}},{key:"updateFrom",value:function(e){}}])}(mo);function Vo(e){return e.type===Ko.type}l(Ko,"type","Arrow"),ko(Ko.type,Ko);var zo=function(e){function t(e,n,i){var s;return r(this,t),(s=o(this,t,[e,n,i])).instance=e,l(s,"type",t.type),s.length=s.length/2,s.foldback=2,s}return h(t,e),a(t)}(Ko);function Wo(e){return e.type===zo.type}l(zo,"type","Diamond"),ko(zo.type,zo);var $o=function(e){function t(e,n,i){var s;return r(this,t),(s=o(this,t,[e,n,i])).instance=e,l(s,"type",t.type),s.foldback=1,s}return h(t,e),a(t)}(Ko);function qo(e){return e.type===$o.type}l($o,"type","PlainArrow"),ko("PlainArrow",$o);var Zo=function(e){function t(e,n,i){var s;return r(this,t),(s=o(this,t,[e,n,i])).instance=e,s.component=n,l(s,"create",void 0),l(s,"type",t.type),s.create=i.create,s}return h(t,e),a(t,[{key:"updateFrom",value:function(e){}}])}(mo);function Jo(e){return e.type===Zo.type}l(Zo,"type","Custom"),ko(Zo.type,Zo);var Qo=function(e){function t(e,n){var i;return r(this,t),l(i=o(this,t,[e,n]),"radius",void 0),l(i,"defaultOffset",void 0),l(i,"defaultInnerRadius",void 0),l(i,"type",t.type),n=n||{},i.radius=n.radius||5,i.defaultOffset=.5*i.radius,i.defaultInnerRadius=i.radius/3,i}return h(t,e),a(t)}(Di);l(Qo,"type","Dot");var er={type:Qo.type,cls:Qo,compute:function(e,t,n,i){var o=t.curX-e.radius,r=t.curY-e.radius,s=2*e.radius,a=2*e.radius;if(i&&i.stroke){var l=i.strokeWidth||1;o-=l,r-=l,s+=2*l,a+=2*l}return e.x=o,e.y=r,e.w=s,e.h=a,[o,r,s,a,e.radius]},getParams:function(e){return{radius:e.radius}}},tr=a((function e(t,n){r(this,e),this.instance=t,this.el=n,l(this,"group",void 0)})),nr=function(e){function t(e,n,i){var s;r(this,t),(s=o(this,t,[e,n])).instance=e,l(s,"children",[]),l(s,"collapsed",!1),l(s,"droppable",void 0),l(s,"enabled",void 0),l(s,"orphan",void 0),l(s,"constrain",void 0),l(s,"proxied",void 0),l(s,"ghost",void 0),l(s,"revert",void 0),l(s,"prune",void 0),l(s,"dropOverride",void 0),l(s,"anchor",void 0),l(s,"endpoint",void 0),l(s,"connections",{source:[],target:[],internal:[]}),l(s,"manager",void 0),l(s,"id",void 0),l(s,"elId",void 0);var a=s.el;return a._isJsPlumbGroup=!0,a._jsPlumbGroup=s,s.elId=e.getId(n),s.orphan=!0===i.orphan,s.revert=!0!==s.orphan&&!1!==i.revert,s.droppable=!1!==i.droppable,s.ghost=!0===i.ghost,s.enabled=!1!==i.enabled,s.prune=!0!==s.orphan&&!0===i.prune,s.constrain=s.ghost||!0===i.constrain,s.proxied=!1!==i.proxied,s.id=i.id||X(),s.dropOverride=!0===i.dropOverride,s.anchor=i.anchor,s.endpoint=i.endpoint,s.anchor=i.anchor,e.setAttribute(n,xe,""),s}return h(t,e),a(t,[{key:"contentArea",get:function(){return this.instance.getGroupContentArea(this)}},{key:"overrideDrop",value:function(e,t){return this.dropOverride&&(this.revert||this.prune||this.orphan)}},{key:"getAnchor",value:function(e,t){return this.anchor||"Continuous"}},{key:"getEndpoint",value:function(e,t){return this.endpoint||{type:Qo.type,options:{radius:10}}}},{key:"add",value:function(e,t){var n=this.instance.getGroupContentArea(this),i=e;if(null!=i._jsPlumbParentGroup){if(i._jsPlumbParentGroup===this)return;i._jsPlumbParentGroup.remove(e,!0,t,!1)}i._jsPlumbParentGroup=this,this.children.push(new tr(this.instance,e)),this.instance._appendElement(i,n),this.manager._updateConnectionsForGroup(this)}},{key:"resolveNode",value:function(e){return null==e?null:I(this.children,(function(t){return t.el===e}))}},{key:"remove",value:function(e,t,n,i,o){var r=this.resolveNode(e);null!=r&&this._doRemove(r,t,n,i,o)}},{key:"_doRemove",value:function(e,t,n,i,o){var r=e.el;if(delete r._jsPlumbParentGroup,N(this.children,(function(t){return t===e})),t)try{this.instance.getGroupContentArea(this).removeChild(r)}catch(e){z("Could not remove element from Group "+e)}if(!n){var s={group:this,el:r};o&&(s.targetGroup=o),this.instance.fire("group:member:removed",s)}i||this.manager._updateConnectionsForGroup(this)}},{key:"removeAll",value:function(e,t){for(var n=0,i=this.children.length;n<i;n++){var o=this.children[0];this._doRemove(o,e,t,!0),this.instance.unmanage(o.el,!0)}this.children.length=0,this.manager._updateConnectionsForGroup(this)}},{key:"orphanAll",value:function(){for(var e={},t=0;t<this.children.length;t++){var n=this.manager.orphan(this.children[t].el,!1);e[n.id]=n.pos}return this.children.length=0,e}},{key:"addGroup",value:function(e){if(this.instance.allowNestedGroups&&e!==this){if(this.instance.groupManager.isAncestor(this,e))return!1;null!=e.group&&e.group.removeGroup(e);var t=this.instance.getId(e.el);this.instance.getManagedElements()[t].group=this.elId;var n=this.instance.getOffsetRelativeToRoot(e.el),i=this.collapsed?this.instance.getOffsetRelativeToRoot(this.el):this.instance.getOffsetRelativeToRoot(this.instance.getGroupContentArea(this));e.el._jsPlumbParentGroup=this,this.children.push(e),this.instance._appendElementToGroup(this,e.el),e.group=this;var o={x:n.x-i.x,y:n.y-i.y};return this.instance.setPosition(e.el,o),this.instance.fire("group:nested:added",{parent:this,child:e}),!0}return!1}},{key:"removeGroup",value:function(e){if(e.group===this){var t=e.el,n=this.instance.getGroupContentArea(this);n===t.parentNode&&n.removeChild(e.el);var i=this.instance.getId(e.el),o=this.instance.getManagedElements()[i];o&&delete o.group,this.children=this.children.filter((function(t){return t.id!==e.id})),delete e.group,delete t._jsPlumbParentGroup,this.instance.fire("group:nested:removed",{parent:this,child:e})}}},{key:"getGroups",value:function(){return this.children.filter((function(e){return e.constructor===t}))}},{key:"getNodes",value:function(){return this.children.filter((function(e){return e.constructor===tr}))}},{key:"collapseParent",get:function(){var e=null;if(null==this.group)return null;for(var t=this.group;null!=t;)t.collapsed&&(e=t),t=t.group;return e}}])}(tr),ir=a((function e(t){var n=this;r(this,e),this.instance=t,l(this,"groupMap",{}),l(this,"_connectionSourceMap",{}),l(this,"_connectionTargetMap",{}),t.bind(Le,(function(e){var t=n.getGroupFor(e.source),i=n.getGroupFor(e.target);null!=t&&null!=i&&t===i?(n._connectionSourceMap[e.connection.id]=t,n._connectionTargetMap[e.connection.id]=t,B(t.connections.internal,e.connection)):(null!=t&&(e.target._jsPlumbGroup===t?B(t.connections.internal,e.connection):B(t.connections.source,e.connection),n._connectionSourceMap[e.connection.id]=t),null!=i&&(e.source._jsPlumbGroup===i?B(i.connections.internal,e.connection):B(i.connections.target,e.connection),n._connectionTargetMap[e.connection.id]=i))})),t.bind(Ge,(function(e){n._cleanupDetachedConnection(e.connection)})),t.bind(Ne,(function(e){var t=e.originalEndpoint.element,i=n.getGroupFor(t),o=e.connection.endpoints[e.index].element,r=n.getGroupFor(o),s=0===e.index?n._connectionSourceMap:n._connectionTargetMap,a=0===e.index?n._connectionTargetMap:n._connectionSourceMap;null!=r?(s[e.connection.id]=r,e.connection.source===e.connection.target&&(a[e.connection.id]=r)):(delete s[e.connection.id],e.connection.source===e.connection.target&&delete a[e.connection.id]),null!=i&&n._updateConnectionsForGroup(i),null!=r&&n._updateConnectionsForGroup(r)}))}),[{key:"_cleanupDetachedConnection",value:function(e){e.proxies.length=0;var t,n=this._connectionSourceMap[e.id];null!=n&&(t=function(t){return t.id===e.id},N(n.connections.source,t),N(n.connections.target,t),N(n.connections.internal,t),delete this._connectionSourceMap[e.id]),null!=(n=this._connectionTargetMap[e.id])&&(t=function(t){return t.id===e.id},N(n.connections.source,t),N(n.connections.target,t),N(n.connections.internal,t),delete this._connectionTargetMap[e.id])}},{key:"addGroup",value:function(e){var t=e.el;if(null!=this.groupMap[e.id])throw new Error("cannot create Group ["+e.id+"]; a Group with that ID exists");if(null!=t._isJsPlumbGroup)throw new Error("cannot create Group ["+e.id+"]; the given element is already a Group");var n=new nr(this.instance,e.el,e);return this.groupMap[n.id]=n,e.collapsed&&this.collapseGroup(n),this.instance.manage(n.el),this.instance.addClass(n.el,je),n.manager=this,this._updateConnectionsForGroup(n),this.instance.fire("group:added",{group:n}),n}},{key:"getGroup",value:function(e){var t=e;if(S(e)&&null==(t=this.groupMap[e]))throw new Error("No such group ["+e+"]");return t}},{key:"getGroupFor",value:function(e){for(var t=e,n=this.instance.getContainer(),i=!1,o=null;!i;)null==t||t===n?i=!0:t._jsPlumbParentGroup?(o=t._jsPlumbParentGroup,i=!0):t=t.parentNode;return o}},{key:"getGroups",value:function(){var e=[];for(var t in this.groupMap)e.push(this.groupMap[t]);return e}},{key:"removeGroup",value:function(e,t,n,i){var o=this,r=this.getGroup(e);this.expandGroup(r,!0);var s={};return j(r.children,(function(e){var t=o.instance.getManagedElements()[o.instance.getId(e.el)];t&&delete t.group})),t?(j(r.getGroups(),(function(e){return o.removeGroup(e,t,n)})),r.removeAll(n,i)):(r.group&&j(r.children,(function(e){return r.group.add(e.el)})),s=r.orphanAll()),r.group&&r.group.removeGroup(r),this.instance.unmanage(r.el,!0),delete this.groupMap[r.id],this.instance.fire("group:removed",{group:r}),s}},{key:"removeAllGroups",value:function(e,t,n){for(var i in this.groupMap)this.removeGroup(this.groupMap[i],e,t,n)}},{key:"forEach",value:function(e){for(var t in this.groupMap)e(this.groupMap[t])}},{key:"orphan",value:function(e,t){var n=e;if(n._jsPlumbParentGroup){var i=n._jsPlumbParentGroup,o=this.instance.getId(n),r=this.instance.getOffset(e);return!0!==t&&i.group?this.instance._appendElementToGroup(i.group,e):this.instance._appendElementToContainer(e),this.instance.setPosition(e,r),delete n._jsPlumbParentGroup,{id:o,pos:r}}}},{key:"_updateConnectionsForGroup",value:function(e){var t=this;e.connections.source.length=0,e.connections.target.length=0,e.connections.internal.length=0;var n=e.children.slice().map((function(e){return e.el})),i=[];if(j(n,(function(e){Array.prototype.push.apply(i,t.instance.getSelector(e,ze))})),Array.prototype.push.apply(n,i),n.length>0){var o,r,s=this.instance.getConnections({source:n,scope:un},!0),a=this.instance.getConnections({target:n,scope:un},!0),l={},c=function(n){for(var i=0;i<n.length;i++)l[n[i].id]||(l[n[i].id]=!0,o=t.getGroupFor(n[i].source),r=t.getGroupFor(n[i].target),n[i].source===e.el&&r===e||n[i].target===e.el&&o===e?e.connections.internal.push(n[i]):o===e?(r!==e?e.connections.source.push(n[i]):e.connections.internal.push(n[i]),t._connectionSourceMap[n[i].id]=e):r===e&&(e.connections.target.push(n[i]),t._connectionTargetMap[n[i].id]=e))};c(s),c(a)}}},{key:"_collapseConnection",value:function(e,t,n){var i=e.endpoints[0===t?1:0].element;if(i._jsPlumbParentGroup&&!i._jsPlumbParentGroup.proxied&&i._jsPlumbParentGroup.collapsed)return!1;var o=e.endpoints[0].element._jsPlumbParentGroup,r=null!=o?o.collapseParent||o:null,s=e.endpoints[1].element._jsPlumbParentGroup,a=null!=s?s.collapseParent||s:null;if(null==r||null==a||r.id!==a.id){var l=n.el;return this.instance.getId(l),this.instance.proxyConnection(e,t,l,(function(e,t){return n.getEndpoint(e,t)}),(function(e,t){return n.getAnchor(e,t)})),!0}return!1}},{key:"_expandConnection",value:function(e,t,n){this.instance.unproxyConnection(e,t)}},{key:"isElementDescendant",value:function(e,t){for(var n=this.instance.getContainer();;){if(null==e||e===n)return!1;if(e===t)return!0;e=e.parentNode}}},{key:"collapseGroup",value:function(e){var t=this,n=this.getGroup(e);if(null!=n&&!n.collapsed){var i=n.el;if(null==n.collapseParent){if(this.instance.setGroupVisible(n,!1),n.collapsed=!0,this.instance.removeClass(i,je),this.instance.addClass(i,Te),n.proxied){var o=new Set,r=function(e,i){for(var r=0;r<e.length;r++){var s=e[r];!0===t._collapseConnection(s,i,n)&&o.add(s.id)}};r(n.connections.source,0),r(n.connections.target,1),j(n.getGroups(),(function(e){t.cascadeCollapse(n,e,o)}))}this.instance.revalidate(i),this.repaintGroup(n),this.instance.fire("group:collapse",{group:n})}else n.collapsed=!0,this.instance.removeClass(i,je),this.instance.addClass(i,Te)}}},{key:"cascadeCollapse",value:function(e,t,n){var i=this;if(e.proxied){var o=function(t,o){for(var r=0;r<t.length;r++){var s=t[r];n.has(s.id)||!0===i._collapseConnection(s,o,e)&&n.add(s.id)}};o(t.connections.source,0),o(t.connections.target,1)}j(t.getGroups(),(function(t){i.cascadeCollapse(e,t,n)}))}},{key:"expandGroup",value:function(e,t){var n=this,i=this.getGroup(e);if(null!=i){var o=i.el;if(null==i.collapseParent){if(this.instance.setGroupVisible(i,!0),i.collapsed=!1,this.instance.addClass(o,je),this.instance.removeClass(o,Te),i.proxied){var r=function(e,t){for(var o=0;o<e.length;o++){var r=e[o];n._expandConnection(r,t,i)}};r(i.connections.source,0),r(i.connections.target,1);var s=function(e,t){if(t||e.collapsed){var i=function(t,i){for(var o=0;o<t.length;o++){var r=t[o];n._collapseConnection(r,i,e.collapseParent||e)}};i(e.connections.source,0),i(e.connections.target,1),j(e.connections.internal,(function(e){return e.setVisible(!1)})),j(e.getGroups(),(function(e){return s(e,!0)}))}else n.expandGroup(e,!0)};j(i.getGroups(),s)}this.instance.revalidate(o),this.repaintGroup(i),t||this.instance.fire("group:expand",{group:i})}else i.collapsed=!1,this.instance.addClass(o,je),this.instance.removeClass(o,Te)}}},{key:"toggleGroup",value:function(e){null!=(e=this.getGroup(e))&&(e.collapsed?this.expandGroup(e):this.collapseGroup(e))}},{key:"repaintGroup",value:function(e){for(var t=this.getGroup(e).children,n=0;n<t.length;n++)this.instance.revalidate(t[n].el)}},{key:"addToGroup",value:function(e,t){var n=this,i=this.getGroup(e);if(i){for(var o=i.el,r=function(e){var r=e,s=null!=r._isJsPlumbGroup,a=r._jsPlumbGroup,l=r._jsPlumbParentGroup;if(l!==i){var c=n.instance.manage(e),u=n.instance.getOffset(e),h=i.collapsed?n.instance.getOffsetRelativeToRoot(o):n.instance.getOffset(n.instance.getGroupContentArea(i));c.group=i.elId,null!=l&&(l.remove(e,!1,t,!1,i),n._updateConnectionsForGroup(l)),s?i.addGroup(a):i.add(e,t);var d=function(e,t){var o=0===t?1:0;e.each((function(e){e.setVisible(!1),e.endpoints[o].element._jsPlumbGroup===i?(e.endpoints[o].setVisible(!1),n._expandConnection(e,o,i)):(e.endpoints[t].setVisible(!1),n._collapseConnection(e,t,i))}))};i.collapsed&&(d(n.instance.select({source:e}),0),d(n.instance.select({target:e}),1)),n.instance.getId(e);var p={x:u.x-h.x,y:u.y-h.y};if(n.instance.setPosition(e,p),n._updateConnectionsForGroup(i),n.instance.revalidate(e),!t){var f={group:i,el:e,pos:p};l&&(f.sourceGroup=l),n.instance.fire(Be,f)}}},s=arguments.length,a=new Array(s>2?s-2:0),l=2;l<s;l++)a[l-2]=arguments[l];j(a,r)}}},{key:"removeFromGroup",value:function(e,t){var n=this,i=this.getGroup(e);if(i){for(var o=function(e){if(i.collapsed){var o=function(t,o){for(var r=0;r<t.length;r++){var s=t[r];if(s.proxies)for(var a=0;a<s.proxies.length;a++)if(null!=s.proxies[a]){var l=s.proxies[a].originalEp.element;(l===e||n.isElementDescendant(l,e))&&n._expandConnection(s,o,i)}}};o(i.connections.source.slice(),0),o(i.connections.target.slice(),1)}i.remove(e,null,t);var r=n.instance.getManagedElements()[n.instance.getId(e)];r&&delete r.group},r=arguments.length,s=new Array(r>2?r-2:0),a=2;a<r;a++)s[a-2]=arguments[a];j(s,o)}}},{key:"getAncestors",value:function(e){for(var t=[],n=e.group;null!=n;)t.push(n),n=n.group;return t}},{key:"isAncestor",value:function(e,t){return null!=e&&null!=t&&-1!==this.getAncestors(e).indexOf(t)}},{key:"getDescendants",value:function(e){var t=[],n=function(e){var i=e.getGroups();t.push.apply(t,g(i)),j(i,n)};return n(e),t}},{key:"isDescendant",value:function(e,t){return null!=e&&null!=t&&-1!==this.getDescendants(t).indexOf(e)}},{key:"reset",value:function(){this._connectionSourceMap={},this._connectionTargetMap={},this.groupMap={}}}]),or=a((function e(t,n){r(this,e),this.instance=t,this.entries=n}),[{key:"length",get:function(){return this.entries.length}},{key:"each",value:function(e){return j(this.entries,(function(t){return e(t)})),this}},{key:"get",value:function(e){return this.entries[e]}},{key:"addClass",value:function(e,t){return this.each((function(n){return n.addClass(e,t)})),this}},{key:"removeClass",value:function(e,t){return this.each((function(n){return n.removeClass(e,t)})),this}},{key:"removeAllOverlays",value:function(){return this.each((function(e){return e.removeAllOverlays()})),this}},{key:"setLabel",value:function(e){return this.each((function(t){return t.setLabel(e)})),this}},{key:"clear",value:function(){return this.entries.length=0,this}},{key:"map",value:function(e){var t=[];return this.each((function(n){return t.push(e(n))})),t}},{key:"addOverlay",value:function(e){return this.each((function(t){return t.addOverlay(e)})),this}},{key:"removeOverlay",value:function(e){return this.each((function(t){return t.removeOverlay(e)})),this}},{key:"removeOverlays",value:function(){return this.each((function(e){return e.removeOverlays()})),this}},{key:"showOverlay",value:function(e){return this.each((function(t){return t.showOverlay(e)})),this}},{key:"hideOverlay",value:function(e){return this.each((function(t){return t.hideOverlay(e)})),this}},{key:"setPaintStyle",value:function(e){return this.each((function(t){return t.setPaintStyle(e)})),this}},{key:"setHoverPaintStyle",value:function(e){return this.each((function(t){return t.setHoverPaintStyle(e)})),this}},{key:"setSuspendEvents",value:function(e){return this.each((function(t){return t.setSuspendEvents(e)})),this}},{key:"setParameter",value:function(e,t){return this.each((function(n){return n.parameters[e]=t})),this}},{key:"setParameters",value:function(e){return this.each((function(t){return t.parameters=e})),this}},{key:"setVisible",value:function(e){return this.each((function(t){return t.setVisible(e)})),this}},{key:"addType",value:function(e){return this.each((function(t){return t.addType(e)})),this}},{key:"toggleType",value:function(e){return this.each((function(t){return t.toggleType(e)})),this}},{key:"removeType",value:function(e){return this.each((function(t){return t.removeType(e)})),this}},{key:"bind",value:function(e,t){return this.each((function(n){return n.bind(e,t)})),this}},{key:"unbind",value:function(e,t){return this.each((function(n){return n.unbind(e,t)})),this}},{key:"setHover",value:function(e){var t=this;return this.each((function(n){return t.instance.setHover(n,e)})),this}}]),rr=function(e){function t(){return r(this,t),o(this,t,arguments)}return h(t,e),a(t,[{key:"setEnabled",value:function(e){return this.each((function(t){return t.enabled=e})),this}},{key:"setAnchor",value:function(e){return this.each((function(t){return t.setAnchor(e)})),this}},{key:"deleteEveryConnection",value:function(){return this.each((function(e){return e.deleteEveryConnection()})),this}},{key:"deleteAll",value:function(){var e=this;return this.each((function(t){return e.instance.deleteEndpoint(t)})),this.clear(),this}}])}(or),sr=function(e){function t(){return r(this,t),o(this,t,arguments)}return h(t,e),a(t,[{key:"setDetachable",value:function(e){return this.each((function(t){return t.setDetachable(e)})),this}},{key:"setReattach",value:function(e){return this.each((function(t){return t.setReattach(e)})),this}},{key:"setConnector",value:function(e){return this.each((function(t){return t._setConnector(e)})),this}},{key:"deleteAll",value:function(){var e=this;this.each((function(t){return e.instance.deleteConnection(t)})),this.clear()}},{key:"repaint",value:function(){var e=this;return this.each((function(t){return e.instance._paintConnection(t)})),this}}])}(or),ar=a((function e(){r(this,e),l(this,"affectedElements",new Set)}));function lr(){return{x:0,y:0,w:0,h:0,r:0,c:{x:0,y:0},x2:0,y2:0,t:{x:0,y:0,c:{x:0,y:0},w:0,h:0,r:0,x2:0,y2:0,cr:0,sr:0},dirty:!0}}var cr=function(e,t){var n=0;return t[1]>e[1]?n=-1:t[1]<e[1]&&(n=1),n},ur=function(e,t){return-1*cr(e,t)};function hr(e,t,n,i){!function(e,t,n,i){if(0===t.length)t.push(e);else{for(var o=i?-1:1,r=0,s=t.length,a=Math.floor((r+s)/2);s>r;)n(e,t[a])*o<0?s=a:r=a+1,a=Math.floor((r+s)/2);t.splice(a,0,e)}}([e,t],n,cr,i)}function dr(e,t){var n=O(t,(function(t){return t[0]===e}));n>-1&&t.splice(n,1)}var pr=function(e){function t(e){var n;return r(this,t),(n=o(this,t)).instance=e,l(n,"_currentTransaction",null),l(n,"_sortedElements",{xmin:[],xmax:[],ymin:[],ymax:[]}),l(n,"_elementMap",new Map),l(n,"_transformedElementMap",new Map),l(n,"_bounds",{minx:0,maxx:0,miny:0,maxy:0}),n}return h(t,e),a(t,[{key:"_updateBounds",value:function(e,t,n){null!=t&&(dr(e,this._sortedElements.xmin),dr(e,this._sortedElements.xmax),dr(e,this._sortedElements.ymin),dr(e,this._sortedElements.ymax),hr(e,t.t.x,this._sortedElements.xmin,!1),hr(e,t.t.x+t.t.w,this._sortedElements.xmax,!0),hr(e,t.t.y,this._sortedElements.ymin,!1),hr(e,t.t.y+t.t.h,this._sortedElements.ymax,!0),!0!==n&&this._recalculateBounds())}},{key:"_recalculateBounds",value:function(){this._bounds.minx=this._sortedElements.xmin.length>0?this._sortedElements.xmin[0][1]:0,this._bounds.maxx=this._sortedElements.xmax.length>0?this._sortedElements.xmax[0][1]:0,this._bounds.miny=this._sortedElements.ymin.length>0?this._sortedElements.ymin[0][1]:0,this._bounds.maxy=this._sortedElements.ymax.length>0?this._sortedElements.ymax[0][1]:0}},{key:"recomputeBounds",value:function(){var e=this;this._sortedElements.xmin.length=0,this._sortedElements.xmax.length=0,this._sortedElements.ymin.length=0,this._sortedElements.ymax.length=0,this._elementMap.forEach((function(t,n){e._sortedElements.xmin.push([n,t.t.x]),e._sortedElements.xmax.push([n,t.t.x+t.t.w]),e._sortedElements.ymin.push([n,t.t.y]),e._sortedElements.ymax.push([n,t.t.y+t.t.h])})),this._sortedElements.xmin.sort(cr),this._sortedElements.ymin.sort(cr),this._sortedElements.xmax.sort(ur),this._sortedElements.ymax.sort(ur),this._recalculateBounds()}},{key:"_finaliseUpdate",value:function(e,t,n){var i,o,r,s,a,l,c,u,h,d,p,f,v,y,g,m,_,b,k;t.t=(i=t.x,o=t.y,r=t.w,s=t.h,a=t.r,l=i+r/2,c=o+s/2,u=Math.cos(a/360*Math.PI*2),h=Math.sin(a/360*Math.PI*2),p=(d=function(e,t){return{x:l+Math.round((e-l)*u-(t-c)*h),y:c+Math.round((t-c)*u-(e-l)*h)}})(i,o),f=d(i+r,o),v=d(i+r,o+s),y=d(i,o+s),g=d(i+r/2,o+s/2),m=Math.min(p.x,f.x,v.x,y.x),_=Math.max(p.x,f.x,v.x,y.x),b=Math.min(p.y,f.y,v.y,y.y),k=Math.max(p.y,f.y,v.y,y.y),{x:m,y:b,w:_-m,h:k-b,c:g,r:a,x2:_,y2:k,cr:u,sr:h}),this._transformedElementMap.set(e,t.t),!0!==n&&this._updateBounds(e,t,n)}},{key:"shouldFireEvent",value:function(e,t,n){return!0}},{key:"startTransaction",value:function(){if(null!=this._currentTransaction)throw new Error("Viewport: cannot start transaction; a transaction is currently active.");this._currentTransaction=new ar}},{key:"endTransaction",value:function(){var e=this;null!=this._currentTransaction&&(this._currentTransaction.affectedElements.forEach((function(t){var n=e.getPosition(t);e._finaliseUpdate(t,n,!0)})),this.recomputeBounds(),this._currentTransaction=null)}},{key:"updateElements",value:function(e){var t=this;j(e,(function(e){return t.updateElement(e.id,e.x,e.y,e.width,e.height,e.rotation)}))}},{key:"updateElement",value:function(e,t,n,i,o,r,s){var a=q(this._elementMap,e,lr);return a.dirty=null==t&&null==a.x||null==n&&null==a.y||null==i&&null==a.w||null==o&&null==a.h,null!=t&&(a.x=t),null!=n&&(a.y=n),null!=i&&(a.w=i),null!=o&&(a.h=o),null!=r&&(a.r=r||0),a.c.x=a.x+a.w/2,a.c.y=a.y+a.h/2,a.x2=a.x+a.w,a.y2=a.y+a.h,null==this._currentTransaction?this._finaliseUpdate(e,a,s):this._currentTransaction.affectedElements.add(e),a}},{key:"refreshElement",value:function(e,t){var n=this.instance.getManagedElements(),i=n[e]?n[e].el:null;if(null!=i){var o=this.getSize(i),r=this.getOffset(i);return this.updateElement(e,r.x,r.y,o.w,o.h,null,t)}return null}},{key:"getSize",value:function(e){return this.instance.getSize(e)}},{key:"getOffset",value:function(e){return this.instance.getOffset(e)}},{key:"registerElement",value:function(e,t){return this.updateElement(e,0,0,0,0,0,t)}},{key:"addElement",value:function(e,t,n,i,o,r){return this.updateElement(e,t,n,i,o,r)}},{key:"rotateElement",value:function(e,t){var n=q(this._elementMap,e,lr);return n.r=t||0,this._finaliseUpdate(e,n),n}},{key:"getBoundsWidth",value:function(){return this._bounds.maxx-this._bounds.minx}},{key:"getBoundsHeight",value:function(){return this._bounds.maxy-this._bounds.miny}},{key:"getX",value:function(){return this._bounds.minx}},{key:"getY",value:function(){return this._bounds.miny}},{key:"setSize",value:function(e,t,n){if(this._elementMap.has(e))return this.updateElement(e,null,null,t,n,null)}},{key:"setPosition",value:function(e,t,n){if(this._elementMap.has(e))return this.updateElement(e,t,n,null,null,null)}},{key:"reset",value:function(){this._sortedElements.xmin.length=0,this._sortedElements.xmax.length=0,this._sortedElements.ymin.length=0,this._sortedElements.ymax.length=0,this._elementMap.clear(),this._transformedElementMap.clear(),this._recalculateBounds()}},{key:"remove",value:function(e){dr(e,this._sortedElements.xmin),dr(e,this._sortedElements.xmax),dr(e,this._sortedElements.ymin),dr(e,this._sortedElements.ymax),this._elementMap.delete(e),this._transformedElementMap.delete(e),this._recalculateBounds()}},{key:"getPosition",value:function(e){return this._elementMap.get(e)}},{key:"getElements",value:function(){return this._elementMap}},{key:"isEmpty",value:function(){return 0===this._elementMap.size}}])}(yo);function fr(e,t){return t.theta-e.theta}function vr(e,t){return(e.theta<0?-Math.PI-e.theta:Math.PI-e.theta)-(t.theta<0?-Math.PI-t.theta:Math.PI-t.theta)}var yr=l(l(l(l({},Ti,vr),Oi,fr),Ii,fr),ji,vr);function gr(e){return!0===e.isContinuous}function mr(e){return!0===e.isContinuous}function _r(e){return e.locations.length>1}function br(e){return[e.currentLocation,e.locations[e.currentLocation]]}var kr=a((function e(t){var n=this;r(this,e),this.instance=t,l(this,"anchorLists",new Map),l(this,"anchorLocations",new Map),t.bind(Ge,(function(e){e.sourceEndpoint._anchor.isContinuous&&n._removeEndpointFromAnchorLists(e.sourceEndpoint),e.targetEndpoint._anchor.isContinuous&&n._removeEndpointFromAnchorLists(e.targetEndpoint)})),t.bind(Fe,(function(e){n._removeEndpointFromAnchorLists(e)}))}),[{key:"getAnchorOrientation",value:function(e){var t=this.anchorLocations.get(e.id);return t?[t.ox,t.oy]:[0,0]}},{key:"_distance",value:function(e,t,n,i,o,r,s){var a=i.x+e.x*o.w,l=i.y+e.y*o.h,c=i.x+o.w/2,u=i.y+o.h/2;if(null!=r&&r.length>0){var h=this.instance._applyRotations([a,l,0,0],r);a=h.x,l=h.y}return Math.sqrt(Math.pow(t-a,2)+Math.pow(n-l,2))+Math.sqrt(Math.pow(c-a,2)+Math.pow(u-l,2))}},{key:"_anchorSelector",value:function(e,t,n,i,o,r,s){for(var a=n.x+i.w/2,l=n.y+i.h/2,c=-1,u=1/0,h=0;h<s.length;h++){var d=this._distance(s[h],a,l,e,t,o,r);d<u&&(c=h+0,u=d)}return[c,s[c]]}},{key:"_floatingAnchorCompute",value:function(e,t){var n=t.xy,i={curX:n.x+e.size.w/2,curY:n.y+e.size.h/2,x:0,y:0,ox:0,oy:0};return this._setComputedPosition(e,i)}},{key:"_setComputedPosition",value:function(e,t,n){return this.anchorLocations.set(e.id,t),e.computedPosition=t,n&&(e.timestamp=n),t}},{key:"_computeSingleLocation",value:function(e,t,n,i){var o,r=i.rotation,s={curX:t.x+e.x*n.w+e.offx,curY:t.y+e.y*n.h+e.offy,x:e.x,y:e.y,ox:0,oy:0};if(null!=r&&r.length>0){var a=[e.iox,e.ioy],l={x:s.curX,y:s.curY,cr:0,sr:0};j(r,(function(e){l=Y(l,e.c,e.r);var t=[Math.round(a[0]*l.cr-a[1]*l.sr),Math.round(a[1]*l.cr+a[0]*l.sr)];a=t.slice()})),e.ox=a[0],e.oy=a[1],o={curX:l.x,curY:l.y,x:e.x,y:e.y,ox:a[0],oy:a[1]}}else e.ox=e.iox,e.oy=e.ioy,o=x({ox:e.iox,oy:e.ioy},s);return o}},{key:"_singleAnchorCompute",value:function(e,t){var n=t.xy,i=t.wh,o=t.timestamp,r=this.anchorLocations.get(e.id);if(null!=r&&o&&o===e.timestamp)return r;var s=f(br(e),2);s[0];var a=s[1];return r=this._computeSingleLocation(a,n,i,t),this._setComputedPosition(e,r,o)}},{key:"_defaultAnchorCompute",value:function(e,t){var n;if(1===e.locations.length)return this._singleAnchorCompute(e,t);var i=t.xy,o=t.wh,r=t.txy,s=t.twh,a=f(br(e),2),l=a[0],c=a[1];if(e.locked||null==r||null==s)n=this._computeSingleLocation(c,i,o,t);else{var u=f(this._anchorSelector(i,o,r,s,t.rotation,t.tRotation,e.locations),2),h=u[0],d=u[1];e.currentLocation=h,h!==l&&(e.cssClass=d.cls||e.cssClass,t.element._anchorLocationChanged(e)),n=this._computeSingleLocation(d,i,o,t)}return this._setComputedPosition(e,n,t.timestamp)}},{key:"_placeAnchors",value:function(e,t){var n=this,i=this.instance.viewport.getPosition(e),o=function(t,o,r,s,a,l){if(r.length>0)for(var c=r.sort(yr[t]),u=function(e,t,n,i,o){for(var r=n?e.w:e.h,s=n?e.h:e.w,a=[],l=r/(t.length+1),c=0;c<t.length;c++){var u=(c+1)*l,h=i*s;o&&(u=r-u);var d=n?u:h,p=e.x+d,f=d/e.w,v=n?h:u,y=e.y+v,g=v/e.h;if(0!==e.r&&null!=e.r){var m=Y({x:p,y:y},e.c,e.r);p=m.x,y=m.y}a.push({x:p,y:y,xLoc:f,yLoc:g,c:t[c].c})}return a}(i,c,s,a,t===Oi||t===Ti),h=0;h<u.length;h++){var d=u[h].c,p=d.endpoints[0].elementId===e?d.endpoints[0]:d.endpoints[1];n._setComputedPosition(p._anchor,{curX:u[h].x,curY:u[h].y,x:u[h].xLoc,y:u[h].yLoc,ox:l[0],oy:l[1]})}};o(Ii,0,t.bottom,!0,1,[0,1]),o(Ti,0,t.top,!0,0,[0,-1]),o(ji,0,t.left,!1,0,[-1,0]),o(Oi,0,t.right,!1,1,[1,0])}},{key:"_updateAnchorList",value:function(e,t,n,i,o,r,s,a,l,c,u){var h,d=i.endpoints[s],p=d.id,f=[1,0][s],v={theta:t,order:n,c:i,b:o,elId:r,epId:p},y=e[l],g=d._continuousAnchorEdge?e[d._continuousAnchorEdge]:null;if(g){var m=O(g,(function(e){return e.epId===p}));if(-1!==m){g.splice(m,1);for(var _=0;_<g.length;_++)!0!==(h=g[_].c).placeholder&&c.add(h),u.add(g[_].c.endpoints[s]),u.add(g[_].c.endpoints[f])}}for(var b=0;b<y.length;b++)!0!==(h=y[b].c).placeholder&&c.add(h),u.add(y[b].c.endpoints[s]),u.add(y[b].c.endpoints[f]);var k=a?0:y.length;y.splice(k,0,v),d._continuousAnchorEdge=l}},{key:"_removeEndpointFromAnchorLists",value:function(e){var t=this.anchorLists.get(e.elementId),n=0;!function(e,t){if(e){var i=function(e){return e.epId===t};N(e.top,i),N(e.left,i),N(e.bottom,i),N(e.right,i),n+=e.top.length,n+=e.left.length,n+=e.bottom.length,n+=e.right.length}}(t,e.id),0===n&&this.anchorLists.delete(e.elementId),this.anchorLocations.delete(e._anchor.id)}},{key:"computeAnchorLocation",value:function(e,t){var n;return n=gr(e)?this.anchorLocations.get(e.id)||{curX:0,curY:0,x:0,y:0,ox:0,oy:0}:mr(e)?this._floatingAnchorCompute(e,t):this._defaultAnchorCompute(e,t),e.timestamp=t.timestamp,n}},{key:"computePath",value:function(e,t){var n=this.instance.viewport.getPosition(e.sourceId),i=this.instance.viewport.getPosition(e.targetId),o=e.endpoints[0],r=e.endpoints[1],s=this.getEndpointLocation(o,{xy:n,wh:n,element:o,timestamp:t,rotation:this.instance._getRotations(e.sourceId)}),a=this.getEndpointLocation(r,{xy:i,wh:i,element:r,timestamp:t,rotation:this.instance._getRotations(e.targetId)});e.connector.resetBounds(),e.connector.compute({sourcePos:s,targetPos:a,sourceEndpoint:e.endpoints[0],targetEndpoint:e.endpoints[1],strokeWidth:e.paintStyleInUse.strokeWidth,sourceInfo:n,targetInfo:i})}},{key:"getEndpointLocation",value:function(e,t){t=t||{};var n=e._anchor,i=this.anchorLocations.get(n.id);return(null==i||null!=t.timestamp&&n.timestamp!==t.timestamp)&&(i=this.computeAnchorLocation(n,t),this._setComputedPosition(n,i,t.timestamp)),i}},{key:"getEndpointOrientation",value:function(e){return e._anchor?this.getAnchorOrientation(e._anchor):[0,0]}},{key:"setAnchorOrientation",value:function(e,t){var n=this.anchorLocations.get(e.id);null!=n&&(n.ox=t[0],n.oy=t[1])}},{key:"isDynamicAnchor",value:function(e){return!!e._anchor&&!gr(e._anchor)&&e._anchor.locations.length>1}},{key:"isFloating",value:function(e){return!!e._anchor&&mr(e._anchor)}},{key:"prepareAnchor",value:function(e){return to(e)}},{key:"redraw",value:function(e,t,n){var i=this,o=new Set,r=new Set,s=new Set;if(!this.instance._suspendDrawing){var a=this.instance.endpointsByElement[e]||[];t=t||X();for(var l,c,u={},h=0;h<a.length;h++)if(!1!==(c=a[h]).visible)if(r.add(c),l=c._anchor,0===c.connections.length)gr(l)&&(this.anchorLists.has(e)||this.anchorLists.set(e,{top:[],right:[],bottom:[],left:[]}),this._updateAnchorList(this.anchorLists.get(e),-Math.PI/2,0,{endpoints:[c,c],placeholder:!0},!1,e,0,!1,Hi(l),o,r),s.add(e));else for(var d=0;d<c.connections.length;d++){var p=c.connections[d],f=p.sourceId,v=p.targetId,y=gr(p.endpoints[0]._anchor),g=gr(p.endpoints[1]._anchor);if(y||g){var m=[f,(p.endpoints[0]._anchor.faces||[]).join("-"),v,(p.endpoints[1]._anchor.faces||[]).join("-")].join("-"),_=u[m],b=p.sourceId===e?1:0;y&&!this.anchorLists.has(f)&&this.anchorLists.set(f,{top:[],right:[],bottom:[],left:[]}),g&&!this.anchorLists.has(v)&&this.anchorLists.set(v,{top:[],right:[],bottom:[],left:[]});var k=this.instance.viewport.getPosition(v),x=this.instance.viewport.getPosition(f);if(v===f&&(y||g))this._updateAnchorList(this.anchorLists.get(f),-Math.PI/2,0,p,!1,v,0,!1,Ti,o,r),this._updateAnchorList(this.anchorLists.get(v),-Math.PI/2,0,p,!1,f,1,!1,Ti,o,r);else{var C=this.instance._getRotations(f),S=this.instance._getRotations(v);_||(_=this._calculateOrientation(f,v,x,k,p.endpoints[0]._anchor,p.endpoints[1]._anchor,C,S),u[m]=_),y&&this._updateAnchorList(this.anchorLists.get(f),_.theta,0,p,!1,v,0,!1,_.a[0],o,r),g&&this._updateAnchorList(this.anchorLists.get(v),_.theta2,-1,p,!0,f,1,!0,_.a[1],o,r)}y&&s.add(f),g&&s.add(v),o.add(p),(y&&0===b||g&&1===b)&&r.add(p.endpoints[b])}else{var w=c.connections[d].endpoints[p.sourceId===e?1:0];if(_r(w._anchor)){this.instance._paintEndpoint(w,{elementWithPrecedence:e,timestamp:t}),o.add(c.connections[d]);for(var E=0;E<w.connections.length;E++)w.connections[E]!==c.connections[d]&&o.add(w.connections[E])}else o.add(c.connections[d])}}s.forEach((function(e){i._placeAnchors(e,i.anchorLists.get(e))})),r.forEach((function(e){var n=i.instance.viewport.getPosition(e.elementId);i.instance._paintEndpoint(e,{timestamp:t,offset:n})})),o.forEach((function(e){i.instance._paintConnection(e,{timestamp:t})}))}return{c:o,e:r}}},{key:"reset",value:function(){this.anchorLocations.clear(),this.anchorLists.clear()}},{key:"setAnchor",value:function(e,t){null!=t&&(e._anchor=t)}},{key:"setConnectionAnchors",value:function(e,t){e.endpoints[0]._anchor=t[0],e.endpoints[1]._anchor=t[1]}},{key:"_calculateOrientation",value:function(e,t,n,i,o,r,s,a){var c=this;if(e===t)return{orientation:"identity",a:[Ti,Ti]};var u=Math.atan2(i.c.y-n.c.y,i.c.x-n.c.x),h=Math.atan2(n.c.y-i.c.y,n.c.x-i.c.x),d=[],p={};!function(e,t){for(var n=0;n<e.length;n++)if(p[e[n]]=l(l(l(l({},ji,{x:t[n][0].x,y:t[n][0].c.y}),Oi,{x:t[n][0].x+t[n][0].w,y:t[n][0].c.y}),Ti,{x:t[n][0].c.x,y:t[n][0].y}),Ii,{x:t[n][0].c.x,y:t[n][0].y+t[n][0].h}),null!=t[n][1]&&t[n][1].length>0)for(var i in p[e[n]])p[e[n]][i]=c.instance._applyRotationsXY(p[e[n]][i],t[n][1])}([ye,ge],[[n,s],[i,a]]);for(var f=[Ti,ji,Oi,Ii],v=0;v<f.length;v++)for(var y=0;y<f.length;y++)d.push({source:f[v],target:f[y],dist:Un(p.source[f[v]],p.target[f[y]])});d.sort((function(e,t){if(e.dist<t.dist)return-1;if(t.dist<e.dist)return 1;var n=l(l(l(l({},ji,0),Ti,1),Oi,2),Ii,3),i=n[e.source],o=n[t.source],r=n[e.target],s=n[t.target];return i<o?-1:o<i?1:r<s?-1:s<r?1:0}));for(var g=d[0].source,m=d[0].target,_=0;_<d.length&&(g=gr(o)&&o.locked?o.currentFace:!o.isContinuous||Xi(o,d[_].source)?d[_].source:null,m=r.isContinuous&&r.locked?r.currentFace:!r.isContinuous||Xi(r,d[_].target)?d[_].target:null,null==g||null==m);_++);return o.isContinuous&&this.setCurrentFace(o,g),r.isContinuous&&this.setCurrentFace(r,m),{a:[g,m],theta:u,theta2:h}}},{key:"setCurrentFace",value:function(e,t,n){e.currentFace=t,n&&null!=e.lockedFace&&(e.lockedFace=e.currentFace)}},{key:"lock",value:function(e){e.locked=!0,gr(e)&&(e.lockedFace=e.currentFace)}},{key:"unlock",value:function(e){e.locked=!1,gr(e)&&(e.lockedFace=null)}},{key:"selectAnchorLocation",value:function(e,t){var n=O(e.locations,(function(e){return e.x===t.x&&e.y===t.y}));return-1!==n&&(e.currentLocation=n,!0)}},{key:"lockCurrentAxis",value:function(e){null!=e.currentFace&&(e.lockedAxis=e.currentFace===ji||e.currentFace===Oi?Li:Ni)}},{key:"unlockCurrentAxis",value:function(e){e.lockedAxis=null}},{key:"anchorsEqual",value:function(e,t){if(!e||!t)return!1;var n=e.locations[e.currentLocation],i=t.locations[t.currentLocation];return n.x===i.x&&n.y===i.y&&n.offx===i.offx&&n.offy===i.offy&&n.ox===i.ox&&n.oy===i.oy}}]),xr={},Cr=function(e,t,n){var i=xr[t];if(i)return new i(e,n);throw{message:"jsPlumb: unknown connector type '"+t+"'"}},Sr=function(e,t){xr[e]=t},wr=function(e){function t(e){var n;return r(this,t),l(n=o(this,t,[e]),"length",void 0),l(n,"m",void 0),l(n,"m2",void 0),l(n,"type",t.segmentType),n._setCoordinates({x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2}),n}return h(t,e),a(t,[{key:"getPath",value:function(e){return(e?"M "+this.x1+" "+this.y1+" ":"")+"L "+this.x2+" "+this.y2}},{key:"_recalc",value:function(){this.length=Math.sqrt(Math.pow(this.x2-this.x1,2)+Math.pow(this.y2-this.y1,2)),this.m=Hn({x:this.x1,y:this.y1},{x:this.x2,y:this.y2}),this.m2=-1/this.m,this.extents={xmin:Math.min(this.x1,this.x2),ymin:Math.min(this.y1,this.y2),xmax:Math.max(this.x1,this.x2),ymax:Math.max(this.y1,this.y2)}}},{key:"getLength",value:function(){return this.length}},{key:"getGradient",value:function(){return this.m}},{key:"_setCoordinates",value:function(e){this.x1=e.x1,this.y1=e.y1,this.x2=e.x2,this.y2=e.y2,this._recalc()}},{key:"pointOnPath",value:function(e,t){if(0!==e||t){if(1!==e||t){var n=t?e>0?e:this.length+e:e*this.length;return Kn({x:this.x1,y:this.y1},{x:this.x2,y:this.y2},n)}return{x:this.x2,y:this.y2}}return{x:this.x1,y:this.y1}}},{key:"gradientAtPoint",value:function(e,t){return this.m}},{key:"pointAlongPathFrom",value:function(e,t,n){var i=this.pointOnPath(e,n),o=t<=0?{x:this.x1,y:this.y1}:{x:this.x2,y:this.y2};return t<=0&&Math.abs(t)>1&&(t*=-1),Kn(i,o,t)}},{key:"within",value:function(e,t,n){return n>=Math.min(e,t)&&n<=Math.max(e,t)}},{key:"closest",value:function(e,t,n){return Math.abs(n-e)<Math.abs(n-t)?e:t}},{key:"findClosestPointOnPath",value:function(e,t){var n={d:1/0,x:null,y:null,l:null,x1:this.x1,x2:this.x2,y1:this.y1,y2:this.y2};if(0===this.m)n.y=this.y1,n.x=this.within(this.x1,this.x2,e)?e:this.closest(this.x1,this.x2,e);else if(this.m===1/0||this.m===-1/0)n.x=this.x1,n.y=this.within(this.y1,this.y2,t)?t:this.closest(this.y1,this.y2,t);else{var i=this.y1-this.m*this.x1,o=(t-this.m2*e-i)/(this.m-this.m2),r=this.m*o+i;n.x=this.within(this.x1,this.x2,o)?o:this.closest(this.x1,this.x2,o),n.y=this.within(this.y1,this.y2,r)?r:this.closest(this.y1,this.y2,r)}var s=Un({x:n.x,y:n.y},{x:this.x1,y:this.y1});return n.d=Un({x:e,y:t},n),n.l=s/length,n}},{key:"_pointLiesBetween",value:function(e,t,n){return n>t?t<=e&&e<=n:t>=e&&e>=n}},{key:"lineIntersection",value:function(e,t,n,i){var o=Math.abs(Hn({x:e,y:t},{x:n,y:i})),r=Math.abs(this.m),s=r===1/0?this.x1:this.y1-r*this.x1,a=[],l=o===1/0?e:t-o*e;if(o!==r)if(o===1/0&&0===r)this._pointLiesBetween(e,this.x1,this.x2)&&this._pointLiesBetween(this.y1,t,i)&&a.push({x:e,y:this.y1});else if(0===o&&r===1/0)this._pointLiesBetween(t,this.y1,this.y2)&&this._pointLiesBetween(this.x1,e,n)&&a.push({x:this.x1,y:t});else{var c,u;o===1/0?(c=e,this._pointLiesBetween(c,this.x1,this.x2)&&(u=r*e+s,this._pointLiesBetween(u,t,i)&&a.push({x:c,y:u}))):0===o?(u=t,this._pointLiesBetween(u,this.y1,this.y2)&&(c=(t-s)/r,this._pointLiesBetween(c,e,n)&&a.push({x:c,y:u}))):(u=r*(c=(l-s)/(r-o))+s,this._pointLiesBetween(c,this.x1,this.x2)&&this._pointLiesBetween(u,this.y1,this.y2)&&a.push({x:c,y:u}))}return a}},{key:"boxIntersection",value:function(e,t,n,i){var o=[];return o.push.apply(o,this.lineIntersection(e,t,e+n,t)),o.push.apply(o,this.lineIntersection(e+n,t,e+n,t+i)),o.push.apply(o,this.lineIntersection(e+n,t+i,e,t+i)),o.push.apply(o,this.lineIntersection(e,t+i,e,t)),o}}])}(rn);l(wr,"segmentType","Straight");var Er=function(e){function t(){var e;r(this,t);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return l(e=o(this,t,[].concat(i)),"type",t.type),e}return h(t,e),a(t,[{key:"getDefaultStubs",value:function(){return[0,0]}},{key:"_compute",value:function(e,t){this._addSegment(wr,{x1:e.sx,y1:e.sy,x2:e.startStubX,y2:e.startStubY}),this._addSegment(wr,{x1:e.startStubX,y1:e.startStubY,x2:e.endStubX,y2:e.endStubY}),this._addSegment(wr,{x1:e.endStubX,y1:e.endStubY,x2:e.tx,y2:e.ty}),this.geometry={source:t.sourcePos,target:t.targetPos}}},{key:"transformGeometry",value:function(e,t,n){return{source:this.transformAnchorPlacement(e.source,t,n),target:this.transformAnchorPlacement(e.target,t,n)}}}])}(Yo);function Pr(e,t,n){var i=[],o=function(t){return S(t)?t:e.getId(t)};if(t)if("string"==typeof t){if("*"===t)return t;i.push(t)}else{var r;if(n)i=t;else if(null!=t.length)(r=i).push.apply(r,g(g(t).map(o)));else i.push(o(t))}return i}function Ar(e,t,n){null!=t&&(t.connections.push(e),1===t.connections.length&&e.instance.addClass(e.source,e.instance.connectedClass)),null!=n&&(null!=t&&e.sourceId===e.targetId||(n.connections.push(e),1===n.connections.length&&e.instance.addClass(e.target,e.instance.connectedClass)))}function Dr(e,t,n){if(null!=t){var i=t.connections.length;N(t.connections,(function(t){return e.id===t.id})),i>0&&0===t.connections.length&&e.instance.removeClass(e.source,e.instance.connectedClass)}if(null!=n){var o=n.connections.length;null!=t&&e.sourceId===e.targetId||N(n.connections,(function(t){return e.id===t.id})),o>0&&0===n.connections.length&&e.instance.removeClass(e.target,e.instance.connectedClass)}}l(Er,"type","Straight");var Mr=function(e){function t(e,n){var i;return r(this,t),(i=o(this,t))._instanceIndex=e,l(i,"defaults",void 0),l(i,"_initialDefaults",{}),l(i,"isConnectionBeingDragged",!1),l(i,"currentlyDragging",!1),l(i,"hoverSuspended",!1),l(i,"_suspendDrawing",!1),l(i,"_suspendedAt",null),l(i,"connectorClass",Ae),l(i,"connectorOutlineClass","jtk-connector-outline"),l(i,"connectedClass","jtk-connected"),l(i,"endpointClass",De),l(i,"endpointConnectedClass","jtk-endpoint-connected"),l(i,"endpointFullClass","jtk-endpoint-full"),l(i,"endpointFloatingClass",Me),l(i,"endpointDropAllowedClass","jtk-endpoint-drop-allowed"),l(i,"endpointDropForbiddenClass","jtk-endpoint-drop-forbidden"),l(i,"endpointAnchorClassPrefix","jtk-endpoint-anchor"),l(i,"overlayClass",Oe),l(i,"connections",[]),l(i,"endpointsByElement",{}),l(i,"endpointsByUUID",new Map),l(i,"sourceSelectors",[]),l(i,"targetSelectors",[]),l(i,"allowNestedGroups",void 0),l(i,"_curIdStamp",1),l(i,"viewport",new pr(i)),l(i,"router",void 0),l(i,"groupManager",void 0),l(i,"_connectionTypes",new Map),l(i,"_endpointTypes",new Map),l(i,"_container",void 0),l(i,"_managedElements",{}),l(i,"DEFAULT_SCOPE",void 0),l(i,"_zoom",1),i.defaults={anchor:on.Bottom,anchors:[null,null],connectionsDetachable:!0,connectionOverlays:[],connector:Er.type,container:null,endpoint:Qo.type,endpointOverlays:[],endpoints:[null,null],endpointStyle:{fill:"#456"},endpointStyles:[null,null],endpointHoverStyle:null,endpointHoverStyles:[null,null],hoverPaintStyle:null,listStyle:{},maxConnections:1,paintStyle:{strokeWidth:2,stroke:"#456"},reattachConnections:!1,scope:"jsplumb_defaultscope",allowNestedGroups:!0},n&&x(i.defaults,n),x(i._initialDefaults,i.defaults),null!=i._initialDefaults.paintStyle&&(i._initialDefaults.paintStyle.strokeWidth=i._initialDefaults.paintStyle.strokeWidth||2),i.DEFAULT_SCOPE=i.defaults.scope,i.allowNestedGroups=!1!==i._initialDefaults.allowNestedGroups,i.router=new kr(i),i.groupManager=new ir(i),i.setContainer(i._initialDefaults.container),i}return h(t,e),a(t,[{key:"defaultScope",get:function(){return this.DEFAULT_SCOPE}},{key:"currentZoom",get:function(){return this._zoom}},{key:"areDefaultAnchorsSet",value:function(){return this.validAnchorsSpec(this.defaults.anchors)}},{key:"validAnchorsSpec",value:function(e){return null!=e&&null!=e[0]&&null!=e[1]}},{key:"getContainer",value:function(){return this._container}},{key:"setZoom",value:function(e,t){return this._zoom=e,this.fire(Xe,this._zoom),t&&this.repaintEverything(),!0}},{key:"_idstamp",value:function(){return""+this._curIdStamp++}},{key:"checkCondition",value:function(e,t){var n=this.getListener(e),i=!0;if(n&&n.length>0){var o=Array.prototype.slice.call(arguments,1);try{for(var r=0,s=n.length;r<s;r++)i=i&&n[r].apply(n[r],o)}catch(t){z("cannot check condition ["+e+"]"+t)}}return i}},{key:"getId",value:function(e,t){if(null==e)return null;var n=this.getAttribute(e,Ce);return n&&"undefined"!==n||(2===arguments.length&&void 0!==arguments[1]?n=t:(1===arguments.length||3===arguments.length&&!arguments[2])&&(n="jsplumb-"+this._instanceIndex+"-"+this._idstamp()),this.setAttribute(e,Ce,n)),n}},{key:"getConnections",value:function(e,t){e?e.constructor===String&&(e={scope:e}):e={};for(var n=Pr(this,e.scope||this.defaultScope,!0),i=Pr(this,e.source),o=Pr(this,e.target),r=!t&&n.length>1?{}:[],s=function(e,i){if(!t&&n.length>1){var o=r[e];null==o&&(o=r[e]=[]),o.push(i)}else r.push(i)},a=0,l=this.connections.length;a<l;a++){var c=this.connections[a],u=c.proxies&&c.proxies[0]?c.proxies[0].originalEp.elementId:c.sourceId,h=c.proxies&&c.proxies[1]?c.proxies[1].originalEp.elementId:c.targetId;k(n,c.scope)&&k(i,u)&&k(o,h)&&s(c.scope,c)}return r}},{key:"select",value:function(e){return(e=e||{}).scope=e.scope||"*",new sr(this,e.connections||this.getConnections(e,!0))}},{key:"selectEndpoints",value:function(e){(e=e||{}).scope=e.scope||un;var t=!e.element&&!e.source&&!e.target,n=t?un:Pr(this,e.element),i=t?un:Pr(this,e.source),o=t?un:Pr(this,e.target),r=Pr(this,e.scope,!0),s=[];for(var a in this.endpointsByElement){var l=k(n,a,!0),c=k(i,a,!0),u="*"!==i,h=k(o,a,!0),d="*"!==o;if(l||c||h)e:for(var p=0,f=this.endpointsByElement[a].length;p<f;p++){var v=this.endpointsByElement[a][p];if(k(r,v.scope,!0)){var y=u&&i.length>0&&!v.isSource,g=d&&o.length>0&&!v.isTarget;if(y||g)continue e;s.push(v)}}}return new rr(this,s)}},{key:"setContainer",value:function(e){this._container=e,this.fire("container:change",this._container)}},{key:"_set",value:function(e,t,n){var i,o,r=[{el:"source",elId:"sourceId"},{el:"target",elId:"targetId"}][n],s=e[r.elId],a=e.endpoints[n],l={index:n,originalEndpoint:a,originalSourceId:0===n?s:e.sourceId,newSourceId:e.sourceId,originalTargetId:1===n?s:e.targetId,newTargetId:e.targetId,connection:e,newEndpoint:a};return t instanceof Lo?(i=t).addConnection(e):i=(o=this.getId(t))===e[r.elId]?null:e.makeEndpoint(0===n,t,o),null!=i&&(l.newEndpoint=i,a.detachFromConnection(e),e.endpoints[n]=i,e[r.el]=i.element,e[r.elId]=i.elementId,l[0===n?"newSourceId":"newTargetId"]=i.elementId,this.fireMoveEvent(l),this._paintConnection(e)),l}},{key:"setSource",value:function(e,t){Dr(e,this._managedElements[e.sourceId]);var n=this._set(e,t,0);Ar(e,this._managedElements[n.newSourceId])}},{key:"setTarget",value:function(e,t){Dr(e,this._managedElements[e.targetId]);var n=this._set(e,t,1);Ar(e,this._managedElements[n.newTargetId])}},{key:"setConnectionType",value:function(e,t,n){e.setType(t,n),this._paintConnection(e)}},{key:"isHoverSuspended",value:function(){return this.hoverSuspended}},{key:"setSuspendDrawing",value:function(e,t){var n=this._suspendDrawing;return this._suspendDrawing=e,e?this._suspendedAt=""+(new Date).getTime():(this._suspendedAt=null,this.viewport.recomputeBounds()),t&&this.repaintEverything(),n}},{key:"getSuspendedAt",value:function(){return this._suspendedAt}},{key:"batch",value:function(e,t){var n=!0===this._suspendDrawing;n||this.setSuspendDrawing(!0),e(),n||this.setSuspendDrawing(!1,!t)}},{key:"each",value:function(e,t){if(null!=e){if(null!=e.length)for(var n=0;n<e.length;n++)t(e[n]);else t(e);return this}}},{key:"updateOffset",value:function(e){var t=e.elId;return e.recalc?this.viewport.refreshElement(t):this.viewport.getPosition(t)}},{key:"deleteConnection",value:function(e,t){if(null!=e&&!0!==e.deleted&&((t=t||{}).force||M(!0,!1,[[e.endpoints[0],Ye,[e]],[e.endpoints[1],Ye,[e]],[e,Ye,[e]],[this,Pe,[Ve,e]]]))){Dr(e,this._managedElements[e.sourceId],this._managedElements[e.targetId]),this.fireDetachEvent(e,!e.pending&&!1!==t.fireEvent,t.originalEvent);var n=e.endpoints[0],i=e.endpoints[1];return n!==t.endpointToIgnore&&n.detachFromConnection(e,null,!0),i!==t.endpointToIgnore&&i.detachFromConnection(e,null,!0),N(this.connections,(function(t){return e.id===t.id})),e.destroy(),n!==t.endpointToIgnore&&n.deleteOnEmpty&&0===n.connections.length&&this.deleteEndpoint(n),i!==t.endpointToIgnore&&i.deleteOnEmpty&&0===i.connections.length&&this.deleteEndpoint(i),!0}return!1}},{key:"deleteEveryConnection",value:function(e){var t=this;e=e||{};var n=this.connections.length,i=0;return this.batch((function(){for(var o=0;o<n;o++)i+=t.deleteConnection(t.connections[0],e)?1:0})),i}},{key:"deleteConnectionsForElement",value:function(e,t){var n=this.getId(e),i=this._managedElements[n];if(i)for(var o=i.connections.length,r=0;r<o;r++)this.deleteConnection(i.connections[0],t);return this}},{key:"fireDetachEvent",value:function(e,t,n){var i=null!=e.id?{connection:e,source:e.source,target:e.target,sourceId:e.sourceId,targetId:e.targetId,sourceEndpoint:e.endpoints[0],targetEndpoint:e.endpoints[1]}:e;t&&this.fire("connection:detach",i,n),this.fire(Ge,i,n)}},{key:"fireMoveEvent",value:function(e,t){this.fire(Ne,e,t)}},{key:"manageAll",value:function(e,t){for(var n=S(e)?this.getSelector(this.getContainer(),e):e,i=0;i<n.length;i++)this.manage(n[i],null,t)}},{key:"manage",value:function(e,t,n){null==this.getAttribute(e,Ce)&&(t=t||this.getAttribute(e,"id")||X(),this.setAttribute(e,Ce,t));var i=this.getId(e);if(this._managedElements[i])n&&(this._managedElements[i].viewportElement=this.updateOffset({elId:i,timestamp:null,recalc:!0}));else{var o={el:e,endpoints:[],connections:[],rotation:0,data:{}};this._managedElements[i]=o,this._suspendDrawing?o.viewportElement=this.viewport.registerElement(i,!0):o.viewportElement=this.updateOffset({elId:i,recalc:!0}),this.fire(Re,{el:e})}return this._managedElements[i]}},{key:"getManagedData",value:function(e,t,n){if(this._managedElements[e]){var i=this._managedElements[e].data[t];return null!=i?i[n]:null}}},{key:"setManagedData",value:function(e,t,n,i){this._managedElements[e]&&(this._managedElements[e].data[t]=this._managedElements[e].data[t]||{},this._managedElements[e].data[t][n]=i)}},{key:"getManagedElement",value:function(e){return this._managedElements[e]?this._managedElements[e].el:null}},{key:"unmanage",value:function(e,t){var n=this;this.removeAllEndpoints(e,!0);var i=function(e){var i=n.getId(e);n.removeAttribute(e,Ce),delete n._managedElements[i],n.viewport.remove(i),n.fire(Ue,{el:e,id:i}),e&&t&&n._removeElement(e)};this._getAssociatedElements(e).map(i),i(e)}},{key:"rotate",value:function(e,t,n){var i=this.getId(e);return this._managedElements[i]&&(this._managedElements[i].rotation=t,this.viewport.rotateElement(i,t),!0!==n)?this.revalidate(e):{c:new Set,e:new Set}}},{key:"_getRotation",value:function(e){var t=this._managedElements[e];return null!=t&&t.rotation||0}},{key:"_getRotations",value:function(e){var t=this,n=[],i=this._managedElements[e],o=function(e){if(null!=e.group){var i=t._managedElements[e.group];null!=i&&(n.push({r:i.viewportElement.r,c:i.viewportElement.c}),o(i))}};return null!=i&&(n.push({r:i.viewportElement.r||0,c:i.viewportElement.c}),o(i)),n}},{key:"_applyRotations",value:function(e,t){var n=e.slice(),i={x:n[0],y:n[1],cr:0,sr:0};return j(t,(function(e){i=Y(i,e.c,e.r)})),i}},{key:"_applyRotationsXY",value:function(e,t){return j(t,(function(t){e=Y(e,t.c,t.r)})),e}},{key:"_internal_newEndpoint",value:function(e){var t=x({},e),n=this.manage(t.element);t.elementId=this.getId(t.element),t.id="ep_"+this._idstamp();var i=new Lo(this,t);return function(e,t){null!=e&&e.endpoints.push(t)}(n,i),e.uuid&&this.endpointsByUUID.set(e.uuid,i),R(this.endpointsByElement,i.elementId,i),this._suspendDrawing||this._paintEndpoint(i,{timestamp:this._suspendedAt}),i}},{key:"_deriveEndpointAndAnchorSpec",value:function(e,t){for(var n=((t?"":"default ")+e).split(/[\s]/),i=null,o=null,r=null,s=null,a=0;a<n.length;a++){var l=this.getConnectionType(n[a]);l&&(l.endpoints&&(i=l.endpoints),l.endpoint&&(o=l.endpoint),l.anchors&&(s=l.anchors),l.anchor&&(r=l.anchor))}return{endpoints:i||[o,o],anchors:s||[r,r]}}},{key:"revalidate",value:function(e,t){var n=this.getId(e);return this.updateOffset({elId:n,recalc:!0,timestamp:t}),this.repaint(e)}},{key:"repaintEverything",value:function(){var e,t=X();for(e in this._managedElements)this.viewport.refreshElement(e,!0);for(e in this.viewport.recomputeBounds(),this._managedElements)this.repaint(this._managedElements[e].el,t,!0);return this}},{key:"setElementPosition",value:function(e,t,n){var i=this.getId(e);return this.viewport.setPosition(i,t,n),this.repaint(e)}},{key:"repaint",value:function(e,t,n){var i={c:new Set,e:new Set},o=function(e){e.c.forEach((function(e){return i.c.add(e)})),e.e.forEach((function(e){return i.e.add(e)}))};if(!this._suspendDrawing){var r=this.getId(e);if(null!=e){var s=this._getAssociatedElements(e);if(null==t&&(t=X()),!n)for(var a=0;a<s.length;a++)this.updateOffset({elId:this.getId(s[a]),recalc:!0,timestamp:t});if(o(this.router.redraw(r,t,null)),s.length>0)for(var l=0;l<s.length;l++)o(this.router.redraw(this.getId(s[l]),t,null))}}return i}},{key:"unregisterEndpoint",value:function(e){var t=e.getUuid();t&&this.endpointsByUUID.delete(t),function(e,t){null!=e&&N(e.endpoints,(function(e){return e===t}))}(this._managedElements[e.elementId],e);var n=this.endpointsByElement[e.elementId];null!=n&&(this.endpointsByElement[e.elementId]=n.filter((function(t){return t!==e}))),this.fire(Fe,e)}},{key:"_maybePruneEndpoint",value:function(e){return!(!e.deleteOnEmpty||0!==e.connections.length)&&(this.deleteEndpoint(e),!0)}},{key:"deleteEndpoint",value:function(e){var t=this,n="string"==typeof e?this.endpointsByUUID.get(e):e;if(n){var i=n.proxiedBy,o=n.connections.slice();j(o,(function(e){n.detachFromConnection(e,null,!0)})),this.unregisterEndpoint(n),n.destroy(),j(o,(function(e){t.deleteConnection(e,{force:!0,endpointToIgnore:n})})),null!=i&&this.deleteEndpoint(i)}return this}},{key:"addEndpoint",value:function(e,t,n){var i=x({},n=n||{});x(i,t||{});var o=x({element:e},i);return this._internal_newEndpoint(o)}},{key:"addEndpoints",value:function(e,t,n){for(var i=[],o=0,r=t.length;o<r;o++)i.push(this.addEndpoint(e,t[o],n));return i}},{key:"reset",value:function(){var e=this;this.silently((function(){e.endpointsByElement={},e._managedElements={},e.endpointsByUUID.clear(),e.viewport.reset(),e.router.reset(),e.groupManager.reset(),e.connections.length=0}))}},{key:"destroy",value:function(){this.reset(),this.unbind(),this.sourceSelectors.length=0,this.targetSelectors.length=0,this._connectionTypes.clear(),this._endpointTypes.clear()}},{key:"getEndpoints",value:function(e){return this.endpointsByElement[this.getId(e)]||[]}},{key:"getEndpoint",value:function(e){return this.endpointsByUUID.get(e)}},{key:"setEndpointUuid",value:function(e,t){e.uuid&&this.endpointsByUUID.delete(e.uuid),e.uuid=t,this.endpointsByUUID.set(t,e)}},{key:"connect",value:function(e,t){try{var n=this._prepareConnectionParams(e,t),i=this._newConnection(n);return this._finaliseConnection(i,n),i}catch(e){return void z(e)}}},{key:"_prepareConnectionParams",value:function(e,t){var n=x({},e);t&&x(n,t);var i=n;if(i.source&&i.source.endpoint&&(i.sourceEndpoint=i.source),i.target&&i.target.endpoint&&(i.targetEndpoint=i.target),e.uuids&&(i.sourceEndpoint=this.getEndpoint(e.uuids[0]),i.targetEndpoint=this.getEndpoint(e.uuids[1])),null!=i.sourceEndpoint){if(i.sourceEndpoint.isFull())throw"Cannot establish connection: source endpoint is full";if(i.type||(i.type=i.sourceEndpoint.edgeType),i.sourceEndpoint.connectorOverlays){i.overlays=i.overlays||[];for(var o=0,r=i.sourceEndpoint.connectorOverlays.length;o<r;o++)i.overlays.push(i.sourceEndpoint.connectorOverlays[o])}i.sourceEndpoint.scope&&(i.scope=i.sourceEndpoint.scope)}else if(null==i.source)throw"Cannot establish connection: source does not exist";if(null!=i.targetEndpoint){if(i.targetEndpoint.isFull())throw"Cannot establish connection: target endpoint is full"}else if(null==i.target)throw"Cannot establish connection: target does not exist";if(i.sourceEndpoint&&i.targetEndpoint&&!function(e,t){for(var n=e.scope.split(/\s/),i=t.scope.split(/\s/),o=0;o<n.length;o++)for(var r=0;r<i.length;r++)if(i[r]===n[o])return!0;return!1}(i.sourceEndpoint,i.targetEndpoint))throw"Cannot establish connection: scopes do not match";return i}},{key:"_newConnection",value:function(e){e.id="con_"+this._idstamp();var t=new Ro(this,e);return Ar(t,this._managedElements[t.sourceId],this._managedElements[t.targetId]),this._paintConnection(t),t}},{key:"_finaliseConnection",value:function(e,t,n){t=t||{},e.suspendedEndpoint||this.connections.push(e),e.pending=null,e.endpoints[0].isTemporarySource=!1,this.repaint(e.source);var i={connection:e,source:e.source,target:e.target,sourceId:e.sourceId,targetId:e.targetId,sourceEndpoint:e.endpoints[0],targetEndpoint:e.endpoints[1]};this.fire(Le,i,n),t.doNotFireConnectionEvent||!1===t.fireEvent||this.fire(Ie,i,n)}},{key:"removeAllEndpoints",value:function(e,t){var n=this,i=function(e){var t,i,o=n.getId(e),r=n.endpointsByElement[o];if(r)for(t=0,i=r.length;t<i;t++)n.deleteEndpoint(r[t]);delete n.endpointsByElement[o]};return t&&this._getAssociatedElements(e).map(i),i(e),this}},{key:"_createSourceDefinition",value:function(e,t){var n=x({},t);x(n,e),n.edgeType=n.edgeType||an;var i=this._deriveEndpointAndAnchorSpec(n.edgeType);n.endpoint=n.endpoint||i.endpoints[0],n.anchor=n.anchor||i.anchors[0];var o=n.maxConnections||-1;return{def:x({},n),uniqueEndpoint:n.uniqueEndpoint,maxConnections:o,enabled:!0,endpoint:null}}},{key:"addSourceSelector",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this._createSourceDefinition(t),o=new so(e,i,n);return this.sourceSelectors.push(o),o}},{key:"removeSourceSelector",value:function(e){N(this.sourceSelectors,(function(t){return t===e}))}},{key:"removeTargetSelector",value:function(e){N(this.targetSelectors,(function(t){return t===e}))}},{key:"addTargetSelector",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this._createTargetDefinition(t),o=new so(e,i,n);return this.targetSelectors.push(o),o}},{key:"_createTargetDefinition",value:function(e,t){var n=x({},t);x(n,e),n.edgeType=n.edgeType||an;var i=n.maxConnections||-1;return{def:x({},n),uniqueEndpoint:n.uniqueEndpoint,maxConnections:i,enabled:!0,endpoint:null}}},{key:"show",value:function(e,t){return this._setVisible(e,me,t)}},{key:"hide",value:function(e,t){return this._setVisible(e,_e,t)}},{key:"_setVisible",value:function(e,t,n){var i=t===me,o=null;n&&(o=function(e){e.setVisible(i,!0,!0)});var r=this.getId(e);return this._operation(e,(function(e){if(i&&n){var t=e.sourceId===r?1:0;e.endpoints[t].isVisible()&&e.setVisible(!0)}else e.setVisible(i)}),o),this}},{key:"toggleVisible",value:function(e,t){var n=null;t&&(n=function(e){var t=e.isVisible();e.setVisible(!t)}),this._operation(e,(function(e){var t=e.isVisible();e.setVisible(!t)}),n)}},{key:"_operation",value:function(e,t,n){var i=this.getId(e),o=this.endpointsByElement[i];if(o&&o.length)for(var r=0,s=o.length;r<s;r++){for(var a=0,l=o[r].connections.length;a<l;a++){if(t(o[r].connections[a]))return}n&&n(o[r])}}},{key:"registerConnectionType",value:function(e,t){if(this._connectionTypes.set(e,x({},t)),t.overlays){for(var n={},i=0;i<t.overlays.length;i++){var o=go(t.overlays[i]);n[o.options.id]=o}this._connectionTypes.get(e).overlays=n}}},{key:"registerConnectionTypes",value:function(e){for(var t in e)this.registerConnectionType(t,e[t])}},{key:"registerEndpointType",value:function(e,t){if(this._endpointTypes.set(e,x({},t)),t.overlays){for(var n={},i=0;i<t.overlays.length;i++){var o=go(t.overlays[i]);n[o.options.id]=o}this._endpointTypes.get(e).overlays=n}}},{key:"registerEndpointTypes",value:function(e){for(var t in e)this.registerEndpointType(t,e[t])}},{key:"getType",value:function(e,t){return"connection"===t?this.getConnectionType(e):this.getEndpointType(e)}},{key:"getConnectionType",value:function(e){return this._connectionTypes.get(e)}},{key:"getEndpointType",value:function(e){return this._endpointTypes.get(e)}},{key:"importDefaults",value:function(e){for(var t in e)this.defaults[t]=e[t];return null!=this.defaults.paintStyle&&(this.defaults.paintStyle.strokeWidth=this.defaults.paintStyle.strokeWidth||2),e.container&&this.setContainer(e.container),this}},{key:"restoreDefaults",value:function(){return this.defaults=x({},this._initialDefaults),this}},{key:"getManagedElements",value:function(){return this._managedElements}},{key:"proxyConnection",value:function(e,t,n,i,o){var r,s=null!=e.proxies[t],a=s?e.proxies[t].originalEp.elementId:e.endpoints[t].elementId,l=s?e.proxies[t].originalEp:e.endpoints[t],c=this.getId(n);e.proxies[t]?e.proxies[t].ep.elementId===c?r=e.proxies[t].ep:(e.proxies[t].ep.detachFromConnection(e,t),r=this._internal_newEndpoint({element:n,endpoint:i(e,t),anchor:o(e,t),parameters:{isProxyEndpoint:!0}})):r=this._internal_newEndpoint({element:n,endpoint:i(e,t),anchor:o(e,t),parameters:{isProxyEndpoint:!0}}),r.deleteOnEmpty=!0,e.proxies[t]={ep:r,originalEp:l},this.sourceOrTargetChanged(a,c,e,n,t),l.detachFromConnection(e,null,!0),r.connections=[e],e.endpoints[t]=r,l.proxiedBy=r,l.setVisible(!1),e.setVisible(!0),this.revalidate(n)}},{key:"unproxyConnection",value:function(e,t){if(null!=e.proxies&&null!=e.proxies[t]){var n=e.proxies[t].originalEp.element,i=e.proxies[t].originalEp.elementId,o=e.proxies[t].ep.elementId;e.endpoints[t]=e.proxies[t].originalEp,delete e.proxies[t].originalEp.proxiedBy,this.sourceOrTargetChanged(o,i,e,n,t),e.proxies[t].ep.detachFromConnection(e,null),e.proxies[t].originalEp.addConnection(e),e.isVisible()&&e.proxies[t].originalEp.setVisible(!0),e.proxies[t]=null,-1===O(e.proxies,(function(e){return null!=e}))&&(e.proxies.length=0)}}},{key:"sourceOrTargetChanged",value:function(e,t,n,i,o){e!==t&&(0===o?(n.sourceId=t,n.source=i):1===o&&(n.targetId=t,n.target=i),Dr(n,this._managedElements[e]),Ar(n,this._managedElements[t]))}},{key:"getGroup",value:function(e){return this.groupManager.getGroup(e)}},{key:"getGroupFor",value:function(e){return this.groupManager.getGroupFor(e)}},{key:"addGroup",value:function(e){return this.groupManager.addGroup(e)}},{key:"addToGroup",value:function(e){for(var t,n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return(t=this.groupManager).addToGroup.apply(t,[e,!1].concat(i))}},{key:"collapseGroup",value:function(e){this.groupManager.collapseGroup(e)}},{key:"expandGroup",value:function(e){this.groupManager.expandGroup(e)}},{key:"toggleGroup",value:function(e){this.groupManager.toggleGroup(e)}},{key:"removeGroup",value:function(e,t,n,i){return this.groupManager.removeGroup(e,t,n,i)}},{key:"removeAllGroups",value:function(e,t){this.groupManager.removeAllGroups(e,t,!1)}},{key:"removeFromGroup",value:function(e,t,n){this.groupManager.removeFromGroup(e,n,t),this._appendElement(t,this.getContainer()),this.updateOffset({recalc:!0,elId:this.getId(t)})}},{key:"_paintEndpoint",value:function(e,t){var n=(t=t||{}).timestamp,i=!(!1===t.recalc);if(!n||e.timestamp!==n){var o=this.viewport.getPosition(e.elementId),r=t.offset?{x:t.offset.x,y:t.offset.y}:{x:o.x,y:o.y};if(null!=r){var s=t.anchorLoc;if(null==s){var a={xy:r,wh:o,element:e,timestamp:n};if(i&&this.router.isDynamicAnchor(e)&&e.connections.length>0){var l=function(e){var n=0;if(null!=t.elementWithPrecedence)for(var i=0;i<e.connections.length;i++)if(e.connections[i].sourceId===t.elementWithPrecedence||e.connections[i].targetId===t.elementWithPrecedence){n=i;break}return e.connections[n]}(e),c=l.endpoints[0]===e?1:0,u=0===c?l.sourceId:l.targetId,h=this.viewport.getPosition(u);a.index=0===c?1:0,a.connection=l,a.txy=h,a.twh=h,a.tElement=l.endpoints[c],a.tRotation=this._getRotations(u)}else e.connections.length>0&&(a.connection=e.connections[0]);a.rotation=this._getRotations(e.elementId),s=this.router.computeAnchorLocation(e._anchor,a)}for(var d in e.endpoint.compute(s,this.router.getEndpointOrientation(e),e.paintStyleInUse),this.renderEndpoint(e,e.paintStyleInUse),e.timestamp=n,e.overlays)if(e.overlays.hasOwnProperty(d)){var p=e.overlays[d];p.isVisible()&&(e.overlayPlacements[d]=this.drawOverlay(p,e.endpoint,e.paintStyleInUse,e.getAbsoluteOverlayPosition(p)),this._paintOverlay(p,e.overlayPlacements[d],{xmin:0,ymin:0}))}}}}},{key:"_paintConnection",value:function(e,t){if(!this._suspendDrawing&&!1!==e.visible){var n=(t=t||{}).timestamp;if(null!=n&&n===e.lastPaintedAt)return;if(null==n||n!==e.lastPaintedAt){this.router.computePath(e,n);var i={xmin:1/0,ymin:1/0,xmax:-1/0,ymax:-1/0};for(var o in e.overlays)if(e.overlays.hasOwnProperty(o)){var r=e.overlays[o];r.isVisible()&&(e.overlayPlacements[o]=this.drawOverlay(r,e.connector,e.paintStyleInUse,e.getAbsoluteOverlayPosition(r)),i.xmin=Math.min(i.xmin,e.overlayPlacements[o].xmin),i.xmax=Math.max(i.xmax,e.overlayPlacements[o].xmax),i.ymin=Math.min(i.ymin,e.overlayPlacements[o].ymin),i.ymax=Math.max(i.ymax,e.overlayPlacements[o].ymax))}var s=parseFloat(""+e.paintStyleInUse.strokeWidth||"1")/2,a=parseFloat(""+e.paintStyleInUse.strokeWidth||"0"),l={xmin:Math.min(e.connector.bounds.xmin-(s+a),i.xmin),ymin:Math.min(e.connector.bounds.ymin-(s+a),i.ymin),xmax:Math.max(e.connector.bounds.xmax+(s+a),i.xmax),ymax:Math.max(e.connector.bounds.ymax+(s+a),i.ymax)};for(var c in this.paintConnector(e.connector,e.paintStyleInUse,l),e.overlays)if(e.overlays.hasOwnProperty(c)){var u=e.overlays[c];u.isVisible()&&this._paintOverlay(u,e.overlayPlacements[c],l)}}e.lastPaintedAt=n}}},{key:"_refreshEndpoint",value:function(e){e._anchor.isFloating||(e.connections.length>0?this.addEndpointClass(e,this.endpointConnectedClass):this.removeEndpointClass(e,this.endpointConnectedClass),e.isFull()?this.addEndpointClass(e,this.endpointFullClass):this.removeEndpointClass(e,this.endpointFullClass))}},{key:"_makeConnector",value:function(e,t,n){return Cr(e,t,n)}},{key:"addOverlay",value:function(e,t,n){if(e.addOverlay(t),!n){var i=e instanceof Lo?e.element:e.source;this.revalidate(i)}}},{key:"removeOverlay",value:function(e,t){e.removeOverlay(t);var n=e instanceof Lo?e.element:e.source;this.revalidate(n)}},{key:"setOutlineColor",value:function(e,t){e.paintStyleInUse.outlineStroke=t,this._paintConnection(e)}},{key:"setOutlineWidth",value:function(e,t){e.paintStyleInUse.outlineWidth=t,this._paintConnection(e)}},{key:"setColor",value:function(e,t){e.paintStyleInUse.stroke=t,this._paintConnection(e)}},{key:"setLineWidth",value:function(e,t){e.paintStyleInUse.strokeWidth=t,this._paintConnection(e)}},{key:"setLineStyle",value:function(e,t){null!=t.lineWidth&&(e.paintStyleInUse.strokeWidth=t.lineWidth),null!=t.outlineWidth&&(e.paintStyleInUse.outlineWidth=t.outlineWidth),null!=t.color&&(e.paintStyleInUse.stroke=t.color),null!=t.outlineColor&&(e.paintStyleInUse.outlineStroke=t.outlineColor),this._paintConnection(e)}},{key:"getPathData",value:function(e){for(var t="",n=0;n<e.segments.length;n++)t+=e.segments[n].getPath(0===n),t+=" ";return t}}])}(yo),Tr={};function jr(e,t){Tr[e]=t}function Or(e,t,n){var i=t,o=_(t.getBoundingClientRect)!==sn?t.getBoundingClientRect():{left:0,top:0,width:0,height:0},r=document.body,s=document.documentElement,a=window.pageYOffset||s.scrollTop||r.scrollTop,l=window.pageXOffset||s.scrollLeft||r.scrollLeft,c=s.clientTop||r.clientTop||0,u=s.clientLeft||r.clientLeft||0,h=o.top+a-c+0*n,d=o.left+l-u+0*n,p=xn(e),f=o.width||i.offsetWidth*n,v=o.height||i.offsetHeight*n;return{x:(p.x-d)/f,y:(p.y-h)/v}}function Ir(e){return Vo(e)||Wo(e)||qo(e)}function Lr(e,t){e.canvas&&(e.canvas.style.display=t?"block":"none")}function Nr(e){e.canvas&&e.canvas.parentNode.removeChild(e.canvas),delete e.canvas}function Fr(e){return e.canvas}function Gr(e){return vo.getElement(e)}function Rr(e){return vo.getElement(e,e.component,(function(t){var n=e.create(t);return e.instance.addClass(n,e.instance.overlayClass),n}))}function Br(e,t,n,i){var o=e.x,r=e.y;return t._jsPlumbParentGroup&&t._jsPlumbParentGroup.constrain&&(o=Math.max(e.x,0),r=Math.max(e.y,0),o=Math.min(o,n.w-i.w),r=Math.min(r,n.h-i.h)),{x:o,y:r}}var Hr=function(e){function t(e,n){var i;if(r(this,t),(i=o(this,t,[e,n]))._instanceIndex=e,l(i,"containerType",null),l(i,"dragSelection",void 0),l(i,"dragManager",void 0),l(i,"_connectorClick",void 0),l(i,"_connectorDblClick",void 0),l(i,"_connectorTap",void 0),l(i,"_connectorDblTap",void 0),l(i,"_endpointClick",void 0),l(i,"_endpointDblClick",void 0),l(i,"_overlayClick",void 0),l(i,"_overlayDblClick",void 0),l(i,"_overlayTap",void 0),l(i,"_overlayDblTap",void 0),l(i,"_connectorMouseover",void 0),l(i,"_connectorMouseout",void 0),l(i,"_endpointMouseover",void 0),l(i,"_endpointMouseout",void 0),l(i,"_connectorContextmenu",void 0),l(i,"_connectorMousedown",void 0),l(i,"_connectorMouseup",void 0),l(i,"_endpointMousedown",void 0),l(i,"_endpointMouseup",void 0),l(i,"_overlayMouseover",void 0),l(i,"_overlayMouseout",void 0),l(i,"_elementClick",void 0),l(i,"_elementTap",void 0),l(i,"_elementDblTap",void 0),l(i,"_elementMouseenter",void 0),l(i,"_elementMouseexit",void 0),l(i,"_elementMousemove",void 0),l(i,"_elementMouseup",void 0),l(i,"_elementMousedown",void 0),l(i,"_elementContextmenu",void 0),l(i,"_resizeObserver",void 0),l(i,"eventManager",void 0),l(i,"draggingClass","jtk-dragging"),l(i,"elementDraggingClass","jtk-element-dragging"),l(i,"hoverClass","jtk-hover"),l(i,"sourceElementDraggingClass","jtk-source-element-dragging"),l(i,"targetElementDraggingClass","jtk-target-element-dragging"),l(i,"hoverSourceClass","jtk-source-hover"),l(i,"hoverTargetClass","jtk-target-hover"),l(i,"dragSelectClass","jtk-drag-select"),l(i,"managedElementsSelector",void 0),l(i,"elementsDraggable",void 0),l(i,"elementDragHandler",void 0),l(i,"groupDragOptions",void 0),l(i,"elementDragOptions",void 0),l(i,"svg",{node:function(e,t){return et(e,t)},attr:function(e,t){return Qe(e,t)},pos:function(e){return tt(e)}}),n=n||{},i.containerType=pe(i.getContainer()),i.elementsDraggable=n&&!1!==n.elementsDraggable,i.managedElementsSelector=n&&n.managedElementsSelector||ze,i.eventManager=new Fn,i.dragSelection=new _i(i),i.dragManager=new xi(i,i.dragSelection,n.dragOptions),i.dragManager.addHandler(new po(i)),i.groupDragOptions={constrainFunction:Br},i.dragManager.addHandler(new fo(i,i.dragSelection),i.groupDragOptions),i.elementDragHandler=new Si(i,i.dragSelection),i.elementDragOptions=n&&n.dragOptions||{},i.dragManager.addHandler(i.elementDragHandler,i.elementDragOptions),n&&n.dragOptions&&n.dragOptions.filter&&i.dragManager.addFilter(n.dragOptions.filter),i._createEventListeners(),i._attachEventDelegates(),!1!==n.resizeObserver)try{i._resizeObserver=new ResizeObserver((function(e){e.filter((function(e){var t=i.getAttribute(e.target,Ce);if(null!=t){var n=i.viewport._elementMap.get(t);return!!n&&(n.w!==e.contentRect.width||n.h!==e.contentRect.height)}return!1})).forEach((function(e){return i.revalidate(e.target)}))}))}catch(e){z("WARN: ResizeObserver could not be attached.")}return i}return h(t,e),a(t,[{key:"fireOverlayMethod",value:function(e,t,n){var i=ot(e.component instanceof Ro?ut:lt,t);n._jsPlumbOverlay=e,e.fire(t,{e:n,overlay:e}),this.fire(i,e.component,n)}},{key:"addDragFilter",value:function(e,t){this.dragManager.addFilter(e,t)}},{key:"removeDragFilter",value:function(e){this.dragManager.removeFilter(e)}},{key:"setDragGrid",value:function(e){this.dragManager.setOption(this.elementDragHandler,{grid:e})}},{key:"setDragConstrainFunction",value:function(e){this.dragManager.setOption(this.elementDragHandler,{constrainFunction:e})}},{key:"_removeElement",value:function(e){e.parentNode&&e.parentNode.removeChild(e)}},{key:"_appendElement",value:function(e,t){t&&t.appendChild(e)}},{key:"_appendElementToGroup",value:function(e,t){this.getGroupContentArea(e).appendChild(t)}},{key:"_appendElementToContainer",value:function(e){this._appendElement(e,this.getContainer())}},{key:"_getAssociatedElements",value:function(e){var t=[];if(3!==e.nodeType&&8!==e.nodeType){var n=e.querySelectorAll(ze);Array.prototype.push.apply(t,n)}return t.filter((function(e){return 3!==e.nodeType&&8!==e.nodeType}))}},{key:"shouldFireEvent",value:function(e,t,n){return!0}},{key:"getClass",value:function(e){return function(e){return ne(e)}(e)}},{key:"addClass",value:function(e,t){re(e,t)}},{key:"hasClass",value:function(e,t){return function(e,t){return e.classList?e.classList.contains(t):-1!==ne(e).indexOf(t)}(e,t)}},{key:"removeClass",value:function(e,t){se(e,t)}},{key:"toggleClass",value:function(e,t){!function(e,t){var n=this,i=function(e,t){null!=e&&null!=t&&t.length>0&&(e.classList?e.classList.toggle(t):n.hasClass(e,t)?n.removeClass(e,t):n.addClass(e,t))};oe(e)?j(e,(function(e){return i(e,t)})):i(e,t)}(e,t)}},{key:"setAttribute",value:function(e,t,n){e.setAttribute(t,n)}},{key:"getAttribute",value:function(e,t){return e.getAttribute(t)}},{key:"setAttributes",value:function(e,t){for(var n in t)e.setAttribute(n,t[n])}},{key:"removeAttribute",value:function(e,t){e.removeAttribute&&e.removeAttribute(t)}},{key:"on",value:function(e,t,n,i){var o=this,r=function(e){null==i?o.eventManager.on(e,t,n):o.eventManager.on(e,t,n,i)};return oe(e)?j(e,(function(e){return r(e)})):r(e),this}},{key:"off",value:function(e,t,n){var i=this;return oe(e)?j(e,(function(e){return i.eventManager.off(e,t,n)})):this.eventManager.off(e,t,n),this}},{key:"trigger",value:function(e,t,n,i,o){this.eventManager.trigger(e,t,n,i,o)}},{key:"getOffsetRelativeToRoot",value:function(e){return ce(e)}},{key:"getOffset",value:function(e){for(var t,n=e,i=this.getContainer(),o=this.getPosition(n),r=e!==i&&n.offsetParent!==i?n.offsetParent:null;null!=r;)o.x+=r.offsetLeft,o.y+=r.offsetTop,null!=(t=r)&&t!==document.body&&(t.scrollTop>0||t.scrollLeft>0)&&(o.x-=t.scrollLeft,o.y-=t.scrollTop),r=r.offsetParent===i?null:r.offsetParent;if(null!=i&&(i.scrollTop>0||i.scrollLeft>0)){var s=null!=n.offsetParent?this.getStyle(n.offsetParent,qt):"static",a=this.getStyle(n,qt);a!==be&&a!==ke&&s!==be&&s!==ke&&(o.x-=i.scrollLeft,o.y-=i.scrollTop)}return o}},{key:"getSize",value:function(e){var t=e;return null!=t.offsetWidth?function(e){return{w:e.offsetWidth,h:e.offsetHeight}}(e):t.width&&t.width.baseVal?function(e){try{return{w:parseFloat(e.width.baseVal.value),h:parseFloat(e.height.baseVal.value)}}catch(e){return{w:0,h:0}}}(t):void 0}},{key:"getPosition",value:function(e){var t=e;return null!=t.offsetLeft?{x:parseFloat(t.offsetLeft),y:parseFloat(t.offsetTop)}:t.x&&t.x.baseVal?function(e){try{return{x:parseFloat(e.x.baseVal.value),y:parseFloat(e.y.baseVal.value)}}catch(e){return{x:0,y:0}}}(t):void 0}},{key:"getStyle",value:function(e,t){return _(window.getComputedStyle)!==sn?getComputedStyle(e,null).getPropertyValue(t):e.currentStyle[t]}},{key:"getGroupContentArea",value:function(e){var t=this.getSelector(e.el,en);return t&&t.length>0?t[0]:e.el}},{key:"getSelector",value:function(e,t){var n=null;if(1===arguments.length){if(!S(e)){var i=document.createDocumentFragment();return i.appendChild(e),F(i.childNodes)}n=F(document.querySelectorAll(e))}else n=F(e.querySelectorAll(t));return n}},{key:"setPosition",value:function(e,t){var n=e;n.style.left=t.x+"px",n.style.top=t.y+"px"}},{key:"setDraggable",value:function(e,t){t?this.removeAttribute(e,Se):this.setAttribute(e,Se,ln)}},{key:"isDraggable",value:function(e){var t=this.getAttribute(e,Se);return null==t||t===cn}},{key:"toggleDraggable",value:function(e){var t=this.isDraggable(e);return this.setDraggable(e,!t),!t}},{key:"_createEventListeners",value:function(){var e=function(e,t){if(!t.defaultPrevented&&null==t._jsPlumbOverlay){var n=ee(te(t),Zt,this.getContainer(),!0);this.fire(e,n.jtk.connector.connection,t)}};this._connectorClick=e.bind(this,Ht),this._connectorDblClick=e.bind(this,Ut),this._connectorTap=e.bind(this,$t),this._connectorDblTap=e.bind(this,Xt);var t=function(e,t){var n=te(t).parentNode;if(n.jtk&&n.jtk.connector){var i=n.jtk.connector,o=i.connection;this.setConnectorHover(i,e),e?(this.addClass(o.source,this.hoverSourceClass),this.addClass(o.target,this.hoverTargetClass)):(this.removeClass(o.source,this.hoverSourceClass),this.removeClass(o.target,this.hoverTargetClass)),this.fire(e?Kt:Yt,n.jtk.connector.connection,t)}};this._connectorMouseover=t.bind(this,!0),this._connectorMouseout=t.bind(this,!1);var n=function(e,t){var n=te(t).parentNode;n.jtk&&n.jtk.connector&&this.fire(e?Vt:zt,n.jtk.connector.connection,t)};this._connectorMouseup=n.bind(this,!0),this._connectorMousedown=n.bind(this,!1),this._connectorContextmenu=function(e){var t=te(e).parentNode;t.jtk&&t.jtk.connector&&this.fire(Wt,t.jtk.connector.connection,e)}.bind(this);var i=function(e,t,n){t.defaultPrevented||null!=t._jsPlumbOverlay||this.fire(e,n.jtk.endpoint,t)};this._endpointClick=i.bind(this,Lt),this._endpointDblClick=i.bind(this,Nt);var o=function(e,t){var n=te(t);n.jtk&&n.jtk.endpoint&&(this.setEndpointHover(n.jtk.endpoint,e),this.fire(e?Gt:Ft,n.jtk.endpoint,t))};this._endpointMouseover=o.bind(this,!0),this._endpointMouseout=o.bind(this,!1);var r=function(e,t){var n=te(t);n.jtk&&n.jtk.endpoint&&this.fire(e?Rt:Bt,n.jtk.endpoint,t)};this._endpointMouseup=r.bind(this,!0),this._endpointMousedown=r.bind(this,!1);var s=function(e,t){var n=ee(te(t),tn,this.getContainer(),!0).jtk.overlay;n&&this.fireOverlayMethod(n,e,t)}.bind(this);this._overlayClick=s.bind(this,ht),this._overlayDblClick=s.bind(this,pt),this._overlayTap=s.bind(this,xt),this._overlayDblTap=s.bind(this,ft);var a=function(e,t){var n=ee(te(t),tn,this.getContainer(),!0).jtk.overlay;n&&this.setOverlayHover(n,e)};this._overlayMouseover=a.bind(this,!0),this._overlayMouseout=a.bind(this,!1);this._elementClick=function(e,t,n){t.defaultPrevented||this.fire(1===t.detail?wt:Et,n,t)}.bind(this,wt);this._elementTap=function(e,t,n){t.defaultPrevented||this.fire(It,n,t)}.bind(this,It);this._elementDblTap=function(e,t,n){t.defaultPrevented||this.fire(Pt,n,t)}.bind(this,Pt);var l=function(e,t){this.fire(e?Dt:At,te(t),t)};this._elementMouseenter=l.bind(this,!0),this._elementMouseexit=l.bind(this,!1),this._elementMousemove=function(e){this.fire(Mt,te(e),e)}.bind(this),this._elementMouseup=function(e){this.fire(Tt,te(e),e)}.bind(this),this._elementMousedown=function(e){this.fire(jt,te(e),e)}.bind(this),this._elementContextmenu=function(e){this.fire(Ot,te(e),e)}.bind(this)}},{key:"_attachEventDelegates",value:function(){var e=this.getContainer();this.eventManager.on(e,ht,tn,this._overlayClick),this.eventManager.on(e,pt,tn,this._overlayDblClick),this.eventManager.on(e,xt,tn,this._overlayTap),this.eventManager.on(e,ft,tn,this._overlayDblTap),this.eventManager.on(e,ht,Zt,this._connectorClick),this.eventManager.on(e,pt,Zt,this._connectorDblClick),this.eventManager.on(e,xt,Zt,this._connectorTap),this.eventManager.on(e,ft,Zt,this._connectorDblTap),this.eventManager.on(e,ht,Jt,this._endpointClick),this.eventManager.on(e,pt,Jt,this._endpointDblClick),this.eventManager.on(e,ht,this.managedElementsSelector,this._elementClick),this.eventManager.on(e,xt,this.managedElementsSelector,this._elementTap),this.eventManager.on(e,ft,this.managedElementsSelector,this._elementDblTap),this.eventManager.on(e,kt,Zt,this._connectorMouseover),this.eventManager.on(e,bt,Zt,this._connectorMouseout),this.eventManager.on(e,dt,Zt,this._connectorContextmenu),this.eventManager.on(e,_t,Zt,this._connectorMouseup),this.eventManager.on(e,vt,Zt,this._connectorMousedown),this.eventManager.on(e,kt,Jt,this._endpointMouseover),this.eventManager.on(e,bt,Jt,this._endpointMouseout),this.eventManager.on(e,_t,Jt,this._endpointMouseup),this.eventManager.on(e,vt,Jt,this._endpointMousedown),this.eventManager.on(e,kt,tn,this._overlayMouseover),this.eventManager.on(e,bt,tn,this._overlayMouseout),this.eventManager.on(e,kt,ze,this._elementMouseenter),this.eventManager.on(e,bt,ze,this._elementMouseexit),this.eventManager.on(e,mt,ze,this._elementMousemove),this.eventManager.on(e,_t,ze,this._elementMouseup),this.eventManager.on(e,vt,ze,this._elementMousedown),this.eventManager.on(e,dt,ze,this._elementContextmenu)}},{key:"_detachEventDelegates",value:function(){var e=this.getContainer();e&&(this.eventManager.off(e,ht,this._connectorClick),this.eventManager.off(e,pt,this._connectorDblClick),this.eventManager.off(e,xt,this._connectorTap),this.eventManager.off(e,ft,this._connectorDblTap),this.eventManager.off(e,ht,this._endpointClick),this.eventManager.off(e,pt,this._endpointDblClick),this.eventManager.off(e,ht,this._overlayClick),this.eventManager.off(e,pt,this._overlayDblClick),this.eventManager.off(e,xt,this._overlayTap),this.eventManager.off(e,ft,this._overlayDblTap),this.eventManager.off(e,ht,this._elementClick),this.eventManager.off(e,xt,this._elementTap),this.eventManager.off(e,ft,this._elementDblTap),this.eventManager.off(e,kt,this._connectorMouseover),this.eventManager.off(e,bt,this._connectorMouseout),this.eventManager.off(e,dt,this._connectorContextmenu),this.eventManager.off(e,_t,this._connectorMouseup),this.eventManager.off(e,vt,this._connectorMousedown),this.eventManager.off(e,kt,this._endpointMouseover),this.eventManager.off(e,bt,this._endpointMouseout),this.eventManager.off(e,_t,this._endpointMouseup),this.eventManager.off(e,vt,this._endpointMousedown),this.eventManager.off(e,kt,this._overlayMouseover),this.eventManager.off(e,bt,this._overlayMouseout),this.eventManager.off(e,yt,this._elementMouseenter),this.eventManager.off(e,gt,this._elementMouseexit),this.eventManager.off(e,mt,this._elementMousemove),this.eventManager.off(e,_t,this._elementMouseup),this.eventManager.off(e,vt,this._elementMousedown),this.eventManager.off(e,dt,this._elementContextmenu))}},{key:"setContainer",value:function(e){var n,i=this;if(e===document||e===document.body)throw new Error("Cannot set document or document.body as container element");this._detachEventDelegates(),null!=this.dragManager&&(n=this.dragManager.reset()),this.setAttribute(e,rt,X().replace("-",""));var o=this.getContainer();null!=o&&(o.removeAttribute(rt),j(F(o.childNodes).filter((function(e){return null!=e&&(i.hasClass(e,Ae)||i.hasClass(e,De)||i.hasClass(e,Oe)||e.getAttribute&&null!=e.getAttribute(Ce))})),(function(t){e.appendChild(t)})));y(t,"setContainer",this,3)([e]),this.containerType=pe(e),null!=this.eventManager&&this._attachEventDelegates(),null!=this.dragManager&&(this.dragManager.addHandler(new po(this)),this.dragManager.addHandler(new fo(this,this.dragSelection),this.groupDragOptions),this.elementDragHandler=new Si(this,this.dragSelection),this.dragManager.addHandler(this.elementDragHandler,this.elementDragOptions),null!=n&&this.dragManager.setFilters(n))}},{key:"reset",value:function(){y(t,"reset",this,3)([]),this._resizeObserver&&this._resizeObserver.disconnect(),j(this.getContainer().querySelectorAll([ze,Jt,Zt,tn].join(",")),(function(e){return e.parentNode&&e.parentNode.removeChild(e)}))}},{key:"destroy",value:function(){this._detachEventDelegates(),null!=this.dragManager&&this.dragManager.reset(),this.clearDragSelection(),y(t,"destroy",this,3)([])}},{key:"unmanage",value:function(e,n){null!=this._resizeObserver&&this._resizeObserver.unobserve(e),this.removeFromDragSelection(e),y(t,"unmanage",this,3)([e,n])}},{key:"addToDragSelection",value:function(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];j(n,(function(t){return e.dragSelection.add(t)}))}},{key:"clearDragSelection",value:function(){this.dragSelection.clear()}},{key:"removeFromDragSelection",value:function(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];j(n,(function(t){return e.dragSelection.remove(t)}))}},{key:"toggleDragSelection",value:function(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];j(n,(function(t){return e.dragSelection.toggle(t)}))}},{key:"addToDragGroup",value:function(e){for(var t,n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];(t=this.elementDragHandler).addToDragGroup.apply(t,[e].concat(i))}},{key:"removeFromDragGroup",value:function(){var e;(e=this.elementDragHandler).removeFromDragGroup.apply(e,arguments)}},{key:"setDragGroupState",value:function(e){for(var t,n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];(t=this.elementDragHandler).setDragGroupState.apply(t,[e].concat(i))}},{key:"clearDragGroup",value:function(e){this.elementDragHandler.clearDragGroup(e)}},{key:"consume",value:function(e,t){Q(e,t)}},{key:"rotate",value:function(e,n,i){var o=this.getId(e);return this._managedElements[o]?(this._managedElements[o].el.style.transform="rotate("+n+"deg)",this._managedElements[o].el.style.transformOrigin="center center",y(t,"rotate",this,3)([e,n,i])):{c:new Set,e:new Set}}},{key:"addOverlayClass",value:function(e,t){if(Co(e))e.instance.addClass(Gr(e),t);else if(Ir(e))e.instance.addClass(Bo(e),t);else{if(!Jo(e))throw"Could not add class to overlay of type ["+e.type+"]";e.instance.addClass(Rr(e),t)}}},{key:"removeOverlayClass",value:function(e,t){if(Co(e))e.instance.removeClass(Gr(e),t);else if(Ir(e))e.instance.removeClass(Bo(e),t);else{if(!Jo(e))throw"Could not remove class from overlay of type ["+e.type+"]";e.instance.removeClass(Rr(e),t)}}},{key:"_paintOverlay",value:function(e,t,n){if(Co(e)){Gr(e);var i=e.component.getXY();e.canvas.style.left=i.x+t.d.minx+"px",e.canvas.style.top=i.y+t.d.miny+"px"}else if(Ir(e)){!function(e,t,n,i){Bo(e);var o=[0,0];i.xmin<0&&(o[0]=-i.xmin),i.ymin<0&&(o[1]=-i.ymin);var r={d:t,stroke:n.stroke?n.stroke:null,fill:n.fill?n.fill:null,transform:"translate("+o[0]+","+o[1]+")","pointer-events":"visibleStroke"};Qe(e.path,r)}(e,isNaN(t.d.cxy.x)||isNaN(t.d.cxy.y)?"M 0 0":"M"+t.d.hxy.x+","+t.d.hxy.y+" L"+t.d.tail[0].x+","+t.d.tail[0].y+" L"+t.d.cxy.x+","+t.d.cxy.y+" L"+t.d.tail[1].x+","+t.d.tail[1].y+" Z",t,n)}else{if(!Jo(e))throw"Could not paint overlay of type ["+e.type+"]";Rr(e);var o=e.component.getXY();e.canvas.style.left=o.x+t.d.minx+"px",e.canvas.style.top=o.y+t.d.miny+"px"}}},{key:"setOverlayVisible",value:function(e,t){var n=t?"block":"none";function i(e){null!=e&&(e.style.display=n)}Co(e)?i(Gr(e)):Jo(e)?i(Rr(e)):Ir(e)&&i(e.path)}},{key:"reattachOverlay",value:function(e,t){Co(e)?e.instance._appendElement(Gr(e),this.getContainer()):Jo(e)?e.instance._appendElement(Rr(e),this.getContainer()):Ir(e)&&this._appendElement(Bo(e),t.connector.canvas)}},{key:"setOverlayHover",value:function(e,t){var n;Co(e)?n=Gr(e):Jo(e)?n=Rr(e):Ir(e)&&(n=Bo(e)),null!=n&&(null!=this.hoverClass&&(t?this.addClass(n,this.hoverClass):this.removeClass(n,this.hoverClass)),this.setHover(e.component,t))}},{key:"destroyOverlay",value:function(e){if(Co(e)){var t=Gr(e);t.parentNode.removeChild(t),delete e.canvas,delete e.cachedDimensions}else if(Vo(e)||Wo(e)||qo(e))!function(e,t){var n=e;null!=n.path&&null!=n.path.parentNode&&n.path.parentNode.removeChild(n.path),null!=n.bgPath&&null!=n.bgPath.parentNode&&n.bgPath.parentNode.removeChild(n.bgPath),delete n.path,delete n.bgPath}(e);else if(Jo(e)){var n=Rr(e);n.parentNode.removeChild(n),delete e.canvas,delete e.cachedDimensions}}},{key:"drawOverlay",value:function(e,t,n,i){if(Co(e)||Jo(e)){var o=vo._getDimensions(e);if(null!=o&&null!=o.w&&null!=o.h){var r={x:0,y:0};if(i)r={x:i.x,y:i.y};else if(t instanceof Di){var s=Array.isArray(e.location)?e.location:[e.location,e.location];r={x:s[0]*t.w,y:s[1]*t.h}}else{var a=e.location,l=!1;(S(e.location)||e.location<0||e.location>1)&&(a=parseInt(""+e.location,10),l=!0),r=t.pointOnPath(a,l)}var c=r.x-o.w/2,u=r.y-o.h/2;return{component:e,d:{minx:c,miny:u,td:o,cxy:r},xmin:c,xmax:c+o.w,ymin:u,ymax:u+o.h}}return{xmin:0,xmax:0,ymin:0,ymax:0}}if(Vo(e)||Wo(e)||qo(e))return e.draw(t,n,i);throw"Could not draw overlay of type ["+e.type+"]"}},{key:"updateLabel",value:function(e){if(P(e.label)){var t=e.label(this);Gr(e).innerText=null!=t?t:""}else null==e.labelText&&(e.labelText=e.label,null!=e.labelText?Gr(e).innerText=e.labelText:Gr(e).innerText="")}},{key:"setHover",value:function(e,t){e._hover=t,e instanceof Lo&&null!=e.endpoint?this.setEndpointHover(e,t,-1):e instanceof Ro&&null!=e.connector&&this.setConnectorHover(e.connector,t)}},{key:"paintConnector",value:function(e,t,n){Uo(this,e,t,n)}},{key:"setConnectorHover",value:function(e,t,n){if(!1===t||!this.currentlyDragging&&!this.isHoverSuspended()){var i=e.canvas;null!=i&&(null!=e.hoverClass&&(t?this.addClass(i,e.hoverClass):this.removeClass(i,e.hoverClass)),t?this.addClass(i,this.hoverClass):this.removeClass(i,this.hoverClass)),null!=e.connection.hoverPaintStyle&&(e.connection.paintStyleInUse=t?e.connection.hoverPaintStyle:e.connection.paintStyle,this._suspendDrawing||this._paintConnection(e.connection)),e.connection.endpoints[0]!==n&&this.setEndpointHover(e.connection.endpoints[0],t,0,!0),e.connection.endpoints[1]!==n&&this.setEndpointHover(e.connection.endpoints[1],t,1,!0)}}},{key:"destroyConnector",value:function(e){null!=e.connector&&Nr(e.connector)}},{key:"addConnectorClass",value:function(e,t){e.canvas&&this.addClass(e.canvas,t)}},{key:"removeConnectorClass",value:function(e,t){e.canvas&&this.removeClass(e.canvas,t)}},{key:"getConnectorClass",value:function(e){return e.canvas?e.canvas.className.baseVal:""}},{key:"setConnectorVisible",value:function(e,t){Lr(e,t)}},{key:"applyConnectorType",value:function(e,t){if(e.canvas&&t.cssClass){var n=Array.isArray(t.cssClass)?t.cssClass:[t.cssClass];this.addClass(e.canvas,n.join(" "))}}},{key:"addEndpointClass",value:function(e,t){var n=Fr(e.endpoint);null!=n&&this.addClass(n,t)}},{key:"applyEndpointType",value:function(e,t){if(t.cssClass){var n=Fr(e.endpoint);if(n){var i=Array.isArray(t.cssClass)?t.cssClass:[t.cssClass];this.addClass(n,i.join(" "))}}}},{key:"destroyEndpoint",value:function(e){var t=this.endpointAnchorClassPrefix+(e.currentAnchorClass?"-"+e.currentAnchorClass:"");this.removeClass(e.element,t),Nr(e.endpoint)}},{key:"renderEndpoint",value:function(e,t){var n=Tr[e.endpoint.type];null!=n?Xo.paint(e.endpoint,n,t):z("jsPlumb: no endpoint renderer found for type ["+e.endpoint.type+"]")}},{key:"removeEndpointClass",value:function(e,t){var n=Fr(e.endpoint);null!=n&&this.removeClass(n,t)}},{key:"getEndpointClass",value:function(e){var t=Fr(e.endpoint);return null!=t?t.className:""}},{key:"setEndpointHover",value:function(e,t,n,i){if(null!=e&&(!1===t||!this.currentlyDragging&&!this.isHoverSuspended())){var o=Fr(e.endpoint);if(null!=o&&(null!=e.hoverClass&&(t?this.addClass(o,e.hoverClass):this.removeClass(o,e.hoverClass)),0===n||1===n)){var r=0===n?this.hoverSourceClass:this.hoverTargetClass;t?this.addClass(o,r):this.removeClass(o,r)}if(null!=e.hoverPaintStyle&&(e.paintStyleInUse=t?e.hoverPaintStyle:e.paintStyle,this._suspendDrawing||this.renderEndpoint(e,e.paintStyleInUse)),!i)for(var s=0;s<e.connections.length;s++)this.setConnectorHover(e.connections[s].connector,t,e)}}},{key:"setEndpointVisible",value:function(e,t){Lr(e.endpoint,t)}},{key:"setGroupVisible",value:function(e,t){for(var n=e.el.querySelectorAll(ze),i=0;i<n.length;i++)t?this.show(n[i],!0):this.hide(n[i],!0)}},{key:"deleteConnection",value:function(e,n){return null!=e&&!0!==e.deleted&&(!0!==e.endpoints[0].deleted&&this.setEndpointHover(e.endpoints[0],!1,0,!0),!0!==e.endpoints[1].deleted&&this.setEndpointHover(e.endpoints[1],!1,1,!0),y(t,"deleteConnection",this,3)([e,n]))}},{key:"addSourceSelector",value:function(e,n,i){return this.addDragFilter(e),y(t,"addSourceSelector",this,3)([e,n,i])}},{key:"removeSourceSelector",value:function(e){this.removeDragFilter(e.selector),y(t,"removeSourceSelector",this,3)([e])}},{key:"manage",value:function(e,n,i){if(this.containerType===de.SVG&&pe(e)!==de.SVG)throw new Error("ERROR: cannot manage non-svg element when container is an SVG element.");var o=y(t,"manage",this,3)([e,n,i]);return null!=o&&null!=this._resizeObserver&&this._resizeObserver.observe(o.el),o}}])}(Mr),Ur=function(e){function t(e,n){var i;return r(this,t),l(i=o(this,t,[e,n]),"width",void 0),l(i,"height",void 0),l(i,"type",t.type),n=n||{},i.width=n.width||10,i.height=n.height||10,i}return h(t,e),a(t,null,[{key:"_getParams",value:function(e){return{width:e.width,height:e.height}}}])}(Di);l(Ur,"type","Rectangle");var Xr={type:Ur.type,cls:Ur,compute:function(e,t,n,i){var o=i.width||e.width,r=i.height||e.height,s=t.curX-o/2,a=t.curY-r/2;return e.x=s,e.y=a,e.w=o,e.h=r,[s,a,o,r]},getParams:function(e){return{width:e.width,height:e.height}}},Yr=function(e){function t(e,n){var i;return r(this,t),l(i=o(this,t,[e,n]),"type",t.type),i}return h(t,e),a(t)}(Di);l(Yr,"type","Blank");var Kr={type:Yr.type,cls:Yr,compute:function(e,t,n,i){return e.x=t.curX,e.y=t.curY,e.w=10,e.h=0,[t.curX,t.curY,10,0]},getParams:function(e){return{}}},Vr={width:10,height:0,fill:"transparent",stroke:"transparent"};jr(Qo.type,{makeNode:function(e,t){return et("circle",{cx:e.w/2,cy:e.h/2,r:e.radius})},updateNode:function(e,t){Qe(t,{cx:""+e.w/2,cy:""+e.h/2,r:""+e.radius})}}),jr(Yr.type,{makeNode:function(e,t){return et("rect",Vr)},updateNode:function(e,t){Qe(t,Vr)}}),jr(Ur.type,{makeNode:function(e,t){return et("rect",{width:e.w,height:e.h})},updateNode:function(e,t){Qe(t,{width:e.w,height:e.h})}});var zr=function(e){return e[e.top=0]="top",e[e.bottom=1]="bottom",e}({}),Wr=new Map;Wr.set(zr.top,[on.TopRight,on.TopLeft]),Wr.set(zr.bottom,[on.BottomRight,on.BottomLeft]);var $r={deriveAnchor:function(e,t,n,i){return Wr.get(e)[t]}},qr="jtk-scrollable-list",Zr=ve(qr),Jr="scroll",Qr=(a((function e(t,n){var i=this;r(this,e),this.instance=t,l(this,"options",void 0),l(this,"count",void 0),l(this,"lists",void 0),this.count=0,this.lists={},this.options=n||{},this.instance.bind(Re,(function(e){for(var t=i.instance.getSelector(e.el,Zr),n=0;n<t.length;n++)i.addList(t[n])})),this.instance.bind(Ue,(function(e){i.removeList(e.el)})),this.instance.bind(Ie,(function(e,t){if(null==t){var n=i.findParentList(e.target);null!=n&&n.newConnection(e.connection,e.target,1);var o=i.findParentList(e.source);null!=o&&o.newConnection(e.connection,e.source,0)}})),this.instance.bind(Ke,(function(e){var t=e.dropEndpoint.element,n=i.findParentList(t);return null==n||t.offsetTop>=n.domElement.scrollTop&&t.offsetTop+t.offsetHeight<=n.domElement.scrollTop+n.domElement.offsetHeight}))}),[{key:"addList",value:function(e,t){var n=x({},$r);x(n,this.options),t=x(n,t||{});var i=[this.instance._instanceIndex,this.count++].join("_");return this.lists[i]=new Qr(this.instance,e,t,i),this.lists[i]}},{key:"getList",value:function(e){var t=this.instance.getAttribute(e,qr);if(null!=t)return this.lists[t]}},{key:"removeList",value:function(e){var t=this.getList(e);t&&(t.destroy(),delete this.lists[t.id])}},{key:"findParentList",value:function(e){for(var t,n=e.parentNode,i=this.instance.getContainer();null!=n&&n!==i&&n!==document;){if(null!=(t=this.getList(n)))return t;n=n.parentNode}}}]),a((function e(t,n,i,o){r(this,e),this.instance=t,this.el=n,this.options=i,this.id=o,l(this,"_scrollHandler",void 0),l(this,"domElement",void 0),l(this,"elId",void 0),this.domElement=n,this.elId=this.instance.getId(n),t.setAttribute(n,qr,o),this._scrollHandler=this.scrollHandler.bind(this),this.domElement._jsPlumbScrollHandler=this._scrollHandler,t.on(n,Jr,this._scrollHandler),this._scrollHandler()}),[{key:"deriveAnchor",value:function(e,t,n,i){return this.options.anchor?this.options.anchor:this.options.deriveAnchor(e,t,n,i)}},{key:"deriveEndpoint",value:function(e,t,n,i){return this.options.deriveEndpoint?this.options.deriveEndpoint(e,t,n,i):this.options.endpoint?this.options.endpoint:n.endpoint.type}},{key:"newConnection",value:function(e,t,n){t.offsetTop<this.el.scrollTop?this._proxyConnection(t,e,n,zr.top):t.offsetTop+t.offsetHeight>this.el.scrollTop+this.domElement.offsetHeight&&this._proxyConnection(t,e,n,zr.bottom)}},{key:"scrollHandler",value:function(){for(var e=this,t=this.instance.getSelector(this.el,ze),n=function(n){if(t[n].offsetTop<e.el.scrollTop)t[n]._jsPlumbProxies=t[n]._jsPlumbProxies||[],e.instance.select({source:t[n]}).each((function(i){e._proxyConnection(t[n],i,0,zr.top)})),e.instance.select({target:t[n]}).each((function(i){e._proxyConnection(t[n],i,1,zr.top)}));else if(t[n].offsetTop+t[n].offsetHeight>e.el.scrollTop+e.domElement.offsetHeight)t[n]._jsPlumbProxies=t[n]._jsPlumbProxies||[],e.instance.select({source:t[n]}).each((function(i){e._proxyConnection(t[n],i,0,zr.bottom)})),e.instance.select({target:t[n]}).each((function(i){e._proxyConnection(t[n],i,1,zr.bottom)}));else if(t[n]._jsPlumbProxies){for(var i=0;i<t[n]._jsPlumbProxies.length;i++)e.instance.unproxyConnection(t[n]._jsPlumbProxies[i][0],t[n]._jsPlumbProxies[i][1]);delete t[n]._jsPlumbProxies}e.instance.revalidate(t[n])},i=0;i<t.length;i++)n(i)}},{key:"_proxyConnection",value:function(e,t,n,i){var o=this;this.instance.proxyConnection(t,n,this.domElement,(function(e,n){return o.deriveEndpoint(i,n,t.endpoints[n],t)}),(function(e,n){return o.deriveAnchor(i,n,t.endpoints[n],t)})),e._jsPlumbProxies=e._jsPlumbProxies||[],e._jsPlumbProxies.push([t,n])}},{key:"destroy",value:function(){this.instance.off(this.el,Jr,this._scrollHandler),delete this.domElement._jsPlumbScrollHandler;for(var e=this.instance.getSelector(this.el,ze),t=0;t<e.length;t++)if(e[t]._jsPlumbProxies){for(var n=0;n<e[t]._jsPlumbProxies.length;n++)this.instance.unproxyConnection(e[t]._jsPlumbProxies[n][0],e[t]._jsPlumbProxies[n][1]);delete e[t]._jsPlumbProxies}}}]));function es(e){var t=Math.floor(e),n=Math.ceil(e);return e-t<1e-10?t:n-e<1e-10?n:e}var ts=function(e){function t(e){var n;r(this,t),l(n=o(this,t,[e]),"type",t.segmentType),l(n,"cx",void 0),l(n,"cy",void 0),l(n,"radius",void 0),l(n,"anticlockwise",void 0),l(n,"startAngle",void 0),l(n,"endAngle",void 0),l(n,"sweep",void 0),l(n,"length",void 0),l(n,"circumference",void 0),l(n,"frac",void 0),n.cx=e.cx,n.cy=e.cy,n.radius=e.r,n.anticlockwise=e.ac,e.startAngle&&e.endAngle?(n.startAngle=e.startAngle,n.endAngle=e.endAngle,n.x1=n.cx+n.radius*Math.cos(n.startAngle),n.y1=n.cy+n.radius*Math.sin(n.startAngle),n.x2=n.cx+n.radius*Math.cos(n.endAngle),n.y2=n.cy+n.radius*Math.sin(n.endAngle)):(n.startAngle=n._calcAngle(n.x1,n.y1),n.endAngle=n._calcAngle(n.x2,n.y2)),n.endAngle<0&&(n.endAngle+=Bn),n.startAngle<0&&(n.startAngle+=Bn);var i=n.endAngle<n.startAngle?n.endAngle+Bn:n.endAngle;return n.sweep=Math.abs(i-n.startAngle),n.anticlockwise&&(n.sweep=Bn-n.sweep),n.circumference=2*Math.PI*n.radius,n.frac=n.sweep/Bn,n.length=n.circumference*n.frac,n.extents={xmin:n.cx-n.radius,xmax:n.cx+n.radius,ymin:n.cy-n.radius,ymax:n.cy+n.radius},n}return h(t,e),a(t,[{key:"_calcAngle",value:function(e,t){return n={x:this.cx,y:this.cy},o=Hn(n,i={x:e,y:t}),r=Math.atan(o),4!=(s=Xn(n,i))&&3!=s||(r+=Math.PI),r<0&&(r+=2*Math.PI),r;var n,i,o,r,s}},{key:"_calcAngleForLocation",value:function(e,t){if(e.anticlockwise){var n=e.startAngle<e.endAngle?e.startAngle+Bn:e.startAngle;return n-Math.abs(n-e.endAngle)*t}var i=e.endAngle<e.startAngle?e.endAngle+Bn:e.endAngle,o=Math.abs(i-e.startAngle);return e.startAngle+o*t}},{key:"getPath",value:function(e){var t=this.sweep>Math.PI?1:0,n=this.anticlockwise?0:1;return(e?"M"+this.x1+" "+this.y1+" ":"")+"A "+this.radius+" "+this.radius+" 0 "+t+","+n+" "+this.x2+" "+this.y2}},{key:"getLength",value:function(){return this.length}},{key:"pointOnPath",value:function(e,t){if(0===e)return{x:this.x1,y:this.y1,theta:this.startAngle};if(1===e)return{x:this.x2,y:this.y2,theta:this.endAngle};t&&(e/=length);var n=this._calcAngleForLocation(this,e),i=this.cx+this.radius*Math.cos(n),o=this.cy+this.radius*Math.sin(n);return{x:es(i),y:es(o),theta:n}}},{key:"gradientAtPoint",value:function(e,t){var n=this.pointOnPath(e,t),i=-1/Hn({x:this.cx,y:this.cy},n);return this.anticlockwise||i!==1/0&&i!==-1/0||(i*=-1),i}},{key:"pointAlongPathFrom",value:function(e,t,n){var i=this.pointOnPath(e,n),o=t/this.circumference*2*Math.PI,r=this.anticlockwise?-1:1,s=i.theta+r*o;return{x:this.cx+this.radius*Math.cos(s),y:this.cy+this.radius*Math.sin(s)}}}])}(rn);l(ts,"segmentType","Arc"),Ai.registerHandler(er),Ai.registerHandler(Xr),Ai.registerHandler(Kr),Sr(Er.type,Er);var ns=function(e){function t(e,n){var i;return r(this,t),(i=o(this,t,[e,n])).connection=e,l(i,"showLoopback",void 0),l(i,"curviness",void 0),l(i,"margin",void 0),l(i,"proximityLimit",void 0),l(i,"orientation",void 0),l(i,"loopbackRadius",void 0),l(i,"clockwise",void 0),l(i,"isLoopbackCurrently",void 0),l(i,"geometry",null),n=n||{},i.showLoopback=!1!==n.showLoopback,i.curviness=n.curviness||10,i.margin=n.margin||5,i.proximityLimit=n.proximityLimit||80,i.clockwise=n.orientation&&"clockwise"===n.orientation,i.loopbackRadius=n.loopbackRadius||25,i.isLoopbackCurrently=!1,i}return h(t,e),a(t,[{key:"getDefaultStubs",value:function(){return[0,0]}},{key:"_distance",value:function(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2))}},{key:"_compute",value:function(e,t){var n=t.sourcePos,i=t.targetPos,o=Math.abs(n.curX-i.curX),r=Math.abs(n.curY-i.curY),s=e.sx,a=e.sy,l=e.tx,c=e.ty,u=e.startStubX,h=e.startStubY,d=e.endStubX,p=e.endStubY;if(this._distance([s,a],[l,c])<this.proximityLimit)this._addSegment(wr,{x1:s,y1:a,x2:u,y2:h}),this._addSegment(wr,{x1:u,y1:h,x2:d,y2:p}),this._addSegment(wr,{x1:d,y1:p,x2:l,y2:c});else if(this.showLoopback&&t.sourceEndpoint.elementId===t.targetEndpoint.elementId){this.isLoopbackCurrently=!0;var f=t.sourcePos.curX,v=t.sourcePos.curY-this.margin,y=f,g=v-this.loopbackRadius,m=y-this.loopbackRadius,_=g-this.loopbackRadius;o=2*this.loopbackRadius,r=2*this.loopbackRadius,e.points[0]=m,e.points[1]=_,e.points[2]=o,e.points[3]=r,this._addSegment(ts,{loopback:!0,x1:f-m+4,y1:v-_,startAngle:0,endAngle:2*Math.PI,r:this.loopbackRadius,ac:!this.clockwise,x2:f-m-4,y2:v-_,cx:y-m,cy:g-_})}else this.isLoopbackCurrently=!1,this._computeBezier(e,t,n,i,o,r)}},{key:"exportGeometry",value:function(){return null==this.geometry?null:{controlPoints:[x({},this.geometry.controlPoints[0]),x({},this.geometry.controlPoints[1])],source:x({},this.geometry.source),target:x({},this.geometry.target)}}},{key:"transformGeometry",value:function(e,t,n){return{controlPoints:[{x:e.controlPoints[0].x+t,y:e.controlPoints[0].y+n},{x:e.controlPoints[1].x+t,y:e.controlPoints[1].y+n}],source:this.transformAnchorPlacement(e.source,t,n),target:this.transformAnchorPlacement(e.target,t,n)}}},{key:"importGeometry",value:function(e){return null!=e&&(null==e.controlPoints||2!=e.controlPoints.length?(z("jsPlumb Bezier: cannot import geometry; controlPoints missing or does not have length 2"),this.setGeometry(null,!0),!1):null==e.controlPoints[0].x||null==e.controlPoints[0].y||null==e.controlPoints[1].x||null==e.controlPoints[1].y?(z("jsPlumb Bezier: cannot import geometry; controlPoints malformed"),this.setGeometry(null,!0),!1):null==e.source||null==e.source.curX||null==e.source.curY?(z("jsPlumb Bezier: cannot import geometry; source missing or malformed"),this.setGeometry(null,!0),!1):null==e.target||null==e.target.curX||null==e.target.curY?(z("jsPlumb Bezier: cannot import geometry; target missing or malformed"),this.setGeometry(null,!0),!1):(this.setGeometry(e,!1),!0))}}])}(Yo),is=function(e,t){return{x:e.x-t.x,y:e.y-t.y}},os=function(e,t){return e.x*t.x+e.y*t.y},rs=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},ss=function(e,t){return{x:e.x*t,y:e.y*t}},as=Math.pow(2,-65);function ls(e,t){for(var n,i=[],o=function(e,t){for(var n=t.length-1,i=2*n-1,o=[],r=[],s=[],a=[],l=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]],c=0;c<=n;c++)o[c]=is(t[c],e);for(var u=0;u<=n-1;u++)r[u]=is(t[u+1],t[u]),r[u]=ss(r[u],3);for(var h=0;h<=n-1;h++)for(var d=0;d<=n;d++)s[h]||(s[h]=[]),s[h][d]=os(r[h],o[d]);for(var p=0;p<=i;p++)a[p]||(a[p]=[]),a[p].y=0,a[p].x=parseFloat(""+p)/i;for(var f=n,v=n-1,y=0;y<=f+v;y++)for(var g=Math.max(0,y-v),m=Math.min(y,f),_=g;_<=m;_++){var b=y-_;a[_+b].y+=s[b][_]*l[b][_]}return a}(e,t),r=t.length-1,s=cs(o,2*r-1,i,0),a=is(e,t[0]),l=rs(a),c=0,u=0;u<s;u++)a=is(e,us(t,r,i[u],null,null)),(n=rs(a))<l&&(l=n,c=i[u]);return a=is(e,t[r]),(n=rs(a))<l&&(l=n,c=1),{location:c,distance:l}}function cs(e,t,n,i){var o,r,s=[],a=[],l=[],c=[];switch(function(e,t){var n,i,o=0;n=i=W(e[0].y);for(var r=1;r<=t;r++)(n=W(e[r].y))!=i&&o++,i=n;return o}(e,t)){case 0:return 0;case 1:if(i>=64)return n[0]=(e[0].x+e[t].x)/2,1;if(function(e,t){var n,i,o,r,s,a,l,c,u,h,d,p,f;s=e[0].y-e[t].y,a=e[t].x-e[0].x,l=e[0].x*e[t].y-e[t].x*e[0].y,p=f=0;for(var v=1;v<t;v++){var y=s*e[v].x+a*e[v].y+l;y>p?p=y:y<f&&(f=y)}return n=((u=1)*(l-p)-(d=a)*(h=0))*(1/((c=0)*d-s*u)),i=(u*(l-f)-(d=a)*h)*(1/(c*d-s*u)),o=Math.min(n,i),r=Math.max(n,i),r-o<as?1:0}(e,t))return n[0]=function(e,t){var n=1,i=0,o=e[t].x-e[0].x,r=e[t].y-e[0].y,s=e[0].x-0,a=e[0].y-0;return 0+n*(1/(o*i-r*n)*(o*a-r*s))}(e,t),1}us(e,t,.5,s,a),o=cs(s,t,l,i+1),r=cs(a,t,c,i+1);for(var u=0;u<o;u++)n[u]=l[u];for(var h=0;h<r;h++)n[h+o]=c[h];return o+r}function us(e,t,n,i,o){for(var r=[[]],s=0;s<=t;s++)r[0][s]=e[s];for(var a=1;a<=t;a++)for(var l=0;l<=t-a;l++)r[a]||(r[a]=[]),r[a][l]||(r[a][l]={}),r[a][l].x=(1-n)*r[a-1][l].x+n*r[a-1][l+1].x,r[a][l].y=(1-n)*r[a-1][l].y+n*r[a-1][l+1].y;if(null!=i)for(var c=0;c<=t;c++)i[c]=r[c][0];if(null!=o)for(var u=0;u<=t;u++)o[u]=r[t-u][u];return r[t][0]}function hs(e,t){var n={x:0,y:0};if(0===e)return t[0];var i=t.length-1;if(1===e)return t[i];var o=t,r=1-e;if(0===i)return t[0];if(1===i)return{x:r*o[0].x+e*o[1].x,y:r*o[0].y+e*o[1].y};if(4>i){var s,a,l,c=r*r,u=e*e,h=0;return 2===i?(o=[o[0],o[1],o[2],n],s=c,a=r*e*2,l=u):3===i&&(s=c*r,a=c*e*3,l=r*u*3,h=e*u),{x:s*o[0].x+a*o[1].x+l*o[2].x+h*o[3].x,y:s*o[0].y+a*o[1].y+l*o[2].y+h*o[3].y}}return n}function ds(e){var t=0;if(!ys(e))for(var n=function(e,t){var n=[];e--;for(var i=0;i<=e;i++)n.push(hs(i/e,t));return n}(16,e),i=0;i<15;i++){t+=vs(n[i],n[i+1])}return t}var ps=new Map;function fs(e,t){for(var n=function(e){var t=ps.get(e);if(!t){var n=function(e){return function(t){return e}},i=function(e){return function(t){for(var n=1,i=0;i<e.length;i++)n*=e[i](t);return n}};(t=[]).push((function(t){return Math.pow(t,e)}));for(var o=1;o<e;o++){for(var r=[n(e)],s=0;s<e-o;s++)r.push((function(e){return e}));for(var a=0;a<o;a++)r.push((function(e){return 1-e}));t.push(i(r))}t.push((function(t){return Math.pow(1-t,e)})),ps.set(e,t)}return t}(e.length-1),i=0,o=0,r=0;r<e.length;r++)i+=e[r].x*n[r](t),o+=e[r].y*n[r](t);return{x:i,y:o}}function vs(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function ys(e){return e[0].x===e[1].x&&e[0].y===e[1].y}function gs(e,t,n){if(ys(e))return{point:e[0],location:t};for(var i=fs(e,t),o=0,r=t,s=n>0?1:-1,a=null;o<Math.abs(n);)o+=vs(a=fs(e,r+=.005*s),i),i=a;return{point:a,location:r}}function ms(e,t){var n=fs(e,t),i=fs(e.slice(0,e.length-1),t),o=i.y-n.y,r=i.x-n.x;return 0===o?1/0:Math.atan(o/r)}function _s(e,t,n,i,o){var r=i-t,s=e-n,a=e*(t-i)+t*(n-e),l=function(e){return[bs(e,"x"),bs(e,"y")]}(o),c=[r*l[0][0]+s*l[1][0],r*l[0][1]+s*l[1][1],r*l[0][2]+s*l[1][2],r*l[0][3]+s*l[1][3]+a],u=ks.apply(null,c),h=[];if(null!=u)for(var d=0;d<3;d++){var p=u[d],f=Math.pow(p,2),v=Math.pow(p,3),y={x:l[0][0]*v+l[0][1]*f+l[0][2]*p+l[0][3],y:l[1][0]*v+l[1][1]*f+l[1][2]*p+l[1][3]},g=void 0;g=n-e!=0?(y[0]-e)/(n-e):(y[1]-t)/(i-t),p>=0&&p<=1&&g>=0&&g<=1&&h.push(y)}return h}function bs(e,t){return[-e[0][t]+3*e[1][t]+-3*e[2][t]+e[3][t],3*e[0][t]-6*e[1][t]+3*e[2][t],-3*e[0][t]+3*e[1][t],e[0][t]]}function ks(e,t,n,i){var o,r,s=t/e,a=n/e,l=i/e,c=(3*a-Math.pow(s,2))/9,u=(9*s*a-27*l-2*Math.pow(s,3))/54,h=Math.pow(c,3)+Math.pow(u,2),d=[0,0,0];if(h>=0)o=W(u+Math.sqrt(h))*Math.pow(Math.abs(u+Math.sqrt(h)),1/3),r=W(u-Math.sqrt(h))*Math.pow(Math.abs(u-Math.sqrt(h)),1/3),d[0]=-s/3+(o+r),d[1]=-s/3-(o+r)/2,d[2]=-s/3-(o+r)/2,0!==Math.abs(Math.sqrt(3)*(o-r)/2)&&(d[1]=-1,d[2]=-1);else{var p=Math.acos(u/Math.sqrt(-Math.pow(c,3)));d[0]=2*Math.sqrt(-c)*Math.cos(p/3)-s/3,d[1]=2*Math.sqrt(-c)*Math.cos((p+2*Math.PI)/3)-s/3,d[2]=2*Math.sqrt(-c)*Math.cos((p+4*Math.PI)/3)-s/3}for(var f=0;f<3;f++)(d[f]<0||d[f]>1)&&(d[f]=-1);return d}var xs=function(e){function t(e){var n;return r(this,t),l(n=o(this,t,[e]),"curve",void 0),l(n,"cp1x",void 0),l(n,"cp1y",void 0),l(n,"cp2x",void 0),l(n,"cp2y",void 0),l(n,"length",0),l(n,"type",t.segmentType),n.cp1x=e.cp1x,n.cp1y=e.cp1y,n.cp2x=e.cp2x,n.cp2y=e.cp2y,n.x1=e.x1,n.x2=e.x2,n.y1=e.y1,n.y2=e.y2,n.curve=[{x:n.x1,y:n.y1},{x:n.cp1x,y:n.cp1y},{x:n.cp2x,y:n.cp2y},{x:n.x2,y:n.y2}],n.extents={xmin:Math.min(n.x1,n.x2,n.cp1x,n.cp2x),ymin:Math.min(n.y1,n.y2,n.cp1y,n.cp2y),xmax:Math.max(n.x1,n.x2,n.cp1x,n.cp2x),ymax:Math.max(n.y1,n.y2,n.cp1y,n.cp2y)},n}return h(t,e),a(t,[{key:"getPath",value:function(e){return(e?"M "+this.x2+" "+this.y2+" ":"")+"C "+this.cp2x+" "+this.cp2y+" "+this.cp1x+" "+this.cp1y+" "+this.x1+" "+this.y1}},{key:"pointOnPath",value:function(e,n){return e=t._translateLocation(this.curve,e,n),fs(this.curve,e)}},{key:"gradientAtPoint",value:function(e,n){return e=t._translateLocation(this.curve,e,n),ms(this.curve,e)}},{key:"pointAlongPathFrom",value:function(e,n,i){return e=t._translateLocation(this.curve,e,i),function(e,t,n){return gs(e,t,n).point}(this.curve,e,n)}},{key:"getLength",value:function(){return null!=this.length&&0!==this.length||(this.length=ds(this.curve)),this.length}},{key:"findClosestPointOnPath",value:function(e,t){var n,i,o,r=(n={x:e,y:t},i=this.curve,o=ls(n,i),{point:us(i,i.length-1,o.location,null,null),location:o.location});return{d:Math.sqrt(Math.pow(r.point.x-e,2)+Math.pow(r.point.y-t,2)),x:r.point.x,y:r.point.y,l:1-r.location,s:this,x1:null,y1:null,x2:null,y2:null}}},{key:"lineIntersection",value:function(e,t,n,i){return _s(e,t,n,i,this.curve)}}],[{key:"_translateLocation",value:function(e,t,n){return n&&(t=function(e,t,n){return gs(e,t,n).location}(e,t>0?0:1,t)),t}}])}(rn);l(xs,"segmentType","Bezier");var Cs=function(e){function t(e,n){var i;return r(this,t),(i=o(this,t,[e,n])).connection=e,l(i,"type",t.type),l(i,"majorAnchor",void 0),l(i,"minorAnchor",void 0),n=n||{},i.majorAnchor=n.curviness||150,i.minorAnchor=10,i}return h(t,e),a(t,[{key:"getCurviness",value:function(){return this.majorAnchor}},{key:"_findControlPoint",value:function(e,t,n,i,o){var r={x:0,y:0};return i[0]!==o[0]||i[1]===o[1]?(0===o[0]?r.x=n.curX<t.curX?e.x+this.minorAnchor:e.x-this.minorAnchor:r.x=e.x+this.majorAnchor*o[0],0===o[1]?r.y=n.curY<t.curY?e.y+this.minorAnchor:e.y-this.minorAnchor:r.y=e.y+this.majorAnchor*i[1]):(0===i[0]?r.x=t.curX<n.curX?e.x+this.minorAnchor:e.x-this.minorAnchor:r.x=e.x-this.majorAnchor*i[0],0===i[1]?r.y=t.curY<n.curY?e.y+this.minorAnchor:e.y-this.minorAnchor:r.y=e.y+this.majorAnchor*o[1]),r}},{key:"_computeBezier",value:function(e,t,n,i,o,r){var s,a,l=n.curX<i.curX?o:0,c=n.curY<i.curY?r:0,u=n.curX<i.curX?0:o,h=n.curY<i.curY?0:r;!0!==this.edited?(s=this._findControlPoint({x:l,y:c},n,i,e.so,e.to),a=this._findControlPoint({x:u,y:h},i,n,e.to,e.so)):(s=this.geometry.controlPoints[0],a=this.geometry.controlPoints[1]),this.geometry={controlPoints:[s,a],source:t.sourcePos,target:t.targetPos},this._addSegment(xs,{x1:l,y1:c,x2:u,y2:h,cp1x:s.x,cp1y:s.y,cp2x:a.x,cp2y:a.y})}}])}(ns);l(Cs,"type","Bezier");var Ss=function(e){function t(e,n){var i;return r(this,t),(i=o(this,t,[e,n])).connection=e,l(i,"type",t.type),l(i,"_controlPoint",void 0),i.curviness=n.curviness||10,i.margin=n.margin||5,i.proximityLimit=n.proximityLimit||80,i.clockwise=n.orientation&&"clockwise"===n.orientation,i}return h(t,e),a(t,[{key:"_computeBezier",value:function(e,t,n,i,o,r){var s,a,l,c,u,h,d,p,f=n.curX<i.curX?0:o,v=n.curY<i.curY?0:r,y=n.curX<i.curX?o:0,g=n.curY<i.curY?r:0;if(0===n.x&&(f-=this.margin),1===n.x&&(f+=this.margin),0===n.y&&(v-=this.margin),1===n.y&&(v+=this.margin),0===i.x&&(y-=this.margin),1===i.x&&(y+=this.margin),0===i.y&&(g-=this.margin),1===i.y&&(g+=this.margin),!0!==this.edited){var m=(f+y)/2,_=(v+g)/2,b=(a=v,c=g,(s=f)<=(l=y)&&c<=a?1:s<=l&&a<=c?2:l<=s&&c>=a?3:4),k=Math.sqrt(Math.pow(y-f,2)+Math.pow(g-v,2));this._controlPoint=function(e,t,n,i,o,r,s,a,l){return a<=l?{x:e,y:t}:1===n?i.curY<=0&&o.curY>=1?{x:e+(i.x<.5?-1*r:r),y:t}:i.curX>=1&&o.curX<=0?{x:e,y:t+(i.y<.5?-1*s:s)}:{x:e+-1*r,y:t+-1*s}:2===n?i.curY>=1&&o.curY<=0?{x:e+(i.x<.5?-1*r:r),y:t}:i.curX>=1&&o.curX<=0?{x:e,y:t+(i.y<.5?-1*s:s)}:{x:e+r,y:t+-1*s}:3===n?i.curY>=1&&o.curY<=0?{x:e+(i.x<.5?-1*r:r),y:t}:i.curX<=0&&o.curX>=1?{x:e,y:t+(i.y<.5?-1*s:s)}:{x:e+-1*r,y:t+-1*s}:4===n?i.curY<=0&&o.curY>=1?{x:e+(i.x<.5?-1*r:r),y:t}:i.curX<=0&&o.curX>=1?{x:e,y:t+(i.y<.5?-1*s:s)}:{x:e+r,y:t+-1*s}:void 0}(m,_,b,t.sourcePos,t.targetPos,this.curviness,this.curviness,k,this.proximityLimit)}else this._controlPoint=this.geometry.controlPoints[0];u=this._controlPoint.x,h=this._controlPoint.x,d=this._controlPoint.y,p=this._controlPoint.y,this.geometry={controlPoints:[this._controlPoint,this._controlPoint],source:t.sourcePos,target:t.targetPos},this._addSegment(xs,{x1:y,y1:g,x2:f,y2:v,cp1x:u,cp1y:d,cp2x:h,cp2y:p})}}])}(ns);function ws(e){return e<0?-1:0===e?0:1}function Es(e){return[ws(e[2]-e[0]),ws(e[3]-e[1])]}function Ps(e){return Math.sqrt(Math.pow(e[0]-e[2],2)+Math.pow(e[1]-e[3],2))}function As(e){var t=[];return t.push.apply(t,e),t}l(Ss,"type","StateMachine"),Sr(Cs.type,Cs),Sr(Ss.type,Ss);var Ds=function(e){function t(e,n){var i;return r(this,t),(i=o(this,t,[e,n])).connection=e,l(i,"type",t.type),l(i,"internalSegments",[]),l(i,"midpoint",void 0),l(i,"alwaysRespectStubs",void 0),l(i,"cornerRadius",void 0),l(i,"lastx",void 0),l(i,"lasty",void 0),l(i,"lastOrientation",void 0),l(i,"loopbackRadius",void 0),l(i,"isLoopbackCurrently",void 0),i.midpoint=null==n.midpoint||isNaN(n.midpoint)?.5:n.midpoint,i.cornerRadius=null!=n.cornerRadius?n.cornerRadius:0,i.alwaysRespectStubs=!0===n.alwaysRespectStubs,i.lastx=null,i.lasty=null,i.lastOrientation=null,i.loopbackRadius=n.loopbackRadius||25,i.isLoopbackCurrently=!1,i}return h(t,e),a(t,[{key:"getDefaultStubs",value:function(){return[30,30]}},{key:"addASegment",value:function(e,t,n){if(this.lastx!==e||this.lasty!==t){var i=null==this.lastx?n.sx:this.lastx,o=null==this.lasty?n.sy:this.lasty,r=i===e?"v":"h";this.lastx=e,this.lasty=t,this.internalSegments.push([i,o,e,t,r])}}},{key:"writeSegments",value:function(e){for(var t,n,i,o=null,r=0;r<this.internalSegments.length-1;r++){if(o=o||As(this.internalSegments[r]),t=As(this.internalSegments[r+1]),n=Es(o),i=Es(t),this.cornerRadius>0&&o[4]!==t[4]){var s=Math.min(Ps(o),Ps(t)),a=Math.min(this.cornerRadius,s/2);o[2]-=n[0]*a,o[3]-=n[1]*a,t[0]+=i[0]*a,t[1]+=i[1]*a;var l=n[1]===i[0]&&1===i[0]||n[1]===i[0]&&0===i[0]&&n[0]!==i[1]||n[1]===i[0]&&-1===i[0],c=(t[1]>o[3]?1:-1)===(t[0]>o[2]?1:-1),u=c&&l||!c&&!l?t[0]:o[2],h=c&&l||!c&&!l?o[3]:t[1];this._addSegment(wr,{x1:o[0],y1:o[1],x2:o[2],y2:o[3]}),this._addSegment(ts,{r:a,x1:o[2],y1:o[3],x2:t[0],y2:t[1],cx:u,cy:h,ac:l})}else this._addSegment(wr,{x1:o[0],y1:o[1],x2:o[2],y2:o[3]});o=t}null!=t&&this._addSegment(wr,{x1:t[0],y1:t[1],x2:t[2],y2:t[3]})}},{key:"_compute",value:function(e,t){var n=this;this.internalSegments.length=0,this.lastx=null,this.lasty=null,this.lastOrientation=null;var i=function(t){return[e.startStubX,e.startStubY,e.endStubX,e.endStubY]},o={perpendicular:i,orthogonal:i,opposite:function(t){var i=e,o="x"===t?0:1,r={x:function(){return 1===i.so[o]&&(i.startStubX>i.endStubX&&i.tx>i.startStubX||i.sx>i.endStubX&&i.tx>i.sx)||-1===i.so[o]&&(i.startStubX<i.endStubX&&i.tx<i.startStubX||i.sx<i.endStubX&&i.tx<i.sx)},y:function(){return 1===i.so[o]&&(i.startStubY>i.endStubY&&i.ty>i.startStubY||i.sy>i.endStubY&&i.ty>i.sy)||-1===i.so[o]&&(i.startStubY<i.endStubY&&i.ty<i.startStubY||i.sy<i.endStubY&&i.ty<i.sy)}};return!n.alwaysRespectStubs&&r[t]()?{x:[(e.sx+e.tx)/2,e.startStubY,(e.sx+e.tx)/2,e.endStubY],y:[e.startStubX,(e.sy+e.ty)/2,e.endStubX,(e.sy+e.ty)/2]}[t]:[e.startStubX,e.startStubY,e.endStubX,e.endStubY]}}[e.anchorOrientation](e.sourceAxis),r="x"===e.sourceAxis?0:1,s="x"===e.sourceAxis?1:0,a=o[r],l=o[s],c=o[r+2],u=o[s+2];this.addASegment(o[0],o[1],e);var h=e.startStubX+(e.endStubX-e.startStubX)*this.midpoint,d=e.startStubY+(e.endStubY-e.startStubY)*this.midpoint,p={x:[0,1],y:[1,0]},f={perpendicular:function(t,n,i,o,r){var s=e,a={x:[[s.startStubX,s.endStubX],null,[s.endStubX,s.startStubX]],y:[[s.startStubY,s.endStubY],null,[s.endStubY,s.startStubY]]},l={x:[[h,s.startStubY],[h,s.endStubY]],y:[[s.startStubX,d],[s.endStubX,d]]},c={x:[[s.endStubX,s.startStubY]],y:[[s.startStubX,s.endStubY]]},u={x:[[s.startStubX,s.endStubY],[s.endStubX,s.endStubY]],y:[[s.endStubX,s.startStubY],[s.endStubX,s.endStubY]]},f={x:[[s.startStubX,d],[s.endStubX,d],[s.endStubX,s.endStubY]],y:[[h,s.startStubY],[h,s.endStubY],[s.endStubX,s.endStubY]]},v={x:[s.startStubY,s.endStubY],y:[s.startStubX,s.endStubX]},y=p[t][0],g=p[t][1],m=s.so[y]+1,_=s.to[g]+1,b=-1===s.to[g]&&v[t][1]<v[t][0]||1===s.to[g]&&v[t][1]>v[t][0],k=a[t][m][0],x=a[t][m][1],C={x:[[[1,2,3,4],null,[2,1,4,3]],null,[[4,3,2,1],null,[3,4,1,2]]],y:[[[3,2,1,4],null,[2,3,4,1]],null,[[4,1,2,3],null,[1,4,3,2]]]}[t][m][_];return s.segment===C[3]||s.segment===C[2]&&b?l[t]:s.segment===C[2]&&x<k?c[t]:s.segment===C[2]&&x>=k||s.segment===C[1]&&!b?f[t]:s.segment===C[0]||s.segment===C[1]&&b?u[t]:void 0},orthogonal:function(t,n,i,o,r){var s=e,a={x:-1===s.so[0]?Math.min(n,o):Math.max(n,o),y:-1===s.so[1]?Math.min(n,o):Math.max(n,o)}[t];return{x:[[a,i],[a,r],[o,r]],y:[[i,a],[r,a],[r,o]]}[t]},opposite:function(i,o,s,a,l){var c=e,u={x:"y",y:"x"}[i],p={x:"h",y:"w"}[i],f=c["is"+i.toUpperCase()+"GreaterThanStubTimes2"];if(t.sourceEndpoint.elementId===t.targetEndpoint.elementId){var v=s+(1-t.sourceEndpoint._anchor.computedPosition[u])*t.sourceInfo[p]+n.maxStub;return{x:[[o,v],[a,v]],y:[[v,o],[v,a]]}[i]}return!f||1===c.so[r]&&o>a||-1===c.so[r]&&o<a?{x:[[o,d],[a,d]],y:[[h,o],[h,a]]}[i]:1===c.so[r]&&o<a||-1===c.so[r]&&o>a?{x:[[h,c.sy],[h,c.ty]],y:[[c.sx,d],[c.tx,d]]}[i]:void 0}}[e.anchorOrientation](e.sourceAxis,a,l,c,u);if(f)for(var v=0;v<f.length;v++)this.addASegment(f[v][0],f[v][1],e);this.addASegment(o[2],o[3],e),this.addASegment(e.tx,e.ty,e),this.writeSegments(e)}},{key:"transformGeometry",value:function(e,t,n){return e}}])}(Yo);l(Ds,"type","Flowchart"),Sr(Ds.type,Ds);for(var Ms={clientX:5e4,clientY:5e4,screenX:5e4,screenY:5e4,pageX:5e4,pageY:5e4},Ts=0;Ts<256;Ts++)Ts.toString(16);a((function e(t,n,i){r(this,e),this._jsPlumb=t,this.ok=n,this.equal=i,l(this,"_divs",[]),l(this,"mottle",void 0),this.mottle=new Fn}),[{key:"_t",value:function(e,t,n,i){this.mottle.trigger(e,t,{pageX:n,pageY:i,screenX:n,screenY:i,clientX:n,clientY:i})}},{key:"addDiv",value:function(e,t,n,i,o,r,s){var a=document.createElement("div");return a.style.position="absolute",a.innerHTML=e,t?t.appendChild(a):this._jsPlumb.getContainer().appendChild(a),a.setAttribute("id",e),a.style.left=(null!=i?i:Math.floor(1e3*Math.random()))+"px",a.style.top=(null!=o?o:Math.floor(1e3*Math.random()))+"px",n&&(a.className=n),r&&(a.style.width=r+"px"),s&&(a.style.height=s+"px"),this._divs.push(e),a}},{key:"addDivs",value:function(e,t){for(var n=0;n<e.length;n++)this.addDiv(e[n],t)}},{key:"assertEndpointCount",value:function(e,t){var n=this._jsPlumb.getEndpoints(e),i=n?n.length:0;this.equal(i,t,e.getAttribute("data-jtk-managed")+" has "+t+(t>1||0==t?" endpoints":" endpoint"))}},{key:"_assertManagedEndpointCount",value:function(e,t){var n=this._jsPlumb.getId(e),i=this._jsPlumb._managedElements[n];this.equal(i.endpoints.length,t,n+" has "+t+" endpoints in managed record")}},{key:"_assertManagedConnectionCount",value:function(e,t){var n=this._jsPlumb.getId(e),i=this._jsPlumb._managedElements[n];this.equal(i.connections.length,t,n+" has "+t+" connections in managed record")}},{key:"_registerDiv",value:function(e){this._divs.push(e)}},{key:"makeDragStartEvt",value:function(e){var t=this.makeEvent(e),n=this._jsPlumb.getContainer();return t.clientX+=n.offsetLeft,t.screenX+=n.offsetLeft,t.pageX+=n.offsetLeft,t.clientY+=n.offsetTop,t.screenY+=n.offsetTop,t.pageY+=n.offsetTop,t}},{key:"getAttribute",value:function(e,t){return e.getAttribute(t)}},{key:"dragNodeBy",value:function(e,t,n,i){(i=i||{}).before&&i.before();var o=this.makeEvent(e);this._jsPlumb.trigger(e,vt,o),i.beforeMouseMove&&i.beforeMouseMove(),this._t(document,mt,o.pageX+t,o.pageY+n),i.beforeMouseUp&&i.beforeMouseUp(),this.mottle.trigger(document,_t,null),i.after&&i.after()}},{key:"dragNodeTo",value:function(e,t,n,i){i=i||{};var o=this._jsPlumb.viewport.getPosition(this._jsPlumb.getId(e));i.before&&i.before();var r=this.makeEvent(e);this._jsPlumb.trigger(e,vt,r);var s=this._jsPlumb.getContainer().getBoundingClientRect();i.beforeMouseMove&&i.beforeMouseMove(),this._t(document,mt,s.x+t+o.w/2,s.y+n+o.h/2),i.beforeMouseUp&&i.beforeMouseUp(),this.mottle.trigger(document,_t,null),i.after&&i.after()}},{key:"dragToGroup",value:function(e,t,n){var i=this._jsPlumb.getGroup(t),o=this._jsPlumb.viewport.getPosition(i.elId),r=o.x+o.w/2,s=o.y+o.h/2;this.dragNodeTo(e,r,s,n)}},{key:"aSyncDragNodeBy",value:function(e,t,n,i){var o=this;(i=i||{}).before&&i.before();var r=this.makeEvent(e);this._jsPlumb.trigger(e,vt,r),i.beforeMouseMove&&i.beforeMouseMove(),setTimeout((function(){o._t(document,mt,r.pageX+t,r.pageY+n),i.beforeMouseUp&&i.beforeMouseUp(),setTimeout((function(){o.mottle.trigger(document,_t,null),i.after&&i.after()}),45)}),45)}},{key:"dragANodeAround",value:function(e,t,n){this._jsPlumb.trigger(e,vt,this.makeEvent(e));for(var i,o,r=50*Math.random(),s=0;s<r;s++){var a=(i=void 0,o=void 0,i=Math.floor(2e3*Math.random()),o=Math.floor(2e3*Math.random()),{clientX:i,clientY:o,screenX:i,screenY:o,pageX:i,pageY:o});e.style.left=a.screenX+"px",e.style.top=a.screenY+"px",this._jsPlumb.trigger(document,mt,a)}t&&this.ok(t(),n||"while dragging assert"),this._jsPlumb.trigger(document,_t,Ms)}},{key:"dragConnection",value:function(e,t,n,i){var o=this.getCanvas(e),r=this.getCanvas(t),s=this.makeEvent(o),a=this.makeEvent(r);i=i||{};var l=this._jsPlumb.select().length;return this._jsPlumb.trigger(o,vt,s),i.beforeMouseMove&&i.beforeMouseMove(),this._jsPlumb.trigger(n?r:document,mt,a),i.beforeMouseUp&&i.beforeMouseUp(),this._jsPlumb.trigger(n?r:document,_t,a),this._jsPlumb.select().get(l)}},{key:"aSyncDragConnection",value:function(e,t,n){var i=this;n=n||{};var o=this.getCanvas(e),r=this.getCanvas(t),s=this.makeEvent(o),a=this.makeEvent(r),l=this._jsPlumb.select().length;this._jsPlumb.trigger(o,vt,s),setTimeout((function(){n.beforeMouseMove&&n.beforeMouseMove(),i._jsPlumb.trigger(document,mt,a),setTimeout((function(){n.beforeMouseUp&&n.beforeMouseUp(),i._jsPlumb.trigger(r,_t,a),n.after&&n.after(i._jsPlumb.select().get(l))}),5)}),5)}},{key:"dragAndAbortConnection",value:function(e){var t=this.getCanvas(e),n=this.makeEvent(t);this._jsPlumb.trigger(t,vt,n),this._jsPlumb.trigger(document,mt,Ms),this._jsPlumb.trigger(document,_t,Ms)}},{key:"detachConnection",value:function(e,t){t=t||{};var n=this.getEndpointCanvas(e),i=this.makeEvent(n);t.before&&t.before(),this._jsPlumb.trigger(n,vt,i),t.beforeMouseMove&&t.beforeMouseMove(),this._jsPlumb.trigger(document,mt,Ms),t.beforeMouseUp&&t.beforeMouseUp(),this._jsPlumb.trigger(document,_t,Ms),t.after&&t.after()}},{key:"detachAndReattachConnection",value:function(e,t){t=t||{};var n=this.getEndpointCanvas(e),i=this.makeEvent(n);t.before&&t.before(),this._jsPlumb.trigger(n,vt,i),t.beforeMouseMove&&t.beforeMouseMove(),this._jsPlumb.trigger(document,mt,Ms),this._jsPlumb.trigger(document,mt,i),t.beforeMouseUp&&t.beforeMouseUp(),this._jsPlumb.trigger(document,_t,i),t.after&&t.after()}},{key:"detachConnectionByTarget",value:function(e,t){this.detachConnection(e.endpoints[1],t)}},{key:"relocateTarget",value:function(e,t,n){this.relocate(e,1,t,n)}},{key:"relocate",value:function(e,t,n,i){i=i||{},n=this.getCanvas(n);var o=this.getEndpointCanvas(e.endpoints[t]),r=this.makeEvent(o),s=this.makeEvent(n);i.before&&i.before(),this._jsPlumb.trigger(o,vt,r),i.beforeMouseMove&&i.beforeMouseMove(),this._jsPlumb.trigger(document,mt,s),i.beforeMouseUp&&i.beforeMouseUp(),this._jsPlumb.trigger(n,_t,s),i.after&&i.after()}},{key:"relocateSource",value:function(e,t,n){this.relocate(e,0,t,n)}},{key:"makeEvent",value:function(e){var t=e.getBoundingClientRect(),n=t.x+t.width/2,i=t.y+t.height/2;return{clientX:n,clientY:i,screenX:n,screenY:i,pageX:n,pageY:i}}},{key:"getCanvas",value:function(e){return e.endpoint?this.getEndpointCanvas(e):e}},{key:"getEndpointCanvas",value:function(e){return e.endpoint.canvas}},{key:"getConnectionCanvas",value:function(e){return e.connector.canvas}},{key:"getEndpointCanvasPosition",value:function(e){var t=this.getEndpointCanvas(e);return{x:parseInt(t.style.left,10),y:parseInt(t.style.top,10),w:t.getAttribute("width"),h:t.getAttribute("height")}}},{key:"within",value:function(e,t,n){this.ok(Math.abs(e-t)<1e-11,n+"[expected: "+t+" got "+e+"] [diff:"+Math.abs(e-t)+"]")}},{key:"assertManagedEndpointCount",value:function(e,t){var n=this._jsPlumb.getId(e),i=this._jsPlumb._managedElements[n];this.equal(i.endpoints.length,t,n+" has "+t+" endpoints in managed record")}},{key:"assertManagedConnectionCount",value:function(e,t){var n=this._jsPlumb.getId(e),i=this._jsPlumb._managedElements[n];this.equal(i.connections.length,t,n+" has "+t+" connections in managed record")}},{key:"fireEventOnEndpoint",value:function(e){for(var t=this.getEndpointCanvas(e),n=0;n<(arguments.length<=1?0:arguments.length-1);n++)this._jsPlumb.trigger(t,n+1<1||arguments.length<=n+1?void 0:arguments[n+1])}},{key:"fireEventOnElement",value:function(e){for(var t=0;t<(arguments.length<=1?0:arguments.length-1);t++)this._jsPlumb.trigger(e,t+1<1||arguments.length<=t+1?void 0:arguments[t+1])}},{key:"fireEventOnConnection",value:function(e){for(var t=this.getConnectionCanvas(e),n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];this.fireEventOnElement.apply(this,[t].concat(i))}},{key:"clickOnConnection",value:function(e){this.fireEventOnConnection(e,ht)}},{key:"dblClickOnConnection",value:function(e){this.fireEventOnConnection(e,pt)}},{key:"tapOnConnection",value:function(e){this.fireEventOnConnection(e,vt),this.fireEventOnConnection(e,_t)}},{key:"dblTapOnConnection",value:function(e){this.fireEventOnConnection(e,vt),this.fireEventOnConnection(e,_t),this.fireEventOnConnection(e,vt),this.fireEventOnConnection(e,_t)}},{key:"clickOnElement",value:function(e,t){this._jsPlumb.trigger(e,ht,null,null,null==t?1:t)}},{key:"dblClickOnElement",value:function(e){this._jsPlumb.trigger(e,pt)}},{key:"tapOnElement",value:function(e){this._jsPlumb.trigger(e,vt),this._jsPlumb.trigger(e,_t)}},{key:"dblTapOnElement",value:function(e){this._jsPlumb.trigger(e,vt),this._jsPlumb.trigger(e,_t),this._jsPlumb.trigger(e,vt),this._jsPlumb.trigger(e,_t)}},{key:"getOverlayCanvas",value:function(e){return e.canvas||e.path}},{key:"fireEventOnOverlay",value:function(e,t,n){var i=e.getOverlay(t),o=this.getOverlayCanvas(i);this._jsPlumb.trigger(o,n)}},{key:"clickOnOverlay",value:function(e,t){this.fireEventOnOverlay(e,t,ht)}},{key:"dblClickOnOverlay",value:function(e,t){this.fireEventOnOverlay(e,t,pt)}},{key:"tapOnOverlay",value:function(e,t){this.fireEventOnOverlay(e,t,vt),this.fireEventOnOverlay(e,t,_t)}},{key:"dblTapOnOverlay",value:function(e,t){this.fireEventOnOverlay(e,t,vt),this.fireEventOnOverlay(e,t,_t),this.fireEventOnOverlay(e,t,vt),this.fireEventOnOverlay(e,t,_t)}},{key:"cleanup",value:function(){var e=this._jsPlumb.getContainer();for(var t in this._jsPlumb.destroy(),this._divs){var n=document.getElementById(this._divs[t]);n&&n.parentNode.removeChild(n)}this._divs.length=0;var i=this._jsPlumb.select().length,o=this._jsPlumb.selectEndpoints().length,r=e.querySelectorAll(".jtk-endpoint").length,s=e.querySelectorAll(".jtk-connector").length;for(var a in e.__ta)for(var l in e.__ta[a])throw"Container event bindings not empty for key "+a;if(i>0)throw"there are connections in the data model!";if(o>0)throw"there are endpoints in the data model!";if(r>0)throw"there are "+r+" endpoints left in the dom!";if(s>0)throw"there are "+s+" connections left in the dom!"}},{key:"makeContent",value:function(e){var t=document.createElement("div");return t.innerHTML=e,t.firstChild}},{key:"length",value:function(e){var t=0;for(var n in e)e.hasOwnProperty(n)&&t++;return t}},{key:"head",value:function(e){for(var t in e)return e[t]}},{key:"uuid",value:function(){return X()}}]);var js=0;function Os(e){return new Hr(function(){var e=js+1;return js++,e}(),e)}},36568:function(e){"use strict";function t(){return(t=Object.assign?Object.assign.bind():function(e){for(var t,n=1;n<arguments.length;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)}var n=["attrs","props","domProps"],i=["class","style","directives"],o=["on","nativeOn"],r=function(e,t){return function(){e&&e.apply(this,arguments),t&&t.apply(this,arguments)}};e.exports=function(e){return e.reduce((function(e,s){for(var a in s)if(e[a])if(-1!==n.indexOf(a))e[a]=t({},e[a],s[a]);else if(-1!==i.indexOf(a)){var l=e[a]instanceof Array?e[a]:[e[a]],c=s[a]instanceof Array?s[a]:[s[a]];e[a]=[].concat(l,c)}else if(-1!==o.indexOf(a))for(var u in s[a])if(e[a][u]){var h=e[a][u]instanceof Array?e[a][u]:[e[a][u]],d=s[a][u]instanceof Array?s[a][u]:[s[a][u]];e[a][u]=[].concat(h,d)}else e[a][u]=s[a][u];else if("hook"===a)for(var p in s[a])e[a][p]=e[a][p]?r(e[a][p],s[a][p]):s[a][p];else e[a]=s[a];else e[a]=s[a];return e}),{})}},949440:function(e,t,n){var i;"undefined"!=typeof self&&self,e.exports=(i=n(370538),function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="fb15")}({"8bbf":function(e,t){e.exports=i},a4b1:function(e,t,n){},f6fd:function(e,t){!function(e){var t="currentScript",n=e.getElementsByTagName("script");t in e||Object.defineProperty(e,t,{get:function(){try{throw new Error}catch(i){var e,t=(/.*at [^\(]*\((.*):.+:.+\)$/gi.exec(i.stack)||[!1])[1];for(e in n)if(n[e].src==t||"interactive"==n[e].readyState)return n[e];return null}}})}(document)},fb15:function(e,t,n){"use strict";var i;n.r(t),"undefined"!=typeof window&&(n("f6fd"),(i=window.document.currentScript)&&(i=i.src.match(/(.+\/)[^/]+\.js(\?.*)?$/))&&(n.p=i[1]));var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:e.wrapperCls},[n("div",{ref:"scrollArea",class:e.scrollAreaCls,on:{"&scroll":function(t){return t.stopPropagation(),e.handleTreeScroll(t)}}},[n("div",{class:e.blockAreaCls},[n("div",{style:e.topSpaceStyles}),e._l(e.expandAnimation.ready?e.expandAnimation.topNodes:e.renderNodes,(function(t){return n("CTreeNode",e._g(e._b({key:t[e.keyField],class:"function"==typeof e.nodeClassName?e.nodeClassName(t):e.nodeClassName,style:{minHeight:e.nodeMinHeight+"px"},attrs:{data:t,noSiblingNodeMap:e.noSiblingNodeMap},on:{check:e.handleNodeCheck,select:e.handleNodeSelect,expand:e.handleNodeExpand,"node-drop":e.handleNodeDrop},scopedSlots:e._u([{key:"default",fn:function(t){return[e._t("node",null,null,t)]}}],null,!0)},"CTreeNode",e.$props,!1),e.treeNodeListeners))})),e.expandAnimation.ready?[n("transition",{attrs:{name:"ctree-expand-animation"},on:{"after-enter":e.onExpandAnimationFinish,"after-leave":e.onExpandAnimationFinish}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.expandAnimation.currentExpandState,expression:"expandAnimation.currentExpandState"}],style:{display:"grid"}},[n("div",{style:{overflow:"hidden"}},e._l(e.expandAnimation.middleNodes,(function(t){return n("CTreeNode",e._g(e._b({key:t[e.keyField],class:"function"==typeof e.nodeClassName?e.nodeClassName(t):e.nodeClassName,style:{minHeight:e.nodeMinHeight+"px"},attrs:{data:t,noSiblingNodeMap:e.noSiblingNodeMap},on:{check:e.handleNodeCheck,select:e.handleNodeSelect,expand:e.handleNodeExpand,"node-drop":e.handleNodeDrop},scopedSlots:e._u([{key:"default",fn:function(t){return[e._t("node",null,null,t)]}}],null,!0)},"CTreeNode",e.$props,!1),e.treeNodeListeners))})),1)])]),e._l(e.expandAnimation.bottomNodes,(function(t){return n("CTreeNode",e._g(e._b({key:t[e.keyField],class:"function"==typeof e.nodeClassName?e.nodeClassName(t):e.nodeClassName,style:{minHeight:e.nodeMinHeight+"px"},attrs:{data:t,noSiblingNodeMap:e.noSiblingNodeMap},on:{check:e.handleNodeCheck,select:e.handleNodeSelect,expand:e.handleNodeExpand,"node-drop":e.handleNodeDrop},scopedSlots:e._u([{key:"default",fn:function(t){return[e._t("node",null,null,t)]}}],null,!0)},"CTreeNode",e.$props,!1),e.treeNodeListeners))}))]:e._e(),n("div",{style:e.bottomSpaceStyles})],2)]),n("div",{directives:[{name:"show",rawName:"v-show",value:!e.blockLength,expression:"!blockLength"}],class:e.emptyCls},[n("span",{class:e.emptyTextDefaultCls},[e._t("empty",[e._v("\n        "+e._s(e.emptyText)+"\n      ")])],2)]),n("div",{directives:[{name:"show",rawName:"v-show",value:e.loading||e.isRootLoading,expression:"loading || isRootLoading"}],class:e.loadingCls},[n("div",{class:e.loadingWrapperCls},[e._t("loading",[n("LoadingIcon",{class:e.loadingIconCls})])],2)]),n("iframe",{ref:"iframe",class:e.iframeCls})])},r=[],s=n("8bbf"),a=n.n(s);function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function u(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}var h,d=["_level","_filterVisible","_parent","_loading","_loaded","_remote","_keyField","children","setChildren"],p=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"id",o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];for(var r in l(this,e),this._keyField=i,this._remote=o,this._level=0,this.checked=!1,this.selected=!1,this.indeterminate=!1,this.disabled=!1,this.expand=!1,this.visible=!0,this._filterVisible=!0,this._parent=null,this.children=[],this.isLeaf=!1,this._loading=!1,this._loaded=!1,t)-1===d.indexOf(r)&&(this[r]=t[r]);null==this[i]&&(this[i]=Math.random().toString(36).substring(2)),this._parent=n,this._parent&&(this._level=this._parent._level+1),this.visible=null===this._parent||this._parent.expand&&this._parent.visible,Array.isArray(t.children)&&this.setChildren(t.children),this.children.length&&(this._loaded=!0),this._remote||(this.isLeaf=!this.children.length)}return u(e,[{key:"setChildren",value:function(t){var n=this;this.children=t.map((function(t){return new e(Object.assign({},t),n,n._keyField,n._remote)}))}}]),e}();!function(e){e.none="none",e.parents="parents",e.children="children"}(h||(h={}));var f,v,y,g,m=["setData","setChecked","setCheckedKeys","checkAll","clearChecked","setSelected","clearSelected","setExpand","setExpandKeys","setExpandAll","getCheckedNodes","getCheckedKeys","getIndeterminateNodes","getSelectedNode","getSelectedKey","getExpandNodes","getExpandKeys","getCurrentVisibleNodes","getNode","getTreeData","getFlatData","getNodesCount","insertBefore","insertAfter","append","prepend","remove","filter","showCheckedNodes","loadRootNodes","scrollTo"],_=["clearKeyword","getKeyword","search"];function b(e){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function x(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function C(e,t,n){return t&&x(e.prototype,t),n&&x(e,n),e}(function(e){e["bottom-start"]="bottom-start",e["bottom-end"]="bottom-end",e.bottom="bottom",e["top-start"]="top-start",e["top-end"]="top-end",e.top="top"})(f||(f={})),function(e){e.top="top",e.center="center",e.bottom="bottom"}(v||(v={})),function(e){e.before="before",e.body="body",e.after="after"}(y||(y={})),function(e){e.dashed="dashed",e.solid="solid"}(g||(g={}));var S=function(){function e(t){k(this,e),this.options=t,this.data=[],this.flatData=[],this.mapData=Object.create(null),this.unloadCheckedKeys=[],this.unloadSelectedKey=null,this.currentSelectedKey=null,this.listenersMap={}}return C(e,[{key:"insertIntoFlatData",value:function(e,t){this.flatData=this.flatData.slice(0,e).concat(t,this.flatData.slice(e))}},{key:"setData",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;for(var o in this.data=e.map((function(e){return new p(e,null,t.options.keyField,!!t.options.load)})),this.mapData)delete this.mapData[o];this.currentSelectedKey=null,this.flatData=this.flattenData(this.data),this.setUnloadCheckedKeys(i||[]),n&&(this.currentSelectedKey=null,this.setUnloadSelectedKey(n)),this.emit("visible-data-change"),this.emit("set-data")}},{key:"setChecked",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],r=this.mapData[e];if(!r)return this.setUnloadChecked(e,t,n,i);r.disabled||r.checked&&t||(r.checked||r.indeterminate||t)&&(this.options.cascade?(this.checkNodeDownward(r,t,o),this.checkNodeUpward(r)):r.checked=t,n&&(r.checked?this.emit("check",r):this.emit("uncheck",r)),this.triggerCheckedChange(n,i))}},{key:"setUnloadChecked",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=this.findIndex(e,this.unloadCheckedKeys);t?-1===o&&this.unloadCheckedKeys.push(e):-1!==o&&this.unloadCheckedKeys.splice(o,1),this.triggerCheckedChange(n,i)}},{key:"setCheckedKeys",value:function(e,t){var n=this,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];e.forEach((function(e){n.setChecked(e,t,!1,!1)})),this.triggerCheckedChange(i,o)}},{key:"checkAll",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.options.cascade)!function t(n){n.forEach((function(n){n.disabled?t(n.children):e.setChecked(n[e.options.keyField],!0,!1,!1)}))}(this.data);else for(var i=this.flatData.length,o=0;o<i;o++){var r=this.flatData[o];this.setChecked(r[this.options.keyField],!0,!1,!1)}this.triggerCheckedChange(t,n)}},{key:"clearChecked",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.getCheckedNodes().forEach((function(t){e.setChecked(t[e.options.keyField],!1,!1,!1)})),this.unloadCheckedKeys=[],this.triggerCheckedChange(t,n)}},{key:"triggerCheckedChange",value:function(){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&this.emit("checked-change",this.getCheckedNodes(),this.getCheckedKeys()),e&&this.emit("render-data-change")}},{key:"setSelected",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=this.mapData[e];if(!o)return this.setUnloadSelected(e,t,n,i);o.disabled||o.selected!==t&&(e===this.currentSelectedKey?t||(o.selected=t,this.currentSelectedKey=null):t&&(null===this.currentSelectedKey?(o.selected=t,this.currentSelectedKey=o[this.options.keyField]):(this.mapData[this.currentSelectedKey]&&(this.mapData[this.currentSelectedKey].selected=!1),o.selected=t,this.currentSelectedKey=o[this.options.keyField])),n&&(o.selected?this.emit("select",o):this.emit("unselect",o),this.emit("selected-change",this.getSelectedNode(),this.getSelectedKey())),i&&this.emit("render-data-change"))}},{key:"setUnloadSelected",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];t?(this.currentSelectedKey&&this.setSelected(this.currentSelectedKey,!1,!1,!1),this.unloadSelectedKey=e):this.unloadSelectedKey===e&&(this.unloadSelectedKey=null),n&&this.emit("selected-change",this.getSelectedNode(),this.getSelectedKey()),i&&this.emit("render-data-change")}},{key:"clearSelected",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.currentSelectedKey&&this.mapData[this.currentSelectedKey]?this.setSelected(this.currentSelectedKey,!1,e,t):null!==this.unloadSelectedKey&&(this.unloadSelectedKey=null,e&&this.emit("selected-change",this.getSelectedNode(),this.getSelectedKey()),t&&this.emit("render-data-change"))}},{key:"setExpand",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=this.mapData[e];if(s&&(i||!s.isLeaf)&&s.expand!==t){if(!s.isLeaf){if("function"==typeof this.options.load){if(!s._loaded&&!s._loading&&t)return s._loading=!0,r&&this.emit("visible-data-change"),void new Promise((function(e,t){(0,n.options.load)(s,e,t)})).then((function(e){if(Array.isArray(e)){var i=n.findIndex(s);if(-1===i)return;s._loaded=!0,s.expand=t,s.setChildren(e);var o=n.getCheckedKeys(),r=n.flattenData(s.children,null===n.getSelectedKey);n.insertIntoFlatData(i+1,r),n.setUnloadCheckedKeys(o),null!==n.unloadSelectedKey&&n.setUnloadSelectedKey(n.unloadSelectedKey),n.emit("set-data")}})).catch((function(e){var t=e;e instanceof Error||(t=new Error(e)),console.error(t)})).then((function(){s._loading=!1,o&&n.emit("expand",s),r&&n.emit("visible-data-change")}));if(s._loading)return}s.expand=t;for(var a=s.children.concat();a.length;){var l=a.pop();l&&(l.expand&&l.children.length&&(a=l.children.concat(a)),!1===l._filterVisible?l.visible=!1:l.visible=null===l._parent||l._parent.expand&&l._parent.visible)}o&&this.emit("expand",s),r&&this.emit("visible-data-change")}i&&s._parent&&t&&this.setExpand(s._parent[this.options.keyField],t,i,!1,r)}}},{key:"setExpandKeys",value:function(e,t){var n=this,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];e.forEach((function(e){n.setExpand(e,t,!1,!1,!1)})),i&&this.emit("visible-data-change")}},{key:"setExpandAll",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.flatData.forEach((function(n){t.options.load&&!n._loaded||t.setExpand(n[t.options.keyField],e,!1,!1,!1)})),n&&this.emit("visible-data-change")}},{key:"getCheckedNodes",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.ignoreMode;if(e===h.children){var t=[];return function e(n){n.forEach((function(n){n.checked?t.push(n):!n.isLeaf&&n.indeterminate&&e(n.children)}))}(this.data),t}return this.flatData.filter((function(t){return e===h.parents?t.checked&&t.isLeaf:t.checked}))}},{key:"getCheckedKeys",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.ignoreMode;return this.getCheckedNodes(t).map((function(t){return t[e.options.keyField]})).concat(this.unloadCheckedKeys)}},{key:"getIndeterminateNodes",value:function(){return this.flatData.filter((function(e){return e.indeterminate}))}},{key:"getSelectedNode",value:function(){return null===this.currentSelectedKey?null:this.mapData[this.currentSelectedKey]||null}},{key:"getSelectedKey",value:function(){return this.currentSelectedKey||this.unloadSelectedKey||null}},{key:"getUnloadCheckedKeys",value:function(){return this.unloadCheckedKeys}},{key:"getExpandNodes",value:function(){return this.flatData.filter((function(e){return!e.isLeaf&&e.expand}))}},{key:"getExpandKeys",value:function(){var e=this;return this.getExpandNodes().map((function(t){return t[e.options.keyField]}))}},{key:"getNode",value:function(e){return this.mapData[e]||null}},{key:"insertBefore",value:function(e,t){var n=this.getInsertedNode(e,t);if(!n)return null;this.remove(n[this.options.keyField],!1);var i=this.mapData[t]._parent,o=this.findIndex(t,i&&i.children),r=this.findIndex(t),s=i?-1:this.findIndex(t,this.data);return this.insertIntoStore(n,i,o,r,s),this.emit("visible-data-change"),n}},{key:"insertAfter",value:function(e,t){var n=this.getInsertedNode(e,t);if(!n)return null;this.remove(n[this.options.keyField],!1);for(var i=this.mapData[t],o=i._parent,r=this.findIndex(t,o&&o.children)+1,s=this.flatData.length,a=this.findIndex(t),l=a+1,c=a+1;c<=s;c++){if(c===s){l=c;break}if(this.flatData[c]._level<=i._level){l=c;break}}var u=o?-1:this.findIndex(t,this.data)+1;return this.insertIntoStore(n,o,r,l,u),this.emit("visible-data-change"),n}},{key:"append",value:function(e,t){var n=this.mapData[t];if(!n.isLeaf){var i=n.children.length;return this.insertAfter(e,n.children[i-1][this.options.keyField])}var o=this.getInsertedNode(e,t,!0);if(!o)return null;this.remove(o[this.options.keyField],!1);var r=this.findIndex(t)+1;return this.insertIntoStore(o,n,0,r),this.emit("visible-data-change"),o}},{key:"prepend",value:function(e,t){var n=this.mapData[t];if(!n.isLeaf)return this.insertBefore(e,n.children[0][this.options.keyField]);var i=this.getInsertedNode(e,t,!0);if(!i)return null;this.remove(i[this.options.keyField],!1);var o=this.findIndex(t)+1;return this.insertIntoStore(i,n,0,o),this.emit("visible-data-change"),i}},{key:"remove",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.mapData[e];if(!i)return null;var o=this.findIndex(i);if(-1===o)return null;for(var r=1,s=this.flatData.length,a=o+1;a<s&&this.flatData[a]._level>i._level;a++)r++;if(this.flatData.splice(o,r),function e(n){var i=t.mapData[n];delete t.mapData[n],i.children.forEach((function(n){return e(n[t.options.keyField])}))}(e),!i._parent){var l=this.findIndex(i,this.data);l>-1&&this.data.splice(l,1)}if(i._parent){var c=this.findIndex(i,i._parent.children);-1!==c&&i._parent.children.splice(c,1),i._parent.isLeaf=!i._parent.children.length,i._parent.isLeaf&&(i._parent.expand=!1,i._parent.indeterminate=!1),this.updateMovingNodeStatus(i)}return n&&this.emit("visible-data-change"),i}},{key:"getInsertedNode",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.mapData[t];if(!i)return null;var o=n?i:i._parent;return e instanceof p?e[this.options.keyField]===t?null:e:"object"===b(e)?e[this.options.keyField]===t?null:this.mapData[e[this.options.keyField]]||new p(e,o,this.options.keyField,!!this.options.load):this.mapData[e]&&e!==t?this.mapData[e]:null}},{key:"insertIntoStore",value:function(e,t,n,i,o){if(-1!==i){-1!==n&&t&&t.children.splice(n,0,e),e._parent=t,t?(t.isLeaf=!1,this.setExpand(t[this.options.keyField],!0,!1,!1,!1)):"number"==typeof o&&o>-1&&this.data.splice(o,0,e);var r=this.flattenData([e]);e._level=t?t._level+1:0,r.forEach((function(e){return e._level=e._parent?e._parent._level+1:0})),this.insertIntoFlatData(i,r),this.updateMovingNodeStatus(e)}}},{key:"updateMovingNodeStatus",value:function(e){this.checkNodeUpward(e),this.triggerCheckedChange(),e.selected&&this.setSelected(e[this.options.keyField],!0)}},{key:"filter",value:function(e,t){var n=this,i=[];this.flatData.forEach((function(n){n._filterVisible=n._parent&&n._parent._filterVisible||t(e,n),n.visible=n._filterVisible,n._filterVisible&&i.push(n)})),i.forEach((function(e){for(var t=[],i=e._parent;i;)t.unshift(i),i=i._parent;t.forEach((function(e){e._filterVisible=!0,e.visible=(null===e._parent||e._parent.expand&&e._parent.visible)&&e._filterVisible,n.options.expandOnFilter&&n.setExpand(e[n.options.keyField],!0,!1,!1,!1)})),e.visible=null===e._parent||e._parent.expand&&e._parent.visible})),this.emit("visible-data-change")}},{key:"setUnloadCheckedKeys",value:function(e){this.unloadCheckedKeys=e;for(var t=e.concat(),n=this.unloadCheckedKeys.length-1;n>=0;n--){var i=this.unloadCheckedKeys[n];this.mapData[i]&&(this.setChecked(i,!0,!1,!1),this.unloadCheckedKeys.splice(n,1))}var o=this.getCheckedKeys();o.length===t.length&&o.every((function(e){return t.some((function(t){return t===e}))}))||this.emit("checked-change",this.getCheckedNodes(),o)}},{key:"setUnloadSelectedKey",value:function(e){var t=this.getSelectedKey();this.mapData[e]?(this.setSelected(e,!0,!1),this.unloadSelectedKey=null):(this.currentSelectedKey&&this.setSelected(this.currentSelectedKey,!1,!1),this.unloadSelectedKey=e);var n=this.getSelectedKey();n!==t&&this.emit("selected-change",this.getSelectedNode(),n)}},{key:"flattenData",value:function(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=e.length,o=0;o<i;o++){var r=e[o],s=r[this.options.keyField];if(n.push(r),this.mapData[s])throw new Error("[CTree] Duplicate tree node key.");this.mapData[s]=r,r.checked&&this.options.cascade&&(this.checkNodeDownward(r,!0),this.checkNodeUpward(r)),r.selected&&t&&(this.clearSelected(!1,!1),this.currentSelectedKey=r[this.options.keyField],this.emit("selected-change",r,this.currentSelectedKey)),!this.options.defaultExpandAll&&!r.expand||this.options.load||r.isLeaf||(r.expand=!1,this.setExpand(r[this.options.keyField],!0,!1,!1,!1)),r.children.length&&this.flattenData(r.children,t,n)}return n}},{key:"checkNodeDownward",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e.children.forEach((function(e){n.checkNodeDownward(e,t,i)})),e.isLeaf||this.options.load&&!e.children.length){if(!e.disabled){if(i&&!this.options.filteredNodeCheckable&&!e._filterVisible)return;e.checked=t,e.indeterminate=!1}}else this.checkParentNode(e)}},{key:"checkNodeUpward",value:function(e){for(var t=e._parent;t;)this.checkParentNode(t),t=t._parent}},{key:"checkParentNode",value:function(e){var t=e.children.length;if(t){for(var n=!1,i=!1,o=!1,r=0;r<t;r++){var s=e.children[r];if(s.checked?n=!0:i=!0,n&&i||s.indeterminate){o=!0,e.checked=!1,e.indeterminate=!0;break}}o||(e.checked=n,e.indeterminate=!1)}}},{key:"findIndex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.flatData;if(null!==t)for(var n=e instanceof p?e[this.options.keyField]:e,i=t.length,o=0;o<i;o++)if(t[0]instanceof p){if(n===t[o][this.options.keyField])return o}else if(n===t[o])return o;return-1}},{key:"on",value:function(e,t){var n=this;this.listenersMap[e]||(this.listenersMap[e]=[]),(Array.isArray(t)?t:[t]).forEach((function(t){-1===n.listenersMap[e].indexOf(t)&&n.listenersMap[e].push(t)}))}},{key:"off",value:function(e,t){if(this.listenersMap[e])if(t){var n=this.listenersMap[e].indexOf(t);n>-1&&this.listenersMap[e].splice(n,1)}else this.listenersMap[e]=[]}},{key:"emit",value:function(e){if(this.listenersMap[e]){for(var t=this.listenersMap[e].length,n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];for(var r=0;r<t;r++){var s;(s=this.listenersMap[e])[r].apply(s,i)}}}}]),e}(),w=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:e.indentWrapperCls},[e.showLine?[e._l(e.data._level,(function(t,i){return[n("svg",{style:{alignSelf:"stretch",width:e.nodeIndent+"px"},attrs:{viewBox:"0 0 100 100",preserveAspectRatio:"none"}},[n("polyline",{attrs:{fill:"none",points:e.polylinePoints(i===e.data._level-1),"stroke-width":e.strokeWidth,stroke:e.showLineParams.color,"stroke-dasharray":e.strokeDasharray}})])]}))]:e._e(),n("div",{class:e.wrapperCls,style:{paddingLeft:e.showLine?"none":e.usePadding?e.data._level*e.nodeIndent+"px":null,marginLeft:e.showLine?"none":e.usePadding?null:e.data._level*e.nodeIndent+"px"}},[n("div",{class:e.dropBeforeCls}),n("div",e._g({ref:"nodeBody",class:e.nodeBodyCls},e.dropListeners),[n("div",{class:e.squareCls},[n("i",{directives:[{name:"show",rawName:"v-show",value:!e.data.isLeaf&&!e.data._loading,expression:"!data.isLeaf && !data._loading"}],class:e.expandCls,on:{click:e.handleExpand}}),e.data._loading?n("LoadingIcon",{class:e.loadingIconCls}):e._e()],1),e.showCheckbox?n("div",{class:e.squareCls},[n("div",{class:e.checkboxCls,on:{click:e.handleCheck}})]):e._e(),n("div",e._g({class:e.titleCls,attrs:{draggable:e.draggable&&!e.disableAll&&!e.data.disabled},on:{click:e.handleSelect,dblclick:e.handleDblclick,contextmenu:e.handleRightClick}},e.dragListeners),[e._t("default",[e.renderFunction?n(e.renderComponent,{tag:"component"}):[e._v(e._s(e.data[e.titleField]))]],{node:e.fullData})],2)]),n("div",{class:e.dropAfterCls})])],2)},E=[],P=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("svg",{attrs:{viewBox:"0 0 50 50"}},[n("circle",{staticClass:"ctree-loading-icon__circle",attrs:{cx:"25",cy:"25",r:"20",fill:"none","stroke-width":"5","stroke-miterlimit":"10"}})])},A=[];function D(e,t,n,i,o,r,s,a){var l,c="function"==typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=n,c._compiled=!0),i&&(c.functional=!0),r&&(c._scopeId="data-v-"+r),s?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),o&&o.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(s)},c._ssrRegister=l):o&&(l=a?function(){o.call(this,this.$root.$options.shadowRoot)}:o),l)if(c.functional){c._injectStyles=l;var u=c.render;c.render=function(e,t){return l.call(t),u(e,t)}}else{var h=c.beforeCreate;c.beforeCreate=h?[].concat(h,l):[l]}return{exports:e,options:c}}var M=D(a.a.extend({name:"CLoadingIcon"}),P,A,!1,null,null,null).exports;function T(e){return(T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var O="ctree-tree-node",I=D(a.a.extend({name:"CTreeNode",inheritAttrs:!1,components:{LoadingIcon:M},props:{data:Object,titleField:String,keyField:String,render:Function,checkable:Boolean,selectable:Boolean,unselectOnClick:Boolean,disableAll:Boolean,draggable:Boolean,droppable:Boolean,usePadding:Boolean,nodeIndent:{type:Number,default:20},showLine:{type:[Boolean,Object]},noSiblingNodeMap:Object},data:function(){return{dragoverBody:!1,dragoverBefore:!1,dragoverAfter:!1}},computed:{indentWrapperCls:function(){return["".concat(O,"__indent-wrapper")]},wrapperCls:function(){return["".concat(O,"__wrapper"),j({},"".concat(O,"__wrapper_is-leaf"),this.data.isLeaf)]},nodeBodyCls:function(){return["".concat(O,"__node-body"),j({},"".concat(O,"__drop_active"),this.dragoverBody)]},dropBeforeCls:function(){return["".concat(O,"__drop"),j({},"".concat(O,"__drop_active"),this.dragoverBefore)]},dropAfterCls:function(){return["".concat(O,"__drop"),j({},"".concat(O,"__drop_active"),this.dragoverAfter)]},squareCls:function(){return["".concat(O,"__square")]},expandCls:function(){return["".concat(O,"__expand"),j({},"".concat(O,"__expand_active"),this.data.expand)]},loadingIconCls:function(){return["".concat(O,"__loading-icon")]},checkboxCls:function(){var e;return["".concat(O,"__checkbox"),(e={},j(e,"".concat(O,"__checkbox_checked"),this.data.checked),j(e,"".concat(O,"__checkbox_indeterminate"),this.data.indeterminate),j(e,"".concat(O,"__checkbox_disabled"),this.disableAll||this.data.disabled),e)]},titleCls:function(){var e;return["".concat(O,"__title"),(e={},j(e,"".concat(O,"__title_selected"),this.data.selected),j(e,"".concat(O,"__title_disabled"),this.disableAll||this.data.disabled),e)]},fullData:function(){return this.$parent.getNode(this.data[this.keyField])||{}},showCheckbox:function(){return this.checkable},renderFunction:function(){return this.data.render||this.render||null},renderComponent:function(){var e=this;return a.a.extend({name:"Render",functional:!0,render:function(t){return"function"!=typeof e.renderFunction?t("div"):e.renderFunction(t,e.fullData)}})},dragListeners:function(){var e={};return!this.draggable||this.disableAll||this.data.disabled||(e={dragstart:this.handleDragStart}),e},dropListeners:function(){var e={};return this.droppable&&(e={dragenter:this.handleDragEnter.bind(this),dragover:this.handleDragOver.bind(this),dragleave:this.handleDragLeave.bind(this),drop:this.handleDrop.bind(this)}),e},showLineParams:function(){var e={width:1,type:g.solid,color:"#D3D3D3",polyline:!1},t=e;return"object"===T(this.showLine)&&(t={width:null!=this.showLine.width?this.showLine.width:e.width,type:this.showLine.type||e.type,color:this.showLine.color||e.color,polyline:null!=this.showLine.polyline?this.showLine.polyline:e.polyline}),t},strokeWidth:function(){return 100*this.showLineParams.width/this.nodeIndent},strokeDasharray:function(){switch(this.showLineParams.type){case g.dashed:return"25"}return"none"}},methods:{polylinePoints:function(e){if(!this.showLineParams.polyline||!e)return"50,0 50,100";var t=this.fullData&&this.fullData._parent;return t&&this.noSiblingNodeMap[t[this.keyField]]&&this.noSiblingNodeMap[this.data[this.keyField]]?"50,0 50,50 100,50 50,50":"50,0 50,50 100,50 50,50 50,100"},handleExpand:function(){this.data.isLeaf||this.$emit("expand",this.fullData)},handleCheck:function(){this.disableAll||this.data.disabled||!this.checkable||this.$emit("check",this.fullData)},handleSelect:function(){if(this.$emit("click",this.fullData),this.selectable){if(this.disableAll||this.data.disabled)return;if(this.data.selected&&!this.unselectOnClick)return;this.$emit("select",this.fullData)}else this.checkable?this.handleCheck():this.handleExpand()},handleDblclick:function(){this.$emit("node-dblclick",this.fullData)},handleRightClick:function(){this.$emit("node-right-click",this.fullData)},getHoverPart:function(e){var t=this.$refs.nodeBody.getBoundingClientRect(),n=t.height,i=e.clientY-t.top;return i<=.3*n?y.before:i<=.7*n?y.body:y.after},resetDragoverFlags:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.dragoverBefore=!1,this.dragoverBody=!1,this.dragoverAfter=!1,t||(e===y.before?this.dragoverBefore=!0:e===y.body?this.dragoverBody=!0:e===y.after&&(this.dragoverAfter=!0))},handleDragStart:function(e){e.dataTransfer&&e.dataTransfer.setData("node",JSON.stringify(this.data)),this.data.expand&&this.handleExpand(),this.$emit("node-dragstart",this.fullData,e)},handleDragEnter:function(e){e.preventDefault();var t=this.getHoverPart(e);this.resetDragoverFlags(t),this.$emit("node-dragenter",this.fullData,e,t)},handleDragOver:function(e){e.preventDefault();var t=this.getHoverPart(e);this.resetDragoverFlags(t),this.$emit("node-dragover",this.fullData,e,t)},handleDragLeave:function(e){var t=this.getHoverPart(e);this.resetDragoverFlags(t,!0),this.$emit("node-dragleave",this.fullData,e,t)},handleDrop:function(e){var t=this.getHoverPart(e);this.resetDragoverFlags(t,!0),this.$emit("node-drop",this.fullData,e,t)}}}),w,E,!1,null,null,null).exports;function L(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var N="ctree-tree",F=["expand","select","unselect","selected-change","check","uncheck","checked-change","set-data"],G=["node-drop"],R=function(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length===t.length&&e.every((function(e){return t.some((function(t){return t===e}))})))return!0}else if(e===t)return!0;return!1},B=D(a.a.extend({name:"CTree",components:{CTreeNode:I,LoadingIcon:M},props:{value:[String,Number,Array],data:{type:Array,default:function(){return[]}},unloadDataList:{type:Array,default:function(){return[]}},showUnloadCheckedNodes:{type:Boolean,default:!0},emptyText:{type:String,default:"暂无数据"},titleField:{type:String,default:"title"},keyField:{type:String,default:"id"},separator:{type:String,default:","},checkable:{type:Boolean,default:!1},selectable:{type:Boolean,default:!1},filteredNodeCheckable:{type:Boolean,default:!1},cascade:{type:Boolean,default:!0},enableLeafOnly:{type:Boolean,default:!1},disableAll:{type:Boolean,default:!1},defaultExpandAll:{type:Boolean,default:!1},defaultExpandedKeys:{type:Array,default:function(){return[]}},expandedKeys:{type:Array,default:function(){return[]}},draggable:{type:Boolean,default:!1},droppable:{type:Boolean,default:!1},beforeDropMethod:{type:Function,default:function(){return function(){return!0}}},ignoreMode:{type:String,default:h.none},autoLoad:{type:Boolean,default:!0},load:Function,render:Function,filterMethod:Function,expandOnFilter:{type:Boolean,default:!0},unselectOnClick:{type:Boolean,default:!0},loading:{type:Boolean,default:!1},nodeMinHeight:{type:Number,default:30},nodeIndent:{type:Number,default:20},renderNodeAmount:{type:Number,default:100},bufferNodeAmount:{type:Number,default:20},nodeClassName:{type:[String,Object,Array,Function]},usePadding:{type:Boolean,default:!1},showLine:{type:[Boolean,Object]},animation:{type:Boolean}},data:function(){return{unloadCheckedNodes:[],blockLength:0,blockAreaHeight:0,topSpaceHeight:0,bottomSpaceHeight:0,renderAmount:0,renderAmountCache:0,renderNodes:[],renderStart:0,renderStartCache:0,isRootLoading:!1,valueCache:Array.isArray(this.value)?this.value.concat():this.value,debounceTimer:void 0,expandAnimation:{start:!1,index:-1,level:-1,nextState:!1,ready:!1,currentExpandState:!1,expandRenderStart:0,topNodes:[],middleNodes:[],bottomNodes:[]}}},computed:{topSpaceStyles:function(){return{height:"".concat(this.topSpaceHeight,"px")}},bottomSpaceStyles:function(){return{height:"".concat(this.bottomSpaceHeight,"px")}},wrapperCls:function(){return["".concat(N,"__wrapper")]},scrollAreaCls:function(){return["".concat(N,"__scroll-area")]},blockAreaCls:function(){return["".concat(N,"__block-area")]},emptyCls:function(){return["".concat(N,"__empty")]},emptyTextDefaultCls:function(){return["".concat(N,"__empty-text_default")]},loadingCls:function(){return["".concat(N,"__loading")]},loadingWrapperCls:function(){return["".concat(N,"__loading-wrapper")]},loadingIconCls:function(){return["".concat(N,"__loading-icon")]},iframeCls:function(){return["".concat(N,"__iframe")]},treeNodeListeners:function(){var e={};for(var t in this.$listeners)-1===F.indexOf(t)&&-1===G.indexOf(t)&&(e[t]=this.$listeners[t]);return e},noSiblingNodeMap:function(){for(var e=this,t=[],n=this.renderNodes[0]&&this.renderNodes[0]._parent;n;)t.push(n),n=n._parent;var i=t.concat(this.renderNodes),o={},r=[];return i.forEach((function(t){for(var n=t._level,i=r.length;i;){var s=r[i-1],a=s._level;if(!(a>n)){if(a===n){r.pop();break}break}o[s[e.keyField]]=!0,r.pop(),i--}r.push(t)})),r.forEach((function(t){o[t[e.keyField]]=!0})),o}},methods:{setData:function(e){this.resetSpaceHeights();var t=null,n=null;this.checkable?Array.isArray(this.value)?t=this.value.concat():"string"==typeof this.value&&(t=""===this.value?[]:this.value.split(this.separator)):this.selectable&&!Array.isArray(this.value)&&(n=this.value),this.nonReactive.store.setData(e,n,t),this.updateExpandedKeys()},setChecked:function(e,t){this.nonReactive.store.setChecked(e,t)},setCheckedKeys:function(e,t){this.nonReactive.store.setCheckedKeys(e,t)},checkAll:function(){this.nonReactive.store.checkAll()},clearChecked:function(){this.nonReactive.store.clearChecked()},setSelected:function(e,t){this.nonReactive.store.setSelected(e,t)},clearSelected:function(){this.nonReactive.store.clearSelected()},setExpand:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.nonReactive.store.setExpand(e,t,n)},setExpandKeys:function(e,t){this.nonReactive.store.setExpandKeys(e,t)},setExpandAll:function(e){this.nonReactive.store.setExpandAll(e)},getCheckedNodes:function(e){return e=e||this.ignoreMode,this.nonReactive.store.getCheckedNodes(e)},getCheckedKeys:function(e){return e=e||this.ignoreMode,this.nonReactive.store.getCheckedKeys(e)},getIndeterminateNodes:function(){return this.nonReactive.store.getIndeterminateNodes()},getSelectedNode:function(){return this.nonReactive.store.getSelectedNode()},getSelectedKey:function(){return this.nonReactive.store.getSelectedKey()},getExpandNodes:function(){return this.nonReactive.store.getExpandNodes()},getExpandKeys:function(){return this.nonReactive.store.getExpandKeys()},getCurrentVisibleNodes:function(){return this.nonReactive.store.flatData.filter((function(e){return e._filterVisible}))},getNode:function(e){return this.nonReactive.store.getNode(e)},getTreeData:function(){return this.nonReactive.store.data},getFlatData:function(){return this.nonReactive.store.flatData},getNodesCount:function(){return this.nonReactive.store.flatData.length},insertBefore:function(e,t){return this.nonReactive.store.insertBefore(e,t)},insertAfter:function(e,t){return this.nonReactive.store.insertAfter(e,t)},append:function(e,t){return this.nonReactive.store.append(e,t)},prepend:function(e,t){return this.nonReactive.store.prepend(e,t)},remove:function(e){return this.nonReactive.store.remove(e)},filter:function(e,t){var n=this,i=function(e,t){var i=t[n.titleField];return!(null==i||!i.toString)&&i.toString().toLowerCase().indexOf(e.toLowerCase())>-1};t=t||this.filterMethod||i,this.nonReactive.store.filter(e,t)},showCheckedNodes:function(e){var t=this;if(this.checkable){e=null==e?this.showUnloadCheckedNodes:e;var n=this.nonReactive.store.getCheckedNodes();if(this.nonReactive.store.filter("",(function(e,t){return t.checked})),e){var i=this.nonReactive.store.getUnloadCheckedKeys();if(i.length){var o=i.map((function(e){var i,o=t.unloadDataList.concat(n),r=e;return o.some((function(n){return n[t.keyField]===e&&null!=n[t.titleField]&&(r=n[t.titleField],!0)})),new p((L(i={},t.keyField,e),L(i,t.titleField,r),L(i,"checked",!0),L(i,"isLeaf",!0),i),null,t.keyField,!!t.load)}));this.unloadCheckedNodes=o,this.nonReactive.blockNodes=this.nonReactive.blockNodes.concat(o),this.updateBlockData(),this.updateRender()}}}},loadRootNodes:function(){var e=this;return this.isRootLoading=!0,new Promise((function(t,n){e.load(null,t,n)})).then((function(t){Array.isArray(t)&&e.setData(t)})).catch((function(){})).then((function(){e.isRootLoading=!1}))},scrollTo:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v.top,n=this.nonReactive.store.mapData[e];if(n&&n.visible){for(var i=-1,o=0;o<this.blockLength;o++)if(this.nonReactive.blockNodes[o][this.keyField]===e){i=o;break}if(-1!==i){var r=i*this.nodeMinHeight;t===v.center?r-=(this.$refs.scrollArea.clientHeight-this.nodeMinHeight)/2:t===v.bottom?r-=this.$refs.scrollArea.clientHeight-this.nodeMinHeight:"number"==typeof t&&(r-=t),this.$refs.scrollArea.scrollTop=r}}},updateExpandedKeys:function(){this.expandedKeys.length&&(this.nonReactive.store.setExpandAll(!1,!1),this.nonReactive.store.setExpandKeys(this.expandedKeys,!0))},updateUnloadStatus:function(){var e=this;if(this.unloadCheckedNodes.length){var t=this.nonReactive.store.getUnloadCheckedKeys();this.unloadCheckedNodes.forEach((function(n){n.checked=t.indexOf(n[e.keyField])>-1}))}},handleNodeCheck:function(e){(this.cascade||!this.enableLeafOnly||e.isLeaf)&&this.nonReactive.store.setChecked(e[this.keyField],!e.indeterminate&&!e.checked,!0,!0,!0)},handleNodeSelect:function(e){this.enableLeafOnly&&!e.isLeaf||this.nonReactive.store.setSelected(e[this.keyField],!e.selected)},handleNodeExpand:function(e){this.updateBeforeExpand(e),this.nonReactive.store.setExpand(e[this.keyField],!e.expand)},handleNodeDrop:function(e,t,n){if(this.droppable&&t.dataTransfer)try{var i=JSON.parse(t.dataTransfer.getData("node"))[this.keyField],o=e[this.keyField];if(this.beforeDropMethod(i,o,n)){if(i===o)return;n===y.before?this.nonReactive.store.insertBefore(i,o):n===y.body||!e.isLeaf&&e.expand?this.nonReactive.store.prepend(i,o):n===y.after&&this.nonReactive.store.insertAfter(i,o),this.$emit("node-drop",e,t,n,this.getNode(i))}}catch(e){throw new Error(e)}},emitCheckableInput:function(e,t){if(this.checkable){var n=t;Array.isArray(this.value)||(n=n.join(this.separator)),Array.isArray(n)?this.valueCache=n.concat():this.valueCache=n,this.$emit("input",n)}},emitSelectableInput:function(e,t){if(this.selectable&&!this.checkable){var n=t||"";this.valueCache=n,this.$emit("input",n)}},attachStoreEvents:function(){for(var e in this.$listeners)if(F.indexOf(e)>-1){var t=e;this.nonReactive.store.on(t,this.$listeners[e])}},resetSpaceHeights:function(){this.topSpaceHeight=0,this.bottomSpaceHeight=0,this.$refs.scrollArea.scrollTop=0},updateBlockNodes:function(){this.nonReactive.blockNodes=this.nonReactive.store.flatData.filter((function(e){return e.visible})),this.updateBlockData(),this.updateRender()},updateBlockData:function(){this.blockLength=this.nonReactive.blockNodes.length,this.blockAreaHeight=this.nodeMinHeight*this.blockLength},updateRender:function(){this.updateRenderAmount(),this.updateRenderNodes()},updateRenderAmount:function(){var e=this.$refs.scrollArea.clientHeight;this.renderAmount=Math.max(this.renderNodeAmount,Math.ceil(e/this.nodeMinHeight)+this.bufferNodeAmount)},updateRenderNodes:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.blockLength>this.renderAmount){var t=this.$refs.scrollArea.scrollTop,n=Math.floor(t/this.nodeMinHeight);this.renderStart=Math.floor(n/this.bufferNodeAmount)*this.bufferNodeAmount}else this.renderStart=0;e&&this.renderAmountCache===this.renderAmount&&this.renderStartCache===this.renderStart||(this.renderNodes=this.nonReactive.blockNodes.slice(this.renderStart,this.renderStart+this.renderAmount).map((function(e){return Object.assign({},e,{_parent:null,children:[]})})),this.topSpaceHeight=this.renderStart*this.nodeMinHeight,this.bottomSpaceHeight=this.blockAreaHeight-(this.topSpaceHeight+this.renderNodes.length*this.nodeMinHeight))},handleTreeScroll:function(){this.debounceTimer&&window.cancelAnimationFrame(this.debounceTimer),this.renderAmountCache=this.renderAmount,this.renderStartCache=this.renderStart,this.debounceTimer=window.requestAnimationFrame(this.updateRenderNodes.bind(this,!0))},resetExpandAnimation:function(){this.expandAnimation.start=!1,this.expandAnimation.ready=!1,this.expandAnimation.index=-1,this.expandAnimation.level=-1,this.expandAnimation.expandRenderStart=0,this.expandAnimation.topNodes=[],this.expandAnimation.middleNodes=[],this.expandAnimation.bottomNodes=[]},updateMiddleNodes:function(){for(var e=this.expandAnimation.level,t=[],n=this.renderNodes.length,i=this.renderStart-this.expandAnimation.expandRenderStart,o=this.expandAnimation.index-i+1;o<n&&this.renderNodes[o]._level>e;o++)t.push(this.renderNodes[o]);this.expandAnimation.middleNodes=t},updateBeforeExpand:function(e){var t=this;if(this.animation){this.resetExpandAnimation();var n=e[this.keyField],i=this.renderNodes.findIndex((function(e){return e[t.keyField]===n}));i>-1&&(this.expandAnimation.index=i,this.expandAnimation.level=e._level,this.expandAnimation.start=!0,this.expandAnimation.currentExpandState=e.expand,this.expandAnimation.nextState=!e.expand,this.expandAnimation.expandRenderStart=this.renderStart,this.expandAnimation.nextState?this.expandAnimation.bottomNodes=this.renderNodes.slice(this.expandAnimation.index+1):this.updateMiddleNodes())}},updateAfterExpand:function(){var e=this;this.animation&&(this.expandAnimation.start?-1!==this.expandAnimation.index&&this.$nextTick((function(){var t=e.renderStart-e.expandAnimation.expandRenderStart;e.expandAnimation.topNodes=e.renderNodes.slice(0,e.expandAnimation.index-t+1),e.expandAnimation.nextState?e.updateMiddleNodes():e.expandAnimation.bottomNodes=e.renderNodes.slice(e.expandAnimation.index-t+1),e.expandAnimation.ready=!0,e.$nextTick((function(){e.expandAnimation.currentExpandState=!e.expandAnimation.currentExpandState}))})):this.expandAnimation.start=!1)},onExpandAnimationFinish:function(){this.resetExpandAnimation()},initializeNonReactiveData:function(){var e=this.keyField,t=this.ignoreMode,n=this.filteredNodeCheckable,i=this.cascade,o=this.defaultExpandAll,r=this.load,s=this.expandOnFilter;this.nonReactive={store:new S({keyField:e,ignoreMode:t,filteredNodeCheckable:n,cascade:i,defaultExpandAll:o,load:r,expandOnFilter:s}),blockNodes:[]}}},created:function(){var e=this;this.initializeNonReactiveData(),this.nonReactive.store.on("expand",this.updateAfterExpand),this.nonReactive.store.on("visible-data-change",this.updateBlockNodes),this.nonReactive.store.on("render-data-change",this.updateRender),this.nonReactive.store.on("checked-change",(function(t,n){e.emitCheckableInput(t,n),e.updateUnloadStatus()})),this.nonReactive.store.on("selected-change",this.emitSelectableInput),this.attachStoreEvents()},mounted:function(){this.data.length?(this.setData(this.data),this.defaultExpandedKeys.length&&this.nonReactive.store.setExpandKeys(this.defaultExpandedKeys,!0)):"function"==typeof this.load&&this.autoLoad&&this.loadRootNodes();var e=this.$refs.iframe;e.contentWindow&&e.contentWindow.addEventListener("resize",this.updateRender)},beforeDestroy:function(){var e=this.$refs.iframe;e.contentWindow&&e.contentWindow.removeEventListener("resize",this.updateRender),this.initializeNonReactiveData()},watch:{value:function(e){if(this.checkable){if(R(e,this.valueCache))return;var t=[];Array.isArray(e)?t=e.concat():"string"==typeof e&&(t=""===e?[]:e.split(this.separator)),this.nonReactive.store.clearChecked(!1,!1),this.nonReactive.store.setCheckedKeys(t,!0)}else if(this.selectable){if(e===this.valueCache)return;var n=this.nonReactive.store.getSelectedKey();""!==e&&null!=e?this.nonReactive.store.setSelected(e,!0):""!==e&&null!=e||!n||this.nonReactive.store.setSelected(n,!1)}},data:{deep:!0,handler:function(e){this.setData(e)}},expandedKeys:function(){this.updateExpandedKeys()},$listeners:function(){this.attachStoreEvents()}}}),o,r,!1,null,null,null).exports,H=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:e.wrapperCls},[n("div",{class:e.searchCls},[e.showCheckAll&&e.checkable?n("div",{class:e.checkAllWrapperCls},[n("div",{class:e.checkboxCls,on:{click:e.handleCheckAll}})]):e._e(),n("div",{class:e.inputWrapperCls},[e._t("search-input",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.keyword,expression:"keyword"}],class:e.inputCls,attrs:{type:"text",placeholder:e.searchPlaceholder,disabled:e.searchDisabled},domProps:{value:e.keyword},on:{input:[function(t){t.target.composing||(e.keyword=t.target.value)},e.handleSearch]}})])],2),n("div",{class:e.actionWrapperCls},[e.showCheckedButton&&e.checkable?n("span",{class:e.checkedButtonCls,on:{click:e.handleShowChecked}},[e._v("\n        "+e._s(e.checkedButtonText)+"\n      ")]):e._e(),e._t("actions")],2)]),n("div",{class:e.treeWrapperCls},[n("CTree",e._g(e._b({ref:"tree",attrs:{value:e.value},on:{input:e.updateCheckedCount,"set-data":e.handleSetData,"checked-change":e.updateCheckAllStatus},scopedSlots:e._u([e._l(e.$scopedSlots,(function(t,n){return{key:n,fn:function(t){return[e._t(n,null,null,t)]}}}))],null,!0)},"CTree",e.$attrs,!1),e.$listeners))],1),e.showFooter&&e.checkable?n("div",{class:e.footerCls},[e._t("footer",[n("span",{staticStyle:{float:"right"}},[e._v("已选 "+e._s(e.checkedCount)+" 个")])])],2):e._e()])},U=[];function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(n,!0).forEach((function(t){K(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function K(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var V="ctree-tree-search",z="ctree-tree-node",W={},$=B.options.methods,q=function(e){var t=e;m.indexOf(t)>-1&&(W[t]=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return $[t].apply(this.$refs.tree,n)})};for(var Z in $)q(Z);var J=D(a.a.extend({name:"CTreeSearch",inheritAttrs:!1,components:{CTree:B},props:{value:{},searchPlaceholder:{type:String,default:"搜索关键字"},showCheckAll:{type:Boolean,default:!0},showCheckedButton:{type:Boolean,default:!0},checkedButtonText:{type:String,default:"已选"},showFooter:{type:Boolean,default:!0},searchMethod:Function,searchLength:{type:Number,default:1},searchDisabled:{type:Boolean,default:!1},searchRemote:{type:Boolean,default:!1},searchDebounceTime:{type:Number,default:300}},data:function(){return{checkAllStatus:{checked:!1,indeterminate:!1,disabled:!1},isShowingChecked:!1,keyword:"",debounceTimer:void 0,checkedCount:0}},computed:{wrapperCls:function(){return["".concat(V,"__wrapper")]},searchCls:function(){return["".concat(V,"__search")]},checkAllWrapperCls:function(){return["".concat(V,"__check-all-wrapper")]},checkboxCls:function(){var e;return["".concat(V,"__check-all"),"".concat(z,"__checkbox"),(e={},K(e,"".concat(z,"__checkbox_checked"),this.checkAllStatus.checked),K(e,"".concat(z,"__checkbox_indeterminate"),this.checkAllStatus.indeterminate),K(e,"".concat(z,"__checkbox_disabled"),this.searchDisabled||this.checkAllStatus.disabled),e)]},inputWrapperCls:function(){return["".concat(V,"__input-wrapper")]},inputCls:function(){return["".concat(V,"__input"),K({},"".concat(V,"__input_disabled"),this.searchDisabled)]},actionWrapperCls:function(){return["".concat(V,"__action-wrapper")]},checkedButtonCls:function(){return["".concat(V,"__checked-button"),K({},"".concat(V,"__checked-button_active"),this.isShowingChecked)]},treeWrapperCls:function(){return["".concat(V,"__tree-wrapper")]},footerCls:function(){return["".concat(V,"__footer")]},checkable:function(){return"checkable"in this.$attrs&&!1!==this.$attrs.checkable}},methods:Y({},W,{clearKeyword:function(){this.keyword=""},getKeyword:function(){return this.keyword},search:function(e){var t=this,n=e;return"string"!=typeof e&&(n=this.keyword),new Promise((function(e,i){clearTimeout(t.debounceTimer),t.debounceTimer=setTimeout((function(){if(!(n.length>0&&n.length<t.searchLength))if(t.isShowingChecked=!1,t.$emit("search",n),"function"==typeof t.searchMethod){var i=t.searchMethod(n);Promise.resolve(i).then((function(){t.updateCheckAllStatus(),e()}))}else t.searchRemote?t.$refs.tree.loadRootNodes().then((function(){t.updateCheckAllStatus(),e()})):(t.$refs.tree.filter(n),t.updateCheckAllStatus(),e())}),t.searchDebounceTime)}))},handleCheckAll:function(){var e=this;if(!this.searchDisabled&&!this.checkAllStatus.disabled){var t=this.$refs.tree.getCurrentVisibleNodes().map((function(t){return t[e.$refs.tree.keyField]}));this.checkAllStatus.checked||this.checkAllStatus.indeterminate?this.$refs.tree.setCheckedKeys(t,!1):this.$refs.tree.setCheckedKeys(t,!0),this.updateCheckAllStatus()}},handleSearch:function(){this.search()},handleShowChecked:function(){var e=this,t=function(){e.isShowingChecked=!e.isShowingChecked,e.isShowingChecked?e.$refs.tree.showCheckedNodes():e.$refs.tree.filter(e.keyword,(function(){return!0})),e.updateCheckAllStatus()};this.keyword?(this.clearKeyword(),this.search().then((function(){t()}))):t()},handleSetData:function(){this.updateCheckedCount(),this.updateCheckAllStatus()},updateCheckAllStatus:function(){for(var e=this.$refs.tree.getCurrentVisibleNodes(),t=e.length,n=!1,i=!1,o=!1,r=0;r<t;r++){var s=e[r];if(s.checked?n=!0:i=!0,n&&i||s.indeterminate){o=!0,this.checkAllStatus.checked=!1,this.checkAllStatus.indeterminate=!0;break}}o||(this.checkAllStatus.checked=n,this.checkAllStatus.indeterminate=!1)},updateCheckedCount:function(){this.checkedCount=this.$refs.tree.getCheckedKeys().length}}),mounted:function(){this.checkable&&!this.checkedCount&&this.handleSetData()}}),H,U,!1,null,null,null).exports,Q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:e.wrapperCls},[n("div",{ref:"reference",class:e.referenceCls,on:{click:e.handleRefClick}},[e._t("default",[n("div",{class:e.displayInputCls},[n("span",{class:e.displayInputTextCls},[e._t("display",[e._v("\n            "+e._s(e.displayValue)+"\n          ")],null,e.slotProps)],2),e.dropDisabled?e._e():[n("i",{class:e.dropIconCls}),e.clearable&&e.showClearIcon?e._t("clear",[n("i",{class:e.clearIconCls,on:{click:function(t){return t.stopPropagation(),e.handleClear(t)}}})]):e._e()]],2)],null,e.slotProps)],2),n("transition",{attrs:{name:"ctree-dropdown"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.dropdownVisible,expression:"dropdownVisible"}],ref:"dropdown",class:e.dropdownCls,style:{height:e.dropHeight+"px"}},[n("CTreeSearch",e._g(e._b({ref:"treeSearch",attrs:{value:e.value},on:{"set-data":e.handleSetData,"checked-change":e.handleCheckedChange,"selected-change":e.handleSelectedChange},scopedSlots:e._u([e._l(e.$scopedSlots,(function(t,n){return{key:n,fn:function(t){return[e._t(n,null,null,t)]}}}))],null,!0)},"CTreeSearch",e.$attrs,!1),e.$listeners))],1)])],1)},ee=[];function te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?te(n,!0).forEach((function(t){ae(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):te(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ie(e){return se(e)||re(e)||oe()}function oe(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function re(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function se(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function ae(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var le="ctree-tree-drop",ce="ctree-tree-search",ue={},he=m.concat(_),de=J.options.methods,pe=function(e){var t=e;he.indexOf(t)>-1&&(ue[t]=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return de[t].apply(this.$refs.treeSearch,n)})};for(var fe in de)pe(fe);var ve=D(a.a.extend({name:"CTreeDrop",inheritAttrs:!1,components:{CTreeSearch:J},props:{value:{},dropHeight:{type:Number,default:300},dropPlaceholder:{type:String},dropDisabled:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},placement:{type:String,default:f["bottom-start"]},transfer:{type:Boolean,default:!1},dropdownClassName:{type:[String,Array]},dropdownMinWidth:{type:Number},dropdownWidthFixed:{type:Boolean,default:!1}},data:function(){return{dropdownVisible:!1,checkedCount:0,selectedTitle:"",slotProps:{checkedNodes:[],checkedKeys:[],selectedNode:null,selectedKey:null}}},computed:{wrapperCls:function(){return["".concat(le,"__wrapper")]},referenceCls:function(){return["".concat(le,"__reference")]},displayInputCls:function(){var e;return["".concat(ce,"__input"),"".concat(le,"__display-input"),(e={},ae(e,"".concat(le,"__display-input_focus"),this.dropdownVisible),ae(e,"".concat(ce,"__input_disabled"),this.dropDisabled),e)]},displayInputTextCls:function(){var e=!1;return"string"==typeof this.dropPlaceholder&&(this.checkable?e=0===this.checkedCount:this.selectable&&(e=""===this.selectedTitle)),["".concat(le,"__display-input-text"),ae({},"".concat(le,"__display-input-placeholder"),e)]},dropIconCls:function(){return["".concat(le,"__display-icon-drop"),ae({},"".concat(le,"__display-icon-drop_active"),this.dropdownVisible)]},clearIconCls:function(){return["".concat(le,"__display-icon-clear")]},dropdownCls:function(){var e=Array.isArray(this.dropdownClassName)?this.dropdownClassName:[this.dropdownClassName];return["".concat(le,"__dropdown")].concat(ie(e))},checkable:function(){return"checkable"in this.$attrs&&!1!==this.$attrs.checkable},selectable:function(){return"selectable"in this.$attrs&&!1!==this.$attrs.selectable},displayValue:function(){return this.checkable?0===this.checkedCount&&"string"==typeof this.dropPlaceholder?this.dropPlaceholder:"已选 ".concat(this.checkedCount," 个"):this.selectable?""===this.selectedTitle&&"string"==typeof this.dropPlaceholder?this.dropPlaceholder:this.selectedTitle:this.dropPlaceholder||""},showClearIcon:function(){return this.checkable?0!==this.checkedCount:!!this.selectable&&""!==this.selectedTitle}},methods:ne({},ue,{locateDropdown:function(){var e=this.$refs.reference.getBoundingClientRect(),t=e.width,n=e.height,i="".concat("number"==typeof this.dropdownMinWidth?this.dropdownMinWidth:t,"px");this.$refs.dropdown.style.minWidth=i,this.$refs.dropdown.style.width=this.dropdownWidthFixed?i:"auto";var o=this.$refs.dropdown.getBoundingClientRect(),r=window.getComputedStyle(this.$refs.dropdown),s=parseFloat(r.marginLeft)+parseFloat(r.marginRight),a=parseFloat(r.marginTop)+parseFloat(r.marginBottom),l=o.width+s,c=o.height/.8+a,u=0,h=0;switch(this.transfer&&(u=-999,h=-999),this.placement){case"bottom-start":this.transfer?(u=window.pageYOffset+e.bottom,h=window.pageXOffset+e.left):u=n;break;case"bottom-end":this.transfer?(u=window.pageYOffset+e.bottom,h=window.pageXOffset+e.right-l):(u=n,h=t-l);break;case"bottom":this.transfer?(u=window.pageYOffset+e.bottom,h=window.pageXOffset+e.left+(t-l)/2):(u=n,h=(t-l)/2);break;case"top-start":this.transfer?(u=window.pageYOffset+e.top-c,h=window.pageXOffset+e.left):u=-c;break;case"top-end":this.transfer?(u=window.pageYOffset+e.top-c,h=window.pageXOffset+e.right-l):(u=-c,h=t-l);break;case"top":this.transfer?(u=window.pageYOffset+e.top-c,h=window.pageXOffset+e.left+(t-l)/2):(u=-c,h=(t-l)/2)}this.$refs.dropdown.style.top="".concat(u,"px"),this.$refs.dropdown.style.left="".concat(h,"px")},handleRefClick:function(){this.dropDisabled||(this.dropdownVisible=!this.dropdownVisible)},handleDocumentClick:function(e){this.$refs&&(this.$refs.reference.contains(e.target)||this.$refs.dropdown.contains(e.target)||(this.dropdownVisible=!1))},handleClear:function(){this.$emit("clear"),this.checkable?this.clearChecked():this.selectable&&this.clearSelected()},handleCheckedChange:function(e,t){this.slotProps.checkedNodes=e,this.slotProps.checkedKeys=t,this.checkedCount=t.length},handleSelectedChange:function(e,t){if(this.slotProps.selectedNode=e,this.slotProps.selectedKey=t,e){var n=this.$refs.treeSearch.$refs.tree.titleField;this.selectedTitle=e[n]}else this.selectedTitle=t||"";this.dropdownVisible=!1},handleSetData:function(){if(this.slotProps.checkedNodes=this.getCheckedNodes(),this.slotProps.checkedKeys=this.getCheckedKeys(),this.slotProps.selectedNode=this.getSelectedNode(),this.slotProps.selectedKey=this.getSelectedKey(),this.checkable&&(this.checkedCount=this.slotProps.checkedKeys.length),this.selectable&&null!=this.value){var e=this.getNode(this.value);if(e){var t=this.$refs.treeSearch.$refs.tree.titleField;this.selectedTitle=e[t]}else this.selectedTitle=this.value}}}),mounted:function(){document.addEventListener("click",this.handleDocumentClick),this.transfer&&document.body.appendChild(this.$refs.dropdown),this.handleSetData()},beforeDestroy:function(){document.removeEventListener("click",this.handleDocumentClick),this.$refs.dropdown.remove()},watch:{dropdownVisible:function(e){var t=this;this.$emit("dropdown-visible-change",e),e?this.$nextTick((function(){t.locateDropdown()})):this.$refs.treeSearch.getKeyword()&&(this.$refs.treeSearch.clearKeyword(),this.$refs.treeSearch.search())}}}),Q,ee,!1,null,null,null).exports,ye=(n("a4b1"),B);n.d(t,"CTreeNode",(function(){return I})),n.d(t,"CTreeSearch",(function(){return J})),n.d(t,"CTreeDrop",(function(){return ve})),t.default=ye}}))},409669:function(e,t,n){e.exports=n(751609)},753671:function(e,t,n){var i=n(317854),o=n(419662),r=n(747908),s=n(168361),a=n(426244),l=i.TypeError,c=function(e){return function(t,n,i,c){o(n);var u=r(t),h=s(u),d=a(u),p=e?d-1:0,f=e?-1:1;if(i<2)for(;;){if(p in h){c=h[p],p+=f;break}if(p+=f,e?p<0:d<=p)throw l("Reduce of empty array with no initial value")}for(;e?p>=0:d>p;p+=f)p in h&&(c=n(c,h[p],p,u));return c}};e.exports={left:c(!1),right:c(!0)}},568886:function(e,t,n){var i=n(188113).match(/firefox\/(\d+)/i);e.exports=!!i&&+i[1]},530256:function(e,t,n){var i=n(188113);e.exports=/MSIE|Trident/.test(i)},498008:function(e,t,n){var i=n(188113).match(/AppleWebKit\/(\d+)\./);e.exports=!!i&&+i[1]},294986:function(e,t,n){var i=n(82109),o=n(386583);i({target:"Array",proto:!0,forced:o!==[].lastIndexOf},{lastIndexOf:o})},185827:function(e,t,n){"use strict";var i=n(82109),o=n(753671).left,r=n(609341),s=n(507392),a=n(235268);i({target:"Array",proto:!0,forced:!r("reduce")||!a&&s>79&&s<83},{reduce:function(e){var t=arguments.length;return o(this,e,t,t>1?arguments[1]:void 0)}})},702707:function(e,t,n){"use strict";var i=n(82109),o=n(901702),r=n(419662),s=n(747908),a=n(426244),l=n(141340),c=n(747293),u=n(994362),h=n(609341),d=n(568886),p=n(530256),f=n(507392),v=n(498008),y=[],g=o(y.sort),m=o(y.push),_=c((function(){y.sort(void 0)})),b=c((function(){y.sort(null)})),k=h("sort"),x=!c((function(){if(f)return f<70;if(!(d&&d>3)){if(p)return!0;if(v)return v<603;var e,t,n,i,o="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(i=0;i<47;i++)y.push({k:t+i,v:n})}for(y.sort((function(e,t){return t.v-e.v})),i=0;i<y.length;i++)t=y[i].k.charAt(0),o.charAt(o.length-1)!==t&&(o+=t);return"DGBEFHACIJK"!==o}}));i({target:"Array",proto:!0,forced:_||!b||!k||!x},{sort:function(e){void 0!==e&&r(e);var t=s(this);if(x)return void 0===e?g(t):g(t,e);var n,i,o=[],c=a(t);for(i=0;i<c;i++)i in t&&m(o,t[i]);for(u(o,function(e){return function(t,n){return void 0===n?-1:void 0===t?1:void 0!==e?+e(t,n)||0:l(t)>l(n)?1:-1}}(e)),n=o.length,i=0;i<n;)t[i]=o[i++];for(;i<c;)delete t[i++];return t}})},651532:function(e,t,n){"use strict";n(277710)("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),n(495631))},925438:function(e,t,n){var i=n(82109),o=Math.hypot,r=Math.abs,s=Math.sqrt;i({target:"Math",stat:!0,forced:!!o&&o(1/0,NaN)!==1/0},{hypot:function(e,t){for(var n,i,o=0,a=0,l=arguments.length,c=0;a<l;)c<(n=r(arguments[a++]))?(o=o*(i=c/n)*i+1,c=n):o+=n>0?(i=n/c)*i:n;return c===1/0?1/0:c*s(o)}})},180091:function(e,t,n){"use strict";n.d(t,{Fp:function(){return i.Z}});n(64503),n(500902),n(354081);var i=n(398823);n(567614)},398823:function(e,t,n){"use strict";function i(e,t){var n,i,o=e.length,r=-1;if(null==t){for(;++r<o;)if(null!=(n=e[r])&&n>=n)for(i=n;++r<o;)null!=(n=e[r])&&n>i&&(i=n)}else for(;++r<o;)if(null!=(n=t(e[r],r,e))&&n>=n)for(i=n;++r<o;)null!=(n=t(e[r],r,e))&&n>i&&(i=n);return i}n.d(t,{Z:function(){return i}})},739985:function(e,t,n){"use strict";function i(e){return e}n.d(t,{Z:function(){return i}})},312968:function(e,t,n){"use strict";n.d(t,{y4:function(){return d}});var i=Array.prototype.slice,o=n(739985),r=1e-6;function s(e){return"translate("+(e+.5)+",0)"}function a(e){return"translate(0,"+(e+.5)+")"}function l(e){return function(t){return+e(t)}}function c(e){var t=Math.max(0,e.bandwidth()-1)/2;return e.round()&&(t=Math.round(t)),function(n){return+e(n)+t}}function u(){return!this.__axis}function h(e,t){var n=[],h=null,d=null,p=6,f=6,v=3,y=1===e||4===e?-1:1,g=4===e||2===e?"x":"y",m=1===e||3===e?s:a;function _(i){var s=null==h?t.ticks?t.ticks.apply(t,n):t.domain():h,a=null==d?t.tickFormat?t.tickFormat.apply(t,n):o.Z:d,_=Math.max(p,0)+v,b=t.range(),k=+b[0]+.5,x=+b[b.length-1]+.5,C=(t.bandwidth?c:l)(t.copy()),S=i.selection?i.selection():i,w=S.selectAll(".domain").data([null]),E=S.selectAll(".tick").data(s,t).order(),P=E.exit(),A=E.enter().append("g").attr("class","tick"),D=E.select("line"),M=E.select("text");w=w.merge(w.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),E=E.merge(A),D=D.merge(A.append("line").attr("stroke","currentColor").attr(g+"2",y*p)),M=M.merge(A.append("text").attr("fill","currentColor").attr(g,y*_).attr("dy",1===e?"0em":3===e?"0.71em":"0.32em")),i!==S&&(w=w.transition(i),E=E.transition(i),D=D.transition(i),M=M.transition(i),P=P.transition(i).attr("opacity",r).attr("transform",(function(e){return isFinite(e=C(e))?m(e):this.getAttribute("transform")})),A.attr("opacity",r).attr("transform",(function(e){var t=this.parentNode.__axis;return m(t&&isFinite(t=t(e))?t:C(e))}))),P.remove(),w.attr("d",4===e||2==e?f?"M"+y*f+","+k+"H0.5V"+x+"H"+y*f:"M0.5,"+k+"V"+x:f?"M"+k+","+y*f+"V0.5H"+x+"V"+y*f:"M"+k+",0.5H"+x),E.attr("opacity",1).attr("transform",(function(e){return m(C(e))})),D.attr(g+"2",y*p),M.attr(g,y*_).text(a),S.filter(u).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===e?"start":4===e?"end":"middle"),S.each((function(){this.__axis=C}))}return _.scale=function(e){return arguments.length?(t=e,_):t},_.ticks=function(){return n=i.call(arguments),_},_.tickArguments=function(e){return arguments.length?(n=null==e?[]:i.call(e),_):n.slice()},_.tickValues=function(e){return arguments.length?(h=null==e?null:i.call(e),_):h&&h.slice()},_.tickFormat=function(e){return arguments.length?(d=e,_):d},_.tickSize=function(e){return arguments.length?(p=f=+e,_):p},_.tickSizeInner=function(e){return arguments.length?(p=+e,_):p},_.tickSizeOuter=function(e){return arguments.length?(f=+e,_):f},_.tickPadding=function(e){return arguments.length?(v=+e,_):v},_}function d(e){return h(4,e)}},543095:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var i=n(645553),o=n(814103);function r(e){var t=(0,i.Z)();return t.changedTouches&&(t=t.changedTouches[0]),(0,o.Z)(e,t)}},814103:function(e,t,n){"use strict";function i(e,t){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=t.clientX,i.y=t.clientY,[(i=i.matrixTransform(e.getScreenCTM().inverse())).x,i.y]}var o=e.getBoundingClientRect();return[t.clientX-o.left-e.clientLeft,t.clientY-o.top-e.clientTop]}n.d(t,{Z:function(){return i}})},425109:function(e,t,n){"use strict";n.d(t,{B:function(){return o},ZP:function(){return u},_H:function(){return h}});var i={},o=null;"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(i={mouseenter:"mouseover",mouseleave:"mouseout"}));function r(e,t,n){return e=s(e,t,n),function(t){var n=t.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||e.call(this,t)}}function s(e,t,n){return function(i){var r=o;o=i;try{e.call(this,this.__data__,t,n)}finally{o=r}}}function a(e){return e.trim().split(/^|\s+/).map((function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}}))}function l(e){return function(){var t=this.__on;if(t){for(var n,i=0,o=-1,r=t.length;i<r;++i)n=t[i],e.type&&n.type!==e.type||n.name!==e.name?t[++o]=n:this.removeEventListener(n.type,n.listener,n.capture);++o?t.length=o:delete this.__on}}}function c(e,t,n){var o=i.hasOwnProperty(e.type)?r:s;return function(i,r,s){var a,l=this.__on,c=o(t,r,s);if(l)for(var u=0,h=l.length;u<h;++u)if((a=l[u]).type===e.type&&a.name===e.name)return this.removeEventListener(a.type,a.listener,a.capture),this.addEventListener(a.type,a.listener=c,a.capture=n),void(a.value=t);this.addEventListener(e.type,c,n),a={type:e.type,name:e.name,value:t,listener:c,capture:n},l?l.push(a):this.__on=[a]}}function u(e,t,n){var i,o,r=a(e+""),s=r.length;if(!(arguments.length<2)){for(u=t?c:l,null==n&&(n=!1),i=0;i<s;++i)this.each(u(r[i],t,n));return this}var u=this.node().__on;if(u)for(var h,d=0,p=u.length;d<p;++d)for(i=0,h=u[d];i<s;++i)if((o=r[i]).type===h.type&&o.name===h.name)return h.value}function h(e,t,n,i){var r=o;e.sourceEvent=o,o=e;try{return t.apply(n,i)}finally{o=r}}},645553:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var i=n(425109);function o(){for(var e,t=i.B;e=t.sourceEvent;)t=e;return t}},372263:function(e,t,n){"use strict";n.d(t,{e1:function(){return i.Z}});n(976067),n(638611),n(348529);var i=n(457811)},23441:function(e,t){"use strict";t.F=function(e,t,n){var i=n.get;if(!i)throw new TypeError("Getter property descriptor expected");n.get=function(){var e=i.call(this);return Object.defineProperty(this,t,{configurable:n.configurable,enumerable:n.enumerable,writable:!1,value:e}),e}}},387737:function(e){e.exports=function(){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function i(e,t,i){t&&n(e.prototype,t),i&&n(e,i),Object.defineProperty(e,"prototype",{writable:!1})}function o(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0===(t=e))throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=s(e);return l(this,t?(n=s(this).constructor,Reflect.construct(i,arguments,n)):i.apply(this,arguments))}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function h(e,t){var n,i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length)return i&&(e=i),n=0,{s:t=function(){},n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,r=!0,s=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return r=e.done,e},e:function(e){s=!0,o=e},f:function(){try{r||null==i.return||i.return()}finally{if(s)throw o}}}}function d(){if(p.url)window.location.href=p.url;else if(p.rewriteHTML)try{document.documentElement.innerHTML=p.rewriteHTML}catch(e){document.documentElement.innerText=p.rewriteHTML}else{try{window.opener=null,window.open("","_self"),window.close(),window.history.back()}catch(e){console.log(e)}setTimeout((function(){window.location.href=p.timeOutUrl||"https://theajack.github.io/disable-devtool/404.html?h=".concat(encodeURIComponent(location.host))}),500)}}var p={md5:"",ondevtoolopen:d,ondevtoolclose:null,url:"",timeOutUrl:"",tkName:"ddtk",interval:500,disableMenu:!0,stopIntervalTime:5e3,clearIntervalWhenDevOpenTrigger:!1,detectors:[0,1,3,4,5,6,7],clearLog:!0,disableSelect:!1,disableCopy:!1,disableCut:!1,disablePaste:!1,ignore:null,disableIframeParents:!0,seo:!0,rewriteHTML:""},f=["detectors","ondevtoolclose","ignore"];function v(t){var n,i=0<arguments.length&&void 0!==t?t:{};for(n in p){var o=n;void 0===i[o]||e(p[o])!==e(i[o])&&-1===f.indexOf(o)||(p[o]=i[o])}"function"==typeof p.ondevtoolclose&&!0===p.clearIntervalWhenDevOpenTrigger&&(p.clearIntervalWhenDevOpenTrigger=!1,console.warn("【DISABLE-DEVTOOL】clearIntervalWhenDevOpenTrigger 在使用 ondevtoolclose 时无效"))}function y(){return(new Date).getTime()}function g(e){var t=y();return e(),y()-t}function m(e,t){function n(n){return function(){e&&e();var i=n.apply(void 0,arguments);return t&&t(),i}}var i=window.alert,o=window.confirm,r=window.prompt;try{window.alert=n(i),window.confirm=n(o),window.prompt=n(r)}catch(n){}}var _={iframe:!1,pc:!1,qqBrowser:!1,firefox:!1,macos:!1,edge:!1,oldEdge:!1,ie:!1,iosChrome:!1,iosEdge:!1,chrome:!1,seoBot:!1,mobile:!1};function b(){function e(e){return-1!==t.indexOf(e)}var t=navigator.userAgent.toLowerCase(),n=function(){var e,t=(e=navigator).platform;if("number"==typeof(e=e.maxTouchPoints))return 1<e;if("string"==typeof t){if(e=t.toLowerCase(),/(mac|win)/i.test(e))return!1;if(/(android|iphone|ipad|ipod|arch)/i.test(e))return!0}return/(iphone|ipad|ipod|ios|android)/i.test(navigator.userAgent.toLowerCase())}(),i=!!window.top&&window!==window.top,o=!n,r=e("qqbrowser"),s=e("firefox"),a=e("macintosh"),l=e("edge"),c=l&&!e("chrome"),u=c||e("trident")||e("msie"),h=e("crios"),d=e("edgios"),p=e("chrome")||h,f=!n&&/(googlebot|baiduspider|bingbot|applebot|petalbot|yandexbot|bytespider|chrome\-lighthouse|moto g power)/i.test(t);Object.assign(_,{iframe:i,pc:o,qqBrowser:r,firefox:s,macos:a,edge:l,oldEdge:c,ie:u,iosChrome:h,iosEdge:d,chrome:p,seoBot:f,mobile:n})}function k(){for(var e=function(){for(var e={},t=0;t<500;t++)e["".concat(t)]="".concat(t);return e}(),t=[],n=0;n<50;n++)t.push(e);return t}var x,C,S,w=window.console||{log:function(){},table:function(){},clear:function(){}};function E(){p.clearLog&&S()}var P="",A=!1;function D(){var e=p.ignore;if(e){if("function"==typeof e)return e();if(0!==e.length){var t=location.href;if(P===t)return A;P=t;var n,i=!1,o=h(e);try{for(o.s();!(n=o.n()).done;){var r=n.value;if("string"==typeof r){if(-1!==t.indexOf(r)){i=!0;break}}else if(r.test(t)){i=!0;break}}}catch(e){o.e(e)}finally{o.f()}return A=i}}}var M=function(){return!1};function T(e){var t,n,i=74,o=73,r=85,s=83,a=123,l=_.macos?function(e,t){return e.metaKey&&e.altKey&&(t===o||t===i)}:function(e,t){return e.ctrlKey&&e.shiftKey&&(t===o||t===i)},c=_.macos?function(e,t){return e.metaKey&&e.altKey&&t===r||e.metaKey&&t===s}:function(e,t){return e.ctrlKey&&(t===s||t===r)};e.addEventListener("keydown",(function(t){var n=(t=t||e.event).keyCode||t.which;if(n===a||l(t,n)||c(t,n))return O(e,t)}),!0),t=e,p.disableMenu&&t.addEventListener("contextmenu",(function(e){if("touch"!==e.pointerType)return O(t,e)})),n=e,p.disableSelect&&j(n,"selectstart"),n=e,p.disableCopy&&j(n,"copy"),n=e,p.disableCut&&j(n,"cut"),n=e,p.disablePaste&&j(n,"paste")}function j(e,t){e.addEventListener(t,(function(t){return O(e,t)}))}function O(e,t){if(!D()&&!M())return(t=t||e.event).returnValue=!1,t.preventDefault(),!1}var I,L=!1,N={};function F(e){N[e]=!1}function G(){for(var e in N)if(N[e])return L=!0;return L=!1}(te=I=I||{})[te.Unknown=-1]="Unknown",te[te.RegToString=0]="RegToString",te[te.DefineId=1]="DefineId",te[te.Size=2]="Size",te[te.DateToString=3]="DateToString",te[te.FuncToString=4]="FuncToString",te[te.Debugger=5]="Debugger",te[te.Performance=6]="Performance",te[te.DebugLib=7]="DebugLib";var R=function(){function e(n){var i=n.type;n=void 0===(n=n.enabled)||n,t(this,e),this.type=I.Unknown,this.enabled=!0,this.type=i,this.enabled=n,this.enabled&&(i=this,X.push(i),this.init())}return i(e,[{key:"onDevToolOpen",value:function(){var e;console.warn("You don't have permission to use DEVTOOL!【type = ".concat(this.type,"】")),p.clearIntervalWhenDevOpenTrigger&&V(),window.clearTimeout(U),p.ondevtoolopen(this.type,d),e=this.type,N[e]=!0}},{key:"init",value:function(){}}]),e}(),B=function(){r(n,R);var e=c(n);function n(){return t(this,n),e.call(this,{type:I.DebugLib})}return i(n,[{key:"init",value:function(){}},{key:"detect",value:function(){var e;(!0===(null==(e=null==(e=window.eruda)?void 0:e._devTools)?void 0:e._isShow)||window._vcOrigConsole&&window.document.querySelector("#__vconsole.vc-toggle"))&&this.onDevToolOpen()}}],[{key:"isUsing",value:function(){return!!window.eruda||!!window._vcOrigConsole}}]),n}(),H=0,U=0,X=[],Y=0;function K(e){function t(){c=!0}function n(){c=!1}var i,o,r,s,a,l,c=!1;function u(){(l[s]===r?o:i)()}m(t,n),i=n,o=t,void 0!==(l=document).hidden?(r="hidden",a="visibilitychange",s="visibilityState"):void 0!==l.mozHidden?(r="mozHidden",a="mozvisibilitychange",s="mozVisibilityState"):void 0!==l.msHidden?(r="msHidden",a="msvisibilitychange",s="msVisibilityState"):void 0!==l.webkitHidden&&(r="webkitHidden",a="webkitvisibilitychange",s="webkitVisibilityState"),l.removeEventListener(a,u,!1),l.addEventListener(a,u,!1),H=window.setInterval((function(){if(!(e.isSuspend||c||D())){var t,n,i=h(X);try{for(i.s();!(t=i.n()).done;){var o=t.value;F(o.type),o.detect(Y++)}}catch(t){i.e(t)}finally{i.f()}E(),"function"==typeof p.ondevtoolclose&&(n=L,!G()&&n&&p.ondevtoolclose())}}),p.interval),U=setTimeout((function(){_.pc||B.isUsing()||V()}),p.stopIntervalTime)}function V(){window.clearInterval(H)}var z=8;function W(e){for(var t=function(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var n=1732584193,i=-271733879,o=-1732584194,r=271733878,s=0;s<e.length;s+=16){var a=n,l=i,c=o,u=r;n=q(n,i,o,r,e[s+0],7,-680876936),r=q(r,n,i,o,e[s+1],12,-389564586),o=q(o,r,n,i,e[s+2],17,606105819),i=q(i,o,r,n,e[s+3],22,-1044525330),n=q(n,i,o,r,e[s+4],7,-176418897),r=q(r,n,i,o,e[s+5],12,1200080426),o=q(o,r,n,i,e[s+6],17,-1473231341),i=q(i,o,r,n,e[s+7],22,-45705983),n=q(n,i,o,r,e[s+8],7,1770035416),r=q(r,n,i,o,e[s+9],12,-1958414417),o=q(o,r,n,i,e[s+10],17,-42063),i=q(i,o,r,n,e[s+11],22,-1990404162),n=q(n,i,o,r,e[s+12],7,1804603682),r=q(r,n,i,o,e[s+13],12,-40341101),o=q(o,r,n,i,e[s+14],17,-1502002290),n=Z(n,i=q(i,o,r,n,e[s+15],22,1236535329),o,r,e[s+1],5,-165796510),r=Z(r,n,i,o,e[s+6],9,-1069501632),o=Z(o,r,n,i,e[s+11],14,643717713),i=Z(i,o,r,n,e[s+0],20,-373897302),n=Z(n,i,o,r,e[s+5],5,-701558691),r=Z(r,n,i,o,e[s+10],9,38016083),o=Z(o,r,n,i,e[s+15],14,-660478335),i=Z(i,o,r,n,e[s+4],20,-405537848),n=Z(n,i,o,r,e[s+9],5,568446438),r=Z(r,n,i,o,e[s+14],9,-1019803690),o=Z(o,r,n,i,e[s+3],14,-187363961),i=Z(i,o,r,n,e[s+8],20,1163531501),n=Z(n,i,o,r,e[s+13],5,-1444681467),r=Z(r,n,i,o,e[s+2],9,-51403784),o=Z(o,r,n,i,e[s+7],14,1735328473),n=J(n,i=Z(i,o,r,n,e[s+12],20,-1926607734),o,r,e[s+5],4,-378558),r=J(r,n,i,o,e[s+8],11,-2022574463),o=J(o,r,n,i,e[s+11],16,1839030562),i=J(i,o,r,n,e[s+14],23,-35309556),n=J(n,i,o,r,e[s+1],4,-1530992060),r=J(r,n,i,o,e[s+4],11,1272893353),o=J(o,r,n,i,e[s+7],16,-155497632),i=J(i,o,r,n,e[s+10],23,-1094730640),n=J(n,i,o,r,e[s+13],4,681279174),r=J(r,n,i,o,e[s+0],11,-358537222),o=J(o,r,n,i,e[s+3],16,-722521979),i=J(i,o,r,n,e[s+6],23,76029189),n=J(n,i,o,r,e[s+9],4,-640364487),r=J(r,n,i,o,e[s+12],11,-421815835),o=J(o,r,n,i,e[s+15],16,530742520),n=Q(n,i=J(i,o,r,n,e[s+2],23,-995338651),o,r,e[s+0],6,-198630844),r=Q(r,n,i,o,e[s+7],10,1126891415),o=Q(o,r,n,i,e[s+14],15,-1416354905),i=Q(i,o,r,n,e[s+5],21,-57434055),n=Q(n,i,o,r,e[s+12],6,1700485571),r=Q(r,n,i,o,e[s+3],10,-1894986606),o=Q(o,r,n,i,e[s+10],15,-1051523),i=Q(i,o,r,n,e[s+1],21,-2054922799),n=Q(n,i,o,r,e[s+8],6,1873313359),r=Q(r,n,i,o,e[s+15],10,-30611744),o=Q(o,r,n,i,e[s+6],15,-1560198380),i=Q(i,o,r,n,e[s+13],21,1309151649),n=Q(n,i,o,r,e[s+4],6,-145523070),r=Q(r,n,i,o,e[s+11],10,-1120210379),o=Q(o,r,n,i,e[s+2],15,718787259),i=Q(i,o,r,n,e[s+9],21,-343485551),n=ee(n,a),i=ee(i,l),o=ee(o,c),r=ee(r,u)}return Array(n,i,o,r)}(function(e){for(var t=Array(),n=(1<<z)-1,i=0;i<e.length*z;i+=z)t[i>>5]|=(e.charCodeAt(i/z)&n)<<i%32;return t}(e),e.length*z),n="0123456789abcdef",i="",o=0;o<4*t.length;o++)i+=n.charAt(t[o>>2]>>o%4*8+4&15)+n.charAt(t[o>>2]>>o%4*8&15);return i}function $(e,t,n,i,o,r){return ee((t=ee(ee(t,e),ee(i,r)))<<o|t>>>32-o,n)}function q(e,t,n,i,o,r,s){return $(t&n|~t&i,e,t,o,r,s)}function Z(e,t,n,i,o,r,s){return $(t&i|n&~i,e,t,o,r,s)}function J(e,t,n,i,o,r,s){return $(t^n^i,e,t,o,r,s)}function Q(e,t,n,i,o,r,s){return $(n^(t|~i),e,t,o,r,s)}function ee(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}var te=function(){r(n,R);var e=c(n);function n(){return t(this,n),e.call(this,{type:I.RegToString,enabled:_.qqBrowser||_.firefox})}return i(n,[{key:"init",value:function(){var e=this;this.lastTime=0,this.reg=/./,x(this.reg),this.reg.toString=function(){var t;return _.qqBrowser?(t=(new Date).getTime(),e.lastTime&&t-e.lastTime<100?e.onDevToolOpen():e.lastTime=t):_.firefox&&e.onDevToolOpen(),""}}},{key:"detect",value:function(){x(this.reg)}}]),n}(),ne=function(){r(n,R);var e=c(n);function n(){return t(this,n),e.call(this,{type:I.DefineId})}return i(n,[{key:"init",value:function(){var e=this;this.div=document.createElement("div"),this.div.__defineGetter__("id",(function(){e.onDevToolOpen()})),Object.defineProperty(this.div,"id",{get:function(){e.onDevToolOpen()}})}},{key:"detect",value:function(){x(this.div)}}]),n}(),ie=function(){r(n,R);var e=c(n);function n(){return t(this,n),e.call(this,{type:I.Size,enabled:!_.iframe&&!_.edge})}return i(n,[{key:"init",value:function(){var e=this;this.checkWindowSizeUneven(),window.addEventListener("resize",(function(){setTimeout((function(){e.checkWindowSizeUneven()}),100)}),!0)}},{key:"detect",value:function(){}},{key:"checkWindowSizeUneven",value:function(){if(!1!==(t=function(){if(oe(window.devicePixelRatio))return window.devicePixelRatio;var e=window.screen;return!(oe(e)||!e.deviceXDPI||!e.logicalXDPI)&&e.deviceXDPI/e.logicalXDPI}())){var e=200<window.outerWidth-window.innerWidth*t,t=300<window.outerHeight-window.innerHeight*t;if(e||t)return this.onDevToolOpen(),!1;F(this.type)}return!0}}]),n}();function oe(e){return null!=e}var re,se=function(){r(n,R);var e=c(n);function n(){return t(this,n),e.call(this,{type:I.DateToString,enabled:!_.iosChrome&&!_.iosEdge})}return i(n,[{key:"init",value:function(){var e=this;this.count=0,this.date=new Date,this.date.toString=function(){return e.count++,""}}},{key:"detect",value:function(){this.count=0,x(this.date),E(),2<=this.count&&this.onDevToolOpen()}}]),n}(),ae=function(){r(n,R);var e=c(n);function n(){return t(this,n),e.call(this,{type:I.FuncToString,enabled:!_.iosChrome&&!_.iosEdge})}return i(n,[{key:"init",value:function(){var e=this;this.count=0,this.func=function(){},this.func.toString=function(){return e.count++,""}}},{key:"detect",value:function(){this.count=0,x(this.func),E(),2<=this.count&&this.onDevToolOpen()}}]),n}(),le=function(){r(n,R);var e=c(n);function n(){return t(this,n),e.call(this,{type:I.Debugger,enabled:_.iosChrome||_.iosEdge})}return i(n,[{key:"detect",value:function(){var e=y();100<y()-e&&this.onDevToolOpen()}}]),n}(),ce=function(){r(n,R);var e=c(n);function n(){return t(this,n),e.call(this,{type:I.Performance,enabled:_.chrome||!_.mobile})}return i(n,[{key:"init",value:function(){this.maxPrintTime=0,this.largeObjectArray=k()}},{key:"detect",value:function(){var e=this,t=g((function(){C(e.largeObjectArray)})),n=g((function(){x(e.largeObjectArray)}));if(this.maxPrintTime=Math.max(this.maxPrintTime,n),E(),0===t||0===this.maxPrintTime)return!1;t>10*this.maxPrintTime&&this.onDevToolOpen()}}]),n}(),ue=(o(re={},I.RegToString,te),o(re,I.DefineId,ne),o(re,I.Size,ie),o(re,I.DateToString,se),o(re,I.FuncToString,ae),o(re,I.Debugger,le),o(re,I.Performance,ce),o(re,I.DebugLib,B),re),he=Object.assign((function(e){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";return{success:!e,reason:e}}if(he.isRunning)return t("already running");if(b(),S=_.ie?(x=function(){return w.log.apply(w,arguments)},C=function(){return w.table.apply(w,arguments)},function(){return w.clear()}):(x=w.log,C=w.table,w.clear),v(e),p.md5&&W(function(e){var t=window.location.search,n=window.location.hash;return""!==(t=""===t&&""!==n?"?".concat(n.split("?")[1]):t)&&void 0!==t&&(n=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),null!=(e=t.substr(1).match(n)))?unescape(e[2]):""}(p.tkName))===p.md5)return t("token passed");if(p.seo&&_.seoBot)return t("seobot");he.isRunning=!0,K(he);var n=he,i=(M=function(){return n.isSuspend},window.top),o=window.parent;if(T(window),p.disableIframeParents&&i&&o&&i!==window){for(;o!==i;)T(o),o=o.parent;T(i)}return("all"===p.detectors?Object.keys(ue):p.detectors).forEach((function(e){new ue[e]})),t()}),{isRunning:!1,isSuspend:!1,md5:W,version:"0.3.7",DetectorType:I,isDevToolOpened:G});return(te=function(){if("undefined"==typeof window||!window.document)return null;var e=document.querySelector("[disable-devtool-auto]");if(!e)return null;var t=["disable-menu","disable-select","disable-copy","disable-cut","disable-paste","clear-log"],n=["interval"],i={};return["md5","url","tk-name","detectors"].concat(t,n).forEach((function(o){var r=e.getAttribute(o);null!==r&&(-1!==n.indexOf(o)?r=parseInt(r):-1!==t.indexOf(o)?r="false"!==r:"detector"===o&&"all"!==r&&(r=r.split(" ")),i[function(e){if(-1===e.indexOf("-"))return e;var t=!1;return e.split("").map((function(e){return"-"===e?(t=!0,""):t?(t=!1,e.toUpperCase()):e})).join("")}(o)]=r)})),i}())&&he(te),he}()},383228:function(e,t,n){var i=n(619755),o=n(327672);void 0===o.window&&(o.window={}),o.window.$=i,void 0===o.window&&(o.window={}),o.window.jQuery=i,e.exports=i},178598:function(e,t,n){var i,o=o||function(e){"use strict";if(!(void 0===e||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var t=e.document,n=function(){return e.URL||e.webkitURL||e},i=t.createElementNS("http://www.w3.org/1999/xhtml","a"),o="download"in i,r=/constructor/i.test(e.HTMLElement)||e.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent),a=function(t){(e.setImmediate||e.setTimeout)((function(){throw t}),0)},l=function(e){setTimeout((function(){"string"==typeof e?n().revokeObjectURL(e):e.remove()}),4e4)},c=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e},u=function(t,u,h){h||(t=c(t));var d,p=this,f="application/octet-stream"===t.type,v=function(){!function(e,t,n){for(var i=(t=[].concat(t)).length;i--;){var o=e["on"+t[i]];if("function"==typeof o)try{o.call(e,n||e)}catch(e){a(e)}}}(p,"writestart progress write writeend".split(" "))};if(p.readyState=p.INIT,o)return d=n().createObjectURL(t),void setTimeout((function(){var e,t;i.href=d,i.download=u,e=i,t=new MouseEvent("click"),e.dispatchEvent(t),v(),l(d),p.readyState=p.DONE}));!function(){if((s||f&&r)&&e.FileReader){var i=new FileReader;return i.onloadend=function(){var t=s?i.result:i.result.replace(/^data:[^;]*;/,"data:attachment/file;");e.open(t,"_blank")||(e.location.href=t),t=void 0,p.readyState=p.DONE,v()},i.readAsDataURL(t),void(p.readyState=p.INIT)}(d||(d=n().createObjectURL(t)),f)?e.location.href=d:e.open(d,"_blank")||(e.location.href=d);p.readyState=p.DONE,v(),l(d)}()},h=u.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,n){return t=t||e.name||"download",n||(e=c(e)),navigator.msSaveOrOpenBlob(e,t)}:(h.abort=function(){},h.readyState=h.INIT=0,h.WRITING=1,h.DONE=2,h.error=h.onwritestart=h.onprogress=h.onwrite=h.onabort=h.onerror=h.onwriteend=null,function(e,t,n){return new u(e,t||e.name||"download",n)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);e.exports?e.exports.saveAs=o:null!==n.amdD&&null!==n.amdO&&(void 0===(i=function(){return o}.call(t,n,t,e))||(e.exports=i))},678410:function(e,t,n){"use strict";n.r(t),n.d(t,{NIL:function(){return w},parse:function(){return h},stringify:function(){return s.Z},v1:function(){return c},v3:function(){return b},v4:function(){return k.Z},v5:function(){return S},validate:function(){return u.Z},version:function(){return E}});var i,o,r=n(813653),s=n(403958),a=0,l=0;var c=function(e,t,n){var c=t&&n||0,u=t||new Array(16),h=(e=e||{}).node||i,d=void 0!==e.clockseq?e.clockseq:o;if(null==h||null==d){var p=e.random||(e.rng||r.Z)();null==h&&(h=i=[1|p[0],p[1],p[2],p[3],p[4],p[5]]),null==d&&(d=o=16383&(p[6]<<8|p[7]))}var f=void 0!==e.msecs?e.msecs:Date.now(),v=void 0!==e.nsecs?e.nsecs:l+1,y=f-a+(v-l)/1e4;if(y<0&&void 0===e.clockseq&&(d=d+1&16383),(y<0||f>a)&&void 0===e.nsecs&&(v=0),v>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=f,l=v,o=d;var g=(1e4*(268435455&(f+=122192928e5))+v)%4294967296;u[c++]=g>>>24&255,u[c++]=g>>>16&255,u[c++]=g>>>8&255,u[c++]=255&g;var m=f/4294967296*1e4&268435455;u[c++]=m>>>8&255,u[c++]=255&m,u[c++]=m>>>24&15|16,u[c++]=m>>>16&255,u[c++]=d>>>8|128,u[c++]=255&d;for(var _=0;_<6;++_)u[c+_]=h[_];return t||(0,s.Z)(u)},u=n(927738);var h=function(e){if(!(0,u.Z)(e))throw TypeError("Invalid UUID");var t,n=new Uint8Array(16);return n[0]=(t=parseInt(e.slice(0,8),16))>>>24,n[1]=t>>>16&255,n[2]=t>>>8&255,n[3]=255&t,n[4]=(t=parseInt(e.slice(9,13),16))>>>8,n[5]=255&t,n[6]=(t=parseInt(e.slice(14,18),16))>>>8,n[7]=255&t,n[8]=(t=parseInt(e.slice(19,23),16))>>>8,n[9]=255&t,n[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,n[11]=t/4294967296&255,n[12]=t>>>24&255,n[13]=t>>>16&255,n[14]=t>>>8&255,n[15]=255&t,n};function d(e,t,n){function i(e,i,o,r){if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t}(e)),"string"==typeof i&&(i=h(i)),16!==i.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var a=new Uint8Array(16+e.length);if(a.set(i),a.set(e,i.length),(a=n(a))[6]=15&a[6]|t,a[8]=63&a[8]|128,o){r=r||0;for(var l=0;l<16;++l)o[r+l]=a[l];return o}return(0,s.Z)(a)}try{i.name=e}catch(e){}return i.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",i.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",i}function p(e){return 14+(e+64>>>9<<4)+1}function f(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function v(e,t,n,i,o,r){return f((s=f(f(t,e),f(i,r)))<<(a=o)|s>>>32-a,n);var s,a}function y(e,t,n,i,o,r,s){return v(t&n|~t&i,e,t,o,r,s)}function g(e,t,n,i,o,r,s){return v(t&i|n&~i,e,t,o,r,s)}function m(e,t,n,i,o,r,s){return v(t^n^i,e,t,o,r,s)}function _(e,t,n,i,o,r,s){return v(n^(t|~i),e,t,o,r,s)}var b=d("v3",48,(function(e){if("string"==typeof e){var t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(var n=0;n<t.length;++n)e[n]=t.charCodeAt(n)}return function(e){for(var t=[],n=32*e.length,i="0123456789abcdef",o=0;o<n;o+=8){var r=e[o>>5]>>>o%32&255,s=parseInt(i.charAt(r>>>4&15)+i.charAt(15&r),16);t.push(s)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[p(t)-1]=t;for(var n=1732584193,i=-271733879,o=-1732584194,r=271733878,s=0;s<e.length;s+=16){var a=n,l=i,c=o,u=r;n=y(n,i,o,r,e[s],7,-680876936),r=y(r,n,i,o,e[s+1],12,-389564586),o=y(o,r,n,i,e[s+2],17,606105819),i=y(i,o,r,n,e[s+3],22,-1044525330),n=y(n,i,o,r,e[s+4],7,-176418897),r=y(r,n,i,o,e[s+5],12,1200080426),o=y(o,r,n,i,e[s+6],17,-1473231341),i=y(i,o,r,n,e[s+7],22,-45705983),n=y(n,i,o,r,e[s+8],7,1770035416),r=y(r,n,i,o,e[s+9],12,-1958414417),o=y(o,r,n,i,e[s+10],17,-42063),i=y(i,o,r,n,e[s+11],22,-1990404162),n=y(n,i,o,r,e[s+12],7,1804603682),r=y(r,n,i,o,e[s+13],12,-40341101),o=y(o,r,n,i,e[s+14],17,-1502002290),n=g(n,i=y(i,o,r,n,e[s+15],22,1236535329),o,r,e[s+1],5,-165796510),r=g(r,n,i,o,e[s+6],9,-1069501632),o=g(o,r,n,i,e[s+11],14,643717713),i=g(i,o,r,n,e[s],20,-373897302),n=g(n,i,o,r,e[s+5],5,-701558691),r=g(r,n,i,o,e[s+10],9,38016083),o=g(o,r,n,i,e[s+15],14,-660478335),i=g(i,o,r,n,e[s+4],20,-405537848),n=g(n,i,o,r,e[s+9],5,568446438),r=g(r,n,i,o,e[s+14],9,-1019803690),o=g(o,r,n,i,e[s+3],14,-187363961),i=g(i,o,r,n,e[s+8],20,1163531501),n=g(n,i,o,r,e[s+13],5,-1444681467),r=g(r,n,i,o,e[s+2],9,-51403784),o=g(o,r,n,i,e[s+7],14,1735328473),n=m(n,i=g(i,o,r,n,e[s+12],20,-1926607734),o,r,e[s+5],4,-378558),r=m(r,n,i,o,e[s+8],11,-2022574463),o=m(o,r,n,i,e[s+11],16,1839030562),i=m(i,o,r,n,e[s+14],23,-35309556),n=m(n,i,o,r,e[s+1],4,-1530992060),r=m(r,n,i,o,e[s+4],11,1272893353),o=m(o,r,n,i,e[s+7],16,-155497632),i=m(i,o,r,n,e[s+10],23,-1094730640),n=m(n,i,o,r,e[s+13],4,681279174),r=m(r,n,i,o,e[s],11,-358537222),o=m(o,r,n,i,e[s+3],16,-722521979),i=m(i,o,r,n,e[s+6],23,76029189),n=m(n,i,o,r,e[s+9],4,-640364487),r=m(r,n,i,o,e[s+12],11,-421815835),o=m(o,r,n,i,e[s+15],16,530742520),n=_(n,i=m(i,o,r,n,e[s+2],23,-995338651),o,r,e[s],6,-198630844),r=_(r,n,i,o,e[s+7],10,1126891415),o=_(o,r,n,i,e[s+14],15,-1416354905),i=_(i,o,r,n,e[s+5],21,-57434055),n=_(n,i,o,r,e[s+12],6,1700485571),r=_(r,n,i,o,e[s+3],10,-1894986606),o=_(o,r,n,i,e[s+10],15,-1051523),i=_(i,o,r,n,e[s+1],21,-2054922799),n=_(n,i,o,r,e[s+8],6,1873313359),r=_(r,n,i,o,e[s+15],10,-30611744),o=_(o,r,n,i,e[s+6],15,-1560198380),i=_(i,o,r,n,e[s+13],21,1309151649),n=_(n,i,o,r,e[s+4],6,-145523070),r=_(r,n,i,o,e[s+11],10,-1120210379),o=_(o,r,n,i,e[s+2],15,718787259),i=_(i,o,r,n,e[s+9],21,-343485551),n=f(n,a),i=f(i,l),o=f(o,c),r=f(r,u)}return[n,i,o,r]}(function(e){if(0===e.length)return[];for(var t=8*e.length,n=new Uint32Array(p(t)),i=0;i<t;i+=8)n[i>>5]|=(255&e[i/8])<<i%32;return n}(e),8*e.length))})),k=n(172045);function x(e,t,n,i){switch(e){case 0:return t&n^~t&i;case 1:return t^n^i;case 2:return t&n^t&i^n&i;case 3:return t^n^i}}function C(e,t){return e<<t|e>>>32-t}var S=d("v5",80,(function(e){var t=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){var i=unescape(encodeURIComponent(e));e=[];for(var o=0;o<i.length;++o)e.push(i.charCodeAt(o))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);for(var r=e.length/4+2,s=Math.ceil(r/16),a=new Array(s),l=0;l<s;++l){for(var c=new Uint32Array(16),u=0;u<16;++u)c[u]=e[64*l+4*u]<<24|e[64*l+4*u+1]<<16|e[64*l+4*u+2]<<8|e[64*l+4*u+3];a[l]=c}a[s-1][14]=8*(e.length-1)/Math.pow(2,32),a[s-1][14]=Math.floor(a[s-1][14]),a[s-1][15]=8*(e.length-1)&4294967295;for(var h=0;h<s;++h){for(var d=new Uint32Array(80),p=0;p<16;++p)d[p]=a[h][p];for(var f=16;f<80;++f)d[f]=C(d[f-3]^d[f-8]^d[f-14]^d[f-16],1);for(var v=n[0],y=n[1],g=n[2],m=n[3],_=n[4],b=0;b<80;++b){var k=Math.floor(b/20),S=C(v,5)+x(k,y,g,m)+_+t[k]+d[b]>>>0;_=m,m=g,g=C(y,30)>>>0,y=v,v=S}n[0]=n[0]+v>>>0,n[1]=n[1]+y>>>0,n[2]=n[2]+g>>>0,n[3]=n[3]+m>>>0,n[4]=n[4]+_>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,255&n[0],n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,255&n[1],n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,255&n[2],n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,255&n[3],n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,255&n[4]]})),w="00000000-0000-0000-0000-000000000000";var E=function(e){if(!(0,u.Z)(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)}},813653:function(e,t,n){"use strict";var i;n.d(t,{Z:function(){return r}});var o=new Uint8Array(16);function r(){if(!i&&!(i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return i(o)}},403958:function(e,t,n){"use strict";for(var i=n(927738),o=[],r=0;r<256;++r)o.push((r+256).toString(16).substr(1));t.Z=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(o[e[t+0]]+o[e[t+1]]+o[e[t+2]]+o[e[t+3]]+"-"+o[e[t+4]]+o[e[t+5]]+"-"+o[e[t+6]]+o[e[t+7]]+"-"+o[e[t+8]]+o[e[t+9]]+"-"+o[e[t+10]]+o[e[t+11]]+o[e[t+12]]+o[e[t+13]]+o[e[t+14]]+o[e[t+15]]).toLowerCase();if(!(0,i.Z)(n))throw TypeError("Stringified UUID is invalid");return n}},172045:function(e,t,n){"use strict";var i=n(813653),o=n(403958);t.Z=function(e,t,n){var r=(e=e||{}).random||(e.rng||i.Z)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var s=0;s<16;++s)t[n+s]=r[s];return t}return(0,o.Z)(r)}},927738:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var i=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;var o=function(e){return"string"==typeof e&&i.test(e)}},965284:function(e,t,n){e.exports=function(){"use strict";var e=n(432156);return{install:function(t,n){var i=n;t.prototype.$sanitize=function(t){return e(t,(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)||i)}},defaults:e.defaults}}()},714743:function(e,t,n){"use strict";var i=n(535183),o=n(242628);(0,i.D)(o.N)},312980:function(e,t,n){"use strict";var i=n(535183),o=n(197194);(0,i.D)(o.N)}}]);