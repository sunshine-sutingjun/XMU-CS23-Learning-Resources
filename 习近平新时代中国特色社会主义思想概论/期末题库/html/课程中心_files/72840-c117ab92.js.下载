(self.webpackChunklms=self.webpackChunklms||[]).push([[72840,27551,69671,2196,87642,6809],{940635:function(e,t,r){var o=r(383228),n=r(261139),i=r(496486);function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r(923157),r(30138),r(692624),r(483941),r(749807),r(148510);var u=r(822077).checkEnableAirChatbot,l=r(951453).useAiPpt,d=o("html").attr("lang"),p=r(978571),f=r(704873),v=r(103982),m=r(726356),h=r(926082),g=r(942518),y=r(19e4),b=r(635224),w=r(752104),_=r(932135),S=r(693604),C=r(843671),x=C.vueVideoMultiPlayer,k=C.wgVideoPlayer,P=C.examVideoPlayer,E=r(117403).default,T=r(979262),M=["ngRoute","stringFormat","ngProgress","monospaced.qrcode","ui.select2","ng-sortable","duScroll","ngSanitize","linkify","angular-clipboard","i18n"];window.CONFIGS&&window.CONFIGS.sentryClientKey&&M.push("ngSentry"),e.exports=n.module("base",M).directive("avatar",r(267038)).directive("errSrc",p.errSrc).directive("svgIcon",r(845032)).directive("fdSlider",r(746794)).directive("autoHeightTable",p.autoHeightTable).directive("verticalSelf",p.verticalSelf).directive("expandableContent",p.expandableContent).directive("expandableContentNew",p.expandableContentNew).directive("expandableContentRemember",p.expandableContentRemember).directive("expandableContentIsolate",p.expandableContentIsolate).directive("foldableContentRemember",p.foldableContentRemember).directive("toggleGroupManager",p.toggleGroupManager).directive("datepicker",p.datepicker).directive("datetimepicker",p.datetimepicker).directive("timepicker",p.timepicker).directive("confirmDialog",p.confirmDialog).directive("revealModal",f.revealModal).directive("resetable",f.resetable).directive("reveal",f.reveal).directive("closePopup",f.closePopup).directive("closePlayerPopup",f.closePlayerPopup).directive("serverValidated",v.serverValidated).directive("errorFor",v.errorFor).directive("errorForTreeView",v.errorForTreeView).directive("closeDropdown",p.closeDropdown).directive("uiSelect2",p.uiSelect2).directive("addSlideSelect2",p.addSlideSelect2).directive("focus",p.focus).directive("simEditor",p.simEditor).directive("formatScore",p.formatScore).directive("multiSelect",m).directive("multipleSelect",h).directive("scrollable",p.scrollable).directive("simditorAudio",p.simditorAudio).directive("ngCompileHtml",p.ngCompileHtml).directive("enterPress",p.enterPress).directive("escPress",p.escPress).directive("scrollableTimeline",p.scrollableTimeline).directive("videoPlayer",p.videoPlayer).directive("vueVideoMultiPlayer",x).directive("wgVideoPlayer",k).directive("examVideoPlayer",P).directive("vueSlider",p.vueSlider).directive("vueWrapper",p.vueWrapper).directive("sortable",p.sortable).directive("dragCloneable",p.dragCloneable).directive("tipsy",p.tipsy).directive("tipsyLiteral",p.tipsyLiteral).directive("tipsyAuto",p.tipsyAuto).directive("fixableNav",p.fixableNav).directive("cornerButtonGroup",p.cornerButtonGroup).directive("fixableButtons",p.fixableButtons).directive("fixableListHeader",p.fixableListHeader).directive("scrollToTop",p.scrollToTop).directive("onModalStateChange",r(716858).p).directive("indeterminateCheckbox",p.indeterminateCheckbox).directive("ngPlaceholder",r(450171).w4).directive("focusPlaceholder",r(450171).he).directive("uiSelect2KeyPress",p.uiSelect2KeyPress).directive("stopPropagation",p.stopPropagation).directive("contentLengthLimit",p.contentLengthLimit).directive("modelPatron",p.modelPatron).directive("modelScorePatron",p.modelScorePatron).directive("modelTimeScorePatron",p.modelTimeScorePatron).directive("contentLengthLeft",p.contentLengthLeft).directive("toggleDropdownList",p.toggleDropdownList).directive("expandHeight",p.expandHeight).directive("autoResizeTextarea",r(864604)).directive("dotdotdot",r(80320)).directive("formatDatetime",p.formatDatetime).directive("parseInteger",p.parseInteger).directive("parseBoolean",p.parseBoolean).directive("goBack",p.goBack).directive("autoSelect",p.autoSelect).directive("onFileSelected",p.onFileSelected).directive("floatPrecision",p.floatPrecision).directive("alert",p.alert).directive("spaceTrim",r(625167)).directive("previewer",p.previewer).directive("resourceReferencePreviewer",p.resourceReferencePreviewer).directive("lessonResourcePreviewer",p.lessonResourcePreviewer).directive("hypothesisStat",p.hypothesisStat).directive("integerLimit",p.integerLimit).directive("uuidFormatter",p.uuidFormatter).directive("wgPlaceholder",r(450171).jC).directive("toggleDropdown",r(956212)).directive("togglePopup",r(908760)).directive("refreshOn",p.refreshOn).directive("backgroundImage",p.backgroundImage).directive("beforeController",p.beforeController).directive("activityCheckpointLock",p.activityCheckpointLock).directive("rootScopeVariable",p.rootScopeVariable).directive("fixNgModelName",p.fixNgModelName).directive("hasSecondLevelMenu",p.hasSecondLevelMenu).directive("treeView",p.treeView).directive("draggable",p.draggable).directive("swfObject",r(529149)).directive("calcElementHeight",r(985396)).directive("mathjax",r(892958)).directive("katex",r(845376)).directive("code",p.code).directive("groupSelector",p.groupSelector).directive("injectContext",p.injectContext).directive("checkUploadStatus",p.checkUploadStatus).directive("doubleClickDisabled",p.doubleClickDisabled).directive("syncScrollContent",p.syncScrollContent).directive("scrollBy",p.scrollBy).directive("iframeonload",p.iframeonload).directive("autoHeightTextarea",p.autoHeightTextarea).directive("waterMark",p.waterMark).directive("widthFor",p.widthFor).directive("ellipsisText",p.ellipsisText).directive("vueActivityTime",p.vueActivityTime).directive("vueDatepicker",p.vueDatepicker).directive("activityScoreTypeWeight",p.activityScoreTypeWeight).directive("uiSortList",p.uiSortList).directive("number",p.number).directive("spinner",p.spinner).filter("duration",g.duration).filter("formatTime",g.formatTime).filter("statFormatTime",g.statFormatTime).filter("humanizeBytes",g.humanizeBytes).filter("humanizeSpeed",g.humanizeSpeed).filter("courseFilter",g.courseFilter).filter("limitLength",g.limitLength).filter("statDatetime",g.statDatetime).filter("datetime",b.datetime).filter("date",b.date).filter("time",b.time).filter("monthAndDay",b.dateWithoutYear).filter("secondsToHms",w).filter("percent",g.percent).filter("formatScore",g.formatScore).filter("truncateText",g.truncateText).filter("fileName",g.fileName).filter("fileExtension",g.fileExtension).filter("clearText",g.clearText).filter("sanitizeHtml",g.sanitizeHtml).filter("year",g.year).filter("month",g.month).filter("day",g.day).filter("trustSrc",g.trustSrc).filter("scoreAsActivity",g.scoreAsActivity).filter("uuidFilter",g.uuidFilter).filter("intToChar",g.intToChar).filter("trustAsHtml",g.trustAsHtml).filter("removeFilesizeTag",g.removeFilesizeTag).filter("removeHtmlTag",g.removeHtmlTag).filter("replaceImgTag",g.replaceImgTag).filter("unescapeHtmlChar",g.unescape).filter("displayName",g.displayName).filter("insert",g.insert).filter("ellipsisText",g.ellipsisText).directive("formatValidated",y.formatValidated).config(["$locationProvider",function(e){e.hashPrefix("")}]).config(["$interpolateProvider",function(e){return e.startSymbol("[["),e.endSymbol("]]")}]).config(["$httpProvider",function(e){return e.defaults.headers.patch={"Content-Type":"application/json;charset=utf-8"},e.defaults.useXDomain=!0,e.interceptors.push(_.progressInterceptor),e.interceptors.push(_.cacheBusterInterceptor)}]).config(["$sanitizeProvider",function(e){e.enableSvg(!0),e.addValidAttrs(["data-latex","data-non-image","controls"]),e.addValidElements(["use","video"])}]).run(["uiSelect2Config",function(e){e.formatResult=function(e){var t=o("<div></div>");t.addClass("select2-line-content"),t.attr("title",e.text).text(e.text);var r=o("<span></span>");return r.addClass("truncate-text"),r.tipsy({ellipsis:!0,gravity:o.fn.tipsy.autoBounds(37,"sw"),opacity:1,html:!0}),t.append(r),t},e.formatSelection=e=>"<div title ='".concat(e.text,"' class='select2-line-content'>").concat(i.escape(e.text),"</div>")}]).run(["$rootScope","$sce",function(e,t){e.$t=E.t.bind(E),e.$tc=E.tc.bind(E),e.$te=E.te.bind(E),e.$on("$routeChangeSuccess",(function(e,t){o(".tipsy").remove()})),e.isIE9=window.isIE9,e.lang=d,["en-US","en-GB"].includes(e.lang)?e.langForTca="en":["zh-TW","zh-MO"].includes(e.lang)?e.langForTca="zh-TW":e.langForTca=d,e.isEnglish=S.startsWith(d,"en"),e.canPreview=e=>!("LARK"!==e.source||!e.url)||["document","image","video","audio","scorm","evercam","swf","video-quiz","link","file","other"].includes(e.type),e.trustSrc=e=>t.trustAsResourceUrl(e),e.canShowResource=(e,t)=>t||!(null!=e&&e.audit_status)||"agree"===(null==e?void 0:e.audit_status),e.openChatRobot=()=>{var e=new CustomEvent("chat-robot:open");window.dispatchEvent(e)};var r=l().enableAiPpt;e.operateCount=0,e.enableAiPpt=r();e.$watch("operateMap",(t=>{if(t)for(var o in t)t[o]&&(e.operateCount+=1);var n;n=null,(r()||u())&&function t(){var o;if(null!==(o=document.querySelector("air-chatbot-app"))&&void 0!==o&&o.shadowRoot)clearInterval(n),u()&&(e.backToTopBottom=()=>{if(u())return"56px"}),r()&&u()&&e.operateCount>0&&(document.querySelector("air-chatbot-app").shadowRoot.querySelector(".bot-button").style.bottom="136px");else{if(n)return;n=setInterval((()=>{t()}),1e3)}}()})),e.operateCollection=t=>{switch(t){case"chatRobot":return void e.openChatRobot();case"feedback":return void e.openFeedbackWebApp();case"enableSobot":default:return}},e.openFeedbackWebApp=()=>{var e=JSON.stringify({orgUrl:document.location.href}),t=T.name+":"+T.version,r="WEB"+document.getElementsByTagName("html")[0].version;window.open("".concat("https://support.qq.com/product/288301","?clientVersion=").concat(r,"&os=").concat(t,"&customInfo=").concat(e))},e.canEditByPdfEditor=e=>!e.deleted&&S.canEditByPdfEditor(e),e.canEditByPdfEditorInHomework=e=>["document","image","audio","video","file"].includes(e.type),e.isIE9CannotUploadFile=()=>e.isIE9&&"QINIU"===e.storageType,e.fileTypeByExtension=S.fileTypeByExtension,e.wpsPreview=S.wpsPreview,e.privateWpsPreview=S.privateWpsPreview,e.aliyunOfficePreview=S.aliyunOfficePreview,e.showTranscodeUnreadyTips=S.showTranscodeUnreadyTips,Foundation.libs.reveal.settings.animation=null}]).run(["highlight",e=>n.element.prototype.highlight=e.highlight]).run(["$rootScope","$route","$location",function(e,t,r){e.openFileSelectModal=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n.element("body").injector().invoke(["fileSelectModel",t=>{var r=e.context,o=e.singleSelect;t.context=s(s({},t.context),r),void 0!==o&&(t.singleSelect=o)}]),o("#file-select").foundation("reveal","open")};var i=r.path;return r.path=function(o,n){if(!0===n&&!1===n)var a=t.current,s=e.$on("$locationChangeSuccess",(function(){return t.current=a,s()}));return i.apply(r,[o])}}]).name},402738:function(e,t,r){var o=r(730381);e.exports=["$scope",e=>{e.title="",e.message="",e.$watch("__accessForbidden",(t=>{if(t)return t.published?t.start_time&&o(t.start_time)>o()?(e.title=e.$t("activityPublish.accessForbiddenNotStarted"),void(e.message="<span>".concat(e.$t("activityPublish.accessForbiddenNotStartedTips",['<span style="color: var(--primary-brand-color)">'.concat(o(t.start_time).format("YYYY-MM-DD HH:mm"),"</span>")]),"</span>"))):t.end_time&&o(t.end_time)<=o()?(e.title=e.$t("activityPublish.accessForbiddenEnded"),void(e.message="<span>".concat(e.$t("activityPublish.accessForbiddenEndedTips",['<span style="color: var(--primary-brand-color)">'.concat(o(t.end_time).format("YYYY-MM-DD HH:mm"),"</span>")]),"</span>"))):void 0:(e.title=e.$t("activityPublish.activityUnpublished"),void(e.message="<span>".concat(e.$t("activityPublish.activityUnpublished"),"</span>")))}))}]},16578:function(e){e.exports=["$scope","$http","toastr","$timeout",function(e,t,r,o){return e.copiedCode=()=>o((()=>r.success(e.copiedSuccessfullyText))),e.fallbackToManuallyCopy=t=>window.prompt(e.copyFallbackText,t),e.resetAssociationCode=function(){return t.put("/api/user/association-code").success((function(t){return r.success(e.resetSuccessfullyText),e.associationCode=t.association_code})).error((()=>r.error(e.resetFailedText)))}}]},454169:function(e,t,r){var o=r(383228);e.exports=["$scope","$rootScope","$document",function(e,t,r){t.$on("attachment-delete-element",((t,r)=>{e.element=r})),e.confirm=()=>{e.element.remove();var t=new CustomEvent("after-delete-attachment");window.dispatchEvent(t),o("#attachment-delete-confirm").foundation("reveal","close")}}]},805802:function(e,t,r){var o=r(383228);e.exports=["$scope","$window",function(e,t){e.isSelect=!1,t.addEventListener("attachment-edit-id",(t=>{e.editId=t.detail.id})),e.confirm=()=>{if(e.isSelect){var t=JSON.parse(window.localStorage.getItem("attachment-tips"))||[];t.push(e.exam.id),window.localStorage.setItem("attachment-tips",JSON.stringify(t))}var r={id:e.editId},n=new CustomEvent("attachment-confirm",{detail:r});window.dispatchEvent(n),o("#attachment-warning").foundation("reveal","close")}}]},608632:function(e,t,r){var o=r(383228),n=r(293789),i=r(496486);r(556977),r(323123);var a=r(693604);e.exports=["$rootScope","$scope","$timeout","$http","$window",function(e,t,r,s,c){t.ui={isPlaying:!1,isMuting:!1,currentTimeStr:"00:00",durationStr:"00:00",maskWidth:0,sliderBarStartPosition:0,sliderWidth:0};var u={isSliding:!1,isOnAudioUpdate:!1,currentTime:0,duration:0,volume:60,seekingThreshold:0},l=function(e){t.ui.currentTimeStr=a.secondsToHms(e.currentTime),t.ui.durationStr=a.secondsToHms(e.duration),t.$apply();t.ui.currentTimeStr,t.ui.durationStr};t.deleteClass=function(){return o(".audio-wrapper .slider-bar").removeClass("has-warning"),o(".slider-tip-arrow").css("display","none"),!0};t.refreshPos=function(e){var r=o(".audio-wrapper .slider-bar");r.addClass("has-warning"),0==t.ui.sliderBarStartPosition&&(t.ui.sliderBarStartPosition=o(e.target).offset().left+15),0==t.ui.sliderWidth&&(t.ui.sliderWidth=o(e.target).width());var n=t.ui.sliderBarStartPosition,i=t.ui.sliderWidth,a=e.pageX-n;a<0&&r.removeClass("has-warning");var s=o(".audio-wrapper .audio")[0];s.duration&&d(s,i,a)};var d=function(r,n,i){var s,c,l,d=o(".slider-tip"),p=o(".slider-tip-arrow"),f=i-d.width()/2+7.5+"px",v=i+10+"px";if(i<function(t,r){var o=e.refuseForwardSeeking?u.seekingThreshold:t.duration;return r/t.duration*o}(r,n)){c={padding:"0  5px",top:"-5px"},s={display:"none"};var m=parseFloat(i/n*100).toFixed(1)/100*r.duration;t.currentTime=m,t.sliderTip=a.secondsToHms(m),t.enterSliderMask=!1}else c={padding:"12px",top:"-30px"},s={left:v,display:"block"},t.sliderTip="",t.enterSliderMask=!0;c.left=f,d.css(c),p.css(s),l=i,o(".slider-tip-line").css("left",l+15+"px")};t.downloadBlob=function(){var e=n.guard(null!=t.activity?t.activity.uploads:void 0,(e=>e[0]));if(e)return statistics.track({activity_type:"courseware",activity_id:t.activity.id,sub_type:e.name.split(".").pop(),sub_id:e.id,action:statistics.enums.CourseWareAction.download,mode:statistics.enums.Mode.normal,channel:statistics.enums.Channel.web})},t.togglePlay=function(e){var r=o(e.target).parents(".audio-wrapper").find("audio")[0];return t.ui.isPlaying?r.pause():r.play(),t.ui.isPlaying=!t.ui.isPlaying},t.toggleVolume=function(e){var r=o(e.target).parents(".audio-wrapper");t.ui.isMuting=!t.ui.isMuting,t.ui.isMuting?r.find(".volume-slider").slider({value:0}):r.find(".volume-slider").slider({value:u.volume})};var p=function(e){return u.seekingThreshold=Math.max(u.seekingThreshold,e.currentTime),f()},f=function(){var e=o(".audio-wrapper .audio")[0];if(!e||!e.duration)return 0;var r=parseFloat(u.seekingThreshold/e.duration).toFixed(4),n=o(".audio-wrapper .audio-slider").width();return t.ui.maskWidth=String((1-r)*n)};return t.init=function(){return o(".audio").each((function(n,s){var d,v,m;return e.refuseForwardSeeking&&(m=i.find(t.activitiesRead,{activity_type:"learning_activity",activity_id:t.activity.id}),u.seekingThreshold=function(e){if(e&&e.data&&e.data.ranges&&e.data.ranges.length>0)return e.data.ranges[e.data.ranges.length-1][1]}(m)||0,f()),function(e){var r=o(e).parent().find(".audio-slider");r.slider({step:Math.pow(10,-1),range:"max",value:0,min:0,max:100,slide:()=>u.isSliding=!0,start:()=>o(e).trigger("beforeSeeking",{timeBeforSeeking:e.currentTime}),change(){if(!u.isOnAudioUpdate){var t=r.slider("value");return e.currentTime=parseInt(t/100*e.duration)||0,u.isSliding=!1}},stop(){if(t.enterSliderMask){var o=parseFloat(100/e.duration*u.seekingThreshold).toFixed(1);return r.slider("value",o)}}});var n=o(e).parent().find(".volume-slider");n.slider({range:"max",value:u.volume,min:0,max:100,orientation:"vertical",change(){var r=n.slider("value");return t.ui.isMuting=!r>0,r>0&&(u.volume=r),((e,t)=>e.volume=t)(e,r/100)}})}(s),(t.pauseWhenLeavingWindow||null!==(d=t.activity)&&void 0!==d&&null!==(v=d.data)&&void 0!==v&&v.pause_when_leaving_window)&&c.addEventListener("blur",(function(){s&&(s.pause(),t.ui.isPlaying=!1)})),r((function(){!function(r){r.ontimeupdate=function(){if(!u.isSliding&&u.duration){u.isOnAudioUpdate=!0;var n=parseInt(100*r.currentTime/r.duration);return o(r).parent().find(".audio-slider").slider({value:n}),r.currentTime===r.duration&&(t.ui.isPlaying=!1),u.isOnAudioUpdate=!1,l(r),e.refuseForwardSeeking&&p(r),u.currentTime=r.currentTime}},r.ondurationchange=function(){return l(r),u.duration=r.duration},(t.activity&&!t.canGuestPreview||t.resource)&&a.enableTrack(t,o(r),t.activity,"audio",t.resource)}(s);var r=o(s).find("source").attr("src");return r&&sessionStorage.setItem("audioSrc",r),s.src=sessionStorage.getItem("audioSrc"),s.currentTime=t.lastPlayed||0,t.$parent.ui.player=s}))})),!1}}]},909382:function(e,t,r){var o=r(383228);e.exports=["$scope","$http",function(e,t){e.goChangePasswordPage=function(){return window.location.href="https://pwchange.mkc.edu.tw/"};t.get("/api/user/check-expired-password").success((function(e){!0===e.is_password_expired&&o("#change-password-tip-popup").foundation("reveal","open")})).error((function(){}))}]},646321:function(e,t,r){var o=r(383228);r(115306);var n=r(722085);n.config.set("basePath","/static/js/ace"),e.exports=["$rootScope","$scope","$timeout",function(e,t,r){var i=o("#code-editor");i.on("codeInit",((e,o)=>{r((function(){o.content&&t.editor.setValue(o.content,0),o.lang&&(t.mode=o.lang.replace("..",""),t.changeMode()),t.editor.focus()}))})),init=function(){t.editor=n.edit("editor"),t.modes=["javascript","python"],t.mode="javascript",t.editor.session.setMode("ace/mode/javascript"),t.editor.focus()},t.save=function(){var e,r;e=t.editor.getValue(),r={lang:t.mode,content:e},i.trigger("codeEdited",r),t.close()},t.close=function(){t.editor.setValue("",0),t.editor.destroy(),r((function(){i.foundation("reveal","close")}))},t.changeMode=function(){t.editor.session.setMode("ace/mode/".concat(t.mode))},init()}]},406177:function(e,t,r){var o=r(383228),n=r(496486);r(682772),r(788674),r(327852),r(132023);var i=r(887757);function a(e,t,r,o,n,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(o,n)}r(535666);var s=r(90963).default,c=r(693604),u=r(693604).Timer,l=r(751840).default,d=r(117403).default,p=r(72827).Z;e.exports=["$rootScope","$scope","$http","$window","$location","activityRepository","toastr","courseManagementApi",function(e,t,r,f,v,m,h,g){var y=o("#courseId").val();t.vueParam={courseCode:""},t.ui={hideCompleteness:!0},t.displayedName="",t.location="",t.teachingClasses="",t.enableEnterDingTalkChat=!1,t.showDingTalkChatButton=!1,t.dingTalkUserInfo={},t.shouldSync=!1,t.isShowMoodleImportButton=!1,t.isShowMoodleImportPopup=!1,t.isShowMoodleImportPopupFooter=!1,t.moodleImporterStatus=void 0,t.showReviewBtn=!1,t.vueMethods={isShowMoodleImportButton(e){t.isShowMoodleImportButton=e,t.$apply()},isShowMoodleImportPopupFooter(e){t.isShowMoodleImportPopupFooter=e,t.$apply()},moodleImporterStatus(e){t.moodleImporterStatus=e,t.$apply(),_()},updateImporterStatus(e){t.moodleImporterStatus=e,t.$apply()}},t.goBack=e=>{if(e.preventDefault(),t.isSimulatingVisitor)f.location.href="/";else{var r=f.localStorage.getItem("preVtrsPageURL");f.localStorage.removeItem("preVtrsPageURL"),r&&11==t.course.course_type?f.location.href=r:7==t.course.course_type?f.location.href="/user/studios":8==t.course.course_type?f.location.href="/user/project":f.location.href="/user/courses"}};var b=new u;t.checkRoleButton=function(e){r.put("/api/course/".concat(y,"/role"),{active:e}).success((()=>{f.location.reload()})).error((e=>{h.error(e.message)}))};t.managerReview=e=>{r.put("/api/course/".concat(y,"/manager/review"),{type:e}).success((r=>{h.success(d.t("courseManager.".concat(e,"Review"))),t.isUnreviewCourse=!t.isUnreviewCourse})).error((e=>h.warning(e.message)))};var w=function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.noop;r.get("/api/course/".concat(y,"/sync-status?status_key=").concat(e,"&no-loading-animation=true")).success(t).error(o)},_=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=function(r){0!==r.status&&(b.stop(),1===r.status&&e&&(h.success(t.$t("moodleCourseImport.importedSuccess1")),location.reload()))},o=()=>{b.stop()};b.start((function(){w("course_importer_status",r,o)}),3e3)},S=function(){var e,r=null===(e=t.course.course_attributes.data)||void 0===e?void 0:e.course_importer_status;void 0===r||2===r?t.isShowMoodleImportButton=!0:0===r&&_(),t.moodleImporterStatus=r},C=()=>f.location.href="/course/"+y+"/content";t.inviteUsers=()=>e.invitingCourseUsers=!0,t.addNewModule=function(){return c.endsWith(v.absUrl(),"/content#/")?e.$emit("$addNewModule"):f.location.href="/course/".concat(y,"/content")},t.previewCourse=()=>r.put("/api/courses/".concat(y,"/preview")).success(C).error((function(){})),t.enterClassmode=function(e){return l({action:"inclass.enter",course_id:e}),r.post("/api/course/".concat(e,"/inclass-report")).success((()=>{})).error((()=>{})),window.open("/inclass/courses/".concat(e)),!1},t.validateLiteCourseConditions=function(e){r.get("/api/courses/".concat(e,"/validate-lite-course-condition")).success((function(){o("#switch-lite-course").foundation("reveal","open")})).error((function(e){t.ui.disableLiteCourse=!0,o("#switch-lite-course").foundation("reveal","open")}))},t.switchToLiteCourse=function(e){r.put("/api/courses/".concat(e,"/switch-lite")).success(C).error((function(e){if(e.message)return h.warning(e.message)}))},t.switchToNormalCourse=function(e){r.put("/api/courses/".concat(e,"/switch-normal")).success(C).error((function(){}))},t.cancelPreview=()=>r.delete("/api/courses/".concat(y,"/preview")).success(C).error((function(){})),t.cancelInspect=function(){return C=function(e){return window.opener?f.close():f.location.href=e.refer||"/management/course#/"},r.delete("/api/courses/".concat(y,"/inspect")).success(C).error((function(){}))},t.displayTeacherPortfolio=function(e){e.portfolio_url&&f.open(e.portfolio_url,"_blank")},t.hasKlassInfo=function(){if(!e.course)return!1;var r=e.course,o=r.academic_year?r.academic_year.name:null,i=r.semester?r.semester:null,a=r.department?r.department.name:null,s=r.grade?r.grade.name:null,c=r.klass?r.klass.name:null,u=r.subject_code?"("+r.subject_code+")":null,l=r.course_attributes?r.course_attributes.teaching_class_name:null;return t.message=n.compact([l,o,i,a,s,c,u]).join(" "),Boolean(o||i||a||s||c||u)};var x=function(){var e,o=(e=i.mark((function e(){var o,a,s;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.get("/api/ding-talk/user-id");case 3:return o=e.sent,t.dingTalkUserInfo=o?o.data:{},e.next=7,r.get("/api/ding-talk/chat?course_id=".concat(y));case 7:a=e.sent,s=n.isEmpty(a.data)?[]:a.data.useridlist,t.enableEnterDingTalkChat=!!(s.length>0&&t.dingTalkUserInfo.dingtalk_user_id)&&!s.includes(t.dingTalkUserInfo.dingtalk_user_id),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.error(e.t0);case 15:return e.prev=15,t.showDingTalkChatButton=!0,e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[0,12,15,18]])})),function(){var t=this,r=arguments;return new Promise((function(o,n){var i=e.apply(t,r);function s(e){a(i,o,n,s,c,"next",e)}function c(e){a(i,o,n,s,c,"throw",e)}s(void 0)}))});return function(){return o.apply(this,arguments)}}();t.enterDingtalkChat=function(){t.enableEnterDingTalkChat&&r.put("/api/ding-talk/chat?course_id=".concat(y),{users_2_add:[t.dingTalkUserInfo.dingtalk_user_id]}).then((()=>{t.enableEnterDingTalkChat=!1}))},t.showCourseImport=function(){0!==t.moodleImporterStatus&&(o("#moodle-course-import-popup").foundation("reveal","open"),t.isShowMoodleImportPopup=!0)},t.showCourseImportFromList=function(){s(p)},t.closeCourseImportPopup=function(){o("#moodle-course-import-popup").foundation("reveal","close"),t.isShowMoodleImportPopup=!1,t.isShowMoodleImportPopupFooter=!1},t.confirmTeachingMode=function(){r.post("/api/course/".concat(y,"/record-user-reads"),{type:"course_teaching_mode_update"})},t.publishCourse=function(){o("#course-publish-popup").hasClass("open")||o("#course-publish-popup").foundation("reveal","open")},t.confirmPublish=e=>{t.updateCoursePublishStatus(e),o("#course-publish-popup").foundation("reveal","close")},t.updateCoursePublishStatus=function(e){return g.updateCoursePublishStatus(e.id,!e.course_attributes.published,(function(){f.location.reload()}),(function(e){return h.error(e.errors.published[0])}))};var k=function(){return g.getCourseCanUnPublished(t.course.id,(function(e){t.courseCanUnpublished=e.can_unpublished}),(()=>{}))};m.initCourseInfo(y).then((function(r){var i,a,s;e.course=r,t.course=r,t.isUnreviewCourse=null===(i=r.course_attributes.data)||void 0===i||!i.review_status||"unreviewed"===(null===(a=r.course_attributes.data)||void 0===a?void 0:a.review_status),t.showReviewBtn=!0,t.displayedName=r.display_name,window.globalData.courseRoles.includes("student")||_(!1),t.courseNeedPublish=null===(s=f.featureToggles)||void 0===s?void 0:s.courseNeedPublish;var c,u="True"===o("#enrollmentIsInstructor").val();t.courseNeedPublish&&u&&(k(),t.coursePublished=null===(c=r.course_attributes)||void 0===c?void 0:c.published),"SHTVU"===t.deliveryOrg&&m.initCourseTimeTable(t.course.id).then((function(e){m.setTimeTableProperty(t.course,e)})),["ZJU","ZUCC"].indexOf(t.deliveryOrg)>-1&&t.isSimulatingInstructor&&x();var l="checkpoint"===r.learning_mode?"True":"False";o("#is-course-in-checkpoint-mode").val(l),t.vueParam.courseCode=r.course_code,S(),r.instructorNames=n.map(r.instructors,"name").join(" / ")}))}]},581986:function(e,t,r){var o=r(496486),n=r(383228);e.exports=["$rootScope","$scope","navSettingRepository","$timeout",function(e,t,r,i){var a;t.ui={inMateriaList:!1,showMateriaList:!1,inGroupList:!1,showGroupList:!1},t.courseNeedPublish=null===(a=window.featureToggles)||void 0===a?void 0:a.courseNeedPublish,t.isXjtuKnowledgeForestMode=window.orgSettings.isXjtuKnowledgeForestMode,t.hasMenu=e=>o.some(t.courseMenus,{type:e,disabled:!1}),t.showMaterialList=function(){return n(".course-menu-material .dropdown").focus(),t.ui.showMateriaList=!0},t.hideMaterialList=function(){if(!t.ui.inMateriaList)return t.ui.showMateriaList=!1},t.showGroupList=function(){return n(".course-menu-group .dropdown").focus(),t.ui.showGroupList=!0},t.hideGroupList=function(){if(!t.ui.inGroupList)return t.ui.showGroupList=!1},t.inviteUsers=()=>e.invitingCourseUsers=!0,t.findEnabledItemOfParent=function(e){return-1!=o.findIndex(t.courseMenus,{parent:e,disabled:!1,can_disabled:!0})},t.findEnabledItemByType=e=>t.courseMenus.some((function(t){if(t.type===e)return!t.disabled}));var s;return s=n("#courseId").val(),r.initNavSetting(s).then((function(r){return t.courseMenus=r.nav_setting,t.$emit("fetchCourseNavSetting",r),i((()=>e.$emit("initCourseMenuFinished")),300)}))}]},108300:function(e,t,r){var o=r(496486),n=r(383228);r(788674),r(132023);var i=r(887757);function a(e,t,r,o,n,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(o,n)}r(535666),e.exports=["$rootScope","$scope","revealModalParams","$http","$interval","$timeout","toastr","$window","$document",function(e,t,r,s,c,u,l,d,p){t.isTimeCollapsed=!0,t.isError=!1,t.inputCode=null;var f=null;t.countDown=60;e.urlPrefix="";var v=function(){return d.location.pathname.includes("/management/")},m=function(){var r,i={};(e.urlPrefix||(e.urlPrefix=v()?"management":"score"),"score"===e.urlPrefix)?(i.unique_id=null===(r=t.course)||void 0===r?void 0:r.id,i.unique_id_type="course"):(i.unique_id=o.parseInt(n("#userId").data("id")),i.unique_id_type="user");return i},h=function(){t.isTimeCollapsed=!t.isTimeCollapsed};t.sendCode=function(){h(),params=m(),s.post("/api/auth_code/get_auth_code",params).then((()=>{}),(function(e){return l.error(e.errors)})),f=c((()=>{--t.countDown}),1e3),u((()=>{c.cancel(f),t.countDown=60,h()}),6e4)},t.validateAndRedirect=function(r){var o=()=>{t.isError=!0};return r&&6===r.length||o(),params=m(),params.user_input_auth_code=r,s.post("/api/auth_code/validate_auth_code",params).then((function(){return t.isError=!1,n("#dingtalk-validate-popup").foundation("reveal","close"),"score"===e.urlPrefix?d.location.href="score":d.location.href="/management/"}),o)};var g=function(){return params=m(),s.get("/api/auth_code/auth_validate",{params:params}).then((function(t){e.dingtalkAuthValidate=t.data.dingtalk_auth_validate,e.dingtalkAuthValidate||!v()||n("#dingtalk-validate-popup").hasClass("open")||e.openValidatePopup("management")}))};t.enableDingtalkValidate&&v()&&!n("#dingtalk-validate-popup").hasClass("open")&&g(),p.on("close.fndtn.reveal","#dingtalk-validate-popup",(function(){!e.dingtalkAuthValidate&&v()&&(d.location.href="/user/index")})),e.openValidatePopup=function(){var t,r=(t=i.mark((function t(r){return i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.urlPrefix=r,t.next=3,g();case 3:if(e.dingtalkAuthValidate){t.next=7;break}n("#dingtalk-validate-popup").foundation("reveal","open"),t.next=12;break;case 7:if("score"!==e.urlPrefix){t.next=11;break}return t.abrupt("return",d.location.href="score");case 11:return t.abrupt("return",d.location.href="/management/");case 12:case"end":return t.stop()}}),t)})),function(){var e=this,r=arguments;return new Promise((function(o,n){var i=t.apply(e,r);function s(e){a(i,o,n,s,c,"next",e)}function c(e){a(i,o,n,s,c,"throw",e)}s(void 0)}))});return function(e){return r.apply(this,arguments)}}()}]},66129:function(e,t,r){var o=r(383228),n=r(693604);e.exports=["$rootScope","$scope",function(e,t){var r=o("#embed-video-popup");init=function(){t.orginalUrl="",t.embedUrl="",t.errors={}},t.checkUrl=function(){n.isSupportedOnlineVideoLink(t.orginalUrl)?t.errors={}:t.errors.orginalUrl=!0};t.save=function(){var e;t.checkUrl(),n.isSupportedOnlineVideoLink(t.orginalUrl)&&(t.embedUrl=n.parseOnlineVideoUrl(t.orginalUrl),e={url:t.embedUrl},r.trigger("urlEntered",e),t.close())},t.close=function(){r.foundation("reveal","close")},init()}]},211376:function(e,t,r){var o=r(383228);function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r(66992),r(864765),r(454747),r(333948);var s=r(180736);e.exports=["$rootScope","$scope","$http",function(e,t,r){var n=s(t);t.close=()=>{o("#entries-select").foundation("reveal","close")},t.searching=!1,t.isSelectAll=!1,t.keyword="",t.save=()=>{e.$broadcast("selectEntry"),t.close()};var a=r=>{var o=r.data.result,a=o.entries.map((e=>{var t,r,o=e.keywords?e.keywords.map((e=>e.name)).join(" ; "):"";return i(i({},e),{},{keywordsStr:o,fileCount:null!==(t=null===(r=e.uploads)||void 0===r?void 0:r.length)&&void 0!==t?t:0,selected:!1})}));t.pagination={currentList:a,currentPage:o.page,totalPage:o.pages,inputPage:o.page},e.entries=t.pagination.currentList,n.hide()};t.openEntryPopup=()=>{e.$broadcast("openEntryContentPopup")};var c="id,org_id,name,created_at,updated_at,created_by_id,updated_by_id,keywords(name),uploads(id)",u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{reverse:!0},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c;return n.show(!0),r.get("/api/entries",{params:{fields:o,page:t,conditions:e}}).then(a)};t.search=()=>{u({keyword:t.keyword,reverse:!0})},t.selectAll=()=>{t.isSelectAll?t.pagination.currentList.forEach((e=>{e.selected=!0})):t.pagination.currentList.forEach((e=>{e.selected=!1}))},t.changeEntrySelectStatus=()=>{var e=t.pagination.currentList.every((e=>e.selected));t.isSelectAll=e},t.changePage=e=>{n.show(!0),u({keyword:t.keywords,reverse:!0},e)},t.$on("reloadEntriesList",(()=>{u().then((()=>{t.pagination.currentList[0].selected=!0}))})),u()}]},389465:function(e,t,r){var o=r(293789),n=r(496486),i=r(383228),a=r(895523),s=r(693604);e.exports=["$rootScope","$scope","$http","$timeout",function(e,t,r,c){var u;t.statChart=null,s.fixMultiModalOverlay("#file-hypothesis-stat-popup"),e.$on("openHypothesisStat",(function(e,r,o){return t.activity=o,t.upload=r,u()}));var l=function(){t.ui.noStatData=!0},d=function(){var e={uri:"urn:tronclass:upload:".concat(t.pdfFileKey),source:"course",sort:"created",group:"__world__",course_id:i("#courseId").val(),enrollment_role:"student",token:t.noteBeneToken},s="".concat(t.noteBeneUrl,"/api/statistic");return r.get(s,{params:e}).success((function(e){var r=o.range(1,t.numPages,!0);return t.statSeries=n.map(r,(t=>o.guard(n.find(e.positions,(e=>Number(e.position)===t)),(e=>e.count))||0)),((e,r)=>c((()=>t.statChart=a.drawLineChart(e,r,t.chartMessage))))(r,{statSeries:t.statSeries})})).error(l)};return u=function(){return t.statChart&&a.clearChart(t.statChart),t.ui={noStatData:!1},t.numPages=null,t.pdfFileKey=null,t.statSeries=[],function(){var e="/api/uploads/reference/document/".concat(t.upload.reference_id,"/pdf-info-for-stat?preview=true");r.get(e).success((function(e){return t.numPages=parseInt(e.num_pages||0),t.statSeries=n.range(0,t.numPages,0),t.pdfFileKey=e.file_key,d()})).error(l)}()}}]},86434:function(e,t,r){var o=r(383228);r(682772),r(66992),r(747042),r(569720),r(838559),r(788674),r(339714),r(132023),r(115306),r(323123),r(333948),r(560285);var n=r(887757);function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],o=!0,n=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(o=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);o=!0);}catch(e){n=!0,i=e}finally{try{o||null==s.return||s.return()}finally{if(n)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function s(e,t,r,o,n,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(o,n)}function c(e){return function(){var t=this,r=arguments;return new Promise((function(o,n){var i=e.apply(t,r);function a(e){s(i,o,n,a,c,"next",e)}function c(e){s(i,o,n,a,c,"throw",e)}a(void 0)}))}}r(535666);var u=r(881063),l=r(693604),d=(r(9075),r(496486)),p=r(117403).default,f=r(90963).default,v=r(832910).Z,m=(r(681423).Z,r(631342)),h=m.getSelfSubmissions,g=m.getCurrentUserAirToken,y=m.getCurrentUserCredits;e.exports=["$rootScope","$scope","$http","toastr","$sce","$timeout","$window","statHelper","scormUtils",function(e,t,a,s,m,b,w,_,S){var C,x,k,P;l.fixMultiModalOverlay("#file-previewer"),l.fixMultiModalOverlay("#file-previewer-with-note"),t.fileExtension=l.fileExtension,t.trustAsResourceUrl=m.trustAsResourceUrl,t.ui={urlLoaded:!1,fullScreen:!1,ytplayer:null,checkTimerId:null,videoStartFrom:0,loggerOffline:!1,showQuestionPanel:!1,showQuestionPanelBtn:!1,showAiQuizPanel:!1,showAiQuizPanelBtn:!1,commentsCount:0,showAnswerPrompt:!1},t.courseId=null===(C=window.globalData)||void 0===C||null===(x=C.course)||void 0===x?void 0:x.id,t.isSimulatingInstructor=(null===(k=window.globalData)||void 0===k||null===(P=k.course)||void 0===P?void 0:P.isSimulatingInstructor)||!1;var E=0,T=0,M=1,A=0,F=function(){M=1,A=0,E=0,T=0};t.clearActivity=function(){delete t.activity};var I=function(){var e="scale(".concat(M,") rotate(").concat(A,"deg)");return{"-webkit-transform":e,"-moz-transform":e,"-ms-transform":e,"-o-transform":e,transform:e,margin:"".concat(T,"px 0 0 ").concat(E,"px")}};t.hasFlashPlayer=!0,t.isWebkitBrowser=/webkit/i.test(navigator.userAgent),t.isFirefoxBrowser=/firefox/i.test(navigator.userAgent);var $=["doc","docx","xls","xlsx","ppt","pptx","uof","uot","uos","uop","ofd"];t.viewMode={mode:"normal",enablePreviewMode:function(e){var r,o=e&&(null===(r=window.featureToggles)||void 0===r?void 0:r.yz_office_preview)&&"document"===e.type&&$.includes(l.fileExtension(e.name||e.file_name||"",!0));return o||(t.viewMode.mode="normal"),o}},t.apiPrefix=t.isVisitor?"anonymous-api":"api";var U=function(){if(t.ui.showQuestionPanelBtn=!1,t.activity&&t.activity.id&&"material"===t.activity.type&&t.activity.id){var e,r,o=l.fileExtension(t.upload.name);if(["doc","docx","ppt","pptx","xls","xlsx","pdf","csv"].includes(o))t.ui.showQuestionPanelBtn=!0,t.isVisitor||(e=t.activity.id,r={referrer_id:t.upload.reference_id,referrer_type:"upload_reference",type:"question"},a.get("/api/activities/".concat(e,"/comment/count?conditions=").concat(JSON.stringify(r))).success((e=>{t.ui.commentsCount=e.question||0})).error(s.decorateError()));else t.ui.showQuestionPanel=!1}},O=function(){return t.ui.urlLoaded=!0,function(){if(t.ui.showAiQuizPanelBtn=!1,t.activity&&t.activity.id&&"material"===t.activity.type&&t.activity.id){var e=l.fileExtension(t.upload.name);["doc","docx","ppt","pptx","xls","xlsx","pdf"].includes(e)?t.ui.showAiQuizPanelBtn=!0:t.ui.showAiQuizPanelBtn=!1}}(),U(),b((()=>N()))};t.uploadCanAddNote=function(e){if(e)return["image","video"].includes(e.type)||"document"===e.type&&!e.isTextFile};var R=function(e){var r;if(r=t.canGuestPreview&&t.isVisitor&&(null!=t.activity?t.activity.id:void 0)?"/anonymous-api/".concat(t.activity.id,"/uploads/").concat(e.id,"/text?preview=true"):t.resourceId?"/".concat(t.apiPrefix,"/shared-resources/").concat(t.resourceId,"/text"):"/api/uploads/".concat(e.id,"/text?preview=true"),!e.textContent)return a.get(r).success((t=>e.textContent=t)).error(s.decorateError())},B=null;o(document).on("closed.fndtn.reveal",(()=>{"function"==typeof B&&B(),W=!1,t.ui.showQuestionPanel=!1,t.focusInputCount=0,t.$broadcast("previewFileCloseEvent",t.upload)}));var L;(L=document.getElementsByTagName("prompt-modal")[0])&&L.addEventListener("confirm",(()=>{t.showAiQuizPanel(),t.$apply()}));var j=function(){var e=c(n.mark((function e(r){var o,i,a,s,c,u,l;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isInstructorView&&null!==(o=window.featureToggles)&&void 0!==o&&o.airDocQuiz&&null!==(i=r.aiQuiz)&&void 0!==i&&i.id){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,h(null===(a=r.aiQuiz)||void 0===a?void 0:a.id);case 4:if(u=e.sent,l=!(null===(s=u.submission)||void 0===s||!s.id),t.ui.showAnswerPrompt=!l&&!H(null===(c=r.aiQuiz)||void 0===c?void 0:c.id),!l){e.next=9;break}return e.abrupt("return");case 9:b((()=>{var e=document.getElementById("pdf-viewer");if(e){var r=()=>{var r=e.contentDocument||e.contentWindow.document;if(r){var o=r.querySelector("#viewerContainer");o&&(o.scrollTop=0,o.addEventListener("scroll",(function(){t.ui.showAiQuizPanel||o.scrollTop+o.clientHeight>=o.scrollHeight&&!l&&document.querySelector("prompt-modal").getVueInstance().open()})))}};r(),e.addEventListener("load",(function(){var t=e.contentDocument||e.contentWindow.document;t&&t.addEventListener("pagerendered",r)}))}}),100);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),z=function(){t.isOrgArrears=!1,t.ui.showAiQuizPanel=!1;var r=t.upload;if(!r)return s.error(p.t("lark.errorMsg.notFound")),void l.closePopup("file-previewer");!function(){var e=t.upload;if(e){t.uploadStatus=l.setUploadFeature(e);var r="material";t.activity&&"tencent_meeting"===t.activity.type&&(r="tencent_meeting"),B=()=>statistics.track({activity_type:r,activity_id:null!=t.activity?t.activity.id:void 0,sub_type:e.name.includes(".")?e.name.split(".").pop():e.name,sub_id:e.id,action:statistics.enums.CourseWareAction.close,mode:statistics.enums.Mode.normal,channel:statistics.enums.Channel.web}),statistics.track({activity_type:r,activity_id:null!=t.activity?t.activity.id:void 0,sub_type:e.name.includes(".")?e.name.split(".").pop():e.name,sub_id:e.id,action:statistics.enums.CourseWareAction.open,mode:statistics.enums.Mode.normal,channel:statistics.enums.Channel.web})}}(),F();var n,c,f=e=>(t.resourceId&&(symbol=-1===e.indexOf("?")?"?":"&",e="".concat(e).concat(symbol,"resource_group_id=").concat(t.resource.group.id)),e),v=e=>{var o=l.getDownloadRefer(t.activity,r),n=new URLSearchParams(o).toString(),i=-1===e.indexOf("?")?"?":"&";return n?e+i+n:e},m=function(e){var r=w(e);r=f(r),e.video_urls=void 0;return a.get(r).success((function(r){var o;O(),e.status=r.status,e.videos=r.videos,e.video_src_type=r.video_src_type,e.orgCode=r.orgCode,t.resourceId?e.video_urls=u.getUrls(e,t.apiPrefix,t.resourceId):(e.isSimulatingInstructor=t.isSimulatingInstructor,e.video_urls=(o=u.getUrls(e,t.apiPrefix),Object.fromEntries(Object.entries(o).map((e=>{var t=i(e,2),r=t[0],o=t[1];return[r,v(o)]})))))})).error(s.decorateError((function(e){})))},h=function(){return t.swfLoaded=function(){t.ui.swfLoading=!1,o("#swf-object param").length<=0&&(t.hasFlashPlayer=!1)},t.ui.swfLoading=!0,O()},g=function(e){var r=w(e);return r=f(r),a.get(r).success((function(r){if(O(),e.status=r.status,"ready"===r.status&&r.scorm.data){var o=r.scorm.id;return t.scormId=o,t.scormManifest=r.scorm.data.manifest,t.resourceId?S.bindItemResources(o,t.scormManifest.organizations.organization.item,t.scormManifest.resources.resource,t.apiPrefix,t.resourceId):S.bindItemResources(o,t.scormManifest.organizations.organization.item,t.scormManifest.resources.resource),b((()=>t.viewScorm(S.getFirstScoItem(t.scormManifest.organizations.organization.item))))}return t.error={status_code:r.scorm.status_code,message:r.scorm.message}})).error(s.decorateError((function(){})))},y=()=>{var e="preview=true";return t.resource&&t.resource.share_to_id&&(e+="&refer_id=".concat(t.resource.id,"&refer_type=shared_resource")),e},w=function(e){return t.canGuestPreview&&t.isVisitor&&(null!=t.activity?t.activity.id:void 0)?"/anonymous-api/".concat(t.activity.id,"/uploads/").concat(e.id,"?preview=true"):(t.resourceId?url="/".concat(t.apiPrefix,"/shared-resources/").concat(t.resourceId,"/uploads"):url="/api/uploads/".concat(e.id,"?").concat(y()),v(f(url)))},_=function(n){var i;(t.isOrgArrears=n.is_org_transfer_arrears,t.isOrgArrears)?t.ui.urlLoaded=!0:"video"===r.type?m(r):"audio"===r.type?function(e){var r=w(e);r=f(r),delete t.audioUrl,a.get(r).success((function(r){O(),e.status=r.status,r.audio&&r.audio.id&&(t.canGuestPreview&&t.isVisitor&&(null!=t.activity?t.activity.id:void 0)?t.audioUrl="/anonymous-api/".concat(t.activity.id,"/uploads/audio/").concat(r.audio.id,"?preview=true"):t.resourceId?t.audioUrl="/".concat(t.apiPrefix,"/shared-resources/").concat(t.resourceId,"/audios"):t.audioUrl=v("/api/uploads/audio/".concat(r.audio.id,"?preview=true")))})).error(s.decorateError((function(e){})))}(r):"swf"===r.type?h():"document"===r.type?function(e){var r,o,n,i,c,u,d;e.reference_id?(u="/reference",c=e.reference_id):(u="",c=e.id);var p=l.wpsPreview(e),m=l.ofdPreview(e),h=(!["exam","homework"].includes(null===(r=t.activity)||void 0===r?void 0:r.type)||t.activity&&-1!==(null===(o=t.activity.uploads)||void 0===o?void 0:o.find((t=>t.id===e.id))))&&l.privateWpsPreview(e),g=(!["exam","homework"].includes(null===(n=t.activity)||void 0===n?void 0:n.type)||t.activity&&-1!==(null===(i=t.activity.uploads)||void 0===i?void 0:i.find((t=>t.id===e.id))))&&l.aliyunOfficePreview(e);d=t.canGuestPreview&&t.isVisitor&&(null!=t.activity?t.activity.id:void 0)?"/anonymous-api/".concat(t.activity.id,"/uploads").concat(u,"/document/").concat(c,"/url?preview=true"):g?"/api/uploads/".concat(e.id,"/preview/aliyun?preview=true"):p?"/api/uploads/".concat(e.id,"/preview/wps?preview=true"):h?"/api/uploads/".concat(e.id,"/preview/private-wps?preview=true"):t.resourceId?"/".concat(t.apiPrefix,"/shared-resources/").concat(t.resourceId,"/documents"):"/api/uploads".concat(u,"/document/").concat(c,"/url?").concat(y()),d=f(v(d)),a.get(d).success((function(r){var o;if(O(),!p&&!h){if(g)return d="/note-bene/aliyun-office-viewer?preview=true&upload_id=".concat(e.id,"&edit=").concat(t.aliyunOfficeEdit),e.documentUrl=f(d),void(e.status="ready");var n=encodeURIComponent(r.url);return m?(d="/note-bene/ofd-viewer?file=".concat(n,"&upload_id=").concat(e.id),e.documentUrl=f(d),void(e.status="ready")):(e.status=r.status,e.downloadUrl=f(r.url),o=t.canGuestPreview&&t.isVisitor&&(null!=t.activity?t.activity.id:void 0)?"/anonymous-api/".concat(t.activity.id,"/uploads/pdf-viewer"):t.resourceId?"/".concat(t.apiPrefix,"/shared-resources/").concat(t.resourceId,"/pdf-viewer"):"/note-bene/pdf-viewer",d="".concat(o,"?file=").concat(n,"&upload_id=").concat(e.id,"&is_attachment_view=").concat(t.isAttachment),e.documentUrl=f(d),j(e),"txt"===l.fileExtension(e.name,!0)?(e.isTextFile=!0,R(e)):void 0)}var i=r.preview_url;e.documentUrl=f(i)})).error(s.decorateError((function(e){})))}(r):"scorm"===r.type?g(r):"evercam"===r.type?function(e){var r,n=w();n=f(n),a.get(n).success((function(n){return O(),e.status=n.status,"ready"===n.status&&"evercam"===n.type?(r=t.resourceId?"/".concat(t.apiPrefix,"/shared-resources/").concat(t.resourceId,"/evercams"):"/api/uploads/embed-material/".concat(e.id),b((()=>{o(".file-previewer #".concat(e.type,"-viewer")).attr("src",r)}))):t.error={status_code:n.status_code||n.status,message:n.message}})).error(s.decorateError((function(){})))}(r):"lesson-resource"===r.type?function(r){var o=r.id;G({width:"100%",height:"calc(100%-50px)"},!1);var n=e.fromPage||"",i="/api/resource-file/".concat(o,"/player-url?from_page=").concat(n);i=f(i),a.get(i).success((function(r){d.includes(r.url,"?")?t.lesson_resource_url="".concat(r.url,"&lang=").concat(e.langForTca):t.lesson_resource_url="".concat(r.url,"?lang=").concat(e.langForTca)})).error((e=>s.error(e.message)))}(r):"capture"===r.type?(i=r,G({width:"100%",height:"calc(100%-50px)"},!1),a.get("/api/captures/".concat(i.code,"/player-url")).success((function(r){d.includes(r.url,"?")?t.capture_url="".concat(r.url,"&lang=").concat(e.langForTca):t.capture_url="".concat(r.url,"?lang=").concat(e.langForTca)})).error((e=>s.error(e.message)))):"link"===r.type&&"youtube"===r.link.type?O():function(e){var t=f(w(e));a.get(t).success((function(t){O(),e.status=t.status})).error(s.decorateError((function(e){})))}(r)};return r.third_part_referrer_id&&!r.source?function(e){var r=w(e);return r=f(r),"video"===e.type?(e.video_urls={},a.get(r).success((function(t){O(),e.status=t.status,e.video_urls=t.video_urls})).error(s.decorateError((function(){})))):"audio"===e.type?a.get(r).success((function(r){O(),e.status=r.status,t.audioUrl=r.audio_url})).error(s.decorateError((function(){}))):"swf"===e.type?h():"document"===e.type?a.get(r).success((function(t){O(),e.status=t.status,e.downloadUrl=t.document_url;var r=encodeURIComponent(t.document_url);if(e.documentUrl="".concat(pdfViewer,"?file=").concat(r,"&upload_id=").concat(e.id),"txt"===l.fileExtension(e.name,!0))return e.isTextFile=!0,R(e)})):"scorm"===e.type?g(e):O()}(r):"SHTVU"===r.source?function(e){t.isOrgArrears=!1,t.ui.urlLoaded=!0,"video"===e.type?(e.video_urls={QVGA:e.url+"/360p.mp4",VGA:e.url+"/480p.mp4",HD:e.url+"/720p.mp4"},e.video_src_type="video/mp4"):"audio"===e.type?t.audioUrl=e.url+"/file.mp3":"document"===e.type?e.documentUrl=e.url+"/"+function(e){var t=e.split("/");return(t=t[t.length-1].split("."))[0].replace("a@","")}(e.url)+".PDF":"image"===e.type&&(e.imageUrl=e.url+"/preview.jpg")}(r):"RMS"===r.source?function(e){t.isOrgArrears=!1,t.ui.urlLoaded=!0;var r="/api/uploads/".concat(e.id,"/rms-preview");"video"===e.type?(a.get("/api/uploads/".concat(e.id,"/rms-video-urls")).success((t=>{Object.keys(t).length>0&&(e.video_urls=Object.fromEntries(Object.entries(t).map((e=>{var t=i(e,2),r=t[0],o=t[1];return[r.toUpperCase(),o]}))))})),e.video_src_type="video/mp4"):"audio"===e.type?t.audioUrl=f(r):"document"===e.type?(r="/note-bene/pdf-viewer?file=".concat(r),e.documentUrl=f(r)):"image"===e.type&&(e.imageUrl=f(r))}(r):"video-quiz"===t.previewType(r.type)?(t.videoQuizId=r.id,n=t.videoQuizId,c=_,a.get("/api/video-quizzes/org/arrears/".concat(n,"?no-intercept=true")).success(c).error(s.decorateError())):"lesson-resource"===t.previewType(r.type)?((e,t)=>a.get("/api/resource-file/org/arrears/".concat(e,"?no-intercept=true")).success(t).error(s.decorateError()))(r.id,_):"capture"===t.previewType(r.type)?_({is_org_transfer_arrears:!1}):r.id?((e,r)=>a.get("/".concat(t.apiPrefix,"/uploads/org/arrears/").concat(e,"?no-intercept=true")).success(r).error(s.decorateError()))(r.id,_):(t.isOrgArrears=!1,t.ui.urlLoaded=!0,r.videos=[r],void(r.video_urls={ORIGINAL:r.video_url+"?preview=true"}))};t.enterHTML5FullScreen=function(e){return e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():void 0};var D=()=>t.isFirefoxBrowser||t.isWebkitBrowser,V=()=>{var e=o(".img-container"),t=o(".img-container > img");if(e.length&&t.length){var r=e.slice(-1)[0].getBoundingClientRect(),n=t.slice(-1)[0].getBoundingClientRect();E=Math.max(Math.ceil(n.width-r.width),0),T=Math.max(Math.ceil(n.height-r.height)/2,0),t.css(I()),D()&&t.hide().show(0)}};t.zoomOut=function(e){e=e||o(".img-container > img"),M=Math.max(M-.2,.2),e.css(I()),D()&&e.hide().show(0),V()},t.reset=function(){return t.uploads&&t.uploads.length>0&&o(document).off("keydown"),delete t.upload},t.zoomIn=function(e){e=e||o(".img-container > img"),M=Math.min(M+.2,5),e.css(I()),D()&&e.hide().show(0),V()},t.rotateImg=function(e){e=e||o(".img-container > img"),A=Math.floor((A-90)%360),e.css(I()),D()&&e.hide().show(0),V()},t.restoreImg=function(e){e=e||o(".img-container > img"),F(),e.css(I()),D()&&e.hide().show(0)},t.enterFullScreen=function(e){return t.ui.fullScreen=!0,e=e||"#file-previewer .reader-wrapper .reader-wrapper",t.enterHTML5FullScreen(o(e).get(0))},t.exitFullScreen=function(){return document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen(),t.ui.fullScreen=!1},t.viewScorm=function(){var e=c(n.mark((function e(t){return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.API&&window.API.resetCmi(),o(".file-previewer #scorm-viewer").attr("src",t.scormUrl);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var N=function(){var e=function(){if(!(document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen||document.msFullScreenElement))return t.ui.fullScreen=!1,t.$apply()};if(document.addEventListener)return document.addEventListener("webkitfullscreenchange",e,!1),document.addEventListener("mozfullscreenchange",e,!1),document.addEventListener("fullscreenchange",e,!1),document.addEventListener("MSFullscreenChange",e,!1)};e.$on("previewFile",(function(r,n,i){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(t.fileAddNote||1!==o("#file-previewer-with-note").length)&&(t.upload=n,t.activity=i,t.aliyunOfficeEdit=a,t.lesson_resource_url=null,delete t.uploads,z(),e.$broadcast("pdfEditor:loading",!1))})),window.parent.postMessage("previewFileReady","*"),e.$on("previewResourceReference",(function(e,r){if(t.fileAddNote||1!==o("#file-previewer-with-note").length)return t.upload=r.upload,t.lesson_resource_url=null,t.resource=r,t.resourceId=r.id,delete t.uploads,z()})),e.$on("previewFiles",(function(e,r,n,i){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],c=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=arguments.length>8&&void 0!==arguments[8]&&arguments[8];if(!a==!t.fileAddNote){t.isAttachment=u,t.aliyunOfficeEdit=l,t.activity=i,d.remove(r,(e=>"source_file"===e.parent_type)),t.uploads=r,t.canGuestPreview=s,t.forceShowDownloadButton=c;var p=0;null!=n.id?p=d.findIndex(t.uploads,(e=>e.id===n.id)):null!=n.url&&(p=d.findIndex(t.uploads,(e=>e.url===n.url))),t.changeFile(p);var f=37,v=39;return o(document).keydown((function(e){if(!(t.focusInputCount>0||t.ui.showAiQuizPanel))switch(e.which){case f:return t.changeFile(t.currentFileIndex-1);case v:return t.changeFile(t.currentFileIndex+1)}}))}})),t.currentFileIndex=0;var W=!1;t.changeFile=function(r){t.ui.showAnswerPrompt=!1,r<0?r=t.uploads.length-1:r>t.uploads.length-1&&(r=0),t.uploads[r].deleted||(t.currentFileIndex=r,t.upload=t.uploads[r],"image"===t.upload.type&&o(".img-container > img").length&&(o(".img-container > img").length>1&&o(".img-container > img")[0].remove(),o(".img-container").append(o(".img-container > img"))),z(),t.$broadcast("previewFile",t.upload,t.activity)),W&&e.$emit("changeFile",t.upload,t.activity),W=!0},t.$watch("ui.fullScreen",(function(e){var t=o("body > .wrapper > .footer");return e?t.hide():t.show()}));var H=e=>{var t=!1;if(visitedStorage=localStorage.getItem("visitedAirDocumentQuiz"),visitedStorage){var r=JSON.parse(visitedStorage);(t=r.includes(e))||(r.push(e),localStorage.setItem("visitedAirDocumentQuiz",JSON.stringify(r)))}else localStorage.setItem("visitedAirDocumentQuiz",JSON.stringify([e]));return t};t.previewType=function(e){return["lesson-resource","video-quiz","capture"].includes(e)?e:"file"},w.onmessage=e=>q(e);var q=function(e){if("adjustPlayerSize"===e.data.name)return G(e.data.args,!0),t.$apply()},G=function(e,r){t.iframeStyle=t.iframeStyle||{};var n=r?Q(t.iframeStyle.width,e.width):e.width,i=r?Q(t.iframeStyle.height,e.height):e.height;return o("#file-previewer .popup-content").css({"min-height":0}),o(".pdf-reader-detail .content").css({height:i,"min-height":0}),t.iframeStyle={width:n,height:i,border:"none","min-width":900}},Q=function(e,t){var r;return 0<(r=Math.abs(e-t))&&r<=4?e:t};t.retry=function(e){l.retryTranscode(a,s,w,e)},t.downloadBlob=function(e,t){if(!t.deleted)return e?_.track(e.type,"download",{activity_id:e.id,upload_id:t.id,file_name:t.name,upload_reference_id:t.reference_id}):void(t.callbackEventName&&window.dispatchEvent(new CustomEvent(t.callbackEventName,{detail:t.uploadReference})))};var J=()=>{t.ui.showAiQuizPanel=!1,t.ui.showQuestionPanel=!1,t.ui.showAnswerPrompt=!1};t.showAiQuizPanel=()=>{J(),t.ui.showAiQuizPanel=!0,window.dispatchEvent(new CustomEvent("open-ai-quiz-panel"))},t.showAiQuizModal=e=>{"ready"===e.originStatus&&f(v,{activity:t.activity,upload:t.upload,destroyComponent:!0,lockScroll:!1})};var K=e=>{var r,o,n,i;if(t.isInstructorView||null===(r=window.featureToggles)||void 0===r||!r.airDocQuiz||!t.ui.showAiQuizPanelBtn||null===(o=t.upload)||void 0===o||null===(n=o.aiQuiz)||void 0===n||!n.id)return!1;var a=null===(i=document.querySelector("ai-quiz-subjects-view"))||void 0===i?void 0:i.getVueInstance();return!(!a||"examination"!==a.studentViewRef.status)&&(a.studentViewRef.exitAnswer(e),!0)};t.manualClosePreviewer=()=>{K("close-file-previewer")||o("#file-previewer-with-note").foundation("reveal","close")},t.showQuestionPanel=function(){K("show-question-panel")||(J(),t.ui.showQuestionPanel=!0,window.dispatchEvent(new CustomEvent("open-question-submit-panel")))},w.addEventListener("show-question-panel",(()=>{J(),t.ui.showQuestionPanel=!0,t.$apply()})),w.addEventListener("close-file-previewer",(()=>{o("#file-previewer-with-note").foundation("reveal","close")})),e.$on("openAiQuizPanel",(function(){t.ui.showAiQuizPanel=!0,t.$apply()})),t.focusInputCount=0,w.addEventListener("comment-question-emit-event",(e=>{var r;switch(e.detail.event){case"count-change":return t.ui.commentsCount=null===(r=e.detail.data)||void 0===r?void 0:r.count,void t.$apply();case"close":return t.ui.showQuestionPanel=!1,void t.$apply();case"focus":return void t.focusInputCount++;case"blur":return void t.focusInputCount--;default:return void(t.allowChangeFile=0)}})),w.addEventListener("ai-quiz-emit-event",(e=>{switch(e.detail.event){case"close":return t.ui.showAiQuizPanel=!1,void t.$apply();default:return}})),w.addEventListener("message",(e=>{var r=document.getElementById("lessonResourceIframe");e.data&&"wg-video-player:getUserAirToken"===e.data&&r&&function(){var e=c(n.mark((function e(){var o,i,a,s;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.upload?null===(o=t.upload)||void 0===o?void 0:o.name:"",e.next=3,g({type:"lesson"},{type:"lesson",resourceName:i});case 3:a=e.sent,s={token:a.airAccessToken,event:"wg-video-player:acceptUserAirToken"},r.contentWindow.postMessage(s,"*");case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()();e.data&&"wg-video-player:getUserAirCredits"===e.data&&r&&function(){var e=c(n.mark((function e(){var t,o;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y();case 2:t=e.sent,o={creditInfo:t,event:"wg-video-player:acceptUserAirCredits"},r.contentWindow.postMessage(o,"*");case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()})),r(637459)}]},3196:function(e,t,r){var o=r(383228);e.exports=["$rootScope","$scope","$timeout","$window",function(e,t,r,n){var i;t.isShowingNoteBox=!1,t.ui.showQuestionPanel=!1,t.ui.showAiQuizPanel=!1,e.hasEdited=!1,t.courseId=null===(i=window.globalData)||void 0===i?void 0:i.course.id,t.enterFullScreen=function(e){return t.hideNoteBoxWithoutAnimate(),t.ui.fullScreen=!0,"#file-previewer-with-note .reader-wrapper",t.enterHTML5FullScreen(o("#file-previewer-with-note .reader-wrapper").get(0))},t.showNoteBox=function(){if(t.canAddNote()&&!t.isShowingNoteBox){t.ui.showQuestionPanel=!1,t.ui.showAiQuizPanel=!1,t.isShowingNoteBox=!0;var e=o("#file-previewer-with-note .content").width();o("#file-previewer-with-note .file-previewer").animate({width:e-290},500),o(".file-preview-note-box").css("z-index",1)}},n.addEventListener("open-ai-quiz-panel",(()=>{t.hideNoteBox(),t.ui.showAiQuizPanel=!0})),n.addEventListener("open-question-submit-panel",(()=>{t.hideNoteBox(),t.ui.showQuestionPanel=!0})),t.hideNoteBox=function(){if(t.isShowingNoteBox){var e=o("#file-previewer-with-note .file-previewer");e.animate({width:e.width()+290},500),o(".file-preview-note-box").css("z-index",-1),r((function(){return t.isShowingNoteBox=!1,500}))}},t.hideNoteBoxWithoutAnimate=function(){if(t.isShowingNoteBox)return o("#file-previewer-with-note .file-previewer").width("100%"),t.isShowingNoteBox=!1},o(document).on("close.fndtn.reveal","#file-previewer-with-note",(function(){return t.hideNoteBox(),e.$broadcast("noteEdited",e.hasEdited),e.hasEdited=!1})),t.playerInitiated=e=>t.player=e;return t.canAddNote=function(){if("image"===t.upload.type)return!0;if("document"===t.upload.type&&"ready"===t.upload.status){var e=o("#file-previewer-with-note #pdf-viewer");return Boolean(e&&e[0]&&e[0].contentWindow&&e[0].contentWindow.PDFViewerApplication&&e[0].contentWindow.PDFViewerApplication.pdfViewer&&e[0].contentWindow.PDFViewerApplication.pdfViewer.onePageRendered)}return Boolean("video"===t.upload.type&&"ready"===t.upload.status&&t.player&&0!==("function"==typeof(r=t.player).readyState?r.readyState():r.readyState));var r}}]},97592:function(e,t,r){var o=r(496486),n=r(261139),i=r(383228),a=(r(117403).default,r(693604));e.exports=["$rootScope","$scope","uploadService","toastr","blobstorage","$window","filesApi","jobQueue",function(e,t,r,s,c,u,l,d){e.uploaded=[],t.unSupportedFiles=[],e.notUploading=()=>o.every(e.uploads,(e=>e.finished||e.failed)),t.humanizeBytes=r.humanizeBytes,t.deleteUploadingUpload=e=>r.deleteUploadingUpload(e),t.delete=function(t){return o.remove(e.uploaded,t),o.remove(e.uploads,t)},t.deleteFailedUpload=function(e){return r.deleteUpload(e,(()=>t.userFreeSpace+=e.size))};var p=function(){return n.isFunction(t.getParentId)?t.getParentId():0};return t.openClient=function(){var e=p();c.getOpenClientURL(e).then((function(e){if(e)return u.open(e)}))},t.onFileSelect=function(o,n,i,c){if(e.showUploadOptions=!1,e.isIE9CannotUploadFile())s.warning(e.isIE9CannotUploadFileMsg);else{var u=a.checkFileNameValidation(o),l=u[0];if(l.length!==o.length&&s.error(t.$t("fileUpload.nameError",[u[1]])),0!==(o=l).length){t.error=!1;var d=[];t.isFileExtensionCheckEnable?(d=r.filterByFileFormat(o,a.getSupportedFormats())).length!==o.length&&(s.error(t.uploadFileFormatLimitErrorMessage),t.error=!0):d=r.filterByFileFormat(o);var f=r.filterByFileSize(d,n);if(f.length!==d.length){if(!t.error){var v=r.filterByFileSizeZero(d);v.length>0&&1==d.length?s.error(t.uploadZeroSizeFileErrorMessage):v.length>0&&d.length>1?s.error("".concat(t.uploadSizeLimitErrorMessage,", ").concat(t.uploadZeroSizeFileErrorMessage)):s.error(t.uploadSizeLimitErrorMessage)}t.error=!0}if(0!==f.length){var m=!(!e.ui||!e.ui.isScorm)&&e.ui.isScorm,h=!(!e.ui||!e.ui.isWmpkg)&&e.ui.isWmpkg,g=e.ui&&e.ui.embedMaterialType?e.ui.embedMaterialType:"",y=p();return r.updateConfig(i,m,h,g,y),r.bindCallback((function(t){return e.uploaded.push(t),e.$broadcast("fileUploaded",t,c),window.st.track("personal_resource","upload",{},{upload_id:t.id,file_name:t.name,upload_type:e.fileTypeByExtension(t)}),e.$broadcast("refreshStorageBar")}),(function(e){if(e.message)return s.error(e.message)})),r.uploadFiles(f)}}}},t.humanizeBytes=r.humanizeBytes,i("div.dropzone").click((function(){return i('input[name="fileSelector"]').click()}))}]},955532:function(e,t,r){var o=r(383228),n=r(496486),i=r(261139);r(66992),r(132023),r(323123),r(454747),r(333948);var a=r(887757);function s(e,t,r,o,n,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(o,n)}function c(e){return function(){var t=this,r=arguments;return new Promise((function(o,n){var i=e.apply(t,r);function a(e){s(i,o,n,a,c,"next",e)}function c(e){s(i,o,n,a,c,"throw",e)}a(void 0)}))}}function u(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,n=function(){};return{s:n,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}r(535666);var d=r(117403).default,p=r(693604),f=r(180736);e.exports=["$rootScope","$scope","uploadService","toastr","filesApi","jobQueue",function(e,t,r,s,l,v){t.currentList=[],e.uploaded=[],t.unSupportedFiles=[];var m=f(t),h=function(o,n){var i,a=[];if(e.showUploadOptions=!1,!e.isIE9CannotUploadFile()){i=p.checkFileNameValidation(o)[0];var c=[];c=t.$parent.isFileExtensionCheckEnable?r.filterByFileFormat(i,p.getSupportedFormats()):r.filterByFileFormat(i);var u=r.filterByFileSize(c,n);a=o.filter((e=>!u.includes(e)));var l=r.filterByFileSizeZero(c);return l.length>0&&l.forEach((e=>{a.includes(e)||a.push(e)})),[u.filter((e=>!l.includes(e))),a]}s.warning(e.isIE9CannotUploadFileMsg)};t.getfileAndfolderStructure=function(r,n,i){"resource_library"===i&&(e.isResourceLibUploadFolder=!0),e.isResourceLibUploadFolder?m.show():t.$parent.loading=!0,e.showUploadOptions=!1;var a=[],s={};t.unSupportedFiles=[];var c,l=0,f=u(r);try{for(f.s();!(c=f.n()).done;){var v=c.value;if(".DS_Store"!==v.name)if(""!==v.webkitRelativePath||void 0!==v.path){filePath=v.path||v.webkitRelativePath;var h=filePath.split("/");if(h.length-1>=window.orgSettings.maxLevelInUploadFolder+1)return t.errMessage=d.t("fileUpload.folderExceedsMaxLevel",[window.orgSettings.maxLevelInUploadFolder]),void(e.isResourceLibUploadFolder?(o("#resource-lib-folders-upload-confirmation-popup").foundation("reveal","open"),p.openPopupAfterCurrentClose("#myFilesUpload","#resource-lib-folders-upload-confirmation-popup"),m.hide()):(o("#folders-upload-confirmation-popup").foundation("reveal","open"),t.$parent.loading=!1));for(var b=s,w=0;w<h.length;w++){var _=h[w];w===h.length-1?b.push({name:v.name,file:v}):(b[_]=b[_]||[],b=b[_])}}else a.push(v);else l++}}catch(e){f.e(e)}finally{f.f()}if(r.length-l>window.orgSettings.maxFileCountInUploadFolder)return t.errMessage=d.t("fileUpload.fileExceedsMaxCount",[window.orgSettings.maxFileCountInUploadFolder]),void(e.isResourceLibUploadFolder?(o("#resource-lib-folders-upload-confirmation-popup").foundation("reveal","open"),p.openPopupAfterCurrentClose("#myFilesUpload","#resource-lib-folders-upload-confirmation-popup"),m.hide()):(o("#folders-upload-confirmation-popup").foundation("reveal","open"),t.$parent.loading=!1));g(s).then((r=>{e.isResourceLibUploadFolder?m.hide():t.$parent.loading=!1,y(a,r,n)}))};var g=function(){var r=c(a.mark((function r(o){var n,i,s;return a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=[],0!==o.length){r.next=3;break}return r.abrupt("return",n);case 3:return i=()=>{e.isResourceLibUploadFolder?m.hide():t.$parent.loading=!1},uploadFolderContents=function(){var e=c(a.mark((function e(t){var r,o,s,c,u,d,p,f,v,m,h=arguments;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=h.length>1&&void 0!==h[1]&&h[1],o=h.length>2&&void 0!==h[2]?h[2]:null,s=h.length>3&&void 0!==h[3]?h[3]:null,r||Array.isArray(t)){e.next=5;break}return e.abrupt("return");case 5:c=Object.keys(t),u=0,d=c;case 7:if(!(u<d.length)){e.next=28;break}if(p=d[u],r&&(s={id:0,name:p,childs:[]}),f=t[p],!Array.isArray(f)){e.next=23;break}return e.next=14,l.uploadFolder(o,p,!0,i);case 14:return v=e.sent,m=o,o=v.data.id,r&&(s.id=v.data.id,s.name=v.data.name),e.next=20,uploadFolderContents(f,!1,o,s);case 20:o=m,e.next=24;break;case 23:s.childs.push({file:f.file,parent_id:o,is_upload:!0});case 24:r&&n.push(s);case 25:u++,e.next=7;break;case 28:return e.abrupt("return",n);case 29:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s=w(),r.next=8,uploadFolderContents(o,!0,s);case 8:return r.abrupt("return",n);case 9:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),y=function(r,i,a){t.noParentFiles=r,t.topLevelFolderStructure=i;var s=[],c=h(r,a);n.forEach(i,(e=>{n.forEach(e.childs,(e=>{s.push(e.file)}))}));var u=h(s,a);c[1].length+u[1].length>0?(t.unSupportedFiles.push(...c[1],...u[1]),t.errMessage=d.t("fileUpload.unsupportedFileMessage",[c[0].length+u[0].length]),o("#upload-not-support-popup").foundation("reveal","open"),e.isResourceLibUploadFolder||(t.currentList=t.$parent.model.pagination.currentList||[])):b()},b=function(){var o=t.noParentFiles.filter((e=>!t.unSupportedFiles.includes(e))),i=function(e){if(e.message)return s.error(e.message)},a=w(),c=!(!e.ui||!e.ui.isScorm)&&e.ui.isScorm,u=!(!e.ui||!e.ui.isWmpkg)&&e.ui.isWmpkg,l=e.ui&&e.ui.embedMaterialType?e.ui.embedMaterialType:"";r.updateConfig(null,c,u,l,a),e.isResourceLibUploadFolder?r.bindCallback((function(t){return e.uploaded.push(t),e.$broadcast("fileUploaded",t,""),window.st.track("personal_resource","upload",{},{upload_id:t.id,file_name:t.name,upload_type:e.fileTypeByExtension(t)}),e.$broadcast("refreshStorageBar")}),i):r.bindCallback((function(r){return(window.inProjectPage?!r.file||!r.file.path&&""===r.file.webkitRelativePath:r.file&&!r.file.path&&""===r.file.webkitRelativePath)&&(r.selectable=!0,t.$parent.model.singleSelect?t.$parent.model.singleSelectedUpload=r:(r.selected=!0,n.find(t.$parent.model.selectedUploads,(e=>e.id===r.id&&e.isThirdPartResource===r.isThirdPartResource))||t.$parent.model.selectedUploads.push(r))),window.st.track("personal_resource","upload",{},{upload_id:r.id,file_name:r.name,upload_type:e.fileTypeByExtension(r)}),e.$broadcast("refreshStorageBar")}),i),uploads=r.uploadFiles(o),e.isResourceLibUploadFolder||t.$emit("addUploads",uploads);var d=t.topLevelFolderStructure;n.forEach(d,(e=>{n.forEach(e.childs,(e=>{t.unSupportedFiles.includes(e.file)&&(e.is_upload=!1)}))}));var p={parent_id:a,is_scorm:c,is_wmpkg:u,embed_material_type:l};n.forEach(d,(o=>{uploadFolder=r.uploadFilesWithFolder(v,o,p),e.isResourceLibUploadFolder||t.$emit("addFolder",uploadFolder)})),e.isResourceLibUploadFolder||(t.$parent.model.tab="repository",t.$parent.model.mode="list")};t.continueUpload=function(){p.closePopup("upload-not-support-popup"),b()},t.uploadFilesWithFolder=b,t.showFailedFiles=function(e){t.currentFolderFailedFiles=e.failedFiles,o("#upload-failed-popup").foundation("reveal","open")};var w=function(){return i.isFunction(t.getParentId)?t.getParentId():0};t.fileClass=function(e){if(extension=p.fileExtension(e.name,!0),"pdf"===extension)return"font font-file-pdf";if("numbers"===extension)return"font font-file-numbers";if("pages"===extension)return"font font-file-pages";if("key"===extension)return"font font-file-keynote";if(["doc","docx"].includes(extension))return"font font-file-word";if(["xls","xlsx"].includes(extension))return"font font-file-excel";return{VIDEO:"font font-file-video",AUDIO:"font font-file-audio",IMAGE:"font font-file-image",DOCUMENT:"font font-file-page",COMPRESSED_DOCUMENT:"font font-file-page",DEFAULT:"font font-file-undefind"}[p.getFileType(e.name)]},e.showUploadOptions=!1,t.ui={inUploadList:!1},t.showUploadList=function(){return o(".file-upload-area .entry").focus(),e.showUploadOptions=!e.showUploadOptions},t.hideUploadList=function(){if(!t.ui.inUploadList)return e.showUploadOptions=!1},t.closePopup=function(e){return p.closePopup(e)}}]},754023:function(e,t,r){var o=r(496486),n=r(383228);e.exports=["$rootScope","$scope",function(e,t){var r=function(e,t){return n.cookie(e,t,{path:"/"})};t.close=()=>{r("forceBindMobilePopup",!1),n("#force-bind-mobile-phone-popup").foundation("reveal","close")},t.goToBind=()=>{r("forceBindMobilePopup",!1),window.location.href="/user/settings?bindMobile"};var i,a,s,c,u,l,d;!t.forceBindMobilePhone||null===(s=window.globalData)||void 0===s||!s.user||(null===(c=window.globalData)||void 0===c||null===(u=c.user)||void 0===u?void 0:u.mobile)&&"None"!==(null===(l=window.globalData)||void 0===l||null===(d=l.user)||void 0===d?void 0:d.mobile)||"true"!==(i="forceBindMobilePopup",a="true",o.has(n.cookie(),i)?n.cookie()[i]:a)||(r("forceBindMobilePopup",!0),setTimeout((()=>n("#force-bind-mobile-phone-popup").foundation("reveal","open")),500))}]},970811:function(e,t,r){var o=r(383228);r(682772),e.exports=["$rootScope","$scope","uploadService","$window","toastr",function(e,t,r,n,i){o("#formula-editor-frame").attr("src","/static/kityformula/kity_formula_editor.html");t.closePopup=()=>o("#formula-editor-popup").foundation("reveal","close"),t.save=function(){var e=o("#formula-editor-frame")[0].contentWindow.kfe;return e.execCommand("get.image.data",(function(r){var n=e.execCommand("get.source");n.indexOf("placeholder ")>0?i.error(t.i18nMessages.latexEmptyTip):((e=>{o("#formula-editor-popup").trigger("formulaEntered",e)})({img:r.img,latex:n}),t.closePopup())}))},t.mouseEnter=function(){t.showLatex=!0},t.mouseLeave=function(){t.showLatex=!1}}]},223957:function(e,t,r){var o=r(383228),n=r(496486);r(804723),r(841812),e.exports=["$rootScope","$scope","$http","toastr",function(e,t,r,i){t.ui={isIE9:window.isIE9,showEmailWarning:!0,showMobileDeviceWarning:!1,showNoMailWarning:!0,isIOS:/\b(iPad|iPhone|iPod)(?=;)/.test(navigator.userAgent),warningWidth:Math.min(window.innerWidth,window.outerWidth)};var a=null,s=function(){var e=o("html").attr("version");return a=setInterval((()=>r.get("/d/version").success((function(r){if(r!==e)return function(){a&&clearInterval(a);var e={preventDuplicates:!0,closeButton:!1,timeOut:-1,extendedTimeOut:-1,onHidden:()=>window.location.reload()};return i.warning(t.warningVersionExpire,e)}()}))),6e5)};t.sendVerificationEmail=function(e){var t=e?"/api/user/send_org_sing_up_verification_email":"/api/user/send_verification_email";return r.post(t,{}).success((function(e){return i.success(e.message,{preventDuplicates:!1}),o("#welcome-verification-email-popup").foundation("reveal","close")})).error((e=>i.error(e.message,{preventDuplicates:!1})))},t.syncSemesters=function(){return api.mySemesters(t.conditions.academic_year_id,(function(e){return t.semesters=e.semesters,t.conditions.semester_id=[],multiSelect.multiSelect("#semester-select")}),(()=>t.semesters=[]))},t.dismissEmailWarning=function(){return o.cookie("warning:verification_email","hide",{path:"/"}),t.ui.showEmailWarning=!1},t.dismissMobileBrowserWarning=()=>t.ui.showMobileDeviceWarning=!1,t.dismissNoMailWarning=function(){return o.cookie("warning:no_email_warning","hide",{path:"/"}),t.ui.showNoMailWarning=!1},t.showVerificationPopup=function(){return o("#welcome-verification-email-popup").foundation("reveal","open"),!0};var c=function(){var e;return s(),e=navigator.userAgent.toLowerCase().match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i),t.ui.showMobileDeviceWarning=!n.isEmpty(e),t.ui.showMobileDeviceWarning&&o(window).resize((()=>{t.ui.warningWidth=Math.min(window.innerWidth,window.outerWidth),t.$apply()})),t.ui.showEmailWarning=!(t.ui.isIE9&&t.ui.showMobileDeviceWarning)&&"hide"!==o.cookie()["warning:verification_email"],t.ui.showNoMailWarning=!(t.ui.isIE9&&t.ui.showNoMailWarning)&&"hide"!==o.cookie()["warning:no_email_warning"]};return t.reset=c,c()}]},653131:function(e,t,r){var o=r(261139);e.exports=o.module("baseCtrl",["base"]).factory("bulletinApi",r(841789)).factory("rollcallRepository",r(301253)).factory("onlineVideoCompletenessRepository",r(6201)).factory("performanceRepository",r(330459)).factory("performanceApi",r(776405)).factory("scoreRepository",r(201305)).factory("groupApi",r(683257)).factory("filesApi",r(397416)).factory("courseManagementApi",r(442247)).factory("resourceGroupApi",r(892955)).controller("HeaderCtrl",r(786995)).controller("FooterCtrl",r(789785)).controller("PreTaskController",r(966641)).controller("UnreadOrgBulletinPopupController",r(383844)).controller("HeaderWarningController",r(223957)).controller("CourseHeaderCtrl",r(406177)).controller("PortfolioCtrl",r(269396)).controller("CourseMenuCtrl",r(581986)).controller("ManagementMenuCtrl",r(223031)).controller("FilePreviewerController",r(86434)).controller("PreviewModeController",r(199004)).controller("PdfEditorController",r(558033)).controller("FileHypStatController",r(389465)).controller("AudioPlayCtrl",r(608632)).controller("CodeEditorController",r(646321)).controller("EmbedVideoController",r(66129)).controller("FileSelectController",r(273085)).controller("EntriesSelectController",r(211376)).controller("FileUploadController",r(97592)).controller("InviteConfirmController",r(364955)).controller("AttachmentDeleteController",r(454169)).controller("AttachmentWarningController",r(805802)).controller("AssociationCodeController",r(16578)).controller("ManualListController",r(272762)).controller("StudentStudyCompletenessController",r(112253)).controller("FormulaEditorController",r(970811)).controller("LatexTipsController",r(960257)).controller("SlidePreviewController",r(371810)).controller("FilePreviewNoteController",r(3196)).controller("CheckExpiredPasswordController",r(909382)).controller("StorageCtrl",r(933533)).controller("EditScorePercentageCtrl",r(548373)).controller("AccessForbiddenController",r(402738)).controller("NoteController",r(79980)).controller("CalendarEventController",r(393862)).controller("CalendarTimetableController",r(350686)).controller("CalendarMeetingController",r(817382)).controller("VideoQuizPreviewController",r(647802)).controller("NotificationContentCtrl",r(166555)).controller("CourseInviteUsersCtrl",r(299365)).controller("UserJoinCourseCtrl",r(186021)).controller("SubCourseFilterController",r(810281)).controller("SwitchAudioPopupController",r(664584)).controller("SwitchVideoPopupController",r(786292)).controller("OrgApplyPopupController",r(13381)).controller("CalendarController",r(581943)).controller("FolderUploadController",r(955532)).controller("ForceBindMobilePhoneController",r(754023)).controller("DingtalkValidatePopupController",r(108300)).name},364955:function(e,t,r){var o=r(496486);e.exports=["$scope","$http","$rootScope","$document","toastr","$window",function(e,t,r,n,i,a){c=s=void 0;var s,c,u=function(){e.error=null,e.teachingUnitType=r.invitePayload.teaching_unit_type,c=r.invitePayload.teaching_unit_id,s=r.invitePayload.invite_id,e.loading=!0;return t.get("/api/invites/".concat(s,"/status")).success((function(t){return e.joined="joined"===t.status,e.loading=!1})).error((function(t,r){return e.error={},404===r?e.error.inviteCancelled=!0:e.error.courseDeleted=!0,e.loading=!1}))};return n.on("open.fndtn.reveal","#invite-confirm",(e=>u())),e.confirm=function(){var r="/course/".concat(c,"/content");return e.joined?location.href=r:t.post("/api/invites/".concat(s,"/invite-confirm")).success((()=>location.href=r)).error(o.noop)},e.toUserIndex=()=>a.location.href="/user/index",u()}]},960257:function(e){e.exports=["$rootScope","$scope",function(e,t){t.showLatex=!1,t.mouseEnter=function(){t.showLatex=!0},t.mouseLeave=function(){t.showLatex=!1}}]},223031:function(e,t,r){var o=r(383228);e.exports=["$scope",function(e){e.useManagementDataboard||window.localStorage.removeItem("ui.departmentId"),e.ui={inLessonMenu:!1,showLessonMenu:!1,inStatMenu:!1,showStatMenu:!1,inCourseMenu:!1,showCourseMenu:!1,inCurriculumMenu:!1,showCurriculumMenu:!1,inUserMenu:!1,showUserMenu:!1,inResourceMenu:!1,showResourceMenu:!1,inBulletinMenu:!1,showBulletinMenu:!1,inStorageMenu:!1,showStorageMenu:!1,inWarningMenu:!1,showWarningMenu:!1,inStatisticsReportMenu:!1,showStatisticsReportMenu:!1,inCourseStatisticsReportMenu:!1,showCourseStatisticsReportMenu:!1,showSubjectMenu:!1,inSubjectMenu:!1,showScoreMenu:!1,inScoreMenu:!1,showLiveCapturePluginMenu:!1,inLiveCapturePluginMenu:!1,showRMSLiveCapturePluginMenu:!1,inRMSLiveCapturePluginMenu:!1,showAuthzMenu:!1,inAuthzMenu:!1,showLiveClassMenu:!1,inLiveClassMenu:!1,showVtrsMenu:!1,inVtrsMenu:!1,defaultDepartmentId:window.localStorage.getItem("ui.departmentId"),showAirMenu:!1,inAirMenu:!1},e.toggleLiveCaptureMenu=function(){return e.ui.showLiveCapturePluginMenu?e.hideLiveCaptureMenu():e.ui.showLiveCapturePluginMenu=!0},e.hideLiveCaptureMenu=function(){if(!e.ui.inLiveCapturePluginMenu)return e.ui.showLiveCapturePluginMenu=!1},e.hideRMSLiveCaptureMenu=function(){if(!e.ui.inRMSLiveCapturePluginMenu)return e.ui.showRMSLiveCapturePluginMenu=!1},e.toggleRMSLiveCaptureMenu=function(){return e.ui.showRMSLiveCapturePluginMenu?e.hideRMSLiveCaptureMenu():e.ui.showRMSLiveCapturePluginMenu=!0},e.showLessonMenu=function(){return e.ui.showLessonMenu?e.hideLessonMenu():(o(".management-menu-lesson .dropdown").focus(),e.ui.showLessonMenu=!0)},e.hideLessonMenu=function(){if(!e.ui.inLessonMenu)return e.ui.showLessonMenu=!1},e.showStatMenu=function(){return e.ui.showStatMenu?e.hideStatMenu():(o(".management-menu-stat .dropdown").focus(),e.ui.showStatMenu=!0)},e.hideStatMenu=function(){if(!e.ui.inStatMenu)return e.ui.showStatMenu=!1},e.showStorageMenu=function(){return e.ui.showStorageMenu?e.hideStorageMenu():(o(".management-menu-storage .dropdown").focus(),e.ui.showStorageMenu=!0)},e.hideStorageMenu=function(){if(!e.ui.inStorageMenu)return e.ui.showStorageMenu=!1},e.toggleCourseMenu=function(){return e.ui.showCourseMenu?e.hideCourseMenu():e.ui.showCourseMenu=!0},e.hideCourseMenu=function(){if(!e.ui.inCourseMenu)return e.ui.showCourseMenu=!1},e.toggleCurriculumMenu=function(){return e.ui.showCurriculumMenu?e.hideCurriculumMenu():e.ui.showCurriculumMenu=!0},e.hideCurriculumMenu=function(){if(!e.ui.inCurriculumMenu)return e.ui.showCurriculumMenu=!1},e.toggleUserMenu=function(){return e.ui.showUserMenu?e.hideUserMenu():e.ui.showUserMenu=!0},e.hideUserMenu=function(){if(!e.ui.inUserMenu)return e.ui.showUserMenu=!1},e.toggleResourceMenu=function(){return e.ui.showResourceMenu?e.hideResourceMenu():e.ui.showResourceMenu=!0},e.hideResourceMenu=function(){if(!e.ui.inResourceMenu)return e.ui.showResourceMenu=!1},e.toggleBulletinMenu=function(){return e.ui.showBulletinMenu?e.hideBulletinMenu():e.ui.showBulletinMenu=!0},e.hideBulletinMenu=function(){if(!e.ui.inBulletinMenu)return e.ui.showBulletinMenu=!1},e.toggleWarningMenu=function(){return e.ui.showWarningMenu?e.hideWarningMenu():e.ui.showWarningMenu=!0},e.hideWarningMenu=function(){if(!e.ui.inWarningMenu)return e.ui.showWarningMenu=!1},e.toggleStatisticsReportMenu=function(){return e.ui.showStatisticsReportMenu?e.hideStatisticsReportnu():e.ui.showStatisticsReportMenu=!0},e.hideStatisticsReportnu=function(){if(!e.ui.inStatisticsReportMenu)return e.ui.showStatisticsReportMenu=!1},e.toggleCourseStatisticsReportMenu=function(){return e.ui.showCourseStatisticsReportMenu?e.hideCourseStatisticsReportnu():e.ui.showCourseStatisticsReportMenu=!0},e.hideCourseStatisticsReportnu=function(){if(!e.ui.inCourseStatisticsReportMenu)return e.ui.showCourseStatisticsReportMenu=!1},e.toggleSubjectMenu=function(){return e.ui.showSubjectMenu?e.hideSubjectMenu():e.ui.showSubjectMenu=!0},e.hideSubjectMenu=function(){if(!e.ui.inSubjectMenu)return e.ui.showSubjectMenu=!1},e.toggleScoreMenu=function(){return e.ui.showScoreMenu?e.hideScoreMenu():e.ui.showScoreMenu=!0},e.hideScoreMenu=function(){if(!e.ui.inScoreMenu)return e.ui.showScoreMenu=!1},e.toggleAuthzMenu=function(){return e.ui.showAuthzMenu?e.hideAuthzMenu():e.ui.showAuthzMenu=!0},e.hideAuthzMenu=function(){if(!e.ui.inAuthzMenu)return e.ui.showAuthzMenu=!1},e.goAuthzPageByUrl=function(e){window.location.href=e},e.hideLiveClassMenu=function(){if(!e.ui.inLiveClassMenu)return e.ui.showLiveClassMenu=!1},e.showLiveClassMenu=function(){return e.ui.showLiveClassMenu?e.hideLiveClassMenu():(o(".management-live-class .dropdown").focus(),e.ui.showLiveClassMenu=!0)},e.toggleVtrsMenu=function(){return e.ui.showVtrsMenu?e.hideVtrsMenu():e.ui.showVtrsMenu=!0},e.hideVtrsMenu=function(){if(!e.ui.inVtrsMenu)return e.ui.showVtrsMenu=!1},e.toggleAirMenu=function(){return e.ui.showAirMenu?e.hideAirMenu():e.ui.showAirMenu=!0},e.hideAirMenu=function(){if(!e.ui.inAirMenu)return e.ui.showAirMenu=!1}}]},272762:function(e,t,r){var o=r(383228);r(682772),e.exports=["$scope","$rootScope","$sce",function(e,t,r){e.trustAsResourceUrl=e=>r.trustAsResourceUrl("/note-bene/pdf-viewer?file=".concat(e)),e.selectManual=function(r){return t.manualType=r,t.manualUrl=e.manualUrlDict[r],t.upload={type:"document"},e.$emit("clickManualListItem")},e.isHtmlManual=function(t){return!!e.manualUrlDict[t].toLowerCase().indexOf(".html")};return e.enterFullScreen=function(e){return t.ui.fullScreen=!0,(r=o(e=e||"#manual-viewer-popup .reader-wrapper").get(0)).requestFullscreen?r.requestFullscreen():r.msRequestFullscreen?r.msRequestFullscreen():r.mozRequestFullScreen?r.mozRequestFullScreen():r.webkitRequestFullscreen?r.webkitRequestFullscreen():void 0;var r},e.exitFullScreen=function(){return document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen(),t.ui.fullScreen=!1}}]},13381:function(e){e.exports=["$scope","$document","$rootScope",function(e,t,r){e.period=0,e.text="",t.on("open.fndtn.reveal","#org_apply_popup",(()=>{e.period="".concat(e.popupParams.period),e.text="".concat(e.popupParams.text),e.type="".concat(e.popupParams.type)})),e.confirm=e=>{r.$broadcast("onPlanRequestCheck",e)}}]},558033:function(e,t,r){var o=r(383228);r(66992),r(788674),r(333948),r(560285);var n=r(887757);function i(e,t,r,o,n,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(o,n)}function a(e){return function(){var t=this,r=arguments;return new Promise((function(o,n){var a=e.apply(t,r);function s(e){i(a,o,n,s,c,"next",e)}function c(e){i(a,o,n,s,c,"throw",e)}s(void 0)}))}}r(535666),e.exports=["$rootScope","$scope","$http","$sce","$translate","toastr",function(e,t,r,i,s,c){t.userName=null,t.fileUrl=null,t.fileName="",t.documentUrl="",t.fileType="",t.uploadId=null,t.saveFunction=e=>{},t.isConfirmPopupOpen=!1,t.loading=!1,t.isPdfChanged=!1,t.iframeOnload=()=>{t.loading=!1};var u=function(e){return(e=e||window.event)&&(e.returnValue=!0),!0};window.addEventListener("refreshPDFURL",function(){var e=a(n.mark((function e(r){var o;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=function(){var e=a(n.mark((function e(o){var i,a;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(r.detail.data).then((e=>e.blob()));case 2:i=e.sent,a=URL.createObjectURL(i),t.fileUrl=a,t.loading=!0,t.documentUrl="/pdf/editor?uploadId=".concat(t.uploadId,"&file=").concat(encodeURIComponent(a),"&fileType=").concat(r.detail.fileType,"&imgURL=").concat(r.detail.imgURL,"&rotatedAngle=").concat(r.detail.rotatedAngle,"&attachmentUrl=").concat(encodeURIComponent(o),"&fileName=").concat(r.detail.fileName),t.fileName=r.detail.fileName,t.fileType=r.detail.fileType,t.$apply(),window.addEventListener("beforeunload",u);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.detail.marksMetadata&&r.detail.marksMetadata.length>0?t.saveFunction(r.detail.marksMetadata,!1,o):o(t.attachmentUrl);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.$on("pdfEditor",((r,o,n)=>{t.fileUrl=o.url,t.userName=o.name,t.documentUrl="/pdf/editor?uploadId=".concat(o.uploadId,"&file=").concat(encodeURIComponent(o.url),"&fileType=").concat(o.fileType,"&imgURL=").concat(o.imgURL,"&rotatedAngle=0&attachmentUrl=").concat(encodeURIComponent(o.attachmentUrl),"&fileName=").concat(o.fileName),t.fileName=o.fileName,t.fileType=o.fileType,t.uploadId=o.uploadId,t.attachmentUrl=o.attachmentUrl,t.saveFunction=n,t.loading=!0,window.addEventListener("beforeunload",u),"homework"!==t.activityData.type||t.canEditByPdfEditorWithType(o.fileType)||e.$broadcast("previewFile",l(),t.activityData.activity)})),e.$on("pdfEditor:loading",((e,r)=>{t.loading=r}));t.savePdf=(r,o)=>{var n;if(t.loading=!0,null!=r&&r>100)return t.loading=!1,c.error(t.$t("homework.scoreError"));(t=>{e.$broadcast("syncSubmissionScore",t)})(r);var i=new CustomEvent("savePdf",{detail:{saveFunction:t.saveFunction,showSuccessToastr:o}}),a=null===(n=document.getElementById("pdfEditorIframe"))||void 0===n?void 0:n.contentDocument;a?a.dispatchEvent(i):t.saveFunction()},t.switchPdfChanged=e=>{t.isPdfChanged=e},t.openConfirmPopup=()=>{var e,r=new CustomEvent("closePdf",{detail:{switchPdfChanged:t.switchPdfChanged}}),o=null===(e=document.getElementById("pdfEditorIframe"))||void 0===e?void 0:e.contentDocument;o&&o.dispatchEvent(r),t.isPdfChanged?t.isConfirmPopupOpen=!0:t.exitPdfEditor()},t.$on("setActivityData",(function(e,r){t.activityData=r})),t.changeFile=r=>{t.exitPdfEditor(),e.$broadcast("changePdfEditor",r)},t.exitPdfEditor=()=>{t.isConfirmPopupOpen=!1,window.removeEventListener("beforeunload",u),o("#pdf-editor").foundation("reveal","close")},t.cancelExitPdfEditor=()=>{t.isConfirmPopupOpen=!1},t.canEditByPdfEditorWithType=e=>["document","image"].includes(e);var l=()=>{var e=t.activityData;return e.uploads[e.uploadIdToIndexes[t.uploadId]]};t.isDisableClick=e=>{var r=t.activityData,o=r.type,n=r.uploadsLen,i=r.uploadIdToIndexes;if("homework"!==o)return!1;var a=i[t.uploadId]+e;return a<0||a>=n}}]},269396:function(e){e.exports=["$rootScope","$scope",function(e,t){}]},966641:function(e,t,r){var o=r(496486),n=r(383228),i=r(730381);e.exports=["$scope","$http",function(e,t){var r=o.parseInt(n("#userId").data("id")),a="".concat(r,":last_check_pre_task");return function(){var r=window.localStorage.getItem(a);if(!r||i.utc(r).add(6,"hour")<i.utc())return t.get("/api/user/pre-task").success((function(t){if(window.localStorage.setItem(a,i.utc().format()),t.has_pre_task)return n("#pre-task-popup").foundation("reveal","open"),e.url=t.url||"http://eurasia.mycospxk.com/"})).error((function(){}))}()}]},199004:function(e,t,r){var o=r(139390);e.exports=["$scope","$http","toastr",function(e,t,r){var n=window.featureToggles||{};n.wps_preview?(wpsInit=function(){var t=document.getElementById("ppt-viewer");o.wpsPreviewInit(e.upload.documentUrl,t)},wpsInit()):n.yz_office_preview&&e.$watch("upload.id",(function(e){i(e)})),e.previewDataMap={};var i=function(o){t.get("/api/uploads/".concat(o,"/preview/yz")).then((function(t){e.previewDataMap[o]=t.data.preview_url})).catch((function(){r.error()}))}}]},371810:function(e){e.exports=["$rootScope","$scope","$location",(e,t,r)=>t.isHttpResource=function(e){return"http"!==r.$$protocol&&/^http:\/\//.test(e)}]},112253:function(e,t,r){var o=r(383228);r(788674);var n=r(887757);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function a(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c(e,t,r,o,n,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(o,n)}r(535666),e.exports=["$scope","activityRepository","modelHelper","publishHelper",function(e,t,r,i){var s=o("#courseId").val();e.activityUrl=r.activityUrl;var u=function(){var r,i=(r=n.mark((function r(){var i,a,c;return n.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return e.courseStudy={completeness:0},r.next=3,t.getAllActivitiesForStudentCompleteness(s);case 3:c=r.sent,e.courseStudy.lastStudyActivity=c.last_activity,e.courseStudy.completeness=c.study_completeness,e.courseStudy.last_update_completeness_time=c.last_update_completeness_time,e.enableAlertStudentCompletedLearning&&null!==(i=e.courseStudy)&&void 0!==i&&i.completeness&&(null===(a=e.courseStudy)||void 0===a?void 0:a.completeness)>=100&&window.location.pathname==="/course/".concat(s,"/content")&&o("#alert-student-complete-learning-popup").foundation("reveal","open");case 8:case"end":return r.stop()}}),r)})),function(){var e=this,t=arguments;return new Promise((function(o,n){var i=r.apply(e,t);function a(e){c(i,o,n,a,s,"next",e)}function s(e){c(i,o,n,a,s,"throw",e)}a(void 0)}))});return function(){return i.apply(this,arguments)}}();return e.continueStudy=()=>{if(e.courseStudy.lastStudyActivity)if(i.canViewActivityPermission(!1,e.courseStudy.lastStudyActivity))window.location.href=e.activityUrl(e.courseStudy.lastStudyActivity,e.course.id,!1);else{var t=o("#access-forbidden-popup");t.foundation("reveal","open");var r=e.courseStudy.lastStudyActivity,n=r.activity_start_time,s=r.activity_end_time,c=r.published;o("[ng-controller=AccessForbiddenController]",t).scope().__accessForbidden=a(a({},e.courseStudy.lastStudyActivity),{},{start_time:n,end_time:s,published:c})}},u()}]},664584:function(e){e.exports=["$scope",function(e){e.currentAudio={},e.nextAudio={},e.nextVideo={},e.$on("initSwitchAudioPopup",(function(t,r){e.currentAudioScope=r.currentAudioScope,e.nextAudioScope=r.nextAudioScope,e.nextVideo=r.videoScope})),e.confirm=function(){if(e.nextVideo&&"video"===e.nextVideo.type)return e.$root.$broadcast("playVideo",e.nextVideo),void e.$root.$broadcast("pauseAudio");e.$root.$broadcast("switchAudio",{currentAudioScope:e.currentAudioScope,nextAudioScope:e.nextAudioScope})}}]},786292:function(e){e.exports=["$scope",function(e){e.currentVideo={},e.nextVideo={},e.nextAudio=null,e.$on("initSwitchVideoPopup",(function(t,r){e.currentVideo=r.currentVideo,e.nextAudio=r.audioScope,e.nextVideo=r.nextVideo})),e.confirm=function(){e.nextAudio?e.$root.$broadcast("playAudio",e.nextAudio):"close"!==e.currentVideo.type?e.$root.$broadcast("switchVideo",{currentVideo:e.currentVideo,nextVideo:e.nextVideo}):e.$root.$broadcast("closeVideo")},e.closeModal=()=>{}}]},383844:function(e,t,r){var o=r(383228),n=r(942783);e.exports=["$scope","$http","bulletinApi","$location",function(e,t,r,i){e.toggleBulletin=function(e){window.location.href="/bulletin-list/?type=org&bulletin_id=".concat(e.id)},e.goToBulletin=function(){window.location.href="/bulletin-list/?type=org"},e.cancel=function(){o("#unread-org-bulletin-popup").foundation("reveal","close")},e.pageSize=100,function(){e.ui={inPopup:!0},e.conditions={unread:!0,show_on_popup:!0};var t=n(e,i,"org-bulletins"),a=(t,o,n)=>r.getBulletins(t,o,e.conditions,n),s=t=>{e.bulletins=t.bulletins,e.bulletins.length&&o("#unread-org-bulletin-popup").foundation("reveal","open")};e.changePage=e=>t.changePage(e,a,s),e.changePage(1)}()}]},787174:function(e){e.exports=["$http","$q","toastr",(e,t,r)=>({getOpenClientURL(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=t.defer(),i="/api/blobstorage/open-client-url?parent_id=".concat(o,"&no-intercept=true");return e.get(i).success((e=>n.resolve(e.open_client_url))).error(r.decorateError()),n.promise}})]},598248:function(e,t,r){var o=r(496486);e.exports=["$http","$q","toastr",function(e,t,r){var n,i=t.defer(),a=!1,s=function(e){return o.merge(n,e),a=!0,i.resolve(e)};return n={load:()=>(a||e.get("/api/config?no-intercept=true").success(s).error(r.decorateError),i.promise)}}]},318293:function(e,t,r){r(747042),e.exports=["$q",function(e){class t{constructor(e){this.blob=e,this.reader=new FileReader}read(){return this.deferred||(this.deferred=e.defer(),this.reader.onload=e=>this.deferred.resolve(e.target.result),this.reader.readAsArrayBuffer(this.blob)),this.deferred.promise}}return function(e){for(var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4194304,o=Math.floor((e.size+r-1)/r),n=[],i=0,a=o,s=0<=a;s?i<a:i>a;s?i++:i--){var c=i*r,u=e.slice(c,c+r);n.push(new t(u))}return n}}]},271692:function(e){e.exports=["$timeout",e=>({highlight(t,r){var o=r&&r.fadeInDuration?r.fadeInDuration:1e3,n=r&&r.fadeOutDuration?r.fadeOutDuration:400,i=r&&r.duration?r.duration:1e3,a=r&&r.color?r.color:"#FFFF99";return t.animate({"background-color":a},{duration:o,complete:()=>e((()=>t.animate({"background-color":""},{duration:n})),i)})}})]},665458:function(e,t,r){var o=r(261139);e.exports=o.module("baseFactory",["base",r(155360)]).factory("toastr",r(959242)).factory("modelHelper",r(766832)).factory("highlight",r(271692)).factory("multiSelect",r(108081)).factory("commonApi",r(392853)).factory("config",r(598248)).factory("blobstorage",r(787174)).factory("simditor",r(969658)).factory("treeViewSearch",r(579920)).factory("scormUtils",r(371493)).factory("fileSlice",r(318293)).factory("revealModalParams",r(924463)).factory("momentService",r(734922)).factory("navSettingRepository",r(515996)).factory("statHelper",r(516109)).factory("videoQuizRepository",r(985592)).factory("ExamSubject",r(665383)).factory("interactionHelper",r(499289)).factory("filesApi",r(397416)).factory("calendarApi",r(875966)).factory("calendarRepository",r(443746)).factory("activityApi",r(169671)).factory("activityRepository",r(33614)).factory("examApi",r(62174)).factory("fileSelectModel",r(194410)).factory("publishHelper",r(685795)).factory("Course",r(354476)).name},734922:function(e){e.exports=()=>({DATE_TIME_FORMAT:"YYYY.MM.DD HH:mm"})},108081:function(e,t,r){var o=r(383228),n=r(496486);r(132023);var i=r(624562),a=r(796824);e.exports=["$timeout",e=>({multiSelect(t,r){var s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],c=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],u=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return e((function(){var e=o(t),l=e.find("option");if(r&&n.each(l,(function(e){r.includes(e.value)&&o(e).prop("selected",!0)})),e.children("option").length>=8e3){try{e.multiselect("destroy")}catch(e){}return a(e,t,null,s,c,!1,u)}return e.data("echMultiselect")&&(c&&e.multiselectfilter("destroy"),e.multiselect("destroy")),i(e,t,s,c,u)}))}})]},515996:function(e){e.exports=["$http","$q",function(e,t){var r={};return{initNavSetting(o){if(r[o])return r[o].promise;r[o]=t.defer();return e.get("/api/courses/".concat(o,"/nav-setting")).success((e=>r[o].resolve(e))).error((()=>r[o].resolve())),r[o].promise}}}]},924463:function(e){e.exports=()=>({})},371493:function(e,t,r){var o=r(496486);function n(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,n=function(){};return{s:n,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw a}}}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}r(454747),e.exports=function(){var e=function(e,t,r,n,i){var a;if((a=r instanceof Array?o.find(r,{identifier:t.identifierref}):r)&&(t.scormUrl="/api/uploads/scorm/".concat(e,"?sco=").concat(a.href,"&preview=true")),a&&i&&(t.scormUrl="/".concat(n,"/shared-resources/").concat(i,"/scorms?sco=").concat(a.href)),t.parameters&&t.scormUrl)return t.scormUrl+="&para=".concat(encodeURIComponent(t.parameters))};return{bindItemResources:function t(r,n,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"api",s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return n instanceof Array?o.forEach(n,(function(o){if(o.identifierref&&e(r,o,i,a,s),o.item)return t(r,o.item,i)})):(e(r,n,i,a,s),n.item?t(r,n.item,i):void 0)},getFirstScoItem:function e(t){if(!(t instanceof Array))return t;var r,o=n(t);try{for(o.s();!(r=o.n()).done;){var i=r.value;if(i.scormUrl)return i;if(i.item)return e(i.item)}}catch(e){o.e(e)}finally{o.f()}}}}},516109:function(e){e.exports=function(){return{inPage(e){if(window.st)return window.st.inPage(e)},setActivityType(e){if(window.st)return window.st.setActivityType(e)},trackVisitOnDestroy(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(window.st)return t&&window.st.inPage(t),e.$on("$destroy",(e=>window.st.trackVisit()))},inExamPage(e){if(window.st){var t={activity_id:e.id};return"syllabus"===e.referrer_type&&(t.syllabus_id=e.referrer_id),"module"===e.referrer_type&&(t.module_id=e.referrer_id),st.inPage(t),st.setActivityType("exam")}},track(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(window.st)return window.st.track(e,t,r,o)}}}},579920:function(e,t,r){var o=r(496486),n=r(261139);r(324603),r(339714),r(132023),r(115306),e.exports=function(){var e=function(e,t){var r=t||"",o=new RegExp(r.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&"),"i");return 0===r.length||o.test(e.name)},t=function t(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"departments";return o.filter(r,(function(r){return r[i]=t(r[i],n),e(r,n)||!o.isEmpty(r[i])}))},r=function(e,t,r){var o=n.copy(t);return i(e,o),r.$broadcast("refreshTreeViewModel")},i=(e,t)=>o.each(e,(function(e){return e.selected=!!t.includes("".concat(e.id)),null!=e.departments&&e.departments.length>0&&i(e.departments,t),!0}));return{searchDepartmentTree(e,n,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"departments",s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,c=n[e].keyword,u=o.cloneDeep(s||n.originalDepartments);return n[a]=t(u,c),r(n[a],i,n)},searchOrgTree(e,n,i){var a=n[e].keyword,s=o.cloneDeep(n.originalOrgs);return n.orgs=t(s,a,"children"),r(n.orgs,i,n)},searchSubjectLibsTree(e,t){var r=t[e].keyword,n=o.cloneDeep(t.originalLibs);return o.filter(n,(e=>function(e,t){var r=new RegExp(t.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&"),"i");return 0===t.length||r.test(e.title)}(e,r)))},searchDepartmentPermissionTree(e,r){var n=r[e].keyword,i=o.cloneDeep(r.originalDepartmentsTree);r.departments.depTree=t(i,n)},searchDepartmentTreeInScorePublishItem(e,n,i){var a=n[e].keyword,s=o.cloneDeep(n.ui.originalDepartments);return n.ui.departments=t(s,a),r(n.ui.departments,i,n)}}}},895523:function(e,t,r){var o=r(383228),n=r(496486),i=r(477260);e.exports={drawLineChart(e,t,r){var a,s,c,u,l,d,p,f,v,m,h,g,y,b,w;return a=o("#file-hyp-stat-chart"),s=i.init(a[0],"default"),c="#D8D8D8",u=[{type:"line",data:t.statSeries||[0],itemStyle:{normal:{color:"#00BBBD"}}}],l={show:!0,type:"line",lineStyle:{width:1,color:"#D8D8D8"}},d="\n\n\n   "+(null!=r?r.pageNumber:void 0),p=(null!=r?r.numOfNotes:void 0)+"\n",f={color:"#333333"},v={lineStyle:{color:c,width:1}},m={lineStyle:{color:c}},h={show:!0,lineStyle:{type:"dashed",color:"#E8E8E8"}},g={textStyle:{color:"#999999",fontWeight:100}},y=n.extend({},g,{margin:15}),b=n.extend({},g,{margin:12}),w={tooltip:{trigger:"axis",axisPointer:l,formatter:"{c}",padding:[5,19]},grid:{x:55,y:55,x2:55,y2:72,borderWidth:0},xAxis:[{name:d,nameTextStyle:f,data:e,boundaryGap:!1,splitLine:{show:!1},splitArea:{show:!1},axisLine:v,axisTick:m,axisLabel:y}],yAxis:[{name:p,nameTextStyle:f,type:"value",splitLine:h,axisLine:{lineStyle:{color:"rgba(0,0,0,0)"}},axisLabel:b}],series:u},s.setOption(w),a.on("resizeChart",(()=>s.resize()))},clearChart(e){i.init(e[0],"default").clear()}}},749807:function(e,t,r){var o=r(383228),n=r(496486),i=function(e,t){var r=o(e),n=r.find(">.row"),i=n.innerHeight();if(i>=t)for(var a=r.find(".autocollapse-container"),s=n.find(".autocollapse-item").not(".autocollapse-container .autocollapse-item"),c=s.length-1;c>=0&&i>t;)o(s[c]).prependTo(a),c-=1,i=n.innerHeight()};o((function(){setTimeout((()=>{i(".header-autocollapse",60)}),300),o(window).on("resize",n.debounce((function(){i(".header-autocollapse",60)}),150))}))},932135:function(e,t,r){var o=r(496486);r(682772),r(132023),r(804723),t.cacheBusterInterceptor=()=>({request:e=>(/^\/api\//.test(e.url)&&window.RequestScope&&(e.headers["Request-Scope"]=window.RequestScope),e)}),t.progressInterceptor=["$q","$rootScope","$injector","$window",function(e,t,r,n){var i=0,a=0,s=null,c=function(e){var t="GET"===e.method.toUpperCase()&&-1!==e.url.indexOf("/notifications"),r=o.includes(e.url,"no-intercept=true");return e.url.match("html$")||t||r},u=function(e){return!o.includes(e.url,"no-loading-animation=true")&&"GET"===e.method.toUpperCase()},l=function(){return s=s||r.get("ngProgress")},d=function(){return t.ui=t.ui||{},t.ui},p=()=>{d().contentLoadingComplete=!0,t.contentLoaded=!1};p();var f=function(e){if(0===(i-=1)&&l().complete(),window.justFontFlush&&window.justFontFlush(),u(e)&&0===(a-=1))return p()};return{request:e=>(c(e)||(i+=1,u(e)&&(a+=1),1===i&&(l().reset(),l().start()),1===a&&(d().contentLoadingComplete=!1,t.contentLoaded=!0)),e),requestError:t=>(c(t.config)||f(t.config),e.reject(t)),response:e=>(c(e.config)||f(e.config),e),responseError:t=>401===t.status?n.location.href="/login?next="+encodeURIComponent(n.location.pathname+n.location.hash):(f(t.config),e.reject(t))}}]},483941:function(e,t,r){"use strict";r.r(t);r(115306);var o={lang:"简体",clipTaskTitle:"剪辑",taskProcessing:"进行中",taskFail:"失败",residue:"剩余",processFail:"处理失败",saveSuccess:"保存成功",saveError:"保存失败",mark:"批改",videoSpeed:"倍速",user:"人员",addUser:"新增人员",basicInfo:"基础信息",enrollmentManagement:"修课管理",rollcallRecord:"点名记录",alertRecord:"预警记录",roleManagement:"权限管理",cliping:"剪辑中",clipFailed:"剪辑失败",compositing:"合成中",compositeFailed:"合成失败",Student:"学生",Instructor:"教师",Faculty:"教职工",EducationalAdmin:"教务人员",Admin:"超级管理员",courseSubject:"科目",addCourseSubject:"新增科目",editCourseSubject:"编辑科目",course:"课程",addCourse:"新增课程",editCourse:"编辑课程"},n={lang:"繁體",clipTaskTitle:"剪輯",taskProcessing:"進行中",taskFail:"失敗",residue:"剩餘",processFail:"處理失敗",saveSuccess:"儲存成功",saveError:"儲存失敗",mark:"批改",videoSpeed:"倍速",user:"人員",addUser:"新增人員",basicInfo:"基本資訊",enrollmentManagement:"修課管理",rollcallRecord:"點名記錄",alertRecord:"預警記錄",roleManagement:"權限管理",cliping:"剪輯中",clipFailed:"剪輯失敗",compositing:"合成中",compositeFailed:"合成失敗",Student:"學生",Instructor:"教師",Faculty:"教職工",EducationalAdmin:"教務人員",Admin:"系統管理員",courseSubject:"科目",addCourseSubject:"新增科目",editCourseSubject:"編輯科目",course:"課程",addCourse:"新增課程",editCourse:"編輯課程"},i={lang:"繁體",clipTaskTitle:"剪輯",taskProcessing:"進行中",taskFail:"失敗",residue:"剩餘",processFail:"處理失敗",saveSuccess:"儲存成功",saveError:"儲存失敗",mark:"批改",videoSpeed:"倍速",user:"人員",addUser:"新增人員",basicInfo:"基本資訊",enrollmentManagement:"修課管理",rollcallRecord:"點名記錄",alertRecord:"預警記錄",roleManagement:"權限管理",cliping:"剪輯中",clipFailed:"剪輯失敗",compositing:"合成中",compositeFailed:"合成失敗",Student:"學生",Instructor:"教師",Faculty:"教職工",EducationalAdmin:"教務人員",Admin:"系統管理員",courseSubject:"學程科目",addCourseSubject:"新增學程科目",editCourseSubject:"編輯學程科目",course:"科目",addCourse:"新增科目",editCourse:"編輯科目"},a={lang:"gb",clipTaskTitle:"Edit",taskProcessing:"In progress",taskFail:"Fail",residue:"Residue",processFail:"Process Fail",saveSuccess:"Save Successfully",saveError:"Save Failed",mark:"Mark",videoSpeed:"Speed",user:"User",addUser:"Add User",basicInfo:"Basic Information",enrollmentManagement:"Enrollment Management",rollcallRecord:"Rollcall Record",alertRecord:"Alert Record",roleManagement:"Authority Management",cliping:"Cliping",clipFailed:"Clip Failed",compositing:"Compositing",compositeFailed:"Composite Failed",Student:"Student",Instructor:"Instructor",Faculty:"Faculty",EducationalAdmin:"EducationalAdmin",Admin:"SuperAdmin",courseSubject:"Subject",addCourseSubject:"Add Subject",editCourseSubject:"Edit Subject",course:"Course",addCourse:"Add Course",editCourse:"Edit Course"},s={lang:"us",clipTaskTitle:"Edit",taskProcessing:"In progress",taskFail:"Fail",residue:"Residue",processFail:"Process Fail",saveSuccess:"Save Successfully",saveError:"Save Failed",mark:"Mark",videoSpeed:"Speed",user:"User",addUser:"Add User",basicInfo:"Basic Information",enrollmentManagement:"Enrollment Management",rollcallRecord:"Rollcall Record",alertRecord:"Alert Record",roleManagement:"Authority Management",cliping:"Cliping",clipFailed:"Clip Failed",compositing:"Compositing",compositeFailed:"Composite Failed",Student:"Student",Instructor:"Instructor",Faculty:"Faculty",EducationalAdmin:"EducationalAdmin",Admin:"SuperAdmin",courseSubject:"Subject",addCourseSubject:"Add Subject",editCourseSubject:"Edit Subject",course:"Course",addCourse:"Add Course",editCourse:"Edit Course"},c={lang:"thai",clipTaskTitle:"แก้ไจ",taskProcessing:"กำลังดำเนินการ",taskFail:"ล้มเหลว",residue:"ส่วนที่เหลือ",processFail:"ดำเนินการล้มเหลว",saveSuccess:"บันทึกสำเร็จ",saveError:"บันทึกล้มเหลว",mark:"ทำเครื่องหมาย",videoSpeed:"ความเร็ว",user:"ผู้ใช้",addUser:"เพิ่มผู้ใช้",basicInfo:"ข้อมูลพื้นฐาน",enrollmentManagement:"การจัดการการลงทะเบียน",rollcallRecord:"บันทึกการขานชื่อ",alertRecord:"บันทึกการแจ้งเตือน",roleManagement:"การจัดการอำนาจ",cliping:"คลิป",clipFailed:"คลิปล้มเหลว",compositing:"กำลังประกอบ",compositeFailed:"การประกอบล้มเหลว",Student:"นักเรียน",Instructor:"ผู้สอน",Faculty:"คณะ",EducationalAdmin:"ผู้ดูแลระบบการศึกษา",Admin:"ผู้ดูแลระบบขั้นสูง",courseSubject:"Subject",addCourseSubject:"Add Subject",editCourseSubject:"Edit Subject",course:"Course",addCourse:"Add Course",editCourse:"Edit Course"},u={lang:"Tiongkok Tradisional",clipTaskTitle:"Mengedit",taskProcessing:"Sedang berlangsung",taskFail:"Gagal",residue:"Sisa",processFail:"Proses gagal",saveSuccess:"Berhasil disimpan",saveError:"Gagal disimpan",mark:"Koreksi",videoSpeed:"Kecepatan Ganda",user:"Staf/Anggota",addUser:"Tambah anggota baru",basicInfo:"Informasi dasar",enrollmentManagement:"Pengelolaan Kursus",rollcallRecord:"Rekam Kehadiran",alertRecord:"Rekam Peringatan",roleManagement:"Pengelolaan Izin",cliping:"Sedang Diedit",clipFailed:"Gagal Diedit",compositing:"Sedang Disintesis",compositeFailed:"Gagal Disintesis",Student:"Siswa",Instructor:"Pengajar",Faculty:"Tenaga Pengajar",EducationalAdmin:"Staf akademik",Admin:"Administrator sistem"},l={lang:"Tradisional",clipTaskTitle:"Sunting",taskProcessing:"Sedang Berlangsung",taskFail:"Gagal",residue:"Baki",processFail:"Proses gagal",saveSuccess:"Berjaya disimpan",saveError:"Gagal disimpan",mark:"Menilai",videoSpeed:"Kelajuan Ganda",user:"Staf/Individu",addUser:"Menambah Staf",basicInfo:"Informasi Dasar",enrollmentManagement:"Pengurusan Kursus",rollcallRecord:"Rekod Kehadiran",alertRecord:"Rekod Amaran",roleManagement:"Pengurusan Keizinan",cliping:"Sedang disunting",clipFailed:"Suntingan gagal",compositing:"Sedang disintesis",compositeFailed:"Penyintesisan gagal",Student:"Pelajar",Instructor:"Guru",Faculty:"Staf pengajar",EducationalAdmin:"Pegawai akademik",Admin:"Pentadbir sistem"},d={lang:"vi",clipTaskTitle:"Chỉnh",taskProcessing:"Đang xử lý",taskFail:"Thất bại",residue:"Dư liệu",processFail:"Xử lý lỗi",saveSuccess:"Lưu thành công",saveError:"Lưu thất bại",mark:"Đánh dấu",videoSpeed:"Tốc độ",user:"Người dùng",addUser:"Thêm người",basicInfo:"Thông tin cơ bản",enrollmentManagement:"Quản lý ghi danh",rollcallRecord:"Ghi điểm danh",alertRecord:"Ghi chú cảnh báo",roleManagement:"Quản lý quyền",cliping:"Đang cắt",clipFailed:"Cắt lỗi",compositing:"Đang ghép",compositeFailed:"Ghép lỗi",Student:"Sinh viên",Instructor:"Giảng viên",Faculty:"Khoa",EducationalAdmin:"QL Giáo vụ",Admin:"Quản trị viên",courseSubject:"Học phần",addCourseSubject:"Thêm học phần",editCourseSubject:"Sửa học phần",course:"Khóa học",addCourse:"Thêm khóa học",editCourse:"Sửa khóa học"},p=r(383228),f=r(261139);r(632067);var v=p("html").attr("lang");f.module("i18n",["pascalprecht.translate"]).config(["$translateProvider",function(e){e.translations("zh-cn",o),e.translations("zh-tw",n),e.translations("zh-mo",i),e.translations("en-gb",a),e.translations("en-us",s),e.translations("th-th",c),e.translations("id-id",u),e.translations("ms-my",l),e.translations("vi-vn",d)}]).run(["$translate",function(e){e.use(v.replace("_","-").toLowerCase())}]).name},716894:function(e,t,r){"use strict";r.r(t);var o=r(261139);r(685690),r(780640),o.module("common",[r(940635),r(665458),r(653131)])},692624:function(e,t,r){var o=r(383228);o(document).on("click","input.truncate-text",(function(){return o(this).prop("readonly",""),o(this).focus()})).on("blur","input.truncate-text",(function(){return o(this).prop("readonly","readonly")}))},624562:function(e,t,r){var o=r(496486),n=r(383228),i=r(261139);function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r(491038),r(115306),r(864765),e.exports=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],c=arguments.length>4&&void 0!==arguments[4]&&arguments[4],u=e.find("option").length,l=25*o.min([u,7]);t=t.replace("#","");var d=()=>n(".multi-select .ui-multiselect-checkboxes .ui-corner-all").each((function(){var e;i.isDefined(n(this).attr("title"))?(e=n(this).attr("title"),n(this).removeAttr("title")):e=n(this).text();var t=n(this).children("span");return t.attr("title",e),t.tipsy({ellipsis:!0,gravity:n.fn.tipsy.autoBounds(37,"sw"),opacity:1,html:!0})})),p=()=>{var e=n("#".concat(t," + :button.multi-select[title]")),r=e.width(),o=e.next(),i=0;o.find("span").each((function(){i=this.offsetWidth>i?this.offsetWidth:i})),i=Math.min(i,435),o.css("width","".concat(i+54,"px")),o.css("min-width","".concat(r,"px")),n(".ui-multiselect-menu .ui-multiselect-header .ui-multiselect-filter input").css("width","100%")},f=()=>{var e=n("#".concat(t," + button.multi-select")),r=e.outerHeight(),o=e.siblings(".ui-multiselect-menu"),i=e.offset(),a=Array.from(o).find((e=>"block"===n(e).css("display")));n(a).offset(s(s({},i),{},{top:i.top+r}))},v=e=>{var r=n("#".concat(t," + button.multi-select"));n(".ui-icon.ui-icon-triangle-1-s",r).css("transform","rotate(".concat(e,"deg)"))},m=e.multiselect({header:!!a&&"",appendTo:e.parent(),multiple:r,noneSelectedText:e.data("title"),htmlText:["options"],selectedText:(e,t,r)=>1===e?n(r[0]).attr("title")||n(r[0]).next().text():e===t?n("#selected-text-all").text():n("#selected-text").text().replace("#",e),classes:"multi-select",buttonWidth:"auto",selectedList:1,height:l,open(){c?p():d(),f(),v(180)},beforeclose(){var e=n("#".concat(t," + :button.multi-select[title]")),r=e.attr("title"),o=n("#".concat(t," + :button.multi-select[title] .button-label"));return e.removeAttr("title"),o.attr("title",r),v(0),o.tipsy({ellipsis:!0,gravity:n.fn.tipsy.autoBounds(37,"sw"),opacity:1,html:!0})},click(){var t=e.scope(),r=t.disbaleSearch||"true"===e.attr("disableSearch");t.$emit("multiSelect.changed"),"function"!=typeof t.search||r||setTimeout((()=>t.$apply((()=>t.search()))),0)}});e.next().children("span.ui-multiselect-open").removeAttr("title"),a&&m.multiselectfilter({label:"",placeholder:n("#filter-placeholder").text()})}},864604:function(e){e.exports=()=>({restrict:"A",link:(e,r)=>r.off("change keyup keydown paste",t).on("change keyup keydown paste",t)});var t=function(){return this.style.height="auto",this.style.height=this.scrollHeight+"px"}},267038:function(e,t,r){var o=r(437232).default,n=r(385819);e.exports=function(){return{restrict:"E",scope:{src:"=src"},template:'<svg viewBox="'.concat(o.viewBox,'" ng-if="!src" class="avatar-svg">\n      <use xlink:href="#').concat(o.id,'" />\n    </svg>\n    <img ng-src="[[ src ]]" ng-if="src" err-src="').concat(n,'">')}}},985396:function(e,t,r){var o=r(496486),n=r(383228);e.exports=["$timeout",e=>({restrict:"A",scope:{actualHeight:"="},link:(t,r,i)=>(t.actualHeight=0,e((()=>o.each(r.children(),(e=>t.actualHeight+=n(e).height())))))})]},80320:function(e,t,r){var o=r(383228),n=r(496486);r(682772),e.exports=["$rootScope",e=>({restrict:"A",link(t,r,i){var a=r,s=function(){return(parseFloat(i.maxLines)||2)*function(){var e,t=a.css("line-height");if(-1===t.indexOf("px")){var r=parseFloat(a.css("font-size"));e=parseFloat(t)*r}else e=parseFloat(t);return e}()+(parseFloat(a.css("padding-top"))||0)+(parseFloat(a.css("padding-bottom"))||0)+(parseFloat(a.css("border-top"))||0)+(parseFloat(a.css("border-bottom"))||0)},c=t.dotdotdotToggleCollapseI18n||e.dotdotdotToggleCollapseI18n,u=t.dotdotdotToggleExpandI18n||e.dotdotdotToggleExpandI18n,l=o(n.template('<a class="dotdotdot-toggle dotdotdot-toggle-expand" href="javascript:void(0)"><%= text %></a>')({text:u})),d=o(n.template('<a class="dotdotdot-toggle dotdotdot-toggle-collapse" href="javascript:void(0)"><%= text %></a>')({text:c})),p=function(){if(i.ngBindHtml&&(a=r.children()),!i.noExpand)return l.detach(),d.detach(),a.trigger("destroy"),a[0].scrollHeight>s()?(a.append(l),a.dotdotdot({ellipsis:"",height:s(),wrap:"letter",after:"a.dotdotdot-toggle"})):void 0;a.dotdotdot({height:s(),wrap:"letter"})};return l.click((e=>{e.stopPropagation(),a.trigger("destroy"),l.detach(),a.append(d)})),d.click((e=>{e.stopPropagation(),p()})),t.$watch(i.ngBind||i.ngBindHtml,p)}})]},746794:function(e){e.exports=["$timeout",e=>({restrict:"A",scope:{sliderErrors:"=?",sliderValidation:"&",sliderVerification:"&"},link(t,r,o){r.foundation(),r.foundation("slider","set_value",0);var n="#".concat(o.sliderControl),i=r.find(n);e((function(){var e=r.find("div[data-slider]");return e.on("change.fndtn.slider",(function(){var t=e.attr("data-slider");return i.val(t),i.trigger("change")}))}));var a=i.controller("ngModel");return t.$watch((()=>a.$modelValue),(function(e){if(t.sliderValidation({sliderModelValue:e})&&(t.sliderErrors&&(t.sliderErrors.sliderModelError=t.sliderVerification({sliderModelValue:e})),!isNaN(e)))return r.foundation("slider","set_value",e)}))}})]},845376:function(e,t,r){var o=r(92116);e.exports=function(){return{restrict:"A",link(e,t,r){o(t[0],{output:"mathml",delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],ignoredTags:["script","noscript","style","textarea","pre","code"]})}}}},892958:function(e,t,r){var o=r(704609),n=!1;e.exports=function(){return{restrict:"A",link(e,t,r){t.addClass("mathjax-process"),n||(o(),n=!0)}}}},726356:function(e,t,r){var o=r(383228),n=r(496486);r(132023);var i=r(624562);e.exports=["$parse",e=>({restrict:"A",link(t,r,a){var s=t.$eval(a.ngModel),c=r.find("option");0===c.length&&a.hasOwnProperty("selectOptionsContainerId")&&(c=o("#".concat(a.selectOptionsContainerId)).find("option"),r.append(c)),s&&n.each(c,(function(e){if(s.includes(e.value)||e.value===s)return o(e).prop("selected",!0)}));var u=a.id,l=!a.multipleDisabled,d=!a.noFilter,p=!!a.responsive;if(i(r,u,l,d,p),a.multiSelectOpen){var f=e(a.multiSelectOpen);return r.bind("multiselectopen",((e,r)=>t.$apply((()=>f(t,{$event:e,$ui:r})))))}}})]},926082:function(e,t,r){var o=r(383228);r(115306),r(864765),e.exports=["$timeout",e=>({restrict:"A",require:"ngModel",scope:{ngModel:"="},link(t,r,n,i){var a,s=!n.noFilter,c=null!==(a=n.selectAll)&&void 0!==a&&a;r.multipleSelect({filter:s,minimumCountSelected:1,filterPlaceholder:o("#filter-placeholder").text(),selectAll:c,data:[],formatCountSelected:(e,t)=>o("#selected-text").text().replace("#",e),formatAllSelected:()=>o("#selected-text-all").text(),formatNoMatchesFound:()=>"",onClick:function(){i.$viewValue=r.multipleSelect("getSelects"),i.$commitViewValue();var t=r.scope();t.ngModel=r.multipleSelect("getSelects"),t.$emit("multiSelect.changed"),"function"!=typeof t.search||t.disbaleSearch||e((()=>t.$apply((()=>t.search()))),0)}})}})]},716858:function(e,t,r){var o=r(261139),n=r(383228),i=function(){return document.querySelectorAll("[data-reveal].open").length+document.querySelectorAll(".ivu-modal-wrap:not(.ivu-modal-hidden)").length};t.p=["$document","$timeout","$window",(e,t,r)=>({restrict:"A",link(a,s,c){var u={reposition:!0};return o.extend(u,a.$eval(c.onModalStateChange)),e.on("open.fndtn.reveal","[data-reveal]",(function(e){var t=n(e.target);return n(".popup-content",t).css("margin-top","")})),e.on("opened.fndtn.reveal","[data-reveal]",(function(e){var o=n(e.target);return t((function(){var e=n(".popup-content",o);if(!(o.attr("no-scroll")||o.hasClass("confirmation-popup")||(u.reposition&&function(e){var t="file-previewer"===e.attr("id");return!t||t&&e.scope().canGuestPreview}(o)&&function(e,t){setTimeout((()=>{if(e.height()>t.innerHeight)return e.css("margin-top",85);var r=parseInt((t.innerHeight-e.height())/2);return e.css("margin-top",r)}),0)}(e,r),i>1)))return n("body").css("overflowY","hidden")}))})),e.on("close.fndtn.reveal","[data-reveal]",(function(e){if(!(n(e.target).attr("no-scroll")||i()>1))return n("body").css("overflowY","")}))}})]},103982:function(e,t,r){var o=r(261139),n=r(496486),i=function e(t,r){for(var n in t){var i=t[n];if(n===r)return void delete t[r];o.isObject(i)&&e(i,r)}},a=function e(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"form",a=arguments.length>3?arguments[3]:void 0,s=()=>n.forOwn(c,(function(e){if(e&&e.$name&&!n.has(r,e.$name)&&n.has(c[e.$name],"error"))return delete c[e.$name].error,c[e.$name].$setValidity("server",!0)}));a=a||t;var c=t.scope()[i];return s(),(()=>{var i=[];for(var s in r){var u=r[s];if(0!==u.length)if(o.isObject(u[0])){var l=o.element("[ng-form='".concat(s,"']"),t);i.push(n.each(l,(function(t,r){e(o.element(t),u[r],s,a)})))}else{if(!c||!c[s])continue;c[s].$setValidity("server",!1),i.push(c[s].error=u[0])}}return i})()};t.serverValidated=()=>({restrict:"A",require:"?ngModel",link:(e,t,r,o)=>"FORM"===t.prop("tagName")?e.$watch("errors",(e=>a(t,e,t.attr("name"))),!0):e.$watch((()=>o.$modelValue),(function(){if(o.$setValidity("server",!0),t.hasClass("matching-sub-subject")||i(e.errors,o.$name),!e.$$phase)return e.$apply()}))}),t.errorFor=()=>({require:"^form",template:"{{message}}",scope:{},link(e,t,r,o){var n=o.$name,i=r.errorFor,a=r.watchForErrorChange;t.addClass("error");var s=function(){var r=n in e.$parent?e.$parent[n][i]:null;return r&&r.$invalid&&r.error?(t.show(),t.addClass("errorMessageShow"),e.message=r.error):(t.hide(),t.removeClass("errorMessageShow"),e.message="")};if(e.$watch("$parent.".concat(n,".").concat(i,".$error.server"),s),a)return e.$watch("$parent.".concat(n,".").concat(i,".error"),(function(e,t){if(null!=t&&e!==t)return s()}))}}),t.errorForTreeView=()=>({require:"^form",template:"{{message}}",scope:{},link(e,t,r,o){var n=o.$name,i=r.errorForTreeView;t.addClass("error");return e.$watch("$parent.".concat(n,".").concat(i,".$error.server"),(function(){var r=e.$parent[n][i],o=t.parents(".".concat(i)).find(".select2-choice");return r&&r.$invalid&&r.error?(o.addClass("ng-invalid"),t.show(),t.addClass("errorMessageShow"),e.message=r.error):(o.removeClass("ng-invalid"),t.hide(),t.removeClass("errorMessageShow"),e.message="")}))}})},625167:function(e,t,r){r(115306),e.exports=()=>({restrict:"A",link:(e,t,r,o)=>t.on("keyup",(function(e){var t=e.target.value,r=t.replace(/^\s+|\s+$/g,"");if(t!==r)return e.target.value=r}))})},845032:function(e,t,r){(0,r(353779).Z)(r(425303)),e.exports=function(){return{restrict:"E",scope:{name:"@name"},template:'<svg class="svg-icon">\n      <use xlink:href="" data-ng-href="[[\'#\' + name]]" />\n    </svg>'}}},529149:function(e,t,r){var o=r(958297);e.exports=["$timeout","$interval",(e,t)=>({restrict:"A",scope:{swfLoad:"&"},link(e,r,n){var i=function(e,r){var o,n=null;return o=t((function(){if(void 0!==e.ref.PercentLoaded&&e.ref.PercentLoaded())return 100===e.ref.PercentLoaded()||e.ref.PercentLoaded()===n?(t.cancel(o),o=null,r({evt:e})):n=e.ref.PercentLoaded()}),400)};return o.embedSWF(n.swfUrl,n.id,n.swfWidth||817,n.swfHeight||470,"9.0.0","/static/swf/expressInstall.swf",!1,{allowScriptAccess:"never",allowNetworking:"internal"},!1,(function(t){if(e.swfLoad&&"function"==typeof e.swfLoad)return t.success&&t.ref?i(t,e.swfLoad):e.swfLoad({evt:t})}))}})]},956212:function(e,t,r){var o=r(383228);e.exports=()=>({restrict:"A",link(e,t,r,n){var i="true"===r.inside?t.children(".dropdown-list"):t.next(".dropdown-list"),a=!1;!("stopPropagation"in r)||void 0!==typeof r.stopPropagation&&"true"!==r.stopPropagation&&""!==r.stopPropagation||(a=!0);var s=0,c=0,u=!1;return t.click((function(e){return e.stopPropagation(),i.toggleClass("hide")})),e.$watch((()=>e.$eval(r.disabled)),((e,t)=>{e!==t&&e&&setTimeout((()=>{i.addClass("hide")}))})),t.on("mouseenter",(function(){if(!e.$eval(r.disabled)){if(clearTimeout(s),clearTimeout(c),i.removeClass("hide"),"fixed"in r){var n=t.get(0).getBoundingClientRect(),a=n.x,u=n.y,l=n.height,d=o(document.body).width(),p=i.width(),f={position:"fixed",left:"".concat(a,"px"),top:"".concat(u+l+10,"px")};p+a>=d&&(f.left=a-p+20+"px"),i.css(f)}return t.removeClass("hovered")}})),t.on("mouseleave",(function(){return t.removeClass("hovered"),s=setTimeout((function(){if(!u)return i.addClass("hide")}),100)})),i.click((function(e){a&&e.stopPropagation()})),i.on("mouseenter",(function(){return t.addClass("hovered"),clearTimeout(s),clearTimeout(c),u=!0})),i.on("mouseleave",(function(){return t.removeClass("hovered"),u=!1,c=setTimeout((function(){if(!u)return i.addClass("hide")}),50)})),o("body").click((()=>i.addClass("hide")))}})},908760:function(e){e.exports=()=>({restrict:"A",link(e,t,r,o){var n="true"===r.inside?t.children(".dropdown-list"):t.next(".dropdown-list"),i=0,a=!1;t.click((function(e){return e.stopPropagation(),n.toggleClass("hide")})),t.on("mouseenter",(function(){return n.removeClass("hide"),t.removeClass("hovered")})),t.on("mouseleave",(function(){return t.removeClass("hovered"),i=setTimeout((function(){if(!a)return n.addClass("hide")}),20)}));var s=0;n.on("mouseenter",(function(){return t.addClass("hovered"),clearTimeout(i),clearTimeout(s),a=!0})),n.on("mouseleave",(function(){return t.removeClass("hovered"),a=!1,s=setTimeout((function(){if(!a)return n.addClass("hide")}),10)}))}})},752104:function(e){e.exports=()=>function(e){(!e||e<0)&&(e=0);var t=Math.floor(e/3600),r=Math.floor((e-3600*t)/60);return e=e-3600*t-60*r,t<10&&(t="0"+t),r<10&&(r="0"+r),(e=parseInt(e,10))<10&&(e="0"+e),"00"!==t?t+":"+r+":"+e:r+":"+e}},19e4:function(e,t,r){var o=r(496486);t.formatValidated=()=>({restrict:"A",require:"?ngModel",link(e,t,r,n){n.$parsers.push((function(e){var t=o.unescape(e);return t!=e&&(n.$setViewValue(t),n.$render()),t})),n.$formatters.push((function(e){return e?o.unescape(e):""}))}})},843671:function(e,t,r){var o=r(496486),n=r(383228);r(788674),r(132023),r(923157),r(454747);var i=r(887757);function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],o=!0,n=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(o=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);o=!0);}catch(e){n=!0,i=e}finally{try{o||null==s.return||s.return()}finally{if(n)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function c(e,t,r,o,n,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(o,n)}function u(e){return function(){var t=this,r=arguments;return new Promise((function(o,n){var i=e.apply(t,r);function a(e){c(i,o,n,a,s,"next",e)}function s(e){c(i,o,n,a,s,"throw",e)}a(void 0)}))}}r(535666);var l=r(117403).default,d=r(370538).default,p=r(385565).default,f=r(742609).WgVideoPlayer,v=r(693604),m=r(201351),h=r(631342),g=r(681423).Z,y=r(881063),b=r(693604);d.use(p),t.vueVideoMultiPlayer=["$timeout",function(){return{restrict:"A",scope:{activity:"=",upload:"=",logVideoPlayed:"&",activitiesRead:"=",playerInitiated:"&",resource:"=",videoUrls:"=",videoSrcType:"=",resolutions:"=",defaultResolution:"=",seekable:"=",lastPlayed:"=",maxPlayed:"=",download:"=",downloadLink:"=",disableTrack:"=",eventTimestamps:"=",onCustomEvent:"&",inCastServer:"@",canEditCaption:"=",captionAiGenerate:"=",unplayedSegments:"=",copyrightNotice:"="},link:function(e,t,i){var a,s=e.defaultResolution,c=o.isEmpty(null===(a=e.activity)||void 0===a?void 0:a.uploads)?e.upload:e.activity.uploads[0],u="boolean"==typeof e.download?e.download:c.allow_download,p=e.downloadLink?e.downloadLink:"/api/uploads/".concat(c.id,"/blob");e.activity&&(e.activity.videoDuration=c.videos[0].duration),e.resource&&(e.resource.videoDuration=c.videos[0].duration);var f=[{sources:o.map(e.videoUrls,(function(t,r){return{src:t,label:e.resolutions[r],type:e.videoSrcType,selected:r===s}})),mute:!1,volume:.7}],h={download:{toggle:u,onClick:()=>window.location.href=p}},g=i.forwardSeekingWarning;e.vue=new d({el:"#".concat(t.attr("id")),delimiters:["{[","]}"],components:{"player-error":r(133773).default},data:()=>{var t;return{reloadKey:0,showError:!1,errorReloadAble:!1,lastPlayed:e.lastPlayed>=(null===(t=e.activity)||void 0===t?void 0:t.videoDuration)?0:e.lastPlayed}},methods:{reload(){this.showError=!1,this.reloadKey+=1}},render:function(t){var r=t("multi-player",{key:this.reloadKey,props:{mode:"replay",videos:f,autoPlay:!1,seekable:e.seekable,lastPlayed:this.lastPlayed,maxPlayed:e.maxPlayed,plugins:h,customEventTimestamps:e.eventTimestamps,seekWarning:g,enablePlayRate:"False"!=i.enablePlayRate,enableFullscreen:"False"!=i.enableFullscreen,unplayedSegments:e.unplayedSegments,copyrightNotice:e.copyrightNotice||{}},on:{error:e=>{this.errorReloadAble=![3,5].includes(e.player.error().code),this.lastPlayed=e.player.currentTime(),this.showError=!0},playerReady:t=>{var r;t.el.querySelectorAll("video").forEach((e=>{e.setAttribute("oncontextmenu","return false;")})),this.reloadKey>0&&t.play(),e.disableTrack&&!e.resource||v.enableTrack(e,t,e.activity,"video",e.resource),e.playerInitiated&&(t.theCurrentTime=e=>e?(t.currentTime=e,e):t.currentTime,e.playerInitiated({player:t}));var o="".concat(c.id,"-").concat(c.key),i=n("#userId").data("id"),a=n("#orgCode").val()||"",s=Boolean(e.canEditCaption&&c.created_by_id==i),u=v.fileName(null!==(r=c.name)&&void 0!==r?r:""),l=r=>{t.configPlugin("caption",{toggle:String(e.inCastServer).startsWith("http"),mediaId:o,server:e.inCastServer||"",source:e.videoUrls[0],organization:r.orgCode,callback:"",downloadUrl:"".concat(e.inCastServer,"/api/media-captions/").concat(o,"/download?org_code=").concat(a,"&filename=").concat(u),permissions:{create:s&&Boolean(e.captionAiGenerate),upload:s}})};c.orgCode&&c.key?l(c):m.previewUploadsInfo(c.id,(e=>{l(e.data)}))}}});return window.player=r,this.showError?t("player-error",{props:{reloadAble:this.errorReloadAble},on:{reload:this.reload}}):r},i18n:l}),e.$on("$destroy",(function(){setTimeout((()=>{e.vue.$destroy()}))}))}}}],t.wgVideoPlayer=["$timeout",function(){return{restrict:"A",scope:{activity:"=",upload:"=",logVideoPlayed:"&",activitiesRead:"=",playerInitiated:"&",resource:"=",videoUrls:"=",videoSrcType:"=",resolutions:"=",defaultResolution:"=",seekable:"=",lastPlayed:"=",maxPlayed:"=",download:"=",orgCode:"=",downloadLink:"=",disableTrack:"=",unplayedSegments:"=",videoEditorServer:"@",enableCaption:"=",captionPermission:"=",enableTopic:"=",topicPermission:"=",copyrightNotice:"=",captionParagraphSplitInterval:"=",captionTranslatePermission:"=",enableChapter:"=",enableAisk:"=",chapterPermission:"=",customizeHeight:"=",hideSubPanel:"="},link:function(e,t,r){var a,s=e.defaultResolution,c=o.isEmpty(null===(a=e.activity)||void 0===a?void 0:a.uploads)?e.upload:e.activity.uploads[0],d="boolean"==typeof e.download?e.download:c.allow_download,p=e.downloadLink?e.downloadLink:"/api/uploads/".concat(c.id,"/blob");e.activity&&(e.activity.videoDuration=c.videos[0].duration),e.resource&&(e.resource.videoDuration=c.videos[0].duration);var g=[{sources:o.map(e.videoUrls,(function(t,r){return{src:t,label:e.resolutions[r],type:e.videoSrcType,selected:r===s}})),mute:!1,volume:.7}],y=o=>{var a,s,m,y,b,w,_,S="".concat(c.id,"-").concat(c.key),C=(n("#userId").data("id"),null===(a=n("#enrollmentIsStudent").val())||void 0===a||a.toLowerCase(),v.fileName(null!==(s=c.name)&&void 0!==s?s:"")),x=(null===(m=window.orgSettings)||void 0===m?void 0:m.airTranslationSupportedLanguages)||[],k={download:{toggle:d,onClick:()=>window.location.href=p}},P=null!==(y=null===(b=window.orgSettings)||void 0===b?void 0:b.airOutputLocale)&&void 0!==y?y:["auto","zh-CN","en-US"],E=function(){var t=u(i.mark((function t(){var r;return i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.getCurrentUserAirToken(null!==(r=e.activity)&&void 0!==r?r:{type:"online_video"},c);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),T=function(){var e=u(i.mark((function e(){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.getCurrentUserCredits();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e.activity&&e.upload.reference_id&&("bridge"===e.captionTranslatePermission?(E=function(){var t=u(i.mark((function t(){return i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{translateBridgeUrl:"/api/activities/".concat(e.activity.id,"/upload_references/").concat(e.upload.reference_id,"/video-caption-translate")});case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),T=function(){var t=u(i.mark((function t(){return i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.getInstructorCreditsByResource(e.upload.reference_id);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()):"read"===e.captionTranslatePermission&&(E=T=function(){var e=u(i.mark((function e(){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}())),e.enableChapter&&(chapterPermission=e.chapterPermission||{view:!1},k.chapter={toggle:Boolean(e.enableChapter)&&chapterPermission.view,mediaId:S,server:e.videoEditorServer||"",source:o,organization:e.orgCode,permissions:e.chapterPermission||{},getContextInfo:E,outputLocales:P}),e.enableCaption&&(k.caption={toggle:Boolean(e.enableCaption),mediaId:S,server:e.videoEditorServer||"",source:o,organization:e.orgCode,callback:"",downloadUrl:"".concat(e.videoEditorServer,"/api/org/").concat(e.orgCode,"/media/").concat(S,"/captions:download?format=srt&filename=").concat(C),permissions:e.captionPermission,paragraphSplitInterval:e.captionParagraphSplitInterval||5e3,enableTranslate:"false"!==e.captionTranslatePermission,getContextInfo:E,outputLocales:P,customTransLangs:x}),e.enableTopic&&(k.topic={toggle:e.enableTopic,mediaId:S,server:e.videoEditorServer||"",callback:"",organization:e.orgCode,permissions:e.topicPermission||{},aiTopic:{category:"",asrInput:o},getContextInfo:E,outputLocales:P}),null!==(w=window.featureToggles)&&void 0!==w&&w.airCreditManage&&(k.airCredit={toggle:!0,getContextInfo:T}),null!==(_=window.featureToggles)&&void 0!==_&&_.airPlayerSyncTranslation&&(k.airPlayerSyncTranslation={toggle:!0}),e.enableAisk&&(k.aisk={toggle:e.enableAisk});var M=r.forwardSeekingWarning,A=new f(t[0],{mode:"replay",videos:g,autoPlay:!1,plugins:k,defaultErr:!0,seekable:e.seekable,lastPlayed:e.lastPlayed,maxPlayed:e.maxPlayed,seekWarning:M,enablePlayRate:"False"!=r.enablePlayRate,enableFullscreen:"False"!=r.enableFullscreen,unplayedSegments:e.unplayedSegments,copyrightNotice:e.copyrightNotice||{},hideSubPanel:e.hideSubPanel},{locale:l.locale});A.on("playerReady",(()=>{t[0].querySelectorAll("video").forEach((e=>{e.setAttribute("oncontextmenu","return false;")})),e.playerInitiated&&(A.theCurrentTime=e=>e?(A.currentTime=e,e):A.currentTime,e.playerInitiated({player:A})),e.disableTrack&&!e.resource||v.enableTrack(e,A,e.activity,"video",e.resource)})),e.$on("$destroy",(function(){setTimeout((()=>{A.destroy()}))})),A.on("captionLoaded",(function(){e.$applyAsync()}))};if(e.$root.isVisitor)y(e.videoUrls[s]);else{var b,w,_;if(e.enableChapter||null!==(b=e.captionPermission)&&void 0!==b&&b.create||null!==(w=e.topicPermission)&&void 0!==w&&null!==(_=w.manage)&&void 0!==_&&_.includes("generate"))return void m.getDownloadUrlForAi(c.id,(e=>{var t=e.data.url;y(t)}));y("")}n(window).on("resize",(()=>{S()}));var S=()=>{if(!e.customizeHeight){var t=.63*n(window).height(),r=n(".video-player").width()/1.8;n(".video-player").height(r>t?t:r)}};S()}}}],t.examVideoPlayer=["$http","$timeout",function(e,t){return{restrict:"A",replace:!0,scope:{upload:"=",resolutions:"=",defaultResolution:"=",settings:"=",noPopup:"="},template:'\n        <div>\n          <div ng-show="!upload.video_urls" ng-click="previewVideo()" class="subject-upload-item">\n            <div class="logo">\n              <i class="font font-file-[[fileTypeByExtension(upload)]]" ng-class="{\'font-delete\': !!upload.deleted}"></i>\n            </div>\n            <div class="content">\n              <div class="filename">\n                [[upload.name]]\n              </div>\n              <div class="file-summary">\n                <div class="file-size" ng-bind="upload.size | humanizeBytes"></div>\n                <div class="file-status" ng-if="!!upload.deleted">[[statusTips(\'missed\')]]</div>\n              </div>\n            </div>\n          </div>\n\n          <div id=\'video\' ng-show="upload.video_urls" class="video-player mb-4 video-container">\n            <i class="font font-close icon-close" ng-click="closePreviewVideo()"></i>\n            <div id="wg-video-player-[[subject.id]]-[[upload.id]]"></div>\n          </div>\n          <span class="warning" ng-show="settings.play_limit && !inSubmission" ng-bind="limitText()"></span>\n       </div>\n      ',link:function(r,s,c){r.videoPlayer=null;var d=!1,p={},v=!0;r.playing=!1,r.fileTypeByExtension=b.fileTypeByExtension,r.playLimitTimes=r.settings.play_limit_times,r.prevVideoScope=null,r.play_record=r.$parent.play_record||{},r.subject=r.$parent.subject||r.$parent.currentSubject,r.play_limit_key="".concat(r.subject.id,"_").concat(r.upload.id),r.playerId="wg-video-player-".concat(r.subject.id,"-").concat(r.upload.id),r.playLimit=r.settings.play_limit,r.disabled=!1;var m=!0;if(r.inSubmission=r.noPopup||r.$parent.inSubmission||!1,r.$parent.progressUi&&(m=r.$parent.progressUi.inPreview),r.upload.video_urls=null,r.enablePlay=!0,r.enableFullscreen=r.inSubmission,r.enablePause=!r.playLimit||r.inSubmission,r.enablePlayRate=!r.playLimit||r.inSubmission,r.seekable=!r.playLimit||r.inSubmission,r.$parent.exam&&r.$parent.exam.data&&(r.enableFullscreen=!r.$parent.exam.data.is_fullscreen_mode),!m){r.play_times=r.play_record[r.play_limit_key]||0,r.play_limit=r.subject.play_limit||r.subject.settings.play_limit||!1,r.play_limit_times=r.subject.play_limit_times||r.subject.settings.play_limit_times||0;var h=r.play_limit_times-r.play_times;r.playLimitTimes=h,r.disabled=0===r.playLimitTimes}r.statusTips=e=>({processing:l.t("exam.video.status.processing"),overLimit:l.t("exam.video.status.overLimit"),missed:l.t("exam.video.status.missedFile"),noReady:l.t("exam.video.status.canNotPlay")}[e]);r.loadUpload=u(i.mark((function t(){var o,n;return i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o="/api/uploads/".concat(r.upload.id),n=[!0,""],!(r.playLimitTimes<=0&&r.playLimit)){t.next=4;break}return t.abrupt("return",[!1,r.statusTips("overLimit")]);case 4:return t.next=6,e.get(o).success((function(e){r.upload.status=e.status,r.upload.videos=e.videos,r.upload.video_src_type=e.video_src_type,r.upload.orgCode=e.orgCode,r.upload.deleted=e.deleted,n=r.upload.deleted?[!1,r.statusTips("missed")]:["ready","failed","processing"].includes(r.upload.status)?[!0,""]:[!1,r.statusTips("noReady")]})).error(((e,t,o)=>{"404"==t?(r.upload.deleted=!0,n=[!1,r.statusTips("missed")]):(n=[!1,r.statusTips("noReady")],g.error(e.message))}));case 6:return t.abrupt("return",n);case 7:case"end":return t.stop()}}),t)}))),r.loadUpload(),r.previewVideo=u(i.mark((function e(){var t,o,s,c;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.upload.deleted){e.next=3;break}return g.warning(r.statusTips("missed")),e.abrupt("return");case 3:return e.next=5,r.loadUpload();case 5:if(t=e.sent,o=a(t,2),s=o[0],c=o[1],s){e.next=12;break}return""!=c&&g.warning(c),e.abrupt("return");case 12:if(!d||r.inSubmission||!p.currentAudioScope.play_limit){e.next=17;break}return r.prevVideoScope=null,n("#switch-audio-confirmation-popup").foundation("reveal","open"),r.$root.$broadcast("initSwitchAudioPopup",{currentAudioScope:p.currentAudioScope,videoScope:{type:"video",playerId:r.playerId}}),e.abrupt("return");case 17:if(!r.prevVideoScope||!r.prevVideoScope.playing||r.inSubmission||!r.prevVideoScope.playLimit){e.next=21;break}return n("#switch-video-confirmation-popup").foundation("reveal","open"),r.$root.$broadcast("initSwitchVideoPopup",{currentVideo:{limitTimes:r.prevVideoScope.playLimitTimes,type:"switch",playerId:r.prevVideoScope.playerId,playLimit:r.prevVideoScope.playLimit},nextVideo:r}),e.abrupt("return");case 21:r.prevVideoScope&&r.prevVideoScope.closePreviewVideo(),d&&r.$root.$broadcast("pauseAudio"),r.upload.video_urls=y.getUrls(r.upload),w();case 25:case"end":return e.stop()}}),e)}))),r.closePreviewVideo=()=>{if(r.playing&&!r.inSubmission)return n("#switch-video-confirmation-popup").foundation("reveal","open"),void r.$root.$broadcast("initSwitchVideoPopup",{currentVideo:{limitTimes:r.playLimitTimes,type:"close",playLimit:r.playLimit}});r.upload.video_urls=null,r.prevVideoScope=null,r.playing=!1,0===r.playLimitTimes&&r.playLimit&&(r.disabled=!0,r.enablePlay=!1,t((()=>r.$apply()),10)),r.videoPlayer&&r.videoPlayer.destroy(),r.$root.$broadcast("directVideoClose")},r.limitText=()=>l.t("exam.playbackLimits",[r.playLimitTimes]);var w=()=>{r.videoPlayer&&r.videoPlayer.destroy();var e=r.upload;if(e.video_urls){var i=r.defaultResolution,a=[{sources:o.map(e.video_urls,(function(t,o){return{src:t,label:r.resolutions[o],type:e.video_src_type,selected:o===i}})),mute:!1,volume:1}];v=!0,0===r.playLimitTimes&&r.playLimit&&(v=!1,r.enablePlay=!1),r.videoPlayer=new f(r.playerId,{mode:"replay",videos:a,autoPlay:v,defaultErr:!0,download:!1,disableTrack:!0,enableFullscreen:r.enableFullscreen,enablePlay:r.enablePlay,enablePause:r.enablePause,enablePlayRate:r.enablePlayRate,seekable:r.seekable,seekWarning:l.t("exam.notForward")},{locale:l.locale}),r.inSubmission||n("video").css({display:"none"}),r.videoPlayer.on("play",(()=>{if(n("video").css({display:"block"}),d&&!r.inSubmission&&p.currentAudioScope.play_limit)return n("#switch-audio-confirmation-popup").foundation("reveal","open"),void r.$root.$broadcast("initSwitchAudioPopup",{currentAudioScope:p.currentAudioScope,videoScope:{type:"video",playerId:r.playerId}});r.playLimitTimes>0&&!r.inSubmission&&!r.playing&&(r.playLimitTimes-=1,t((()=>r.$apply()),10)),m||!r.playLimit||r.playing||(r.play_record[r.play_limit_key]=(r.play_record[r.play_limit_key]||0)+1,r.play_record.needSync=!0,r.$emit("playRecordUpdated")),r.playing=!0,r.$root.$broadcast("videoPlay",r)})),r.videoPlayer.on("ended",(()=>{r.playing=!1,r.inSubmission||n("video").css({display:"none"}),0===r.playLimitTimes&&r.playLimit&&w(),r.upload.video_urls&&r.$root.$broadcast("videoPlay",r)})),r.videoPlayer.on("unplayable",(()=>{g.warning(l.t("exam.unplayable"))}))}};r.$on("closeVideo",(()=>{r.playing=!1,r.closePreviewVideo()})),r.$on("playVideo",((e,t)=>{d=!1,t.playerId===r.playerId&&r.previewVideo()})),r.$on("audioPlay",((e,t)=>{d="play"===(p=t).status,r.playing=!1,r.videoPlayer&&r.closePreviewVideo(),"ready"===p.status&&(r.prevVideoScope=null)})),r.$on("videoPlay",((e,t)=>{d||(r.prevVideoScope=t)})),r.$on("switchVideo",((e,t)=>{r.prevVideoScope&&(r.prevVideoScope.playing=!1,r.prevVideoScope.closePreviewVideo()),t.nextVideo.playerId===r.playerId&&(r.prevVideoScope=null,r.previewVideo())}))}}}]},139390:function(e,t,r){r(788674);var o=r(887757);function n(e,t,r,o,n,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(o,n)}function i(e){return function(){var t=this,r=arguments;return new Promise((function(o,i){var a=e.apply(t,r);function s(e){n(a,o,i,s,c,"next",e)}function c(e){n(a,o,i,s,c,"throw",e)}s(void 0)}))}}r(535666);var a=function(){var e=i(o.mark((function e(t){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.CommandBars("PlayComponentToolbar");case 2:return e.sent.Visible=!1,e.next=6,t.CommandBars("FloatMenuCheckImage");case 6:e.sent.Visible=!1;case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s=function(e){e.ActivePresentation.SlideShowSettings.Run(),e.ActivePresentation.SlideShowWindow.IsFullScreen=!1},c=function(e){e.iframe.focus()},u=function(e){e.Sub.SlideShowEnd=()=>{a(e),s(e)}},l=function(){var e=i(o.mark((function e(t,n){var i,l,d;return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e(91531).then(r.bind(r,391531));case 2:return i=e.sent,l=i.config({url:t,mount:n}),e.next=6,l.ready();case 6:this.wpsApp=l.Application,(d=l.iframe).style.height="100%",d.style.width="100%",c(l),a(this.wpsApp),s(this.wpsApp),u(this.wpsApp);case 14:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),d=function(){var e=i(o.mark((function e(){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.wpsApp.ActivePresentation.SlideShowWindow.View.GotoNextClick();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),p=function(){var e=i(o.mark((function e(){return o.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.wpsApp.ActivePresentation.SlideShowWindow.View.GotoPreClick();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}();e.exports={autoFocus:c,enterPlayModule:s,sdkConfig:a,wpsPreviewInit:l,nextPage:d,prevPage:p,autoEnterFullScreen:u}},299365:function(e,t,r){var o=r(383228),n=r(261139),i=r(496486);r(66992),r(324603),r(339714),r(115306),r(323123),r(454747),r(333948);var a=r(983994).encodeData,s=r(180736);e.exports=["$rootScope","$scope","$http","$timeout","$window","toastr","treeViewSearch",function(e,t,r,c,u,l,d){var p=o("#courseId").val(),f=s(t),v=function(){return t.data={emails:"",org_emails:"",role:"student",org_invite_type:"search",org_id:"",department_id:""},t.user={hide:!0,team_teaching:[]},t.inviteResponse={emails_not_exist:[],emails:"",org_emails:"",invite_type:""},t.orgInviteResponse={emails_not_exist:[],emails:""},t.orgAddError={missingOrg:!1,missingDepartment:!1,missingUser:!1},t.allowInviteStudent?t.data.role="student":t.allowInviteAssistant?t.data.role="instructor_assistant":t.data.role="instructor"};v(),t.ui={resetable:!1,accessCodeCopied:!1,accessUrlCopied:!1},t.access_code="",t.access_url="";var m=function(e){return f.hide(),t.accessCode=e.access_code,t.accessRq=t.h5Host?g(t.accessCode):h(t.accessCode),t.accessUrl=h(t.accessCode)};t.resetAccessCodeAndUrl=function(){return f.show(),r.put("/api/course/".concat(p,"/access_code")).success(m).error((()=>f.hide()))},t.fallbackToManuallyCopy=e=>window.prompt(t.copyFallbackText,e),t.copiedCode=()=>c((()=>l.success(t.copiedSuccessfullyText))),t.copiedUrl=()=>c((()=>l.success(t.copiedSuccessfullyText)));var h=e=>"".concat(u.location.protocol,"//").concat(u.location.host,"/course/join/").concat(e),g=e=>encodeURI("".concat(t.h5Host,"/j?p=").concat(a({courseId:p,accessCode:e})));e.$watch("invitingCourseUsers",(function(e){if(e&&""===t.access_code){return r.get("/api/course/".concat(p,"/access_code")).success((function(e){return t.ui.resetable=e.resetable,e.access_code?m(e):e.resetable?t.resetAccessCodeAndUrl():void 0})).error((function(){}))}})),t.getJoinResult=e=>e.join(",");var y=function(t){return f.hide(),l.success(t.message),o("#course-invite-users-popup").foundation("reveal","close"),v(),e.$broadcast("invitationSend")},b=function(e,o,n){return n||(n=""),n=n.replace(/\s+/g,""),f.show(),r.post("/api/course/".concat(p,"/invites"),{emails:n.split(","),invite_type:e}).success(y).error((function(e){return f.hide(),t[o]=e.errors}))};t.sendInvite=e=>b(e,"inviteResponse",t.data.emails),t.sendOrgInvite=()=>b("team_teaching","orgInviteResponse",t.data.org_emails),t.clear=()=>v(),t.initTeamTeachingOrgs=function(){return f.show(),r.get("/api/toggle-opened-orgs?toggle=org_team_teaching").success((function(e){return f.hide(),t.orgs=e.orgs})).error((function(){return f.hide(),t.orgs=[]}))},t.course_invite_department_single_select_tree={keyword:""},t.searchTreeView=function(e){return"course_invite_department_single_select_tree"===e&&d.searchDepartmentTree(e,t,[])},t.initOrgDepartments=function(e){if(e){return f.show(),r.get("/api/orgs/".concat(e,"/departments")).success((function(e){return f.hide(),t.originalDepartments=e.departments,t.departments=n.copy(e.departments)})).error((function(){return f.hide(),t.departments=[],t.originalDepartments=[]}))}};var w=function(e){if(e&&t.user.keywords){var r=new RegExp("(".concat(t.user.keywords,")"),"gim");return e.replace(r,'<span class="search-keyword">$1</span>')}return e||""},_=function(e){if(f.hide(),(null!=e.users?e.users.length:void 0)>=0)return t.user.results=e.users,i.forEach(t.user.results,(function(e){return e.highlightedName=w(e.name),e.highlightedUserNo=w(e.user_no)})),t.user.hide=!1};t.searchUser=function(){if(!t.user.keywords||(t.orgAddError={missingOrg:!t.data.org_id,missingDepartment:""===t.data.department_id},t.orgAddError.missingOrg||t.orgAddError.missingDepartment))return t.user.hide=!0;f.show();var e={keywords:t.user.keywords,exclude_student_role:!0,org_id:t.data.org_id?t.data.org_id:void 0,department_id:t.data.org_id&&t.data.department_id?t.data.department_id:void 0};return r.get("/api/user/search",{params:e}).success(_).error((function(){return f.hide(),t.user.hide=!0}))},t.updateSearchUser=function(){if(!t.user.hide)return t.searchUser()},t.searchUserReset=function(){return t.user.hide=!0,t.user.keywords=""},t.addTeamTeaching=function(e){return t.user.team_teaching.push(e),t.user.hide=!0,null!=t.errors?delete t.errors.team_teaching:void 0},t.isAdded=e=>i.find(t.user.team_teaching,{id:e.id}),t.rmTeamTeaching=e=>i.remove(t.user.team_teaching,e);return t.addOrgTeamTeachings=function(){if(t.orgAddError={missingOrg:!t.data.org_id,missingDepartment:""===t.data.department_id,missingUser:0===t.user.team_teaching.length},i.some(i.values(t.orgAddError)))return null;var n={user_ids:i.map(t.user.team_teaching,(e=>e.id))};return f.show(),r.post("/api/courses/".concat(p,"/team-teaching"),n).success((function(t){return f.hide(),l.success(t.message),o("#course-invite-users-popup").foundation("reveal","close"),v(),e.$broadcast("enrollmentsAdded")})).error((function(e){return f.hide(),l.error(e.message)}))}}]},186021:function(e,t,r){var o=r(383228);r(324603),r(339714),r(804723);var n=r(180736);e.exports=["$scope","$http","$window",(e,t,r)=>{var i,a=n(e),s=new RegExp("^[0-9A-Z]{7,}$");e.error=null,e.accessCode="",o(document).on("opened.fndtn.reveal","#user-join-course-popup",(()=>o("#accessCode").focus()));e.join=()=>{if(o=e.accessCode.match(s),e.error=o?null:e.validationError,o){var o;a.show(),t.get("/api/course/access-code/".concat(e.accessCode,"/validate")).success((()=>{a.hide(),e.error=null,e.onRedirecting=!0,r.location.href=i(e.accessCode)})).error((t=>{a.hide(),e.error=t.message||e.validationError}))}},e.onAccessCodeChange=()=>e.error=null,e.reset=()=>e.$apply((()=>(e.error=null,e.accessCode=""))),i=e=>"".concat(r.location.protocol,"//").concat(r.location.host,"/course/join/").concat(e)}]},169671:function(e,t,r){var o=r(496486),n=r(383228);e.exports=["$http","toastr","commonApi",function(e,t,r){return{course:r.course,getCcLicenseGroups:r.getCcLicenseGroups,addActivity(r,n,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:o.noop;return e.post("/api/courses/".concat(r,"/activities"),n).success(t.decorateSuccess(i)).error(t.decorateError(a))},updateActivity(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.put("/api/activities/".concat(r.id),r).success(t.decorateSuccess(n)).error(t.decorateError(i))},deleteActivity(r,n,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:o.noop;return e.delete("/api/activities/".concat(r.id),{params:n}).success(i).error(t.decorateError(a))},deleteActivities(r,n,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:o.noop,s=o.map(r,"id");return e.delete("/api/activities",{data:{activity_ids:s}}).success(i).error(t.decorateError(a))},getHomeworkSubmissionStatus(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/course/".concat(r,"/homework/submission-status?no-intercept=true")).success(n).error(t.decorateError(i))},getHomeworkSubmissionsNum(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/course/".concat(r,"/homework-submission-number")).success(n).error(t.decorateError(i))},getActivity(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop,a={fields:arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,sub_course_id:n("#subCourseId").val()};return e.get("/api/activities/".concat(t),{params:a}).success(r).error(i)},logActivityRead(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:o.noop,a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];return n.ajax({url:"/api/course/activities-read/".concat(e),data:JSON.stringify(t),contentType:"application/json",success:r,error:i,async:a,type:"POST"})},logExamActivityRead(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:o.noop,a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];return n.ajax({url:"/api/course/activities-read/exam/".concat(e),data:JSON.stringify(t),contentType:"application/json",success:r,error:i,async:a,type:"POST"})},updateSyllabusActivitiesSort(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.put("/api/syllabus/".concat(r.id,"/activity-sort"),r).success(n).error(t.decorateError(i))},updateModuleActivitiesSort(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.put("/api/modules/".concat(r.id,"/activity-sort"),r).success(n).error(t.decorateError(i))},updateModuleOrSyllabusActivitiesSort(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.put("/api/activity-resort",r).success(n).error(t.decorateError(i))},classroomInCourse(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/courses/".concat(t,"/classroom-list")).success(r).error(n)},catalogActivitiesInCourse(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/courses/".concat(t,"/catalog-activities")).success(r).error(n)},catalogActivitiesInCourseForVisitor(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/anonymous-api/courses/".concat(t,"/catalog-activities")).success(r).error(n)},homeworksInCourseWithPageInfo(r,n,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:o.noop;return e.get("/api/courses/".concat(r,"/homework-activities"),{params:n}).success(i).error(t.decorateError(a))},groupHomeworksInGroupSet(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/group-sets/".concat(r,"/group-homework-activities")).success(n).error(t.decorateError(i))},groupExamsInGroupSet(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/group-sets/".concat(r,"/group-exams")).success(n).error(t.decorateError(i))},groupSetsInCourse(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/courses/".concat(r,"/group-sets")).success(n).error(t.decorateError(i))},examInCourse(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/courses/".concat(r,"/exams")).success(n).error(t.decorateError(i))},liveRecordInCourse(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/courses/".concat(r,"/live-record")).success(n).error(t.decorateError(i))},baseRollcallInCourse(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/courses/".concat(r,"/modules/rollcalls")).success(n).error(t.decorateError(i))},inclassInteractionInCourse(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/courses/".concat(r,"/interactions")).success(n).error(t.decorateError(i))},inclassInteractionInCourseWithPage(r,n,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:o.noop,s="/api/courses/".concat(r,"/interactions");return e.get(s,{params:n}).success(i).error(t.decorateError(a))},createLiveRecordAsrTask(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.post("/api/live-records/".concat(r,"/task/asr")).success(n).error(t.decorateError(i))},getLiveRecordAsrTaskStatus(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/live-records/".concat(r,"/task/asr?no-intercept=true")).success(n).error(t.decorateError(i))},getLiveRecordCaptions(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/live-records/".concat(r,"/caption")).success(n).error(t.decorateError(i))},getActivitiesByModuleIds(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"learning_activities,exams,classrooms,live_records,interactions,rollcalls",a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s="/api/course/".concat(r,"/all-activities?module_ids=[").concat(n.join(","),"]&activity_types=").concat(i);return a||(s+="&no-loading-animation=true"),e.get(s).error(t.decorateError(o.noop))},examsSubmitted(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/courses/".concat(r,"/submitted-exams?no-intercept=true")).success(n).error(t.decorateError(i))},examSubmissions(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/courses/".concat(r,"/exam-submissions")).success(n).error(t.decorateError(i))},examsScores(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/courses/".concat(r,"/exam-scores?no-intercept=true")).success(n).error(t.decorateError(i))},getScorePercentages(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/course/".concat(r,"/score-percentages")).success(n).error(t.decorateError(i))},classroomScores(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/course/".concat(r,"/classroom-exam-scores")).success(n).error(t.decorateError(i))},getSubmissionNumber(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/activity/".concat(r,"/submission-number")).success(n).error(t.decorateError(i))},hasReviewedInterScore(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/activity/".concat(r,"/has-reviewed-inter-score")).success(n).error(t.decorateError(i))},getHomeworkFirstSubmissionTime(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/activity/".concat(r,"/first-submission-time")).success(n).error(t.decorateError(i))},createShtvuGroups(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.post("/api/courses/".concat(t,"/create-groups")).success(r).error(n)},isInterReviewStarted(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/activity/".concat(r,"/is-inter-review-started")).success(n).error(t.decorateError(i))},isIntraReviewStarted(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/activity/".concat(r,"/is-intra-review-started")).success(n).error(t.decorateError(i))},isHomeworkExpired(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/activity/".concat(r,"/is-homework-expired")).success(n).error(t.decorateError(i))},forumInCourse(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/course/".concat(r,"/forum-activities")).success(n).error(t.decorateError(i))},forumScores(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/course/".concat(r,"/forum-scores")).success(n).error(t.decorateError(i))},weblinkInCourse(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/course/".concat(r,"/web-link-activities")).success(n).error(t.decorateError(i))},weblinkScores(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/course/".concat(r,"/web-link-scores")).success(n).error(t.decorateError(i))},getStudents(r,o){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e.get("/api/course/".concat(r,"/students?ignore_avatar=").concat(n)).success(o).error(t.decorateError())},weblinkStudentScores(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/activities/".concat(r,"/web-link-scores")).success(n).error(t.decorateError(i))},virtualExperimentScores(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/activities/".concat(r,"/virtual-experiment-scores")).success(n).error(t.decorateError(i))},courseVirtualExperimentsScores(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/course/".concat(r,"/virtual-experiment-scores")).success(n).error(t.decorateError(i))},courseVirtualExperiments(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/course/".concat(r,"/virtual-experiments")).success(n).error(t.decorateError(i))},questionnaireInCourse(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/course/".concat(r,"/questionnaires")).success(n).error(t.decorateError(i))},initQuestionnairesWithPage(r,n,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:o.noop,s="/api/courses/".concat(r,"/questionnaire-list");return e.get(s,{params:n}).success(t.decorateSuccess(i)).error(t.decorateError(a))},questionnaireScores(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/course/".concat(r,"/questionnaire-scores")).success(n).error(t.decorateError(i))},interactionInCourse(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/course/".concat(r,"/interactions")).success(n).error(t.decorateError(i))},interactionScores(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/course/".concat(r,"/interaction-scores")).success(n).error(t.decorateError(i))},anonymousCourse(r,n,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:o.noop;return e.get("/anonymous-api/courses/".concat(r,"?fields=").concat(n)).success(i).error(t.decorateError(a))},getActivities(r,i){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop,s=n("#subCourseId").val();return e.get("/api/courses/".concat(r,"/activities?fields=").concat("id,title,type,sort,completion_criterion,completion_criterion_key","&no-intercept=true&sub_course_id=").concat(s)).success(i).error(t.decorateError(a))},getActivitiesReadForUser(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/course/".concat(r,"/activity-reads-for-user")).success(n).error(t.decorateError(i))},getCompletionCriteriaForType(r,n,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:o.noop;return e.get("/api/completion-criteria",{params:{activity_type:"".concat(r),course_id:"".concat(n),"no-intercept":!0}}).success(i).error(t.decorateError(a))},getActivityCompletionCriteria(r,n,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:o.noop;return e.get("/api/activities/".concat(r.id,"/completion-criteria"),{params:{activity_type:"".concat(r.type),course_id:"".concat(n),"no-intercept":!0}}).success(i).error(t.decorateError(a))},getActivityPrerequisites(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/activities/".concat(r.id,"/prerequisites"),{params:{activity_type:"".concat(r.type),"no-intercept":!0}}).success(n).error(t.decorateError(i))},removeAllDependants(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.put("/api/activities/".concat(r.id,"/remove-all-dependants"),{activity_type:r.type}).success(t.decorateSuccess(n)).error(t.decorateError(i))},deleteActivityPrerequisite(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.delete("/api/activities/".concat(r.id,"/prerequisites"),{params:{activity_type:r.type}}).success(t.decorateSuccess(n)).error(t.decorateError(i))},getUnavailablePrerequisites(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/activities/".concat(r.id,"/unavailable-prerequisites"),{params:{activity_type:r.type}}).success(t.decorateSuccess(n)).error(t.decorateError(i))},getActivityHasDependents(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/activities/".concat(r.id,"/has-dependents"),{params:{activity_type:r.type}}).success(t.decorateSuccess(n)).error(t.decorateError(i))},getActivitiesHaveDependents(r,n,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:o.noop,s=o.map(r,"id");return e.get("/api/activities/have-dependents",{params:{activity_ids:s,activity_type:n}}).success(t.decorateSuccess(i)).error(t.decorateError(a))},getActivityObeWeight(r,n,i,a){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:o.noop,c="/api/".concat(r,"/obe/activity/weight?refer_type=").concat(n);i&&(c+="&refer_id=".concat(i)),e.get(c).success(t.decorateSuccess(a)).error(t.decorateError(s))},getActivityUploadsLicenseInfo(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/activities/".concat(t,"/uploads-license")).success(r).error(n)},saveActivityResource(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.post("/api/activities/resources/".concat(r,"/save")).success(t.decorateSuccess(n)).error(t.decorateError(i))},publishActivities(t,r,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:o.noop;return e.post("/api/courses/".concat(t,"/publish-activities"),r).success(n).error(i)},getUserEsignInfo(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/users/".concat(r,"/esign-info")).success(n).error(t.decorateError(i))},startUploadEsign:(t,r,o)=>e.post("/api/uploads/".concat(t,"/start-esign")).success(r).error(o),activityDeleteCheck(r,n,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:o.noop;return e.get("/api/activities/delete-check?activity_id=".concat(r,"&activity_type=").concat(n)).success(i).error(t.decorateError(a))},getActivityReadCount(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.get("/api/online-videos/".concat(r,"/activity-read-count")).success(n).error(t.decorateError(i))}}}]},9075:function(e,t,r){var o=r(383228),n=r(496486),i=r(261139);r(788674),r(117727),e.exports=["service","toastr","$scope",function(e,t,r){var a=this;return a.successMsg="同步成功",a.currentJob=null,a.jobs=[],a.haveRunningJob=!0,a.selectedUsers=[],a.isTransferable=c,a.confirm=function(){c()&&a.confirmPopup.foundation("reveal","open")},a.createJob=function(){var r={users:n.map(a.selectedUsers,(e=>({user_no:e.user_no,name:e.name})))};e.createJob(r).then((e=>{a.selectedUsers=[],a.confirmPopup.foundation("reveal","close"),a.jobs.unshift(e),a.haveJobRunning=!0})).catch((()=>{t.warning()}))},a.view=function(t){a.currentJob=i.copy(t),a.jobDetailPopup.foundation("reveal","open"),r.loading=!0,e.getProcesses(a.currentJob).then((e=>{a.currentJob.processes=e})).finally((()=>{r.loading=!1}))},a.confirmPopup=o("#confirm-transfer-resources-popup"),a.jobDetailPopup=o("#job-detail-popup"),e.startPolling(s,(()=>{t.warning()})),a;function s(e){a.jobs=e;var r=a.haveJobRunning;a.haveJobRunning=!n.every(e,{status:"finished"}),!1===a.haveJobRunning&&!0===r&&t.success(a.successMsg)}function c(){return!a.haveJobRunning&&a.selectedUsers.length>0}}]},442247:function(e,t,r){var o=r(496486);e.exports=["$http","toastr","commonApi",function(e,t,r){return{course:r.course,departments:r.departments,grades:r.grades,classes:r.classes,instructors:r.instructors,users:r.users,changeEnrollmentRole:r.changeEnrollmentRole,deleteEnrollment:r.deleteEnrollment,editBulletin:r.editBulletin,classifications:r.resourceClassifications,updateOutline:(r,o,n)=>e.put("/api/course/".concat(r.id,"/outline"),r).success(t.decorateSuccess(o)).error(t.decorateError(n)),notifyOutlineEditing:(r,o,n)=>e.post("/api/outline/notify",{course_ids:r}).success(t.decorateSuccess(o)).error(t.decorateError(n)),syncFromUrp:(r,o,n)=>e.post("/api/courses/sync_from_urp",{course_ids:r}).success(t.decorateSuccess(o)).error(t.decorateError(n)),searchCourses:(r,n,i,a,s)=>(o.isEmpty(i.fields)&&(i.fields="id,name,academic_year,compulsory,course_code,semester,subject_code,department(id,name),course_attributes(student_count,audience_type,education_type,teaching_class_name),public_scope,status,grade(id,name),klass(id,name),instructors(id,name),course_outline,imported_from,course_type,allow_clone"),e.post("/api/courses?page=".concat(r,"&page_size=").concat(n,"&include_children_tenant"),i).success(a).error(t.decorateError(s))),searchResources:(r,o,n,i,a)=>e.get("/api/shared-resources/management",{params:{page:r,page_size:o,conditions:n}}).success(i).error(t.decorateError(a)),getVideoResourceGroups:(r,o,n,i,a)=>e.get("/api/shared-resources/stat/video-resources",{params:{page:r,page_size:o,conditions:n}}).success(i).error(t.decorateError(a)),exportResources:(r,o,n)=>e.get("/api/shared-resources/stat",{params:{conditions:r},responseType:"arraybuffer"}).success(o).error(t.decorateError(n)),exportVideoResources:(r,o,n)=>e.get("/api/shared-resources/stat/video-resources/export",{params:{conditions:r},responseType:"arraybuffer"}).success(o).error(t.decorateError(n)),exportCourses(r,o,n){return e({url:"/api/stat/courses/export/to/".concat(arguments.length>3&&void 0!==arguments[3]?arguments[3]:"xlsx"),method:"POST",responseType:"arraybuffer",data:r}).success(o).error(t.decorateError(n))},exportAttendance(r,o,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"xlsx";return Array.isArray(r.academic_year_ids)||(r.academic_year_ids=[r.academic_year_ids]),Array.isArray(r.semester_ids)||(r.semester_ids=[r.semester_ids]),e({url:"/api/stat/attendance/export/to/".concat(i),method:"POST",responseType:"arraybuffer",data:r}).success(o).error(t.decorateError(n))},exportRollcallStat:(r,o,n)=>(Array.isArray(r.academic_year_ids)||(r.academic_year_ids=[r.academic_year_ids]),e.get("/api/stat/courses/rollcall/export",{params:{conditions:r},responseType:"arraybuffer"}).success(o).error(t.decorateError(n))),exportRollcallStatByClass:(r,o,n)=>e.get("/api/stat/courses/rollcall/export-by-class",{params:{conditions:r},responseType:"arraybuffer"}).success(o).error(t.decorateError(n)),exportHomeworkCorrect:(r,o,n)=>e.get("/api/stat/courses/homework-correct/export",{params:{conditions:r},responseType:"arraybuffer"}).success(o).error(t.decorateError(n)),exportClassHours:(r,o,n)=>e.get("/api/stat/courses/class-hours/export",{params:{conditions:r},responseType:"arraybuffer"}).success(o).error(t.decorateError(n)),addCourse:(r,o,n)=>e.post("/api/course",r).success(t.decorateSuccess(o)).error(t.decorateError(n)),updateCourse:(r,o,n)=>e.put("/api/courses/".concat(r.id),r).success(t.decorateSuccess(o)).error(t.decorateError(n)),deleteCourse:(r,o,n)=>e.delete("/api/course/".concat(r)).success(t.decorateSuccess(o)).error(t.decorateError(n)),updateCoursePublishStatus:(r,o,n,i)=>e.put("/api/courses/".concat(r,"/publish"),{published:o}).success(t.decorateSuccess(n)).error(t.decorateError(i)),getCourseCanUnPublished:(t,r,o)=>e.get("/api/courses/".concat(t,"/can-unpublished")).success(r).error(o),restoreCourse:(r,o,n)=>e.put("/api/courses/".concat(r,"/restore")).success(t.decorateSuccess(o)).error(t.decorateError(n)),batchUpdateCourseSettings:(r,o,n)=>e.put("/api/courses/settings",r).success(t.decorateSuccess(o)).error(t.decorateError(n)),addEnrollments:(r,o,n,i)=>e.post("/api/courses/".concat(r,"/enrollments"),o).success(n).error(t.decorateError(i)),getMembers:(r,o,n)=>e.get("/api/courses/".concat(r,"/members")).success(o).error(t.decorateError(n)),getCustomCourseRoles:(r,o)=>e.get("/api/authz/course-roles",{params:{conditions:{name:["customer"]}}}).success(r).error(t.decorateError(o)),getCertifications:(r,o)=>e.get("/api/certifications").success(r).error(t.decorateError(o)),academicYears:r.academicYears,semesters:r.semesters,getBulletins:r.getBulletins,addBulletin:r.addBulletin,deleteBulletin:r.deleteBulletin,mySemesters:r.mySemesters,mySemestersAll:r.mySemestersAll,getCcLicenseGroups:r.getCcLicenseGroups,changeEnrollmentsRole:(r,o,n,i)=>e.put("/api/course/enrollments",{enrollment_ids:r,role:o}).success(n).error(t.decorateError(i)),deleteEnrollments:(r,o,n)=>e({url:"/api/course/enrollments",data:{enrollment_ids:r},method:"DELETE"}).success(o).error(t.decorateError(n)),getStatInfoForCourseInstructors:(t,r,o)=>e.get("/api/stat/courses/".concat(t,"/instructors")).success(r).error(o),getStatInfoForCourseStudents:(r,o,n)=>e.get("/api/stat/courses/".concat(r,"/students")).success(o).error(t.decorateError(n)),getDepartmentCourses:(r,o,n)=>e.get("/api/departments/".concat(r,"/courses")).success(t.decorateSuccess(o)).error(t.decorateError(n)),importCourses:(t,r,o)=>e.post("/api/data-import/courses",t).success(r).error(o),importEditCourses:(t,r,o)=>e.post("/api/data-import/edit-courses",t).success(r).error(o),importCoursesEnrollments:(t,r,o)=>e.post("/api/data-import/enrollments",t).success(r).error(o),importEnrollments:(t,r,o)=>e.post("/api/data-import/enrollments/".concat(t.courseId),t).success(r).error(o),markBulletinAsRead:r.markBulletinAsRead,createPartnerAssociation:(r,o,n,i)=>e.post("/api/courses/".concat(r,"/associated-partner-info"),o).success(t.decorateSuccess(n)).error(t.decorateSuccess(i)),getPartnerAssociation:(t,r,o)=>e.get("/api/courses/".concat(t,"/associated-partner-info")).success(r).error(o),updatePartnerAssociation:(r,o,n,i)=>e.put("/api/courses/".concat(r,"/associated-partner-info"),o).success(t.decorateSuccess(n)).error(t.decorateSuccess(i)),getPartnerTypes:(t,r,o)=>e.get("/api/orgs/".concat(t,"/associated-partner-types")).success(r).error(o),recalculateCertificationScoreOfCourses:(r,o,n)=>e.put("/api/user/course-certification/scores",{course_ids:r}).success(t.decorateSuccess(o)).error(t.decorateError(n)),getCoursesCount(r,o,n){e.get("/api/courses/count",{params:{conditions:r}}).success(o).error(t.decorateError(n))},syncItriEnrollments:(t,r,o)=>e.put("/api/courses/".concat(t,"/sync-itri-enrollments")).success(r).error(o),getStatInfoForCourses(t,r){var o={ids:t};return e.get("/api/stat/activities-for-courses",{params:o}).success(r)}}}]},79980:function(e,t,r){var o=r(383228),n=r(496486),i=r(261139),a=r(293789);r(454747);var s=r(289895),c=r(180736);e.exports=["$rootScope","$scope","$http","toastr","$timeout","$interval",function(e,t,r,u,l,d){t.ui={showForm:!1};var p=s(),f=c(t),v=function(){return t.note={content:"",target_type:t.target_type,anchor:null,course_id:t.course_id,activity_id:t.activity_id,target_id:t.target_id},delete t.errors},m=()=>l((function(){return o(".note-form .note-content").focus(),100}));t.showAddNoteForm=function(){return t.note.anchor=0,"video"===t.note.target_type?t.note.anchor=Math.floor(t.player.theCurrentTime()):"document"===t.note.target_type&&(t.note.anchor=o("#file-previewer-with-note #pdf-viewer")[0].contentWindow.PDFViewerApplication.pdfViewer.currentPageNumber),t.ui.showForm=!0,m()},t.hideAddNoteForm=function(){return v(),t.ui.showForm=!1},t.formatAnchor=function(e){if(!e)return"";var t=e.anchor;return"video"===e.target_type?(p.parseTime(t),p.asKey()):t},t.seekToAnchor=function(e){var r=e.anchor;return"video"===e.target_type?t.player.theCurrentTime(r):"document"===e.target_type?o("#file-previewer-with-note #pdf-viewer")[0].contentWindow.PDFViewerApplication.pdfViewer.currentPageNumber=r:void 0},t.save=function(){var o;f.show();var i=function(e,r){return 400===r&&(t.errors=e.errors),f.hide()};return t.note.id?(o=function(r){r.order=r.updated_at?r.updated_at:r.created_at;var o=n.findIndex(t.notes,(e=>e.id===t.note.id));return t.notes[o]=r,t.hideAddNoteForm(),f.hide(),e.hasEdited=!0},r.put("/api/notes/".concat(t.note.id),t.note).success(o).error(u.decorateError(i))):(o=function(r){return r.order=r.updated_at?r.updated_at:r.created_at,t.notes.push(r),t.hideAddNoteForm(),f.hide(),e.hasEdited=!0},r.post("/api/notes",t.note).success(o).error(u.decorateError(i)))},t.editNote=function(e){return t.note=i.copy(e),t.ui.showForm=!0,m()},t.deleteNote=function(o){return r.delete("/api/notes/".concat(o)).success((function(){return n.remove(t.notes,(e=>e.id===o)),t.hideAddNoteForm(),e.hasEdited=!0})).error(u.decorateError((function(){})))};t.uploadCanAddNote=function(e){if(e)return["image","video"].includes(e.type)||"document"===e.type&&!e.isTextFile};if(t.$on("previewFile",(function(e,r,n,i){if(t.fileAddNote){if(!t.uploadCanAddNote(r))return"function"==typeof t.hideNoteBox?t.hideNoteBox():void 0;if(t.initData(n,r),i)return l((function(){var e;if("document"===i.target_type){var r=o("#file-previewer-with-note #pdf-viewer")[0];return e=d((function(){if(a.guard(a.guard(a.guard(null!=r?r.contentWindow:void 0,(e=>e.PDFViewerApplication)),(e=>e.pdfViewer)),(e=>e.getPageView(i.anchor-1))))return t.seekToAnchor(i),d.cancel(e)}),100)}if("video"===i.target_type)return e=d((function(){if(4===("function"==typeof(r=t.player).readyState?r.readyState():r.readyState))return t.seekToAnchor(i),t.player.play(),d.cancel(e);var r}),100)}),1e3)}})),t.initData=function(e,o){return e||(e=t.activity),t.course_id=e.course_id,t.activity_id=e.id,e&&!o?(t.target_id=e.uploads[0].id,t.target_type=e.uploads[0].type):(t.target_id=o.id,t.target_type=o.type),r.get("/api/notes?course_id=".concat(t.course_id,"&activity_id=").concat(t.activity_id,"&target_id=").concat(t.target_id)).success((e=>t.notes=n.forEach(e.notes,(e=>e.order=e.updated_at?e.updated_at:e.created_at)))).error(u.decorateError((function(){}))),v()},t.upload)return t.initData(t.activity,t.upload)}]},289895:function(e,t,r){var o=r(496486);e.exports=function(){var e=function(e){var t=o.parseInt(e)||0;return t>9?"".concat(t):"0".concat(t)};return{hour:0,minute:0,second:0,asKey(){return 0===this.hour?"".concat(e(this.minute),":").concat(e(this.second)):"".concat(e(this.hour),":").concat(e(this.minute),":").concat(e(this.second))},parseTime(e){this.second=Math.floor(e%3600%60),this.minute=Math.floor(e%3600/60),this.hour=Math.floor(e/3600)}}}},166555:function(e,t,r){var o=r(383228),n=r(496486);r(682772),r(132023),r(115306),e.exports=["$scope","$rootScope","$timeout","$window",(e,t,r,i)=>(e.notificationText=(t,r)=>{var o=e.notificationTypesAndText[t];if(!o)return"";var n=o[r];return n||""},e.getActivityIcon=e=>(e||"").replace(/_/g,"-"),e.openActivity=t=>{e.canOpenActivity(t)&&(i.location.href=t.url)},e.canOpenActivity=t=>!t.is_locked||(e.lockedActivity=t,o("#prerequisites-confirmation-popup").foundation("reveal","open"),!1),e.linkToActivity=t=>{if(e.canOpenActivity(t)){var r=t.course_id,o=t.activity_type,n=t.activity_id,a="";switch(o){case"material":case"online_video":case"page":case"scorm":case"welink":case"tencent_meeting":case"classin":case"zoom":case"web_link":case"lesson":case"slide":case"homework":case"forum":case"chinamcloud_live":case"virtual_experiment":case"microsoft_teams_meeting":case"dingtalk_live":case"h5_courseware":a="/course/".concat(r,"/learning-activity#/").concat(n);break;case"exam":a="/course/".concat(r,"/learning-activity#/exam/").concat(n);break;case"questionnaire":a="/course/".concat(r,"/learning-activity/full-screen#/questionnaire/").concat(n);break;case"classroom":a="/course/".concat(r,"/learning-activity#/classroom/").concat(n);break;case"lecture_live":a="/course/".concat(r,"/live-activities#/").concat(n,"/detail");break;default:a=""}a&&(i.location.href=a)}},e.linkToBulletin=e=>{"org"===e.type?i.location.href="/bulletin-list/?type=org&bulletin_id=".concat(e.bulletin_id):i.location.href="/bulletin-list/?type=course"},e.linkToHomeworkActivity=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r="/course/".concat(e.course_id,"/learning-activity#/").concat(e.homework_id);t&&(r+=t),i.location.href=r},e.linkToAuditActivity=e=>i.location.href="/course/".concat(e.course_id,"/learning-activity#/").concat(e.activity_id),e.linkToQuestionnaireActivity=e=>i.location.href="/course/".concat(e.course_id,"/learning-activity#/questionnaire/").concat(e.questionnaire_id),e.linkToTopic=e=>{e.group_id?i.location.href="/course/".concat(e.course_id,"/group-set#/topics/").concat(e.topic_id,"?groupId=").concat(e.group_id):i.location.href="/course/".concat(e.course_id,"/forum?show_sidebar=false#/topics/").concat(e.topic_id)},e.linkToExamSubmissionInfo=e=>i.location.href="/course/".concat(e.course_id,"/learning-activity#exam/").concat(e.activity_id,"/score-list"),e.linkToExam=t=>{e.canOpenActivity(t)&&(i.location.href="/course/".concat(t.course_id,"/learning-activity#/exam/").concat(t.exam_id))},e.linkToForumActivity=e=>i.location.href="/course/".concat(e.course_id,"/learning-activity#/").concat(e.activity_id),e.linkToTeachingUnit=e=>i.location.href="/course/".concat(e.course_id,"/content"),e.linkToVtrs=e=>i.location.href="/vtrs/".concat(e.vtrs_id),e.linkToProject=e=>i.location.href="/course/".concat(e.project_id,"/resource"),e.linkToEvaluationActivity=e=>i.location.href="/course/".concat(e.course_id,"/evaluation?redirect=task/").concat(e.evaluation_id,"/detail"),e.isFromRMS=e=>"RMS"===e.sender,e.linkToBookLive=t=>{t.course_id&&!e.isFromRMS(t)?i.location.href="/course/".concat(t.course_id,"/live-activities#/").concat(t.live_id,"/detail?backToPath=/course/").concat(t.course_id,"/live-activities"):i.location.href=t.book_live_url},e.linkToResearchMeeting=e=>i.location.href="/course/".concat(e.course_id,"/teaching-team#/meeting/").concat(e.meeting_id),e.linkToResearchForum=e=>i.location.href="/course/".concat(e.course_id,"/teaching-team#/forum/").concat(e.forum_id),e.linkToLearningProgressAlert=e=>i.location.href="/management/learning-statistics/learning-progress#/".concat(e.course_id,"/alert-list"),e.linkToLearningWarning=e=>i.location.href="/course/".concat(e.course_id,"/warning"),e.view=t=>(o("#instrucor-warning-info-popup").foundation("reveal","open"),e.warningInfo=t),e.teachingUnitName=t=>t.teaching_unit_type&&"teaching_class"===t.teaching_unit_type?e.teachingUnitNames.teaching_class:e.teachingUnitNames.course,e.teachingUnitRoleName=t=>e.teachingUnitRoleNames[t.teaching_unit_role],e.linkToTrackedUserResource=e=>i.location.href="/shared-resource/user/".concat(e.tracked_user_id,"/track-user-resource"),e.linkToFollowerInfo=e=>i.location.href="/shared-resource/user/".concat(e.follower_id,"/track-user-resource"),e.linkToResourceGroup=e=>i.location.href="/user/resource-groups#/".concat(e.group_id,"/members"),e.link=t=>{["shared_resource_audit_agree","shared_resource_audit_reject","shared_resource_reported","shared_resource_off_the_shelf","campus_subject_lib_audit_agree","campus_subject_lib_audit_reject","campus_subject_lib_off_the_shelf"].indexOf(t.type)>-1||(["course_outline_edit","course_outline_closing_edit","course_completeness_alert","course_obe_unassociated_alert"].includes(t.type)?i.location.href="/course/".concat(t.payload.course_id,"/outline"):n.includes(["submission_submitted","homework_ended","homework_expiring","homework_opened_for_submission","homework_opening_for_submission","homework_is_recommended","homework_is_recommended_group","has_recommend_homework","has_recommend_homework_group","recommend_homework_removed","inter_score_ended","inter_score_expiring","inter_score_homework_submission","homework_score_updated","course_homework_remind","course_homework_make_up","course_homework_resubmit","course_homework_review_remind"],t.type)?e.linkToHomeworkActivity(t.payload):"homework_submitted"!==t.type?n.includes(["activity_opening","activity_expiring","activity_opened","exam_submission"],t.type)?e.linkToActivity(t.payload):"course_opening"!==t.type&&"course_started"!==t.type?n.includes(["bulletin_created","bulletin_updated"],t.type)?e.linkToBulletin(t.payload):n.includes(["reply_created","topic_replies","topic_secondary_replies","topic_like","topic_create"],t.type)?e.linkToTopic(t.payload):"user_join_course"!==t.type&&"user_exit_course"!==t.type?n.includes(["score_publish_closing","score_setting_changed","score_publish_reject"],t.type)?i.location.href="/course/".concat(t.payload.course_id,"/score"):n.includes(["recent_plan_expire","plan_expired","recent_storage_run_out","storage_run_out","recent_transfer_run_out","transfer_run_out"],t.type)?i.location.href="/management/plan":"instructor_submit_course_public_audit"!==t.type?"course_public_audit_response"!==t.type?"org_plan_request"!==t.type?"org_plan_response"!==t.type?["course_estimate_reply","course_estimate"].includes(t.type)?i.location.href="/course/".concat(t.payload.course_id):"exam_submission_info"!==t.type?n.includes(["exam_opened","exam_expiring","exam_ended","exam_submit_started","exam_score_updated","exam_make_up"],t.type)?e.linkToExam(t.payload):n.includes(["discussion_create","discussion_score_updated"],t.type)?e.linkToForumActivity(t.payload):"new_resource_share_to_follower"!==t.type?"tracked_user_is_tracked"!==t.type?"user_join_resource_group"!==t.type?i.location.href="/user/index":e.linkToResourceGroup(t.payload):e.linkToFollowerInfo(t.payload):e.linkToTrackedUserResource(t.payload):e.linkToExamSubmissionInfo(t.payload):i.location.href="/management/plan":i.location.href="/wg-admin/request":i.location.href="/course/".concat(t.payload.course_id,"/content"):i.location.href="/management/course/audit":i.location.href="/course/".concat(t.payload.course_id,"/enrollments"):i.location.href="/course/".concat(t.payload.course_id,"/content"):e.linkToHomeworkActivity(t.payload,"?view=scores"))},e.confirmInvite=e=>(t.invitePayload=e,r((()=>o("#invite-confirm").foundation("reveal","open")))),e.weeklyDayTranslateForEnglish={"一":"Mon","二":"Tue","三":"Wed","四":"Thu","五":"Fri","六":"Sat","日":"Sun"})]},148510:function(e,t,r){"use strict";r.r(t);var o=r(261139),n=r.n(o),i=r(370538),a=r(621822),s=r(473441),c=r(109827);a.S1({ignoreErrors:["top.GLOBALS","UnhandledRejection","ChunkLoadError","ResizeObserver loop limit exceeded","window.loadApps is not a function"],denyUrls:[/^chrome:\/\//i,/^chrome-extension:\/\//i,/^file:\/\//i],release:"1.75-dev",dsn:window.CONFIGS&&window.CONFIGS.sentryClientKey,tracesSampleRate:.2,integrations:[new s.j({angular:n()}),new c.w({Vue:i.default,attachProps:!0})]})},25536:function(e){e.exports=["$q",function(e){return class{constructor(e){this.blob=e,this.reader=new FileReader}read(){return this.deferred||(this.deferred=e.defer(),this.reader.onload=e=>this.deferred.resolve(e.target.result),this.reader.readAsArrayBuffer(this.blob)),this.deferred.promise}}}]},155360:function(e,t,r){var o=r(261139);r(230293),r(647301),e.exports=o.module("uploadModule",["ngFileUpload"]).factory("jobQueue",r(694771)).factory("uploadBlob",r(25536)).factory("uploadClass",r(150858)).factory("storageUploader",r(185514)).factory("uploadFolderClass",r(305838)).factory("uploadService",r(657886)).name},694771:function(e,t,r){var o=r(496486);e.exports=["$timeout",function(e){return new class{constructor(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;this.concurrentJobNumber=e,this.queue=[],this.id=1}execute(){return(()=>{for(var e=[],t=0,r=o.min([this.queue.length,this.concurrentJobNumber]),n=0<=r;n?t<r:t>r;n?t++:t--){var i=this.queue[t];if("ready"===i.status){i.status="processing";var a=i.run();e.push(a.then((()=>(this.successCallback(i),this.jobDoneCallback(i))),(()=>(this.errorCallback(i),this.jobDoneCallback(i)))))}else e.push(void 0)}return e})()}push(e){return e.jobId=this.id,e.status="ready",this.queue.push(e),this.id+=1,this.execute()}removeFromQueue(e){return o.remove(this.queue,(t=>t.jobId===e))}jobDoneCallback(t){return e((()=>(this.removeFromQueue(t.jobId),this.execute())))}removeJob(e){var t=o.find(this.queue,(t=>t.jobId===e.jobId));return"processing"===e.status?t.delete():this.removeFromQueue(e.jobId)}isDone(){return 0===this.queue.length}bindCallback(e,t){return this.successCallback=e,this.errorCallback=t}}}]},150858:function(e,t,r){var o=r(261139),n=r(496486);function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],o=!0,n=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(o=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);o=!0);}catch(e){n=!0,i=e}finally{try{o||null==s.return||s.return()}finally{if(n)throw i}}return r}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){if(e){if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}r(682772),r(66992),r(747042),r(788674),r(117727),r(333948),e.exports=["$rootScope","$http","$q","$timeout","Upload","uploadBlob",function(e,t,r,s,c,u){var l=t=>function(r){t.progress=parseInt(100*r.loaded/r.total);var o=(Date.now()-t.startTime)/1e3;return t.speed=o?r.loaded/o:0,s((()=>e.$apply()))};return class{constructor(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4194304;this.name=e.name,this.size=e.size,this.file=e,this.finished=!1,this.failed=!1,this.failedWithAMessage=!1,this.progress=0,this.isThirdPartResource=!1,this.blockSize=t,this.uploadedBlockCtxs=[],this.uptoken=null,this.isChunkMode=!0,this.allow_download=!0,this.metadata={},this.parentFolder=null,this.isFolderFile=!1}updateUploadWithServerData(e){if(this.id=e.id,this.created_at=e.created_at,this.uploadUrl=e.upload_url,this.status=e.status,this.type=e.type,e.name&&(this.name=e.name),this.storageType=e.storage_type,this.transcoder=e.transcoder,e.is_cc_video&&(this.isCCVideo=e.is_cc_video),e.cc_info)return this.CCInfo=e.cc_info;this.allow_aliyun_office_view=e.allow_aliyun_office_view||!1,this.allow_private_wps_office_view=e.allow_private_wps_office_view||!1}abort(){return this.aborted=!0,this.abortRequest()}abortRequest(){if(this.isChunkMode){if(this.blockRequest)return this.blockRequest.abort.resolve()}else if(this.uploadRequest)return this.uploadRequest.abort()}resume(){return this.aborted=!1,this.uploadToServer()}delete(){return this.abort(),this.deleteUploadProgressLog()}run(){return this.uploadToServer()}getStorageKey(){return"".concat(this.name,"_").concat(this.type,"_").concat(this.size,"_").concat(this.file.lastModified)}getBlocks(){for(var e=[],t=0,r=Math.floor((this.file.size+this.blockSize-1)/this.blockSize),o=r>=0;o?t<r:t>r;o?t++:t--){var n=t*this.blockSize,i=this.file.slice(n,n+this.blockSize);e.push(new u(i))}return e}getBlob(e){return this.file.slice(e,e+this.blockSize)}getMetadata(){var e=r.defer();return"video"===this.type?(e=>{if(e.$ngfMediaMeta){var t=r.defer();return s((function(){t.resolve(e.$ngfMediaMeta)})),t.promise}if(e.$ngfMediaMetaPromise)return e.$ngfMediaMetaPromise;var n=r.defer();return s((function(){0===e.type.indexOf("audio")||0===e.type.indexOf("video")?c.dataUrl(e).then((t=>{var r=o.element(0===e.type.indexOf("audio")?"<audio>":"<video>").attr("src",t).css("visibility","none").css("position","fixed");function i(){e.$ngfDuration=r[0].duration,0===e.type.indexOf("video")&&(e.$ngfWidth=r[0].videoWidth,e.$ngfHeight=r[0].videoHeight),e.$ngfMediaMeta={duration:e.$ngfDuration,width:e.$ngfWidth||0,height:e.$ngfHeight||0},r.remove(),n.resolve(e.$ngfMediaMeta)}r.on("loadedmetadata",i),r.on("error",(function(){r.remove(),n.reject("load error")})),function e(){s((function(){r[0].parentNode&&(r[0].duration?i():e())}),1e3)}(),o.element(document.body).append(r)}),(function(){n.reject("load error")})):n.reject("not media")})),e.$ngfMediaMetaPromise=n.promise,e.$ngfMediaMetaPromise.finally((function(){delete e.$ngfMediaMetaPromise})),e.$ngfMediaMetaPromise})(this.file).then((t=>{this.metadata=t,e.resolve()}),(()=>{e.resolve()})):e.resolve(),e.promise}uploadToServer(){this.deferredUploadJob||(this.deferredUploadJob=r.defer()),this.startTime||(this.startTime=Date.now());var e=e=>(this.doSuccessfulUpload(e),this.deferredUploadJob.resolve(this)),o=()=>(this.doFailedUpload(),this.deferredUploadJob.reject(this)),a=r((e=>{e()}));return a=this.isCCVideo?this.uploadToBokeCC():"QINIU"===this.storageType?this.updateToken().then((()=>{var t=r.defer();if(window.FileAPI&&window.FileAPI.upload)this.uploadToQiniuServerFromIE9().then(e,o);else{this.blobs=this.getBlocks();var n=this.loadUploadProgressLog();n&&(Date.now()-n.timestamp>864e5?this.deleteUploadProgressLog():this.uploadedBlockCtxs=n.uploadedBlockCtxs),this.uploadToQiniuServerFromHtml5().then((()=>this.isChunkMode?this.makeFile().then((e=>(this.deleteUploadProgressLog(),t.resolve(e))),(e=>t.reject(e))):t.resolve()),(e=>t.reject(e)))}return t.promise})):this.uploadToLocalServer().then((e=>r((r=>{"S3"==this.storageType&&"WRPC"==this.transcoder?t.post("/internal-api/upload/callback/".concat(this.id),{file_key:this.id}).then((()=>r(e))):r(e)})))),Promise.all([a,this.getMetadata()]).then((e=>{var t=i(e,2),r=t[0];t[1];return r})).then((e=>r((r=>{"video"===this.type&&this.metadata&&this.metadata.duration&&t.post("/api/uploads/".concat(this.id,"/videos"),{resolution:"ORIGINAL",duration:this.metadata.duration,width:this.metadata.width,height:this.metadata.height}).catch(n.noop),r(e)})))).then(e).catch(o),this.deferredUploadJob.promise}uploadToLocalServer(){return this.isChunkMode=!1,window.FileAPI&&window.FileAPI.upload?this.uploadToLocalServerFromIE9():this.uploadToLocalServerFromHtml5()}makeFile(){var e,r={"Content-Type":"text/plain;charset=UTF-8",Authorization:"UpToken ".concat(this.uptoken)},o="",n=function(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=a(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,n=function(){};return{s:n,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,c=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return s=e.done,e},e:function(e){c=!0,i=e},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw i}}}}(this.uploadedBlockCtxs);try{for(n.s();!(e=n.n()).done;){var i=e.value;o="".concat(o+i,",")}}catch(e){n.e(e)}finally{n.f()}return o=o.slice(0,o.length-1),t.post("".concat(this.uploadUrl,"/mkfile/").concat(this.size),o,{headers:r})}uploadFromIE9(e){var t=r.defer(),o={url:this.uploadUrl,files:{file:[this.file]},progress:l(this),complete:function(e){return e?t.reject(e):t.resolve()}};return e||(o.headers={Authorization:"UpToken ".concat(this.uptoken)},o.data={token:this.uptoken}),this.uploadRequest=FileAPI.upload(o),t.promise}uploadToQiniuServerFromIE9(){this.isChunkMode=!1;return this.uploadFromIE9(!1)}uploadToQiniuServerFromHtml5(e){var t=e=>(this.uploadedBlockCtxs.push(e.data.ctx),this.saveUploadProgressLog(),this.uploadedBlockCtxs.length<this.blobs.length?this.uploadToQiniuServerFromHtml5(this.uploadedBlockCtxs.length):this.deferredBlobsJob.resolve(e)),n=e=>401===e.status?this.refreshToken().then((()=>this.uploadToQiniuServerFromHtml5(this.uploadedBlockCtxs.length)),(function(e){return this.deferredBlobsJob.reject(e)})):0===e.status?this.deferredBlobsJob.reject({aborted:!0}):this.deferredBlobsJob.reject(e),i=o.isDefined(e)?e:this.getFinishedIndex();return this.deferredBlobsJob||(this.deferredBlobsJob=r.defer()),this.blobs[i].read().then((e=>this.uploadBlockData(e).then(t,n))),this.deferredBlobsJob.promise}uploadToBokeCC(){var e=()=>(o.resolve(),this.notifyUploaded()),t=e=>o.reject(e),o=r.defer();return window.FileAPI&&window.FileAPI.upload?alert("Please update your browser to IE10+"):this.uploadCCMeta().then((()=>this.uploadToBokeCCFromH5().then(e,t))),o.promise}uploadCCMeta(){return t.get("".concat(this.CCInfo.metaurl,"?ccvid=").concat(this.CCInfo.videoid,"&uid=").concat(this.CCInfo.userid,"&filename=").concat(encodeURI(this.name),"&filesize=").concat(this.size,"&servicetype=").concat(this.CCInfo.servicetype))}notifyUploaded(){return t.put("/api/uploads/".concat(this.id,"/uploaded"))}uploadToBokeCCFromH5(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.deferredBlobsJob||(this.deferredBlobsJob=r.defer()),this.uploadFileChunk2CC(e).then((e=>0===e.result?this.uploadToBokeCCFromH5(e.received):this.deferredBlobsJob.resolve(e)),(e=>-2===(null!=e?e.result:void 0)?this.uploadToBokeCCFromH5(e.received):this.deferredBlobsJob.reject(e))),this.deferredBlobsJob.promise}uploadFileChunk2CC(e){var t=r.defer(),o=this.getBlob(e),i=Date.now(),a=e=>(t.resolve(e),delete this.blockRequest),s=e=>(delete this.blockRequest,t.reject(e));if(this.aborted)t.reject({aborted:this.aborted});else{this.setBlockRequest();var c=new FormData;c.append("file",o);var u=new XMLHttpRequest;u.open("POST","".concat(this.CCInfo.chunkurl,"?ccvid=").concat(this.CCInfo.videoid)),u.setRequestHeader("Content-Range","bytes ".concat(e,"-").concat(e-1+o.size,"/").concat(this.size)),u.upload.addEventListener("progress",(t=>{var r=(Date.now()-i)/1e3;return this.speed=r?t.loaded/r:0,this.progress=n.parseInt(100*(e+t.loaded)/this.size)}),!1),u.send(c),u.onload=function(){if(200===u.status){var e=JSON.parse(u.response);return(null!=e?e.result:void 0)>=0?a(e):s(e)}return s(u)}}return t.promise}uploadToLocalServerFromIE9(){return this.uploadFromIE9(!0)}uploadToLocalServerFromHtml5(){var t=r.defer();return"S3"===this.storageType&&"WRPC"==this.transcoder?this.uploadRequest=c.http({url:this.uploadUrl,data:this.file,method:"PUT",headers:{"Content-Type":this.file.type}}):this.uploadRequest=c.upload({url:this.uploadUrl,data:{file:this.file},method:"PUT"}),this.uploadRequest.then((r=>(this.parentFolder&&(this.parentFolder.finishedCount+=1,this.parentFolder.finished&&this.successCallback(this.parentFolder)),t.resolve(r),s((()=>e.$apply())))),(r=>(this.parentFolder&&this.parentFolder.failedFiles.push(this),t.reject(r),s((()=>e.$apply())))),l(this)),t.promise}setBlockRequest(){return this.blockRequest={abort:r.defer()}}getFinishedIndex(){return this.uploadedBlockCtxs.length}saveUploadProgressLog(){var e={uploadedBlockCtxs:this.uploadedBlockCtxs,timestamp:Date.now()};return window.sessionStorage.setItem(this.getStorageKey(),JSON.stringify(e))}loadUploadProgressLog(){var e=this.getStorageKey();if(e)return JSON.parse(window.sessionStorage.getItem(e))}deleteUploadProgressLog(){return window.sessionStorage.removeItem(this.getStorageKey())}uploadBlockData(e){var t=r.defer(),o=Date.now();return this.aborted?t.reject({aborted:this.aborted}):(this.setBlockRequest(),c.http({url:"".concat(this.uploadUrl,"/mkblk/").concat(e.byteLength),data:e,headers:{Authorization:"UpToken ".concat(this.uptoken),"Content-Type":"application/octet-stream"},timeout:this.blockRequest.abort.promise}).then((e=>(t.resolve(e),delete this.blockRequest)),(e=>(delete this.blockRequest,t.reject(e))),(e=>{var t=e.loaded;return this.updateProgress(t),this.updateSpeed(o,t)}))),t.promise}updateProgress(e){var t=100*(this.getUploadedSize()+e);return this.progress=n.parseInt(t/this.size)}doSuccessfulUpload(t){return t&&t.data&&t.data.file_key&&(this.key=t.data.file_key),this.finished=!0,delete this.progress,delete this.speed,s((()=>e.$apply()))}doFailedUpload(){return this.failed=!0,delete this.progress,delete this.speed,s((()=>e.$apply()))}updateSpeed(e,t){var r=(Date.now()-e)/1e3;return this.speed=r?t/r:0}getUploadedSize(){return this.blockSize*this.uploadedBlockCtxs.length}updateToken(){var e=r.defer();return this.uptoken?e.resolve(this.uptoken):t.get("/api/uptoken?id=".concat(this.id)).success((t=>(this.uptoken=t.uptoken,e.resolve(t)))).error((t=>e.reject(t))),e.promise}refreshToken(){return this.uptoken=null,this.updateToken()}bindparentFolder(e){this.parentFolder=e,this.isFolderFile=!0}}}]},305838:function(e,t,r){r(185827),e.exports=[function(){return class{constructor(){this.name="",this.size=0,this.filesCount=0,this.finishedCount=0,this.failedFiles=[],this.loadedCount=0}loadUploadFolder(e){this.id=e.id,this.name=e.name,this.filesCount=e.childs.reduce(((e,t)=>t.is_upload?e+1:e),0)}get progress(){return 0===this.filesCount?0:this.finishedCount/this.filesCount*100}get finished(){return this.filesCount===this.finishedCount}get failed(){return 0!==this.failedFiles.length&&this.failedFiles.length===this.filesCount}get loaded(){return this.loadedCount===this.filesCount}get progressing(){return this.filesCount>this.failedFiles.length+this.finishedCount}}}]},657886:function(e,t,r){var o=r(496486);r(556977),r(324603),r(339714);var n=r(693604);e.exports=["$rootScope","$http","$q","uploadClass","jobQueue","uploadFolderClass",function(e,t,r,i,a,s){e.uploads=[],e.uploadFolders=[];return new class{constructor(e){this.jobQueue=e,this.config={}}uploadFiles(t){var r=[];return o.each(t,(t=>{var o=new i(t);return r.push(o),this.updateServerData(o).then((t=>(e.uploads.push(t),this.jobQueue.push(t))),(e=>(o.createFailed=!0,this.errorCallback(e))))})),r}uploadFilesWithFolder(t,r,n){var a=new s(r);return a.loadUploadFolder(r),e.uploadFolders.push(a),o.each(r.childs,(r=>{if(r.is_upload){var s=new i(r.file);s.successCallback=this.successCallback,s.bindparentFolder(a);var c=o.cloneDeep(n);c.name=r.file.name,c.size=r.file.size,c.parent_id=r.parent_id,this.updateServerDataForUploadFolder(s,c).then((r=>(e.uploads.push(r),t.push(r))),(e=>(s.createFailed=!0,s.parentFolder.failedFiles.push(s),this.errorCallback(e))))}})),a}updateConfig(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",a=arguments.length>6&&void 0!==arguments[6]&&arguments[6];this.config.parentId=n,this.config.parentType=e,this.config.isScorm=t,this.config.embedMaterialType=o,this.config.isWmpkg=r,this.config.source=i,this.config.isMarkedAttachment=a}bindCallback(e,t){return this.errorCallback=t,this.successCallback=e,this.jobQueue.bindCallback(e,t)}updateServerData(e){var o=e.file,n={name:o.name,size:o.size,parent_type:this.config.parentType,parent_id:this.config.parentId,is_scorm:this.config.isScorm,is_wmpkg:this.config.isWmpkg,source:this.config.source,is_marked_attachment:this.config.isMarkedAttachment,embed_material_type:this.config.embedMaterialType},i=r.defer();return t.post("/api/uploads",n).success((function(t){return e.updateUploadWithServerData(t),i.resolve(e)})).error((e=>i.reject(e))),i.promise}updateServerDataForUploadFolder(e,o){var n=r.defer();return t.post("/api/uploads",o).success((function(t){return e.parentFolder.size+=e.size,e.parentFolder.loadedCount+=1,e.parentFolder.created_at||(e.parentFolder.created_at=t.created_at),e.updateUploadWithServerData(t),n.resolve(e)})).error((e=>n.reject(e))),n.promise}checkFileFormat(e,t){return o.every(e,(e=>o.some(t,(t=>new RegExp(".".concat(t),"i").test(e.name)))))}checkFileSize(e,t){return"number"==typeof t?o.every(e,(e=>e.size>0&&e.size<=t)):o.every(e,(e=>{var r=n.getFileType(e.name),o=t[r];return e.size>0&&e.size<=o}))}checkFiles(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return 0===r.length?this.checkFileSize(e,t):this.checkFileSize(e,t)&&this.checkFileFormat(e,r)}filterByFileSizeZero(e){return o.filter(e,(e=>0===e.size))}filterByFileSize(e,t){return o.filter(e,(e=>{var r=n.getFileType(e.name),o="number"==typeof t?t:t[r];return e.size>0&&e.size<=o}))}filterByFileFormat(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return 0===t.length?e:o.filter(e,(e=>o.some(t,(t=>new RegExp("\\.".concat(t,"$"),"i").test(e.name)))))}deleteUploadingUpload(t){return this.jobQueue.removeJob(t),o.remove(e.uploads,(e=>e.id===t.id))}deleteUpload(e,r){return e.id?t.delete("/api/uploads/".concat(e.id)).success(r):r()}isUploading(){return!this.jobQueue.isDone()}humanizeBytes(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:" ",n=!0,i=["Bytes","KB","MB","GB","TB"];if(/floor/.test(r)&&(r=Math.floor),0===e)return"0 ".concat(i[0]);if(e<0){if(!t)return"0 ".concat(i[0]);n=!1,e=-e}var a=parseInt(Math.floor(Math.log(e)/Math.log(1024)));a=a>3?3:a;var s=Number((e/Math.pow(1024,a)).toFixed(2));r&&(s=r(s));var c=s+o+i[a];return n||(c="-".concat(c)),c}getUserCourseResourceFolder(e){return t.get("/api/user/course/".concat(e,"/resources/folder")).then((e=>e.data))}}(a)}]},581943:function(e,t,r){var o=r(383228),n=r(730381),i=r(496486),a=r(261139);r(141817),r(140561),r(115306),r(323123),r(454747);var s=r(887757);function c(e,t,r,o,n,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(o,n)}function u(e){return function(){var t=this,r=arguments;return new Promise((function(o,n){var i=e.apply(t,r);function a(e){c(i,o,n,a,s,"next",e)}function s(e){c(i,o,n,a,s,"throw",e)}a(void 0)}))}}r(535666);var l=r(554174).deleteActivity,d=r(180736);e.exports=["$scope","$rootScope","calendarApi","statHelper","toastr","$compile","$window",function(e,t,r,c,p,f,v){var m=d(e);o(document).on("closed.fndtn.reveal","[data-reveal]",(function(){if(e.isShowCalendar)return o("body").css("overflow","hidden")})),e.$watch("isShowCalendar",(e=>{e?o("body").addClass("fixed-content"):o("body").removeClass("fixed-content")})),e.ui=e.ui||{},e.ui.inited=!1,e.eventSources=[[],[],[],[],[]];r.getAlerts((t=>e.ui.alerts=t.alerts)),e.changeView=function(t){if(S(),t&&(e.ui.currentView=t),"timetable"===e.ui.currentView)return E();if("event"===e.ui.currentView)return y();if("meeting"===e.ui.currentView)return b();if("instructionMeeting"===e.ui.currentView)w();else{if("cloudClassroom"!==e.ui.currentView)return e.isTimetableToggleOpen&&E(),w(),_(),b(),y();_()}},e.downloadBlob=function(e,t){if(!t.deleted)return c.track("calendar_event","download",{calendar_event_id:e.id,upload_id:t.id})},e.formatTime=e=>"".concat(n.utc(e).format("YYYY-MM-DD"),"T").concat(n.utc(e).format("HH:mm:ss"),"Z"),e.eventDrop=t=>e.$broadcast("bindEventDrop",t),e.addEventToCalendar=function(t){if(["event","all"].includes(e.ui.currentView))return e.eventSources[1].push(h(t))},e.updateEventInCalendar=function(t){var r=i.findIndex(e.eventSources[1],(e=>e.id===t.id));return e.eventSources[1][r]=h(t)},e.deleteEventFromCalendar=function(t){var r=i.findIndex(e.eventSources[1],(e=>e.id===t.id));return e.eventSources[1].splice(r,1)};var h=function(e){return{id:e.id,title:e.title,allDay:e.all_day,start:e.start_time,end:e.end_time,backgroundColor:e.color,data:e,editable:e.editable,uploads:e.uploads,type:"event"}},g=function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#5879B4",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"meeting";t.description=t.data.description,t.join_url=t.data.join_url,t.live_addr=t.data.live_config.live_addr,t.color=r,t.replay_address=t.data.replay_address,t.host_user_id=t.host_user.id,t.scope_org_ids=t.participant_ids?t.participant_ids.split(","):[],t.is_started=n.utc()>n(t.start_time),t.is_ended=n.utc()>n(t.end_time);var i=!("agree"===t.audit_status&&t.is_started);"instructionMeeting"===o&&(i=!1);var a={id:t.id,title:t.title,start:e.formatTime(t.start_time),end:e.formatTime(t.end_time),backgroundColor:r,description:t.description,data:t,editable:i,type:o,course:t.teaching_unit,course_id:t.course_id,room:t.room};return a},y=function(){return r.getEvents((function(t){if(["event","all"].includes(e.ui.currentView))return e.eventSources[1]=[],i.each(t.events,(t=>e.eventSources[1].push(h(t))))}),(function(){}))},b=function(){return r.getCalendarMeeting((function(t){if(["meeting","all"].includes(e.ui.currentView))return e.eventSources[2]=[],i.each(t.calendar_meeting,(t=>e.eventSources[2].push(g(t))))}),(function(){}))};window.addEventListener("live-meeting-popup:close",(()=>{b()}));var w=function(){var t=u(s.mark((function t(){var o,n;return s.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.getInstructionMeeting();case 2:o=t.sent,n=o.meetings,e.eventSources[3]=[],n.forEach((t=>{e.eventSources[3].push(g(t,"#7AB27C","instructionMeeting"))}));case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),_=function(){var t=u(s.mark((function t(){var o,n;return s.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.getCloudClassroomActivity(e.start,e.end);case 2:o=t.sent,n=o.cloud_classrooms,e.eventSources[4]=[],n.forEach((t=>{e.eventSources[4].push(g(t,"#99DE9B","cloudClassroom"))}));case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();e.openMeeting=function(e){S(),"meeting"===e.type&&v.open(e.data.join_url,"_blank")},e.viewPlayBack=function(e){S(),"meeting"===e.type&&v.open(e.data.live_addr,"_blank")},e.viewLiveReplay=function(e){S(),"meeting"===e.type&&v.open(e.data.replay_address[0],"_blank")},e.editCalendar=function(t){return S(),"timetable"===t.type?e.$broadcast("bindTimetableForEdit",t):"meeting"===t.type?e.$broadcast("bindMeetingForEdit",t):e.$broadcast("bindEventForEdit",t)},e.editCloudClassroom=()=>{S()};e.deleteCalendar=function(t){return S(),"timetable"===t.type?k(t):"meeting"===t.type?x(t):"instructionMeeting"!==t.type?"cloudClassroom"===t.type?(t=>{e.confirm=u(s.mark((function r(){var n,i,a,c;return s.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=function(){p.success(),o("#calendar-confirmation-popup").foundation("reveal","close")},r.prev=1,r.next=4,l(t.id);case 4:n(),(i=e.eventSources[4].findIndex((e=>e.id===t.id)))>-1&&e.eventSources[4].splice(i,1),r.next=12;break;case 9:r.prev=9,r.t0=r.catch(1),p.error(null===(a=r.t0.response)||void 0===a||null===(c=a.data)||void 0===c?void 0:c.message);case 12:case"end":return r.stop()}}),r,null,[[1,9]])}))),e.ui=e.ui||{},e.ui.titleBind=o("#deleteMeetingTitle").val(),e.ui.messageBind=o("#deleteMeetingText").val(),o("#calendar-confirmation-popup").foundation("reveal","open")})(t):C(t):void 0};var S=()=>(WebuiPopovers.hideAll(),o(".webui-popover.webui-popover-calendar.webui-no-padding.in").hide());e.closeCalendarDetailPopover=()=>S();var C=function(t){return e.confirm=function(){return r.deleteEvent(t,(function(){return p.success(),o("#calendar-confirmation-popup").foundation("reveal","close"),window.dispatchEvent(new CustomEvent("delete-event-in-calendar",{detail:{type:"event",data:t}})),e.deleteEventFromCalendar(t)}))},o("#event-detail-popup").foundation("reveal","close"),e.ui=e.ui||{},e.ui.titleBind=o("#deleteEventTitle").val(),e.ui.messageBind=o("#deleteEventConfirmText").val(),o("#calendar-confirmation-popup").foundation("reveal","open"),null},x=function(t){e.confirm=function(){r.delCalendarMeeting(t.id,(function(){p.success(),o("#calendar-confirmation-popup").foundation("reveal","close")}));var n=e.eventSources[2].findIndex((e=>e.id===t.id));n>-1&&e.eventSources[2].splice(n,1)},e.ui=e.ui||{},e.ui.titleBind=o("#deleteMeetingTitle").val(),e.ui.messageBind=o("#deleteMeetingText").val(),o("#calendar-confirmation-popup").foundation("reveal","open")},k=function(t){return e.confirm=function(){var n={target_time:e.formatTime(t.start),update_scope:e.ui.update_scope};return m.show(),r.deleteTimetable(t.id,n,(function(r){return e.changeView(),p.success(r.message),m.hide(),window.dispatchEvent(new CustomEvent("delete-event-in-calendar",{detail:{type:"timetable",data:t}})),o("#calendar-confirmation-popup").foundation("reveal","close")}),(function(){}))},o("#timetable-detail-popup").foundation("reveal","close"),e.ui=e.ui||{},e.ui.update_scope="current",e.ui.titleBind=o("#deleteTimetableTitle").val(),delete e.ui.messageBind,o("#calendar-confirmation-popup").foundation("reveal","open"),null},P=function(t,r,o){return{id:t.id,title:t.course_title,start:e.formatTime(r),end:e.formatTime(o),data:t,editable:t.editable,uploads:[],backgroundColor:t.color,type:"timetable"}},E=function(){return r.getTimetables((function(t){if(["timetable","all"].includes(e.ui.currentView))return e.eventSources[0]=[],i.each(t.timetables,(t=>function(t){var r,o=n.utc(t.start_time),a=n.utc(t.end_time);if(["week","custom"].includes(t.repeat_type)){r=n.utc(t.repeat_end_date);var s=t.repeat_frequency,c=t.repeat_weekly_days.split(",");return i.each(c,(function(n){var i=parseInt(n)-(o.day()||7);i=i<0?i+7*s:i;var c=o.clone().add(i,"days"),u=a.clone().add(i,"days");return(()=>{for(var n=[];c.isSame(o)||c.isBetween(o,r)||c.date()===r.date();)e.eventSources[0].push(P(t,c,u)),c.add(7*s,"days"),n.push(u.add(7*s,"days"));return n})()}))}return"day"===t.repeat_type?(r=n.utc(t.repeat_end_date),(()=>{for(var n=[];o.date()===r.date()||o.isBefore(r);)e.eventSources[0].push(P(t,o,a)),o.add(1,"days"),n.push(a.add(1,"days"));return n})()):e.eventSources[0].push(P(t,o,a))}(t)))}),(function(){}))};e.formatEventTimeRange=function(t){var r=n(t.start),o=n(t.end),i="".concat(r.format("LL"),"（").concat(e.weekDayMap[r.day()],"）");if(t.allDay)return i;if(!o.isSame(r,"day")){var a="".concat(o.format("LL"),"（").concat(e.weekDayMap[o.day()],"）");return"".concat(i," ").concat(r.format("HH:mm")," -\n ").concat(a," ").concat(o.format("HH:mm"))}return"".concat(i," ").concat(r.format("HH:mm")," - ").concat(o.format("HH:mm"))};var T=function(t){return S(),"timetable"===t||void 0===t&&"timetable"===e.ui.currentView?e.$broadcast("bindTimetableForNew"):"meeting"===t?document.getElementById("live-meeting-popup").getVueInstance().showCalendarMeetingPopup():e.$broadcast("bindEventForNew")};e.createNew=e=>T(e);var M=function(){switch(t.lang){case"zh-CN":return"zh-cn";case"zh-TW":case"zh-MO":return"zh-tw";default:return"en"}},A=e=>o("#moreText").val().replace("{0}",e);e.calendarOptions={locale:M(),timezone:"local",customButtons:{change:{richContent:f(a.element('<div class="types-filter">\n    <a href="javascript:void(0)" toggle-dropdown>\n        <span>[[ calendarViewMap[ui.currentView] ]]</span>\n        <i class="font font-down-arrow"></i>\n    </a>\n    <div class="dropdown-list hide">\n        <ul>\n            <li ng-if="isTimetableToggleOpen">\n                <a ng-click="changeView(\'timetable\')">\n                    <span ng-bind="calendarViewMap.timetable"></span>\n                </a>\n            </li>\n            <li>\n                <a ng-click="changeView(\'event\')">\n                    <span ng-bind="calendarViewMap.event"></span>\n                </a>\n            </li>\n            <li ng-if="isCloudClassroomToggleOpen">\n                <a ng-click="changeView(\'meeting\')">\n                    <span ng-bind="calendarViewMap.meeting"></span>\n                </a>\n            </li>\n            <li ng-if="isInstructionTeamToggleOpen">\n                <a ng-click="changeView(\'instructionMeeting\')">\n                    <span ng-bind="calendarViewMap.instructionMeeting"></span>\n                </a>\n            </li>\n            <li ng-if="isCloudClassroomToggleOpen">\n                <a ng-click="changeView(\'cloudClassroom\')">\n                    <span ng-bind="calendarViewMap.cloudClassroom"></span>\n                </a>\n            </li>\n            <li>\n                <a ng-click="changeView(\'all\')">\n                    <span ng-bind="calendarViewMap.all"></span>\n                </a>\n            </li>\n        </ul>\n    </div>\n</div>'))(e)},create:{richContent:f(a.element('<a class="button button-green create-button" href="javascript:void(0)" toggle-dropdown>\n    <i class="icon icon-add-white"></i><span class="create-text" ng-bind="i18nMessage.createText"></span>\n</a>\n<div class="dropdown-list hide calendar-add-dropdown-list">\n    <ul>\n        <li ng-if="isTimetableToggleOpen">\n            <a ng-click="createNew(\'timetable\')"><span ng-bind="calendarViewMap.timetable"></span></a>\n        </li>\n        <li>\n            <a ng-click="createNew(\'event\')"><span ng-bind="calendarViewMap.event"></span></a>\n        </li>\n    </ul>\n</div>'))(e),richText:'<i class="icon icon-add-white"></i>'.concat(o("#addText").val()),click:T}},header:{left:"change create",center:"prev title next",right:"today"},views:{month:{titleFormat:"YYYY.MM"}},firstDay:1,viewRender:t=>(e.start=t.start.format("YYYY-MM-DD HH:mm:ss"),e.end=t.end.format("YYYY-MM-DD HH:mm:ss"),e.ui.inited||(e.ui.inited=!0,e.ui.calendar=t.calendar,e.isTimetableToggleOpen?e.ui.currentView="timetable":e.ui.currentView="all"),e.changeView()),eventLimit:!0,eventLimitText:A,eventTimeFormat:"HH:mm",eventClick(t){return(null!=e.currentCalendar?e.currentCalendar.start:void 0)===t.start&&o(this).attr("data-target")?o(this).webuiPopover("show"):(function(t){e.currentCalendar=t,e.uploads=e.currentCalendar.uploads,e.activity=e.currentCalendar.data,e.currentCalendar.timeRange=e.formatEventTimeRange(t)}(t),o(this).webuiPopover("destroy").webuiPopover({url:"#calendar-detail-popup",width:400,padding:!1,style:"calendar",arrow:!1,trigger:"manual"}).webuiPopover("show"))}}}]},393862:function(e,t,r){var o=r(261139),n=r(496486),i=r(383228),a=r(730381);function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],o=!0,n=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(o=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);o=!0);}catch(e){n=!0,i=e}finally{try{o||null==s.return||s.return()}finally{if(n)throw i}}return r}(e,t)||c(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){if(e){if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}r(491038),r(339714),r(132023),r(923157),r(454747);var l=r(180736),d=r(693604);e.exports=["$scope","calendarApi","$q","multiSelect","$http","$window",function(e,t,r,u,p,f){var v=l(e);e.errors={},e.ui={},e.uploads=[];var m=function(){return e.target_data={department_ids:[],role_ids:[],course_id:null,course_ids:[],course_targets:[]},e.ui.showDepartmentTreeView=!1},h=function(){if(!e.ui.alerts&&e.ui.hasAlert)return t.getAlerts((t=>e.ui.alerts=t.alerts))},g=function(){var n;if(!n){n=r.defer();t.getDepartments((e=>n.resolve(e.departments)),(()=>n.resolve([])))}return n.promise.then((function(t){return e.ui.departments=o.copy(t),y(),e.ui.showDepartmentTreeView=!0}))},y=function(){if(e.target_data.department_ids.length>0){var t=function t(r){return n.includes(e.target_data.department_ids,r.id.toString())&&(r.selected=!0),r.departments.map((e=>t(e)))};return(()=>{var r,o=[],n=function(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=c(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,n=function(){};return{s:n,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}(e.ui.departments);try{for(n.s();!(r=n.n()).done;){var i=r.value;o.push(t(i))}}catch(e){n.e(e)}finally{n.f()}return o})()}},b=()=>u.multiSelect("#role-select",e.target_data.role_ids,!0,!1),w=function(){e.errors={};if(!e.ui.courses){var r=i("#userId").data("id");return t.getUserCourses(r,(function(t){e.ui.courses=t.courses,n.each(e.ui.courses,(function(e){return e.course_code&&d.startsWith(e.course_code,"_uuid")?e.display_text=e.name:e.display_text="".concat(e.name," (").concat(e.course_code,")")})),u.multiSelect("#course-select",e.target_data.course_ids,!0,!0)}))}u.multiSelect("#course-select",e.target_data.course_ids,!0,!0)},_=function(o){if(o){var i=r.defer(),a=r.defer();return t.getGroups(o,(e=>i.resolve(e.groups))),t.getStudents(o,(e=>a.resolve(e.students))),r.all([i.promise,a.promise]).then((function(){var t=Array.from(arguments.length<=0?void 0:arguments[0]),r=s(t,2),o=r[0],i=r[1],a=[];return n.forEach(o,(e=>a.push({id:"g".concat(e.id),name:e.name}))),n.forEach(i,(e=>a.push({id:"s".concat(e.id),name:e.name}))),e.ui.courseTargets=a,u.multiSelect("#course-target-select",e.target_data.course_targets)}))}},S=function(){e.event={title:"",all_day:!1,start_time:null,end_time:null,location:"",description:"",target_type:"self",target_data:{},alert_id:null,send_email_alert:!1,tag_id:void 0,uploads:[]},e.uploads=[],function(){var t;(t=e.selectedDate?a.utc(e.selectedDate).local().hour(a().hour()).utc():a.utc()).add(1,"hour").startOf("hour");var r=t.clone().add(1,"hour");e.event.start_time=t.format(),e.event.end_time=r.format()}(),m(),e.ui.hasAlert=0,i("#event-popup").foundation("reveal","open")};e.$on("bindEventForNew",(()=>S())),e.$on("bindEventForEdit",((t,r)=>function(t){var r;switch(e.event=o.copy(t.data),null!==(r=t.data.tag)&&void 0!==r&&r.id&&(e.event.tag_id=t.data.tag.id),e.uploads=o.copy(t.uploads),e.event.all_day&&(e.event.end_time=a.utc(e.event.end_time).add(-1,"day").format()),m(),e.event.target_type){case"department":e.target_data.department_ids=n.map(e.event.target_data.department_ids,(e=>e.toString())),g(),e.target_data.role_ids=n.map(e.event.target_data.role_ids,(e=>e.toString())),b();break;case"course":w(),e.target_data.course_id=e.event.target_data.course_id,e.event.target_data.course_ids&&(e.target_data.course_ids=e.event.target_data.course_ids.map((e=>e.toString())),u.multiSelect("#course-select",e.target_data.course_ids,!0,!0));var s=[];n.forEach(e.event.target_data.group_ids,(e=>s.push("g".concat(e)))),n.forEach(e.event.target_data.user_ids,(e=>s.push("s".concat(e)))),e.target_data.course_targets=s,_(e.target_data.course_id)}e.ui.hasAlert=e.event.alert_id?1:0,h(),i("#event-popup").foundation("reveal","open")}(r))),e.$on("bindEventDrop",(function(r,n){var i=o.copy(n);i.start_time=a.utc(n.start_time).format(),i.end_time=a.utc(n.end_time).format();return t.updateEvent(i,(t=>e.updateEventInCalendar(t)),(function(t){return e.errors=t.errors,e.updateEventInCalendar(n)}))})),e.changeAllDay=function(){var t=a.utc(e.event.start_time),r=a.utc(e.event.end_time);if(e.event.all_day)t.local().startOf("day").utc(),r.local().startOf("day").utc();else{var o=a().hour();t.local().hour(o).add(1,"hour").startOf("hour").utc(),r.local().hour(o).add(2,"hour").startOf("hour").utc()}return e.event.start_time=t.format(),e.event.end_time=r.format()},e.showTargetType=()=>i(".target-type select option").length>1,e.changeTargetType=function(){switch(m(),e.event.target_type){case"department":return g(),b();case"course":return w()}},e.changeCourse=()=>_(e.target_data.course_id),e.changeHasAlert=function(){return e.event.alert_id=e.ui.hasAlert?100:null,h()};var C=t=>{var r=t.detail;e.event&&(e.event.tag_id=r)};return f.removeEventListener("calendar-tag-change",C),f.addEventListener("calendar-tag-change",C),e.save=function(){var r;v.show();var s=function(t){return e.errors=t.errors,v.hide()},c=o.copy(e.event);switch(e.uploads&&(c.uploads=e.uploads.map((e=>e.id))),c.all_day&&(c.end_time=a.utc(c.end_time).add(1,"day").format()),c.target_type){case"department":if(0===e.target_data.department_ids.length)return void s({errors:{event_target_data_department_multi_select_tree:[e.i18nMessage.dataRequired]}});c.target_data={department_ids:n.map(e.target_data.department_ids,(e=>+e)),role_ids:n.map(e.target_data.role_ids,(e=>+e))};break;case"course":if(e.calendarEventToAllCourses)c.target_data={course_ids:e.target_data.course_ids.length?e.target_data.course_ids.map((e=>+e)):e.ui.courses.map((e=>+e.id))};else{if(!e.target_data.course_id)return void s({errors:{target_data_course_id:[e.i18nMessage.dataRequired]}});var u=[],l=[];n.forEach(e.target_data.course_targets,(function(e){return d.startsWith(e,"s")?u.push(+e.substr(1)):d.startsWith(e,"g")?l.push(+e.substr(1)):void 0})),c.target_data={course_id:+e.target_data.course_id,user_ids:u,group_ids:l}}break;default:c.target_data={}}return c.id?(r=function(t){return e.updateEventInCalendar(t),window.dispatchEvent(new CustomEvent("update-event-in-calendar",{detail:{type:"event",data:t}})),v.hide(),i("#event-popup").foundation("reveal","close")},t.updateEvent(c,r,s)):(r=function(t){return e.addEventToCalendar(t),window.dispatchEvent(new CustomEvent("add-event-to-calendar",{detail:{type:"event",data:t}})),v.hide(),i("#event-popup").foundation("reveal","close")},t.createEvent(c,r,s))},e.addFiles=t=>e.uploads=t.concat(e.uploads),e.deleteFile=t=>n.remove(e.uploads,t)}]},817382:function(e,t,r){var o=r(730381),n=r(383228),i=r(261139);r(294986),r(747042),r(132023),r(454747);var a=r(180736);e.exports=["$scope","calendarApi","$q","multiSelect","toastr",function(e,t,r,s,c){var u=a(e);e.errors={},e.ui={},e.orgs=[];var l=function(){var r=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],o=t=>{if(e.orgs=t.orgs,r)return s.multiSelect("#orgs-select");var o="";e.orgs.forEach((t=>{e.meeting.scope_org_ids.includes(t.id+"")&&(o=o.concat(t.name).concat("; "))})),e.scope_orgs=o.slice(0,o.lastIndexOf(";"))};return t.getOrgs(o)},d=function(){var t,r=n("#userId").data("id"),i=n("#currentUserPhone").val();return e.can_edit=!0,e.meeting={title:"",start_time:null,end_time:null,data:{description:""},scope_org_ids:[],host_user:e.userCurrentName+"("+window.globalData.user.userNo+")("+i+")",host_user_id:r},l(),(t=o.utc()).add(10,"minute").startOf("minute"),e.meeting.start_time=t.format(),n("#calendar-meeting-popup").foundation("reveal","open")};e.$on("bindMeetingForNew",(()=>d())),e.$on("bindMeetingForEdit",((t,r)=>function(t){return e.can_edit="reject"===t.data.audit_status,e.meeting=i.copy(t.data),e.meeting.start_time=e.formatTime(t.data.start_time),e.meeting.end_time=e.formatTime(t.data.end_time),e.meeting.host_user=t.data.host_user.name+"("+t.data.host_user.user_no+")("+t.data.host_user.mobile_phone+")",e.can_edit&&(e.meeting.scope_org_ids=[]),l(e.can_edit),n("#calendar-meeting-popup").foundation("reveal","open")}(r))),e.save=function(){var r;u.show();var o=function(t){return e.errors=t.errors,t.message&&c.error(t.message),u.hide()},a=i.copy(e.meeting);return 0===a.scope_org_ids.length&&e.orgs.forEach((e=>a.scope_org_ids.push(e.id))),a.scope_org_ids=a.scope_org_ids.join(","),a.id?(r=function(t){return c.success(t.message),u.hide(),e.changeView("meeting"),n("#calendar-meeting-popup").foundation("reveal","close")},t.updateCalendarMeeting(a,r,o)):(r=function(t){return c.success(t.message),u.hide(),e.changeView("meeting"),n("#calendar-meeting-popup").foundation("reveal","close")},t.createCalendarMeeting(a,r,o))}}]},443746:function(e){e.exports=["calendarApi","$q",function(e,t){var r={},o=null,n=null;return{initUserCourses(o){if(r[o])return r[o].promise;return r[o]=t.defer(),e.getUserCourses(o,(e=>r[o].resolve(e.courses)),(()=>r[o].resolve([]))),r[o].promise},initTimetables(){if(o)return o.promise;return o=t.defer(),e.getTimetables((e=>o.resolve(e.timetables)),(()=>o.resolve([]))),o.promise},initEvents(){if(n)return n.promise;return n=t.defer(),e.getEvents((e=>n.resolve(e.events)),(()=>n.resolve([]))),n.promise},clearTimetableCache:()=>o=null,clearEventCache:()=>n=null}}]},350686:function(e,t,r){var o=r(383228),n=r(496486),i=r(730381),a=r(261139);r(682772),r(702707),r(140561),r(323123),r(923157);var s=r(180736),c=r(693604),u=r(905686);e.exports=["$scope","calendarApi","calendarRepository","toastr","$document",function(e,t,r,l,d){var p=s(e),f=o("#userId").data("id");e.weeklyDays=n.map(e.weekDayIso,((e,t)=>({name:e,val:t}))),e.defaultColors=["#800000","#FFD000","#000000","#7BA8D4","#002654","#A8497A"],e.errors={},e.showWeeklyDaysError=!1;var v=function(t){return e.courses=t,n.each(e.courses,(function(e){return e.course_code&&c.startsWith(e.course_code,"_uuid")?e.display_text=e.name:e.display_text="".concat(e.name," (").concat(e.course_code,")")}))};e.$on("bindTimetableForNew",(function(){var t=i.utc();t.add(1,"hour").startOf("hour");var n=t.clone().add(2,"hour");return e.timetable={course_id:0,course_title:"",instructors_names:"",start_time:t.format(),end_time:n.format(),repeat_type:"no_repeat",repeat_frequency:1,repeat_weekly_days:[],repeat_end_date:null,location:"",description:"",color:e.defaultColors[0]},r.initUserCourses(f).then((function(e){return v(e),o("#timetable-popup").foundation("reveal","open")}))})),e.$on("bindTimetableForEdit",(function(t,i){return e.timetable=a.copy(i.data),e.timetable.start_time=e.formatTime(i.start),e.timetable.end_time=e.formatTime(i.end),e.timetable.repeat_weekly_days=e.timetable.repeat_weekly_days?e.timetable.repeat_weekly_days.split(","):[],e.oldTimetable=a.copy(e.timetable),e.timetable.update_scope="current",e.timetable.origin_repeat_type=e.timetable.repeat_type,e.timetable.update_target_time=e.formatTime(i.start),e.timetable.send_ntf=!1,r.initUserCourses(f).then((function(t){e.courses||v(t);var r=n.find(e.courses,{id:parseInt(e.timetable.course_id)});return e.timetable.course_end_date=null!=r?r.end_date:void 0,o("#timetable-popup").foundation("reveal","open"),e.$watch("timetable",(function(t,r){if(t&&r){var o=r.start_time!==t.start_time,n=r.end_time!==t.end_time,i=t.update_scope!==r.update_scope,a=t.repeat_type!==r.repeat_type,s=t.repeat_frequency!==r.repeat_frequency,c=t.repeat_weekly_days.sort().join("")!==r.repeat_weekly_days.sort().join("");return o||n||i||a||s||c?e.timetable.ntf_content=u.generateNtfContent(e.oldTimetable,t):void 0}}),!0)}))})),d.on("close.fndtn.reveal","#timetable-popup",(()=>delete e.timetable)),e.changeCourse=function(){if(null!=e.errors&&delete e.errors.course_id,e.timetable.course_id){var t=n.find(e.courses,{id:parseInt(e.timetable.course_id)});e.timetable.course_title=null!=t?t.display_text:void 0,e.timetable.course_end_date=null!=t?t.end_date:void 0,e.timetable.instructors_names=null!=t?t.instructors_names:void 0}},e.toggleSelectDay=function(t){var r=n.indexOf(e.timetable.repeat_weekly_days,t);return-1!==r?e.timetable.repeat_weekly_days.splice(r,1):e.timetable.repeat_weekly_days.push(t)},e.selectColor=t=>e.timetable.color=t;return e.save=function(){var r,n=function(t){return e.errors=t.errors,e.showWeeklyDaysError=Boolean(null!=e.errors?e.errors.repeat_weekly_days:void 0),p.hide()};p.show();var i=function(t){var r=a.copy(t);return r.send_ntf||delete r.ntf_content,"current"===e.timetable.update_scope&&(r.repeat_type="no_repeat"),"no_repeat"===r.repeat_type?(delete r.repeat_frequency,delete r.repeat_weekly_days,delete r.repeat_end_date):"day"===r.repeat_type?(delete r.repeat_frequency,delete r.repeat_weekly_days):"week"===r.repeat_type?(r.repeat_weekly_days=r.repeat_weekly_days.join(","),r.repeat_frequency=1):"custom"===r.repeat_type&&(r.repeat_weekly_days=r.repeat_weekly_days.join(",")),r}(e.timetable);return i.color="#FF9700",i.id?(r=function(t){return e.changeView(),l.success(t.message),window.dispatchEvent(new CustomEvent("update-event-in-calendar",{detail:{type:"timetable",data:t.timetable}})),p.hide(),o("#timetable-popup").foundation("reveal","close")},t.updateTimetable(i,r,n)):(r=function(t){return e.changeView(),l.success(t.message),window.dispatchEvent(new CustomEvent("add-event-to-calendar",{detail:{type:"timetable",data:t.timetable}})),p.hide(),o("#timetable-popup").foundation("reveal","close")},t.createTimetable(i,r,n))}}]},905686:function(e,t,r){var o=r(730381),n=r(496486);r(702707),r(323123);var i=function(e,t){var r,n=e.repeat_type,i=o(e.start_time).format("HH:mm"),a=o(e.end_time).format("HH:mm");if("current"===t||"no_repeat"===n){var c=o(e.start_time),u=c.month()+1,l=c.date();return"".concat(u,"月").concat(l,"日").concat(i,"-").concat(a)}if("day"===n)return"每天".concat(i,"-").concat(a);if("week"===n)return r=s(e.repeat_weekly_days),"每周".concat(r).concat(i,"-").concat(a);if("custom"===n){var d=e.repeat_frequency;return r=s(e.repeat_weekly_days),"每".concat(d,"周").concat(r).concat(i,"-").concat(a)}},a={1:"一",2:"二",3:"三",4:"四",5:"五",6:"六",7:"日"},s=function(e){return e="string"==typeof e?e.split(","):e,n.map(e.sort(),(e=>"周"+a[e])).join("、")};e.exports={generateNtfContent(e,t){var r=e.course_title,n=function(e){if("current_and_after"!==e.update_scope)return"";var t=o(e.update_target_time),r=t.month()+1,n=t.date();return"自".concat(r,"月").concat(n,"日起，")}(t),a=i(e,t.update_scope),s=i(t,t.update_scope);return"课程".concat(r,"，").concat(n,"上课时间由").concat(a,"调整至").concat(s,"，望周知。")}}},875966:function(e,t,r){var o=r(496486);e.exports=["$http","toastr",function(e,t){return{getEvents(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.noop;return e.get("/api/calendar-events?no-intercept=true").success(r).error(t.decorateError(n))},createEvent(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.post("/api/calendar-events",r).success(n).error(t.decorateError(i))},updateEvent(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.put("/api/calendar-events/".concat(r.id),r).success(n).error(t.decorateError(i))},getOrgs:t=>e.get("/api/org").success(t),deleteEvent(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.delete("/api/calendar-events/".concat(r.id)).success(n).error(t.decorateError(i))},getAlerts(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.noop;return e.get("/api/calendar-alerts?no-intercept=true").success(r).error(t.decorateError(n))},getDepartments(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.noop;return e.get("/api/departments?no-intercept=true").success(r).error(t.decorateError(n))},getUserCourses(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop,a="/api/calendar-events/users/".concat(r,"/courses?no-intercept=true");return e.get(a).success(n).error(t.decorateError(i))},getGroups:(r,o)=>e.get("/api/courses/".concat(r,"/groups?no-intercept=true")).success(o).error(t.decorateError()),getStudents:(r,o)=>e.get("/api/course/".concat(r,"/students?no-intercept=true")).success(o).error(t.decorateError()),getTimetables(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.noop;return e.get("/api/calendar-timetables?no-intercept=true").success(r).error(t.decorateError(n))},createTimetable(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.post("/api/calendar-timetables",t).success(r).error(n)},updateTimetable(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.put("/api/calendar-timetables/".concat(t.id),t).success(r).error(n)},deleteTimetable(t,r,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:o.noop;return e.put("/api/calendar-timetables/".concat(t,"/delete"),r).success(n).error(i)},createCalendarMeeting(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.post("/api/calendar-meeting",t).success(r).error(n)},getCalendarMeeting(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.noop;return e.get("/api/calendar-meeting").success(r).error(t.decorateError(n))},delCalendarMeeting(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.delete("/api/calendar-meeting/".concat(r)).success(n).error(t.decorateError(i))},updateCalendarMeeting(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e.put("/api/calendar-meeting/".concat(r.id),r).success(n).error(t.decorateError(i))},getCalendarMeetingForManagement(t,r,n,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:o.noop;return e.post("/api/management/calendar-meeting?page=".concat(t,"&page_size=").concat(r),n).success(i).error(a)},getCalendarMeetingForManagementExcel(r,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.noop;return e({url:"/api/management/calendar-meeting/excel",method:"POST",responseType:"arraybuffer",data:r}).success(n).error(t.decorateError(i))},getCloudClassroomActivity:(t,r)=>e.get("/api/activity/cloud-classroom?start=".concat(t,"&end=").concat(r)).then((e=>e.data)),getInstructionMeeting:()=>e.get("/api/instruction-team/meeting").then((e=>e.data))}}]},933533:function(e,t,r){r(323123);var o=r(693604);e.exports=["$rootScope","$scope","$timeout","toastr","filesApi",function(e,t,r,n,i){var a;t.humanizeBytes=o.humanizeBytes,t.usedStorage="--",t.assignedStorage="--",t.unusedStorage="--",t.storageUsageRate="0%",r((function(){return a()})),e.$on("refreshStorageBar",(()=>a()));var s=function(e,t){var r=Math.round(e/t*100);return r>100?"100%":"".concat(r,"%")};t.calcBgColor=()=>{var e=t.storageUsageRate.split("%")[0];return e<80?"used":e>=80&&e<100?"warning":"insufficient"};return a=function(){return i.getStorageUsed((function(e){var o=e.storage_used,n=t.maxSize;return t.ui={usedPercent:()=>s(o,n),unusedPercent(){return e=o,t=n,(r=Math.round((t-e)/t*100))<0?"0%":"".concat(r,"%");var e,t,r},backgroundColor(){return(e=o)/(t=n)<.8?"#20bec8":e/t<1&&e/t>=.8?"#ff9700":"#f85353";var e,t},usedRadius:()=>function(e,t){if(Math.round(e/t*100)>=100)return"3px"}(o,n),unusedRadius:()=>function(e,t){if(Math.round(e/t*100)<=0)return"3px"}(o,n),unUsedSpace:()=>function(e,t){return t-e}(o,n)},r((function(){return function(e,r){t.usedStorage=t.humanizeBytes(e,!1,"floor"),t.assignedStorage=t.humanizeBytes(r,!1,"floor"),t.storageUsageRate=s(e,r),t.unusedStorage=t.humanizeBytes(r-e,!1,"floor")}(o,n)}))}))}}]},397416:function(e,t,r){var o=r(496486);e.exports=["$http","toastr",function(e,t){return{getStorageUsed:r=>e.get("/api/user/storage-used").success(r).error(t.decorateError()),createLink:t=>e.post("/api/user/links",t),editLink:(t,r)=>e.put("/api/user/links/".concat(t),r),getUploadReferenceDetail(t,r,n,i,a){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:o.noop;return e.get("/api/uploads/".concat(t,"/references"),{params:{page:r,page_size:n,conditions:i}}).success(a).error(s)},getResourceReferenceDetail(t,r,n,i,a){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:o.noop;return e.get("/api/resources/".concat(t,"/activities"),{params:{page:r,page_size:n,conditions:i}}).success(a).error(s)},uploadFolder:(t,r,o,n)=>e.post("/api/uploads",{parent_id:t,name:r,is_folder:o}).error(n)}}]},647802:function(e,t,r){function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],o=!0,n=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(o=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);o=!0);}catch(e){n=!0,i=e}finally{try{o||null==s.return||s.return()}finally{if(n)throw i}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return n(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}r(491038),e.exports=["$rootScope","$scope","videoQuizRepository","$q","$timeout","interactionHelper","$interval",function(e,t,r,n,i,a,s){t.canContinue=()=>!0;var c,u;return c=r.initSubjects(t.videoQuizId),u=r.initVideoQuiz(t.videoQuizId),n.all([u,c]).then((function(){var r=Array.from(arguments.length<=0?void 0:arguments[0]),c=o(r,2),u=c[0],l=c[1];return a.initForVideoQuiz(t,u,l),t.$emit("video-quiz-subject-loaded",{subjectCount:t.subjects.length}),a.initForPreview(e,t,n,i,s)}))}]},985592:function(e){e.exports=["$http","$q",function(e,t){var r={},o={};return{initVideoQuiz(o){if(r[o])return r[o].promise;r[o]=t.defer();return e.get("/api/video-quizzes/".concat(o)).success((e=>r[o].resolve(e))).error((()=>r[o].resolve())),r[o].promise},initSubjects(r){if(o[r])return o[r].promise;o[r]=t.defer();return e.get("/api/video-quizzes/".concat(r,"/subjects")).success((e=>o[r].resolve(e.subjects))).error((()=>o[r].resolve([]))),o[r].promise}}}]},637459:function(e,t,r){"use strict";r.r(t);r(788674);var o=r(866473),n=r.n(o),i=r(370538),a=r(925706),s=r(117403),c=(0,a.aZ)({components:{},props:{headerTitle:{type:String,default:s.default.t("air.prompt")},contentDesc:{type:String,default:""},confirmText:{type:String,default:s.default.t("confirm")}},setup:function(e,t){var r=t.emit,o=(0,a.iH)(!1);return{modal:o,ok:function(){o.value=!1,r("confirm")},cancel:function(){o.value=!1},open:function(){o.value=!0}}}}),u=(0,r(551900).Z)(c,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("Modal",{attrs:{width:"416","class-name":"vertical-center-modal"},on:{"on-ok":e.ok,"on-cancel":e.cancel},scopedSlots:e._u([{key:"header",fn:function(){return[r("i",{staticClass:"font font-alert-warning"}),e._v(" "),r("span",[e._v(e._s(e.headerTitle))])]},proxy:!0},{key:"footer",fn:function(){return[r("Button",{attrs:{type:"primary"},on:{click:e.ok}},[e._v(e._s(e.confirmText))]),e._v(" "),r("Button",{on:{click:e.cancel}},[e._v(e._s(e.$t("cancel")))])]},proxy:!0}]),model:{value:e.modal,callback:function(t){e.modal=t},expression:"modal"}},[e._v(" "),r("div",[e._v(e._s(e.contentDesc))])])}),[],!1,null,"242400b6",null).exports,l=r(285256),d=(r(422592),r(230791),r(863322));i.default.prototype.$store=d.Z,i.default.use(n()),i.default.use(l.default),i.default.customElement("prompt-modal",u),(0,r(90963).install)(),Promise.all([r.e(90858),r.e(74803),r.e(78784),r.e(40433),r.e(66309),r.e(11610),r.e(99480),r.e(32910),r.e(47995),r.e(54608)]).then(r.bind(r,854448)).then((e=>{e.default.store=d.Z,e.default.i18n=s.default,i.default.customElement(e.default.name,e.default)})),Promise.all([r.e(40433),r.e(66309),r.e(11610),r.e(99480),r.e(32910),r.e(47995),r.e(43260),r.e(36316)]).then(r.bind(r,603187)).then((e=>{e.default.store=d.Z,e.default.i18n=s.default,i.default.customElement(e.default.name,e.default)})),r.e(74521).then(r.bind(r,674521)).then((e=>{e.default.store=d.Z,e.default.i18n=s.default,i.default.customElement(e.default.name,e.default)})),Promise.all([r.e(66309),r.e(9723),r.e(77555)]).then(r.bind(r,465353)).then((e=>{e.default.store=d.Z,e.default.i18n=s.default,i.default.customElement(e.default.name,e.default)})),Promise.all([r.e(40433),r.e(81857),r.e(11610),r.e(97430),r.e(93316)]).then(r.bind(r,597134)).then((e=>{e.default.store=d.Z,e.default.i18n=s.default,i.default.customElement(e.default.name,e.default)})),Promise.all([r.e(40433),r.e(10138),r.e(11610),r.e(97430),r.e(65560)]).then(r.bind(r,497412)).then((e=>{e.default.store=d.Z,e.default.i18n=s.default,i.default.customElement(e.default.name,e.default)})),Promise.all([r.e(66309),r.e(9723),r.e(97714)]).then(r.bind(r,745677)).then((e=>{e.default.store=d.Z,e.default.i18n=s.default,i.default.customElement(e.default.name,e.default)}))},751840:function(e,t,r){"use strict";r(319601);var o,n=r(409669),i=r.n(n),a=r(383228),s=function(){return(s=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},c=null===(o=window.featureToggles)||void 0===o?void 0:o["inclass.user_action_track"];c&&document.addEventListener("click",(function(e){if(e.target){var t=a(e.target).closest("[data-action]").data();t&&t.action&&u(t)}}));var u=function(e){var t,r,o;if(c&&window.st.isCanTrack()){var n=window.statisticsSettings,a=window.globalData,u=n.server+"/api/user-actions",l=void 0===(null===(t=n.course)||void 0===t?void 0:t.id)?null===(r=null==a?void 0:a.course)||void 0===r?void 0:r.id:null===(o=n.course)||void 0===o?void 0:o.id,d=s({screen:{width:screen.width,height:screen.height},user_id:n.userId,org_id:n.orgId,course_id:l},e);navigator.sendBeacon?navigator.sendBeacon(u,JSON.stringify(d)):i().post(u,d)}};t.default=u},185514:function(e,t,r){"use strict";r(747042);var o,n=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});e.exports=["$rootScope","$http","Upload","uploadBlob",function(e,t,r,o){var i;!function(e){e.MEDIA="MEDIA",e.QINIU="QINIU",e.S3="S3",e.CHINAMCLOUD="CHINAMCLOUD"}(i||(i={}));var a=function(){function e(){}return e.prototype.upload=function(e){return r.upload({url:e.uploadUrl,data:{file:e.file},method:"PUT"})},e}(),s=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.blockSize=4194304,t.blocks=[],t.storedBlobCtxs=[],t}return n(i,e),i.prototype.upload=function(e){var t=this;return this.uploadInfo=e,this.blocks=this.splitFile(this.uploadInfo.file),this.getUptoken().then((function(){return t.uploadBlock(t.blocks[0])})).then((function(){return t.makeFile()}))},i.prototype.getUptoken=function(){var e=this;return t.get("/api/uptoken?id=".concat(this.uploadInfo.uploadId)).then((function(t){return e.uptoken=t.data.uptoken,e.uptoken}))},i.prototype.splitFile=function(e){for(var t=[],r=0,n=Math.floor((e.size+this.blockSize-1)/this.blockSize),i=n>=0;i?r<n:r>n;i?r++:r--){var a=r*this.blockSize,s=e.slice(a,a+this.blockSize);t.push(new o(s))}return t},i.prototype.makeFile=function(){for(var e={"Content-Type":"text/plain;charset=UTF-8",Authorization:"UpToken ".concat(this.uptoken)},r="",o=0,n=this.storedBlobCtxs;o<n.length;o++){var i=n[o];r="".concat(r+i,",")}return r=r.slice(0,r.length-1),t.post("".concat(this.uploadInfo.uploadUrl,"/mkfile/").concat(this.uploadInfo.file.size),r,{headers:e})},i.prototype.uploadBlock=function(e){var t=this,o=function(e){return t.storedBlobCtxs.push(e.data.ctx),t.uploadInfo.onProgress&&t.uploadInfo.onProgress(t.storedBlobCtxs.length/t.blocks.length),t.storedBlobCtxs.length<t.blocks.length?t.uploadBlock(t.blocks[t.storedBlobCtxs.length]):e},n=function(e){return 401===e.status?t.getUptoken().then((function(){return t.uploadBlock(t.blocks[t.storedBlobCtxs.length])})):e};return e.read().then((function(e){return r.http({url:"".concat(t.uploadInfo.uploadUrl,"/mkblk/").concat(e.byteLength),data:e,headers:{Authorization:"UpToken ".concat(t.uptoken),"Content-Type":"application/octet-stream"}}).then(o).catch(n)}))},i}(a),c=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return n(o,e),o.prototype.upload=function(o){return"WRPC"==o.transcoder?r.http({url:o.uploadUrl,data:o.file,method:"PUT",headers:{"Content-Type":o.file.type}}).then((function(){return t.post("/internal-api/upload/callback/".concat(o.uploadId),{file_key:o.uploadId})})):e.prototype.upload.call(this,o)},o}(a);return new(function(){function e(){}return e.prototype.getUploader=function(e){switch(e){case i.S3:return new c;case i.QINIU:return new s;default:return new a}},e}())}]},922942:function(e,t,r){"use strict";r.d(t,{Ef:function(){return l},h0:function(){return c},kJ:function(){return u}});r(141817),r(66992),r(747042),r(319601),r(788674),r(333948);var o=r(925706),n=r(48496),i=function(e,t,r,o){return new(r||(r=Promise))((function(n,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},a=function(e,t){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,o&&(n=2&s[0]?o.return:s[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,s[1])).done)return n;switch(o=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){a.label=s[1];break}if(6===s[0]&&a.label<n[1]){a.label=n[1],n=s;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(s);break}n[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{r=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},s=function(e){return{page:1,pageSize:e,total:0,pages:0,start:0,end:0,items:[]}},c=function(e,t){void 0===t&&(t=10);var r=(0,o.qj)(s(t)),c=(0,o.iH)(!1),u=function(o){return i(void 0,void 0,void 0,(function(){var n;return a(this,(function(i){switch(i.label){case 0:o&&(r.page=o),c.value=!0,i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,e(r.page,r.pageSize)];case 2:return n=i.sent(),Object.assign(r,n),[3,5];case 3:return i.sent(),Object.assign(r,s(t)),[3,5];case 4:return c.value=!1,[7];case 5:return[2]}}))}))},l=n._.debounce(u,300);return{fetch:l,originalFetch:u,data:r,pageSizeChanged:function(e){r.page=1,r.pageSize=e,l()},pageChanged:function(e){r.page=e,l()},isLoading:c,reset:function(){Object.assign(r,s(t))}}},u=function(e,t){void 0===t&&(t=10);return c((function(r,o){return i(void 0,void 0,void 0,(function(){var n,i,s,c;return a(this,(function(a){return n=e.value.length,i=o||t,s=r,c=e.value,(s-1)*i>n?s=1:c=e.value.slice((s-1)*i,s*i),[2,Promise.resolve({page:s,pageSize:i,pages:Math.ceil(n/i),total:n,items:c,start:(s-1)*i+1,end:c.length+(s-1)*i})]}))}))}),t)},l=function(e,t){void 0===t&&(t=10);return c((function(r,n){return i(void 0,void 0,void 0,(function(){var i,s,c,u;return a(this,(function(a){switch(a.label){case 0:i=(0,o.qj)({page:1,pageSize:n,total:0,pages:0,start:0,end:0,items:[]}),r&&(i.page=r),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,e()];case 2:return s=a.sent(),c=s.length,u=s,(i.page-1)*i.pageSize>c?i.page=1:u=s.slice((i.page-1)*i.pageSize,i.page*i.pageSize),Object.assign(i,{pages:Math.ceil(c/i.pageSize),total:c,items:u,start:(i.page-1)*i.pageSize+1,end:u.length+(i.page-1)*i.pageSize,totalItems:s}),[3,4];case 3:return a.sent(),Object.assign(i,{page:1,pageSize:t,total:0,pages:0,start:0,end:0,items:[],totalItems:[]}),[3,4];case 4:return[2,i]}}))}))}),t)}},422592:function(e,t,r){"use strict";r(115306),r(923157),r(454747);var o=r(370538),n=r(48496);o.default.directive("ellipsis",{inserted:function(e,t,r){var o=e.getElementsByClassName("ivu-tooltip-rel")[0],n=o.firstElementChild||o;r&&r.componentInstance&&r.componentInstance.$refs&&r.componentInstance.$refs.popper&&e.parentElement&&n&&n.offsetWidth<=e.parentElement.offsetWidth?r.componentInstance.$refs.popper.style.visibility="hidden":r.componentInstance.$refs.popper.style.visibility="visiable"},componentUpdated:function(e,t,r){o.default.nextTick((function(){var t=e.getElementsByClassName("ivu-tooltip-rel")[0],o=t.firstElementChild||t;r&&r.componentInstance&&r.componentInstance.$refs&&r.componentInstance.$refs.popper&&e.parentElement&&o&&o.offsetWidth<=e.parentElement.offsetWidth?r.componentInstance.$refs.popper.style.visibility="hidden":r.componentInstance.$refs.popper.style.visibility="visible"}))}}),o.default.directive("auto-label-width",{inserted:function(e,t,r){o.default.nextTick((function(){var e,t,o=[];null===(e=r.componentInstance)||void 0===e||e.$children.forEach((function(e){var t=e.$el.getElementsByTagName("label")[0];t&&o.push(t.clientWidth)}));var i=n._.max(o);console.log(i),null===(t=r.componentInstance)||void 0===t||t.$children.forEach((function(e){var t=e.$el.getElementsByTagName("label")[0];t&&(t.style.width=i)}))}))},componentUpdated:function(e,t,r){o.default.nextTick((function(){var e,t,o=[];null===(e=r.componentInstance)||void 0===e||e.$children.forEach((function(e){var t=e.$el.getElementsByTagName("label")[0];t&&o.push(t.clientWidth)}));var i=n._.max(o);console.log(i),null===(t=r.componentInstance)||void 0===t||t.$children.forEach((function(e){var t=e.$el.getElementsByTagName("label")[0];t&&(t.style.width="".concat(i,"px"))}))}))}}),o.default.directive("upload-font",(function(e,t,r){var o=(0,n.fileTypeByExtension)(t.value);e.classList.add("font"),e.classList.forEach((function(t){t.startsWith("font-file-")?e.classList.replace(t,"font-file-".concat(o)):e.classList.add("font-file-".concat(o))}))}))},230791:function(e,t,r){"use strict";var o=r(370538),n=r(48496),i=r(576201);o.default.filter("localDatetime",(function(e){return i.Z.toLocalDateTime(e)})),o.default.filter("formatUtcDatetime",(function(e){return i.Z.formatUtcDatetime(e)})),o.default.filter("localDateYMDHm",(function(e){return i.Z.formatDatetime(e,"YYYY-MM-DD HH:mm")})),o.default.filter("toYmd",(function(e){return i.Z.toYmd(e)})),o.default.filter("toHm",(function(e){return i.Z.toHm(e)})),o.default.filter("secondsToHms",(function(e){return i.Z.secondsToHms(e)})),o.default.filter("diffBySeconds",(function(e,t){return i.Z.diffBySeconds(e,t)})),o.default.filter("humanizeBytes",n.humanizeBytes)},90139:function(e,t,r){"use strict";r.d(t,{JK:function(){return u},Mb:function(){return d},UK:function(){return n},bx:function(){return i},n5:function(){return l}});var o,n,i,a=r(413447),s=r(526617),c=function(e,t,r,o){var n,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,r,a):n(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};!function(e){e[e.INSTRUCTOR=0]="INSTRUCTOR",e[e.STUDENT=1]="STUDENT",e[e.ADMIN=2]="ADMIN",e[e.WG_ADMIN=3]="WG_ADMIN"}(o||(o={})),function(e){e.qq="qq",e.wechat="wechat",e.weibo="weibo"}(n||(n={})),function(e){e.home="home",e.shipping="shipping"}(i||(i={}));var u=function(){function e(){}return c([(0,a.C)()],e.prototype,"id",void 0),c([(0,a.C)(),(0,s.D)((function(){return l}))],e.prototype,"user",void 0),e}(),l=function(){function e(e,t,r,o){this.webexAuth=!1,this.larkAuth=!1,this.id=e,this.userNo=t,this.name=r,this.role=o}return e.prototype.isInstructor=function(){return o.INSTRUCTOR===this.role},c([(0,a.C)()],e.prototype,"id",void 0),c([(0,a.C)()],e.prototype,"userNo",void 0),c([(0,a.C)()],e.prototype,"name",void 0),c([(0,a.C)()],e.prototype,"role",void 0),c([(0,a.C)()],e.prototype,"org",void 0),c([(0,a.C)()],e.prototype,"groupName",void 0),c([(0,a.C)()],e.prototype,"department",void 0),c([(0,a.C)()],e.prototype,"avatarBigUrl",void 0),c([(0,a.C)()],e.prototype,"isLeader",void 0),c([(0,a.C)()],e.prototype,"sex",void 0),c([(0,a.C)()],e.prototype,"education",void 0),c([(0,a.C)()],e.prototype,"teachingDate",void 0),c([(0,a.C)()],e.prototype,"occupationType",void 0),c([(0,a.C)()],e.prototype,"mobilePhone",void 0),c([(0,a.C)()],e.prototype,"email",void 0),c([(0,a.C)()],e.prototype,"userAttributes",void 0),c([(0,a.C)()],e.prototype,"userAddresses",void 0),c([(0,a.C)()],e.prototype,"userAuthExternals",void 0),c([(0,a.C)()],e.prototype,"klass",void 0),c([(0,a.C)()],e.prototype,"program",void 0),c([(0,a.C)()],e.prototype,"webexAuth",void 0),c([(0,a.C)()],e.prototype,"larkAuth",void 0),e}(),d=function(){function e(){}return c([(0,a.C)()],e.prototype,"id",void 0),c([(0,a.C)()],e.prototype,"name",void 0),e}()},77343:function(e,t,r){"use strict";r.d(t,{ZV:function(){return u},Zb:function(){return c},rK:function(){return s}});r(141817),r(66992),r(788674),r(333948);var o=r(409669),n=r.n(o),i=function(e,t,r,o){return new(r||(r=Promise))((function(n,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},a=function(e,t){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,o&&(n=2&s[0]?o.return:s[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,s[1])).done)return n;switch(o=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){a.label=s[1];break}if(6===s[0]&&a.label<n[1]){a.label=n[1],n=s;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(s);break}n[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{r=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},s=function(e,t,r){return void 0===e&&(e=1),void 0===t&&(t=10),i(void 0,void 0,void 0,(function(){var o,i;return a(this,(function(a){switch(a.label){case 0:return[4,n().get("/api/uploads/moodle-pkg?page=".concat(e,"&page_size=").concat(t,"&conditions=").concat(JSON.stringify(r)))];case 1:return o=a.sent(),i=o.data.items.map((function(e){var t=e.data;return{id:e.id,courseName:t.course_name,courseCode:t.course_code,academicYear:t.academic_year,semester:t.semester,department:t.department,college:t.college,spocCourseName:t.spoc_course_name,instructors:t.instructors,useCount:t.use_count}})),[2,{page:o.data.page,pageSize:o.data.page_size,pages:o.data.pages,total:o.data.total,start:o.data.start,end:o.data.end,items:i}]}}))}))},c=function(e,t){return i(void 0,void 0,void 0,(function(){return a(this,(function(r){return[2,n().post("/api/course/".concat(e,"/moodle/import"),{upload_id:t})]}))}))},u=function(e){return i(void 0,void 0,void 0,(function(){var t;return a(this,(function(r){return(t=new FormData).append("upload_id",String(e)),[2,n().post("/api/course/mbz/import",t)]}))}))}},128666:function(e){e.exports={props:{reloadAble:{default:!1,type:Boolean}},methods:{reload(){this.$emit("reload")}}}},385819:function(e,t,r){e.exports=r.p+"assets/images/large/cl-cracked-avatar-42a51066.svg"},474346:function(e,t,r){e.exports=r.p+"assets/images/large/player-error-63f5038a.png"},252940:function(e,t,r){e.exports=r.p+"assets/images/large/upload-avatar-normal-46d43f7d.png"},685690:function(e,t,r){"use strict";r.r(t)},133773:function(e,t,r){"use strict";r.d(t,{default:function(){return i}});var o=r(128666),n=r.n(o)(),i=(0,r(551900).Z)(n,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"player-error-box"},[o("div",{staticClass:"left-section"},[o("h2",[e._v(e._s(e.$t("player.loadFailed")))]),e._v(" "),o("div",{staticClass:"desc"},[e._v(e._s(e.reloadAble?e.$t("player.errMsg"):e.$t("player.errMsg1")))]),e._v(" "),e.reloadAble?o("button",{staticClass:"btn-primary",on:{click:e.reload}},[o("i",{staticClass:"font font-retry"}),e._v("\n      "+e._s(e.$t("player.reload"))+"\n    ")]):e._e()]),e._v(" "),o("div",{staticClass:"right-section"},[o("img",{attrs:{src:r(474346)}})])])}),[],!1,null,"224386d5",null).exports},661510:function(e,t,r){"use strict";r.d(t,{Z:function(){return m}});var o,n=r(495334),i=r(292426),a=r(632657),s=(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),c=function(e,t,r,o){var n,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,r,a):n(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t.prototype.go=function(){this.$refs.pageInput.dispatchEvent(new KeyboardEvent("keyup",{key:"Enter"}))},c([(0,n.fI)()],t.prototype,"prefixCls",void 0),t=c([(0,n.wA)({})],t)}((0,n.Wr)(a.Z)),l=r(551900),d=(0,l.Z)(u,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.showSizer||e.showElevator?r("div",{class:e.optsClasses},[e.showSizer?r("div",{class:e.sizerClasses},[r("i-select",{attrs:{size:e.size,placement:e.placement,transfer:e.transfer,disabled:e.disabled},on:{"on-change":e.changeSize},model:{value:e.currentPageSize,callback:function(t){e.currentPageSize=t},expression:"currentPageSize"}},e._l(e.pageSizeOpts,(function(t){return r("i-option",{key:t,attrs:{value:t}},[e._v(e._s(t))])})),1),e._v("\n    "+e._s(e.$t("pagination.item/page"))+"\n  ")],1):e._e(),e._v(" "),e.showElevator?r("div",{class:e.ElevatorClasses},[r("span",[e._v(e._s(e.$t("pagination.page"))+":")]),e._v(" "),r("input",{ref:"pageInput",attrs:{type:"text",autocomplete:"off",spellcheck:"false",disabled:e.disabled},domProps:{value:e._current},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.changePage(t)}}}),e._v(" "),r("span",{class:e.prefixCls+"-go",on:{click:e.go}},[e._v("Go")])]):e._e()]):e._e()}),[],!1,null,"7772651a",null).exports,p=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),f=function(e,t,r,o){var n,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,r,a):n(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return p(t,e),t.prototype.onCurrentPageChanged=function(){this.scrollTop&&(document.documentElement.scrollTop=0)},t.prototype.onCurrentPageSizeChanged=function(){this.scrollTop&&(document.documentElement.scrollTop=0)},f([(0,n.fI)({default:function(){return[10,20,30,50,100]}})],t.prototype,"pageSizeOpts",void 0),f([(0,n.fI)({default:!0})],t.prototype,"scrollTop",void 0),f([(0,n.RL)("currentPage")],t.prototype,"onCurrentPageChanged",null),f([(0,n.RL)("currentPageSize")],t.prototype,"onCurrentPageSizeChanged",null),t=f([(0,n.wA)({components:{PaginationOptions:d}})],t)}((0,n.Wr)(i.Z)),m=(0,l.Z)(v,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.simple?r("ul",{class:e.simpleWrapClasses,style:e.styles},[r("li",{class:e.prevClasses,attrs:{title:e.t("i.page.prev")},on:{click:e.prev}},[e._m(0)]),e._v(" "),r("div",{class:e.simplePagerClasses,attrs:{title:e.currentPage+"/"+e.allPages}},[r("input",{attrs:{type:"text",autocomplete:"off",spellcheck:"false",disabled:e.disabled},domProps:{value:e.currentPage},on:{keydown:e.keyDown,keyup:e.keyUp,change:e.keyUp}}),e._v(" "),r("span",[e._v("/")]),e._v("\n    "+e._s(e.allPages)+"\n  ")]),e._v(" "),r("li",{class:e.nextClasses,attrs:{title:e.t("i.page.next")},on:{click:e.next}},[e._m(1)])]):r("ul",{class:e.wrapClasses,style:e.styles},[1!==e.currentPage?r("li",{class:e.prevClasses,on:{click:e.prev}},[r("a",[e._v("< "+e._s(e.$t("pagination.prev")))])]):e._e(),e._v(" "),r("li",{class:e.firstPageClasses,attrs:{title:"1"},on:{click:function(t){return e.changePage(1)}}},[r("a",[e._v("1")])]),e._v(" "),e.currentPage-2>1?r("li",{class:[e.prefixCls+"-item",e.prefixCls+"-item-ellipsis"]},[r("a",[e._v("...")])]):e._e(),e._v(" "),e.currentPage-1>1?r("li",{class:[e.prefixCls+"-item"],attrs:{title:e.currentPage-1},on:{click:function(t){return e.changePage(e.currentPage-1)}}},[r("a",[e._v(e._s(e.currentPage-1))])]):e._e(),e._v(" "),1!=e.currentPage&&e.currentPage!=e.allPages?r("li",{class:[e.prefixCls+"-item",e.prefixCls+"-item-active"],attrs:{title:e.currentPage}},[r("a",[e._v(e._s(e.currentPage))])]):e._e(),e._v(" "),e.currentPage+1<e.allPages?r("li",{class:[e.prefixCls+"-item"],attrs:{title:e.currentPage+1},on:{click:function(t){return e.changePage(e.currentPage+1)}}},[r("a",[e._v(e._s(e.currentPage+1))])]):e._e(),e._v(" "),e.currentPage+2<e.allPages?r("li",{class:[e.prefixCls+"-item",e.prefixCls+"-item-ellipsis"]},[r("a",[e._v("...")])]):e._e(),e._v(" "),e.allPages>1?r("li",{class:e.lastPageClasses,attrs:{title:e.allPages},on:{click:function(t){return e.changePage(e.allPages)}}},[r("a",[e._v(e._s(e.allPages))])]):e._e(),e._v(" "),e.currentPage!==e.allPages?r("li",{class:e.nextClasses,on:{click:e.next}},[r("a",[e._v(e._s(e.$t("pagination.next"))+" >")])]):e._e(),e._v(" "),r("PaginationOptions",{attrs:{"show-sizer":e.showSizer,"page-size":e.currentPageSize,"page-size-opts":e.pageSizeOpts,placement:e.placement,transfer:e.transfer,"show-elevator":e.showElevator,_current:e.currentPage,current:e.currentPage,disabled:e.disabled,"all-pages":e.allPages,"is-small":e.isSmall,"prefix-cls":e.prefixCls},on:{"on-size":e.onSize,"on-page":e.onPage}})],1)}),[function(){var e=this.$createElement,t=this._self._c||e;return t("a",[t("i",{staticClass:"ivu-icon ivu-icon-ios-arrow-back"})])},function(){var e=this.$createElement,t=this._self._c||e;return t("a",[t("i",{staticClass:"ivu-icon ivu-icon-ios-arrow-forward"})])}],!1,null,"95867d2c",null).exports},485687:function(e,t,r){"use strict";r.d(t,{Z:function(){return c}});r(864765);var o,n=r(495334),i=(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),a=function(e,t,r,o){var n,i=arguments.length,a=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(i<3?n(a):i>3?n(t,r,a):n(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="search-input",t}return i(t,e),t.prototype.clickSearch=function(){var e=this.$refs.searchInput;this.search(e.$data.currentValue)},t.prototype.search=function(e){this.enableSearch&&this.$emit("on-search",e)},a([(0,n.fI)({default:!0})],t.prototype,"enableSearch",void 0),a([(0,n.fI)({required:!0})],t.prototype,"placeholder",void 0),t=a([n.wA],t)}(n.w3),c=(0,r(551900).Z)(s,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("i-input",{ref:"searchInput",staticClass:"search",attrs:{search:"",placeholder:e.placeholder},on:{"on-search":e.search}},[r("Button",{attrs:{slot:"append"},on:{click:e.clickSearch},slot:"append"},[e.enableSearch?r("Icon",{attrs:{size:16,custom:"font font-standard-search"}}):r("Icon",{staticClass:"loading",attrs:{size:16,type:"ios-loading"}})],1)],1)}),[],!1,null,"71fc24ae",null).exports},441942:function(e,t,r){"use strict";r.d(t,{Z:function(){return f}});r(141817),r(66992),r(747042),r(788674),r(333948);var o=r(925706),n=r(922942),i=r(485687),a=r(117403),s=r(661510),c=r(77343),u=function(e,t,r,o){return new(r||(r=Promise))((function(n,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},l=function(e,t){var r,o,n,i,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,o&&(n=2&s[0]?o.return:s[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,s[1])).done)return n;switch(o=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(n=a.trys,(n=n.length>0&&n[n.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){a.label=s[1];break}if(6===s[0]&&a.label<n[1]){a.label=n[1],n=s;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(s);break}n[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{r=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},d=function(e,t,r){if(r||2===arguments.length)for(var o,n=0,i=t.length;n<i;n++)!o&&n in t||(o||(o=Array.prototype.slice.call(t,0,n)),o[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))},p=(0,o.aZ)({props:{selectAble:{type:Boolean,default:!1},value:{type:Number,default:void 0},instructorNo:{type:String}},components:{SearchInput:i.Z,Pagination:s.Z},setup:function(e,t){var r=t.emit,i=[{title:a.default.t("academic_year"),key:"academicYear"},{title:a.default.t("semester"),key:"semester",width:100},{title:a.default.t("moodleCourseImport.spocCourseCode"),slot:"courseCode"},{title:a.default.t("auditCourseResource.courseName"),key:"courseName",width:300},{title:a.default.t("moodleCourseImport.college"),key:"college"},{title:a.default.t("teachingCalendar.instructor"),slot:"instructors"}];e.instructorNo||i.push({title:a.default.t("subjectLib.useTimes"),key:"useCount"}),e.selectAble&&(i=d([{slot:"selection",width:60,title:" "}],i,!0));var s=(0,o.iH)({keyword:"",instructor_no:e.instructorNo});var p=(0,n.h0)((function(e,t){return void 0===e&&(e=1),void 0===t&&(t=10),u(this,void 0,void 0,(function(){return l(this,(function(r){return[2,(0,c.rK)(e,t,s.value)]}))}))}));p.fetch();var f=(0,o.iH)(void 0);return{columns:i,select:function(e){f.value=e,r("input",e)},page:p,search:function(e){s.value.keyword=e,p.fetch()},selected:f}}}),f=(0,r(551900).Z)(p,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"filters"},[r("search-input",{staticClass:"search-input",attrs:{placeholder:e.$t("moodleCourseImport.spocCourseCode")+" / "+e.$t("auditCourseResource.courseName")+" / "+e.$t("studentLearningReport.teacher")+" / "+e.$t("vtrs.members.code")},on:{"on-search":e.search}})],1),e._v(" "),r("Table",{attrs:{columns:e.columns,data:e.page.data.items},scopedSlots:e._u([{key:"selection",fn:function(t){var o=t.row;return[r("Radio",{attrs:{name:"selection",value:e.selected===o.id},on:{"on-change":function(t){return e.select(o.id)}}})]}},{key:"courseCode",fn:function(t){var o=t.row;return[r("div",[r("Tooltip",{attrs:{content:o.courseCode,placement:"top"}},[e._v("\n          "+e._s(o.courseCode)+"\n        ")])],1)]}},{key:"instructors",fn:function(t){var o=t.row;return[r("div",[r("Tooltip",{attrs:{content:o.instructors.join(","),placement:"top"}},[e._v("\n          "+e._s(o.instructors.join(","))+"\n        ")])],1)]}}])}),e._v(" "),r("div",{staticClass:"page-area"},[e.page.data.total>0?r("Pagination",{attrs:{total:e.page.data.total,current:e.page.data.page,"page-size":e.page.data.pageSize,"show-elevator":"",placement:"top","show-sizer":""},on:{"on-change":e.page.pageChanged,"on-page-size-change":e.page.pageSizeChanged}}):e._e()],1)],1)}),[],!1,null,"59f93a89",null).exports},72827:function(e,t,r){"use strict";r.d(t,{Z:function(){return l}});var o=r(925706),n=r(391737),i=r(48496),a=r(117403),s=r(441942),c=r(77343),u=(0,o.aZ)({name:"CoursePkgSelectModal",components:{PackageList:s.Z},setup:function(){var e,t=(0,o.iH)(void 0),r=(0,o.iH)(!0),s=null===(e=window.globalData)||void 0===e?void 0:e.user.userNo;return{selected:t,confirm:function(){var e,o,s,u;if(t.value)if(r.value=!1,null===(o=null===(e=window.globalData)||void 0===e?void 0:e.course)||void 0===o?void 0:o.id){var l=(0,n.useAngularScope)(document.querySelector('[ng-controller="CourseHeaderCtrl"]'));(0,c.Zb)(null===(u=null===(s=window.globalData)||void 0===s?void 0:s.course)||void 0===u?void 0:u.id,t.value).then((function(){l.vueMethods.moodleImporterStatus(0)})).catch((function(){l.vueMethods.updateImporterStatus(void 0)}))}else{var d=(0,n.useAngularScope)(document.querySelector('[ng-controller="CourseListCtrl"]'));(0,c.ZV)(t.value).then((function(){i.Toast.success(a.default.t("moodleCourseImport.importing")),d.startCourseImportTaskInterval("progressing")})).catch((function(){}))}},show:r,userNo:s}}}),l=(0,r(551900).Z)(u,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("Modal",{ref:"modal",attrs:{value:e.show,width:900,title:e.$t("selectMoodlePkg")}},[r("PackageList",{attrs:{"select-able":!0,"instructor-no":e.userNo},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}}),e._v(" "),r("div",{attrs:{slot:"footer"},slot:"footer"},[r("Button",{staticClass:"btn btn-primary",attrs:{disabled:!e.selected,type:"primary"},on:{click:e.confirm}},[e._v(e._s(e.$t("confirm")))]),e._v(" "),r("Button",{staticClass:"btn-default btn-minor",on:{click:function(t){e.show=!1}}},[e._v(e._s(e.$t("cancel")))])],1)],1)}),[],!1,null,"5d51fc2a",null).exports},979262:function(e,t,r){var o;e=r.nmd(e),function(){"use strict";var n={function:!0,object:!0},i=n[typeof window]&&window||this,a=n[typeof t]&&t,s=n.object&&e&&!e.nodeType&&e,c=a&&s&&"object"==typeof r.g&&r.g;!c||c.global!==c&&c.window!==c&&c.self!==c||(i=c);var u=Math.pow(2,53)-1,l=/\bOpera/,d=Object.prototype,p=d.hasOwnProperty,f=d.toString;function v(e){return(e=String(e)).charAt(0).toUpperCase()+e.slice(1)}function m(e){return e=w(e),/^(?:webOS|i(?:OS|P))/.test(e)?e:v(e)}function h(e,t){for(var r in e)p.call(e,r)&&t(e[r],r,e)}function g(e){return null==e?v(e):f.call(e).slice(8,-1)}function y(e){return String(e).replace(/([ -])(?!$)/g,"$1?")}function b(e,t){var r=null;return function(e,t){var r=-1,o=e?e.length:0;if("number"==typeof o&&o>-1&&o<=u)for(;++r<o;)t(e[r],r,e);else h(e,t)}(e,(function(o,n){r=t(r,o,n,e)})),r}function w(e){return String(e).replace(/^ +| +$/g,"")}var _=function e(t){var r=i,o=t&&"object"==typeof t&&"String"!=g(t);o&&(r=t,t=null);var n=r.navigator||{},a=n.userAgent||"";t||(t=a);var s,c,u,d,p,v=o?!!n.likeChrome:/\bChrome\b/.test(t)&&!/internal|\n/i.test(f.toString()),_="Object",S=o?_:"ScriptBridgingProxyObject",C=o?_:"Environment",x=o&&r.java?"JavaPackage":g(r.java),k=o?_:"RuntimeObject",P=/\bJava/.test(x)&&r.java,E=P&&g(r.environment)==C,T=P?"a":"α",M=P?"b":"β",A=r.document||{},F=r.operamini||r.opera,I=l.test(I=o&&F?F["[[Class]]"]:g(F))?I:F=null,$=t,U=[],O=null,R=t==a,B=R&&F&&"function"==typeof F.version&&F.version(),L=b([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"],(function(e,r){return e||RegExp("\\b"+(r.pattern||y(r))+"\\b","i").exec(t)&&(r.label||r)})),j=function(e){return b(e,(function(e,r){return e||RegExp("\\b"+(r.pattern||y(r))+"\\b","i").exec(t)&&(r.label||r)}))}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),z=N([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),D=function(e){return b(e,(function(e,r,o){return e||(r[z]||r[/^[a-z]+(?: +[a-z]+\b)*/i.exec(z)]||RegExp("\\b"+y(o)+"(?:\\b|\\w*\\d)","i").exec(t))&&o}))}({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}}),V=function(e){return b(e,(function(e,r){var o=r.pattern||y(r);return!e&&(e=RegExp("\\b"+o+"(?:/[\\d.]+|[ \\w.]*)","i").exec(t))&&(e=function(e,t,r){var o={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return t&&r&&/^Win/i.test(e)&&!/^Windows Phone /i.test(e)&&(o=o[/[\d.]+$/.exec(e)])&&(e="Windows "+o),e=String(e),t&&r&&(e=e.replace(RegExp(t,"i"),r)),m(e.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}(e,o,r.label||r)),e}))}(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function N(e){return b(e,(function(e,r){var o=r.pattern||y(r);return!e&&(e=RegExp("\\b"+o+" *\\d+[.\\w_]*","i").exec(t)||RegExp("\\b"+o+" *\\w+-[\\w]*","i").exec(t)||RegExp("\\b"+o+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(t))&&((e=String(r.label&&!RegExp(o,"i").test(r.label)?r.label:e).split("/"))[1]&&!/[\d.]+/.test(e[0])&&(e[0]+=" "+e[1]),r=r.label||r,e=m(e[0].replace(RegExp(o,"i"),r).replace(RegExp("; *(?:"+r+"[_-])?","i")," ").replace(RegExp("("+r+")[-_.]?(\\w)","i"),"$1 $2"))),e}))}function W(e){return b(e,(function(e,r){return e||(RegExp(r+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(t)||0)[1]||null}))}if(L&&(L=[L]),/\bAndroid\b/.test(V)&&!z&&(s=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(t))&&(z=w(s[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),D&&!z?z=N([D]):D&&z&&(z=z.replace(RegExp("^("+y(D)+")[-_.\\s]","i"),D+" ").replace(RegExp("^("+y(D)+")[-_.]?(\\w)","i"),D+" $2")),(s=/\bGoogle TV\b/.exec(z))&&(z=s[0]),/\bSimulator\b/i.test(t)&&(z=(z?z+" ":"")+"Simulator"),"Opera Mini"==j&&/\bOPiOS\b/.test(t)&&U.push("running in Turbo/Uncompressed mode"),"IE"==j&&/\blike iPhone OS\b/.test(t)?(D=(s=e(t.replace(/like iPhone OS/,""))).manufacturer,z=s.product):/^iP/.test(z)?(j||(j="Safari"),V="iOS"+((s=/ OS ([\d_]+)/i.exec(t))?" "+s[1].replace(/_/g,"."):"")):"Konqueror"==j&&/^Linux\b/i.test(V)?V="Kubuntu":D&&"Google"!=D&&(/Chrome/.test(j)&&!/\bMobile Safari\b/i.test(t)||/\bVita\b/.test(z))||/\bAndroid\b/.test(V)&&/^Chrome/.test(j)&&/\bVersion\//i.test(t)?(j="Android Browser",V=/\bAndroid\b/.test(V)?V:"Android"):"Silk"==j?(/\bMobi/i.test(t)||(V="Android",U.unshift("desktop mode")),/Accelerated *= *true/i.test(t)&&U.unshift("accelerated")):"UC Browser"==j&&/\bUCWEB\b/.test(t)?U.push("speed mode"):"PaleMoon"==j&&(s=/\bFirefox\/([\d.]+)\b/.exec(t))?U.push("identifying as Firefox "+s[1]):"Firefox"==j&&(s=/\b(Mobile|Tablet|TV)\b/i.exec(t))?(V||(V="Firefox OS"),z||(z=s[1])):!j||(s=!/\bMinefield\b/i.test(t)&&/\b(?:Firefox|Safari)\b/.exec(j))?(j&&!z&&/[\/,]|^[^(]+?\)/.test(t.slice(t.indexOf(s+"/")+8))&&(j=null),(s=z||D||V)&&(z||D||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(V))&&(j=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(V)?V:s)+" Browser")):"Electron"==j&&(s=(/\bChrome\/([\d.]+)\b/.exec(t)||0)[1])&&U.push("Chromium "+s),B||(B=W(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",y(j),"(?:Firefox|Minefield|NetFront)"])),(s=("iCab"==L&&parseFloat(B)>3?"WebKit":/\bOpera\b/.test(j)&&(/\bOPR\b/.test(t)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(t)&&!/^(?:Trident|EdgeHTML)$/.test(L)&&"WebKit"||!L&&/\bMSIE\b/i.test(t)&&("Mac OS"==V?"Tasman":"Trident")||"WebKit"==L&&/\bPlayStation\b(?! Vita\b)/i.test(j)&&"NetFront")&&(L=[s]),"IE"==j&&(s=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(t)||0)[1])?(j+=" Mobile",V="Windows Phone "+(/\+$/.test(s)?s:s+".x"),U.unshift("desktop mode")):/\bWPDesktop\b/i.test(t)?(j="IE Mobile",V="Windows Phone 8.x",U.unshift("desktop mode"),B||(B=(/\brv:([\d.]+)/.exec(t)||0)[1])):"IE"!=j&&"Trident"==L&&(s=/\brv:([\d.]+)/.exec(t))&&(j&&U.push("identifying as "+j+(B?" "+B:"")),j="IE",B=s[1]),R){if(d="global",p=null!=(u=r)?typeof u[d]:"number",/^(?:boolean|number|string|undefined)$/.test(p)||"object"==p&&!u[d])g(s=r.runtime)==S?(j="Adobe AIR",V=s.flash.system.Capabilities.os):g(s=r.phantom)==k?(j="PhantomJS",B=(s=s.version||null)&&s.major+"."+s.minor+"."+s.patch):"number"==typeof A.documentMode&&(s=/\bTrident\/(\d+)/i.exec(t))?(B=[B,A.documentMode],(s=+s[1]+4)!=B[1]&&(U.push("IE "+B[1]+" mode"),L&&(L[1]=""),B[1]=s),B="IE"==j?String(B[1].toFixed(1)):B[0]):"number"==typeof A.documentMode&&/^(?:Chrome|Firefox)\b/.test(j)&&(U.push("masking as "+j+" "+B),j="IE",B="11.0",L=["Trident"],V="Windows");else if(P&&($=(s=P.lang.System).getProperty("os.arch"),V=V||s.getProperty("os.name")+" "+s.getProperty("os.version")),E){try{B=r.require("ringo/engine").version.join("."),j="RingoJS"}catch(e){(s=r.system)&&s.global.system==r.system&&(j="Narwhal",V||(V=s[0].os||null))}j||(j="Rhino")}else"object"==typeof r.process&&!r.process.browser&&(s=r.process)&&("object"==typeof s.versions&&("string"==typeof s.versions.electron?(U.push("Node "+s.versions.node),j="Electron",B=s.versions.electron):"string"==typeof s.versions.nw&&(U.push("Chromium "+B,"Node "+s.versions.node),j="NW.js",B=s.versions.nw)),j||(j="Node.js",$=s.arch,V=s.platform,B=(B=/[\d.]+/.exec(s.version))?B[0]:null));V=V&&m(V)}if(B&&(s=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(B)||/(?:alpha|beta)(?: ?\d)?/i.exec(t+";"+(R&&n.appMinorVersion))||/\bMinefield\b/i.test(t)&&"a")&&(O=/b/i.test(s)?"beta":"alpha",B=B.replace(RegExp(s+"\\+?$"),"")+("beta"==O?M:T)+(/\d+\+?/.exec(s)||"")),"Fennec"==j||"Firefox"==j&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(V))j="Firefox Mobile";else if("Maxthon"==j&&B)B=B.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(z))"Xbox 360"==z&&(V=null),"Xbox 360"==z&&/\bIEMobile\b/.test(t)&&U.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(j)&&(!j||z||/Browser|Mobi/.test(j))||"Windows CE"!=V&&!/Mobi/i.test(t))if("IE"==j&&R)try{null===r.external&&U.unshift("platform preview")}catch(e){U.unshift("embedded")}else(/\bBlackBerry\b/.test(z)||/\bBB10\b/.test(t))&&(s=(RegExp(z.replace(/ +/g," *")+"/([.\\d]+)","i").exec(t)||0)[1]||B)?(V=((s=[s,/BB10/.test(t)])[1]?(z=null,D="BlackBerry"):"Device Software")+" "+s[0],B=null):this!=h&&"Wii"!=z&&(R&&F||/Opera/.test(j)&&/\b(?:MSIE|Firefox)\b/i.test(t)||"Firefox"==j&&/\bOS X (?:\d+\.){2,}/.test(V)||"IE"==j&&(V&&!/^Win/.test(V)&&B>5.5||/\bWindows XP\b/.test(V)&&B>8||8==B&&!/\bTrident\b/.test(t)))&&!l.test(s=e.call(h,t.replace(l,"")+";"))&&s.name&&(s="ing as "+s.name+((s=s.version)?" "+s:""),l.test(j)?(/\bIE\b/.test(s)&&"Mac OS"==V&&(V=null),s="identify"+s):(s="mask"+s,j=I?m(I.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(s)&&(V=null),R||(B=null)),L=["Presto"],U.push(s));else j+=" Mobile";(s=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(t)||0)[1])&&(s=[parseFloat(s.replace(/\.(\d)$/,".0$1")),s],"Safari"==j&&"+"==s[1].slice(-1)?(j="WebKit Nightly",O="alpha",B=s[1].slice(0,-1)):B!=s[1]&&B!=(s[2]=(/\bSafari\/([\d.]+\+?)/i.exec(t)||0)[1])||(B=null),s[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(t)||0)[1],537.36==s[0]&&537.36==s[2]&&parseFloat(s[1])>=28&&"WebKit"==L&&(L=["Blink"]),R&&(v||s[1])?(L&&(L[1]="like Chrome"),s=s[1]||((s=s[0])<530?1:s<532?2:s<532.05?3:s<533?4:s<534.03?5:s<534.07?6:s<534.1?7:s<534.13?8:s<534.16?9:s<534.24?10:s<534.3?11:s<535.01?12:s<535.02?"13+":s<535.07?15:s<535.11?16:s<535.19?17:s<536.05?18:s<536.1?19:s<537.01?20:s<537.11?"21+":s<537.13?23:s<537.18?24:s<537.24?25:s<537.36?26:"Blink"!=L?"27":"28")):(L&&(L[1]="like Safari"),s=(s=s[0])<400?1:s<500?2:s<526?3:s<533?4:s<534?"4+":s<535?5:s<537?6:s<538?7:s<601?8:s<602?9:s<604?10:s<606?11:s<608?12:"12"),L&&(L[1]+=" "+(s+="number"==typeof s?".x":/[.+]/.test(s)?"":"+")),"Safari"==j&&(!B||parseInt(B)>45)?B=s:"Chrome"==j&&/\bHeadlessChrome/i.test(t)&&U.unshift("headless")),"Opera"==j&&(s=/\bzbov|zvav$/.exec(V))?(j+=" ",U.unshift("desktop mode"),"zvav"==s?(j+="Mini",B=null):j+="Mobile",V=V.replace(RegExp(" *"+s+"$"),"")):"Safari"==j&&/\bChrome\b/.exec(L&&L[1])?(U.unshift("desktop mode"),j="Chrome Mobile",B=null,/\bOS X\b/.test(V)?(D="Apple",V="iOS 4.3+"):V=null):/\bSRWare Iron\b/.test(j)&&!B&&(B=W("Chrome")),B&&0==B.indexOf(s=/[\d.]+$/.exec(V))&&t.indexOf("/"+s+"-")>-1&&(V=w(V.replace(s,""))),V&&-1!=V.indexOf(j)&&!RegExp(j+" OS").test(V)&&(V=V.replace(RegExp(" *"+y(j)+" *"),"")),L&&!/\b(?:Avant|Nook)\b/.test(j)&&(/Browser|Lunascape|Maxthon/.test(j)||"Safari"!=j&&/^iOS/.test(V)&&/\bSafari\b/.test(L[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(j)&&L[1])&&(s=L[L.length-1])&&U.push(s),U.length&&(U=["("+U.join("; ")+")"]),D&&z&&z.indexOf(D)<0&&U.push("on "+D),z&&U.push((/^on /.test(U[U.length-1])?"":"on ")+z),V&&(s=/ ([\d.+]+)$/.exec(V),c=s&&"/"==V.charAt(V.length-s[0].length-1),V={architecture:32,family:s&&!c?V.replace(s[0],""):V,version:s?s[1]:null,toString:function(){var e=this.version;return this.family+(e&&!c?" "+e:"")+(64==this.architecture?" 64-bit":"")}}),(s=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec($))&&!/\bi686\b/i.test($)?(V&&(V.architecture=64,V.family=V.family.replace(RegExp(" *"+s),"")),j&&(/\bWOW64\b/i.test(t)||R&&/\w(?:86|32)$/.test(n.cpuClass||n.platform)&&!/\bWin64; x64\b/i.test(t))&&U.unshift("32-bit")):V&&/^OS X/.test(V.family)&&"Chrome"==j&&parseFloat(B)>=39&&(V.architecture=64),t||(t=null);var H={};return H.description=t,H.layout=L&&L[0],H.manufacturer=D,H.name=j,H.prerelease=O,H.product=z,H.ua=t,H.version=j&&B,H.os=V||{architecture:null,family:null,version:null,toString:function(){return"null"}},H.parse=e,H.toString=function(){return this.description||""},H.version&&U.unshift(B),H.name&&U.unshift(j),V&&j&&(V!=String(V).split(" ")[0]||V!=j.split(" ")[0]&&!z)&&U.push(z?"("+V+")":"on "+V),U.length&&(H.description=U.join(" ")),H}();i.platform=_,void 0===(o=function(){return _}.call(t,r,t,e))||(e.exports=o)}.call(this)},842480:function(){}}]);