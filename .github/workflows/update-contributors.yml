name: Update Contributors

on:
  schedule:
    - cron: '0 2 * * 1' # æ¯å‘¨ä¸€å‡Œæ™¨2ç‚¹è‡ªåŠ¨æ›´æ–°
  push:
    branches: [ main ]
  workflow_dispatch: # å…è®¸æ‰‹åŠ¨è§¦å‘

jobs:
  update-contributors:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
      
    - name: Update contributors section
      uses: wow-actions/contributors-readme@v1
      with:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        filename: README.md
        format: table
        max: 100
        flush: false
        includeBots: false
        round: true
        size: 80
        sortBy: contributions
        affiliation: all
        noCommit: false
        excludeUsers: 'web-flow,dependabot[bot],github-actions[bot]'
        template: |
          {{#each contributors}}
          <a href="{{htmlUrl}}">
            <img src="{{avatar}}&s={{../size}}" width="{{../size}}" style="border-radius: 50%;" alt="{{login}}"/>
          </a>
          {{/each}}
        
    - name: Commit changes
      uses: stefanzweifel/git-auto-commit-action@v5
      with:
        commit_message: 'ğŸ¤– è‡ªåŠ¨æ›´æ–°è´¡çŒ®è€…åˆ—è¡¨'
        file_pattern: README.md
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}